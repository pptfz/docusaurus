"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[9539],{53069:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>x,contentTitle:()=>$,default:()=>l,frontMatter:()=>r,metadata:()=>s,toc:()=>a});var o=i(74848),t=i(28453);const r={},$=void 0,s={id:"linux/shell/\u5404\u79cd\u811a\u672c/\u5927\u795e\u6770\u4f5c/shell\u811a\u672c-\u4fc4\u7f57\u65af\u65b9\u5757",title:"shell\u811a\u672c-\u4fc4\u7f57\u65af\u65b9\u5757",description:"shell\u811a\u672c-\u4fc4\u7f57\u65af\u65b9\u5757",source:"@site/docs/linux/shell/\u5404\u79cd\u811a\u672c/\u5927\u795e\u6770\u4f5c/shell\u811a\u672c-\u4fc4\u7f57\u65af\u65b9\u5757.md",sourceDirName:"linux/shell/\u5404\u79cd\u811a\u672c/\u5927\u795e\u6770\u4f5c",slug:"/linux/shell/\u5404\u79cd\u811a\u672c/\u5927\u795e\u6770\u4f5c/shell\u811a\u672c-\u4fc4\u7f57\u65af\u65b9\u5757",permalink:"/docs/linux/shell/\u5404\u79cd\u811a\u672c/\u5927\u795e\u6770\u4f5c/shell\u811a\u672c-\u4fc4\u7f57\u65af\u65b9\u5757",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u7cfb\u7edf\u4f18\u5316\u811a\u672c",permalink:"/docs/linux/shell/\u5404\u79cd\u811a\u672c/\u4f18\u5316\u811a\u672c/\u7cfb\u7edf\u4f18\u5316\u811a\u672c"},next:{title:"shell\u811a\u672c\u5224\u65ad\u7cfb\u7edf\u7c7b\u578b",permalink:"/docs/linux/shell/\u5404\u79cd\u811a\u672c/\u5b9e\u9645\u5e94\u7528\u811a\u672c/shell\u811a\u672c\u5224\u65ad\u7cfb\u7edf\u7c7b\u578b"}},x={},a=[];function c(n){const e={code:"code",p:"p",pre:"pre",...(0,t.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.p,{children:"shell\u811a\u672c-\u4fc4\u7f57\u65af\u65b9\u5757"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:'#!/bin/bash\n\n#\u989c\u8272\u5b9a\u4e49\ncRed=1\ncGreen=2\ncYellow=3\ncBlue=4\ncFuchsia=5\ncCyan=6\ncWhite=7\ncolorTable=($cRed $cGreen $cYellow $cBlue $cFuchsia $cCyan $cWhite)\n\n#\u4f4d\u7f6e\u548c\u5927\u5c0f\niLeft=3\niTop=2\n((iTrayLeft = iLeft + 2))\n((iTrayTop = iTop + 1))\n((iTrayWidth = 10))\n((iTrayHeight = 15))\n\n#\u989c\u8272\u8bbe\u7f6e\ncBorder=$cGreen\ncScore=$cFuchsia\ncScoreValue=$cCyan\n\n#\u63a7\u5236\u4fe1\u53f7\n#\u6539\u6e38\u620f\u4f7f\u7528\u4e24\u4e2a\u8fdb\u7a0b\uff0c\u4e00\u4e2a\u7528\u4e8e\u63a5\u6536\u8f93\u5165\uff0c\u4e00\u4e2a\u7528\u4e8e\u6e38\u620f\u6d41\u7a0b\u548c\u663e\u793a\u754c\u9762;\n#\u5f53\u524d\u8005\u63a5\u6536\u5230\u4e0a\u4e0b\u5de6\u53f3\u7b49\u6309\u952e\u65f6\uff0c\u901a\u8fc7\u5411\u540e\u8005\u53d1\u9001signal\u7684\u65b9\u5f0f\u901a\u77e5\u540e\u8005\u3002\nsigRotate=25\nsigLeft=26\nsigRight=27\nsigDown=28\nsigAllDown=29\nsigExit=30\n\n#\u4e03\u4e2d\u4e0d\u540c\u7684\u65b9\u5757\u7684\u5b9a\u4e49\n#\u901a\u8fc7\u65cb\u8f6c\uff0c\u6bcf\u79cd\u65b9\u5757\u7684\u663e\u793a\u7684\u6837\u5f0f\u53ef\u80fd\u6709\u51e0\u79cd\nbox0=(0 0 0 1 1 0 1 1)\nbox1=(0 2 1 2 2 2 3 2 1 0 1 1 1 2 1 3)\nbox2=(0 0 0 1 1 1 1 2 0 1 1 0 1 1 2 0)\nbox3=(0 1 0 2 1 0 1 1 0 0 1 0 1 1 2 1)\nbox4=(0 1 0 2 1 1 2 1 1 0 1 1 1 2 2 2 0 1 1 1 2 0 2 1 0 0 1 0 1 1 1 2)\nbox5=(0 1 1 1 2 1 2 2 1 0 1 1 1 2 2 0 0 0 0 1 1 1 2 1 0 2 1 0 1 1 1 2)\nbox6=(0 1 1 1 1 2 2 1 1 0 1 1 1 2 2 1 0 1 1 0 1 1 2 1 0 1 1 0 1 1 1 2)\n#\u6240\u6709\u5176\u4e2d\u65b9\u5757\u7684\u5b9a\u4e49\u90fd\u653e\u5230box\u53d8\u91cf\u4e2d\nbox=(${box0[@]} ${box1[@]} ${box2[@]} ${box3[@]} ${box4[@]} ${box5[@]} ${box6[@]})\n#\u5404\u79cd\u65b9\u5757\u65cb\u8f6c\u540e\u53ef\u80fd\u7684\u6837\u5f0f\u6570\u76ee\ncountBox=(1 2 2 2 4 4 4)\n#\u5404\u79cd\u65b9\u5757\u518dbox\u6570\u7ec4\u4e2d\u7684\u504f\u79fb\noffsetBox=(0 1 3 5 7 11 15)\n\n#\u6bcf\u63d0\u9ad8\u4e00\u4e2a\u901f\u5ea6\u7ea7\u9700\u8981\u79ef\u7d2f\u7684\u5206\u6570\niScoreEachLevel=50  #be greater than 7\n\n#\u8fd0\u884c\u65f6\u6570\u636e\nsig=0       #\u63a5\u6536\u5230\u7684signal\niScore=0    #\u603b\u5206\niLevel=0    #\u901f\u5ea6\u7ea7\nboxNew=()   #\u65b0\u4e0b\u843d\u7684\u65b9\u5757\u7684\u4f4d\u7f6e\u5b9a\u4e49\ncBoxNew=0   #\u65b0\u4e0b\u843d\u7684\u65b9\u5757\u7684\u989c\u8272\niBoxNewType=0   #\u65b0\u4e0b\u843d\u7684\u65b9\u5757\u7684\u79cd\u7c7b\niBoxNewRotate=0 #\u65b0\u4e0b\u843d\u7684\u65b9\u5757\u7684\u65cb\u8f6c\u89d2\u5ea6\nboxCur=()   #\u5f53\u524d\u65b9\u5757\u7684\u4f4d\u7f6e\u5b9a\u4e49\ncBoxCur=0   #\u5f53\u524d\u65b9\u5757\u7684\u989c\u8272\niBoxCurType=0   #\u5f53\u524d\u65b9\u5757\u7684\u79cd\u7c7b\niBoxCurRotate=0 #\u5f53\u524d\u65b9\u5757\u7684\u65cb\u8f6c\u89d2\u5ea6\nboxCurX=-1  #\u5f53\u524d\u65b9\u5757\u7684x\u5750\u6807\u4f4d\u7f6e\nboxCurY=-1  #\u5f53\u524d\u65b9\u5757\u7684y\u5750\u6807\u4f4d\u7f6e\niMap=()     #\u80cc\u666f\u65b9\u5757\u56fe\u8868\n\n#\u521d\u59cb\u5316\u6240\u6709\u80cc\u666f\u65b9\u5757\u4e3a-1, \u8868\u793a\u6ca1\u6709\u65b9\u5757\nfor ((i = 0; i < iTrayHeight * iTrayWidth; i++)); do iMap[$i]=-1; done\n\n#\u63a5\u6536\u8f93\u5165\u7684\u8fdb\u7a0b\u7684\u4e3b\u51fd\u6570\nfunction RunAsKeyReceiver()\n{\n    local pidDisplayer key aKey sig cESC sTTY\n\n    pidDisplayer=$1\n    aKey=(0 0 0)\n\n    cESC=`echo -ne "\\033"`\n    cSpace=`echo -ne "\\040"`\n\n    #\u4fdd\u5b58\u7ec8\u7aef\u5c5e\u6027\u3002\u5728read -s\u8bfb\u53d6\u7ec8\u7aef\u952e\u65f6\uff0c\u7ec8\u7aef\u7684\u5c5e\u6027\u4f1a\u88ab\u6682\u65f6\u6539\u53d8\u3002\n    #\u5982\u679c\u5728read -s\u65f6\u7a0b\u5e8f\u88ab\u4e0d\u5e78\u6740\u6389\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7ec8\u7aef\u6df7\u4e71\uff0c\n    #\u9700\u8981\u5728\u7a0b\u5e8f\u9000\u51fa\u65f6\u6062\u590d\u7ec8\u7aef\u5c5e\u6027\u3002\n    sTTY=`stty -g`\n\n    #\u6355\u6349\u9000\u51fa\u4fe1\u53f7\n    trap "MyExit;" INT TERM\n    trap "MyExitNoSub;" $sigExit\n\n    #\u9690\u85cf\u5149\u6807\n    echo -ne "\\033[?25l"\n\n\n    while (( 1 ))\n    do\n        #\u8bfb\u53d6\u8f93\u5165\u3002\u6ce8-s\u4e0d\u56de\u663e\uff0c-n\u8bfb\u5230\u4e00\u4e2a\u5b57\u7b26\u7acb\u5373\u8fd4\u56de\n        read -s -n 1 key\n\n        aKey[0]=${aKey[1]}\n        aKey[1]=${aKey[2]}\n        aKey[2]=$key\n        sig=0\n\n        #\u5224\u65ad\u8f93\u5165\u4e86\u4f55\u79cd\u952e\n        if [[ $key == $cESC && ${aKey[1]} == $cESC ]]\n        then\n            #ESC\u952e\n            MyExit\n        elif [[ ${aKey[0]} == $cESC && ${aKey[1]} == "[" ]]\n        then\n            if [[ $key == "A" ]]; then sig=$sigRotate    #<\u5411\u4e0a\u952e>\n            elif [[ $key == "B" ]]; then sig=$sigDown   #<\u5411\u4e0b\u952e>\n            elif [[ $key == "D" ]]; then sig=$sigLeft   #<\u5411\u5de6\u952e>\n            elif [[ $key == "C" ]]; then sig=$sigRight  #<\u5411\u53f3\u952e>\n            fi\n        elif [[ $key == "W" || $key == "w" ]]; then sig=$sigRotate   #W, w\n        elif [[ $key == "S" || $key == "s" ]]; then sig=$sigDown #S, s\n        elif [[ $key == "A" || $key == "a" ]]; then sig=$sigLeft #A, a\n        elif [[ $key == "D" || $key == "d" ]]; then sig=$sigRight    #D, d\n        elif [[ "[$key]" == "[]" ]]; then sig=$sigAllDown  #\u7a7a\u683c\u952e\n        elif [[ $key == "Q" || $key == "q" ]]         #Q, q\n        then\n            MyExit\n        fi\n\n        if [[ $sig != 0 ]]\n        then\n            #\u5411\u53e6\u4e00\u8fdb\u7a0b\u53d1\u9001\u6d88\u606f\n            kill -$sig $pidDisplayer\n        fi\n    done\n}\n\n#\u9000\u51fa\u524d\u7684\u6062\u590d\nfunction MyExitNoSub()\n{\n    local y\n\n    #\u6062\u590d\u7ec8\u7aef\u5c5e\u6027\n    stty $sTTY\n    ((y = iTop + iTrayHeight + 4))\n\n    #\u663e\u793a\u5149\u6807\n    echo -e "\\033[?25h\\033[${y};0H"\n    exit\n}\n\n\nfunction MyExit()\n{\n    #\u901a\u77e5\u663e\u793a\u8fdb\u7a0b\u9700\u8981\u9000\u51fa\n    kill -$sigExit $pidDisplayer\n\n    MyExitNoSub\n}\n\n\n#\u5904\u7406\u663e\u793a\u548c\u6e38\u620f\u6d41\u7a0b\u7684\u4e3b\u51fd\u6570\nfunction RunAsDisplayer()\n{\n    local sigThis\n    InitDraw\n\n    #\u6302\u8f7d\u5404\u79cd\u4fe1\u53f7\u7684\u5904\u7406\u51fd\u6570\n    trap "sig=$sigRotate;" $sigRotate\n    trap "sig=$sigLeft;" $sigLeft\n    trap "sig=$sigRight;" $sigRight\n    trap "sig=$sigDown;" $sigDown\n    trap "sig=$sigAllDown;" $sigAllDown\n    trap "ShowExit;" $sigExit\n\n    while (( 1 ))\n    do\n        #\u6839\u636e\u5f53\u524d\u7684\u901f\u5ea6\u7ea7iLevel\u4e0d\u540c\uff0c\u8bbe\u5b9a\u76f8\u5e94\u7684\u5faa\u73af\u7684\u6b21\u6570\n        for ((i = 0; i < 21 - iLevel; i++))\n        do\n            sleep 0.02\n            sigThis=$sig\n            sig=0\n\n            #\u6839\u636esig\u53d8\u91cf\u5224\u65ad\u662f\u5426\u63a5\u53d7\u5230\u76f8\u5e94\u7684\u4fe1\u53f7\n            if ((sigThis == sigRotate)); then BoxRotate;    #\u65cb\u8f6c\n            elif ((sigThis == sigLeft)); then BoxLeft;  #\u5de6\u79fb\u4e00\u5217\n            elif ((sigThis == sigRight)); then BoxRight;    #\u53f3\u79fb\u4e00\u5217\n            elif ((sigThis == sigDown)); then BoxDown;  #\u4e0b\u843d\u4e00\u884c\n            elif ((sigThis == sigAllDown)); then BoxAllDown;    #\u4e0b\u843d\u5230\u5e95\n            fi\n        done\n        #kill -$sigDown $$\n        BoxDown #\u4e0b\u843d\u4e00\u884c\n    done\n}\n\n\n#BoxMove(y, x), \u6d4b\u8bd5\u662f\u5426\u53ef\u4ee5\u628a\u79fb\u52a8\u4e2d\u7684\u65b9\u5757\u79fb\u5230(x, y)\u7684\u4f4d\u7f6e, \u8fd4\u56de0\u5219\u53ef\u4ee5, 1\u4e0d\u53ef\u4ee5\nfunction BoxMove()\n{\n    local j i x y xTest yTest\n    yTest=$1\n    xTest=$2\n    for ((j = 0; j < 8; j += 2))\n    do\n        ((i = j + 1))\n        ((y = ${boxCur[$j]} + yTest))\n        ((x = ${boxCur[$i]} + xTest))\n        if (( y < 0 || y >= iTrayHeight || x < 0 || x >= iTrayWidth))\n        then\n            #\u649e\u5230\u5899\u58c1\u4e86\n            return 1\n        fi\n        if ((${iMap[y * iTrayWidth + x]} != -1 ))\n        then\n            #\u649e\u5230\u5176\u4ed6\u5df2\u7ecf\u5b58\u5728\u7684\u65b9\u5757\u4e86\n            return 1\n        fi\n    done\n    return 0;\n}\n\n\n#\u5c06\u5f53\u524d\u79fb\u52a8\u4e2d\u7684\u65b9\u5757\u653e\u5230\u80cc\u666f\u65b9\u5757\u4e2d\u53bb,\n#\u5e76\u8ba1\u7b97\u65b0\u7684\u5206\u6570\u548c\u901f\u5ea6\u7ea7\u3002(\u5373\u4e00\u6b21\u65b9\u5757\u843d\u5230\u5e95\u90e8)\nfunction Box2Map()\n{\n    local j i x y xp yp line\n\n    #\u5c06\u5f53\u524d\u79fb\u52a8\u4e2d\u7684\u65b9\u5757\u653e\u5230\u80cc\u666f\u65b9\u5757\u4e2d\u53bb\n    for ((j = 0; j < 8; j += 2))\n    do\n        ((i = j + 1))\n        ((y = ${boxCur[$j]} + boxCurY))\n        ((x = ${boxCur[$i]} + boxCurX))\n        ((i = y * iTrayWidth + x))\n        iMap[$i]=$cBoxCur\n    done\n\n    #\u6d88\u53bb\u53ef\u88ab\u6d88\u53bb\u7684\u884c\n    line=0\n    for ((j = 0; j < iTrayWidth * iTrayHeight; j += iTrayWidth))\n    do\n        for ((i = j + iTrayWidth - 1; i >= j; i--))\n        do\n            if ((${iMap[$i]} == -1)); then break; fi\n        done\n        if ((i >= j)); then continue; fi\n\n        ((line++))       \n        for ((i = j - 1; i >= 0; i--))\n        do\n            ((x = i + iTrayWidth))\n            iMap[$x]=${iMap[$i]}\n        done\n        for ((i = 0; i < iTrayWidth; i++))\n        do\n            iMap[$i]=-1\n        done\n    done\n\n    if ((line == 0)); then return; fi\n\n    #\u6839\u636e\u6d88\u53bb\u7684\u884c\u6570line\u8ba1\u7b97\u5206\u6570\u548c\u901f\u5ea6\u7ea7\n    ((x = iLeft + iTrayWidth * 2 + 7))\n    ((y = iTop + 11))\n    ((iScore += line * 2 - 1))\n    #\u663e\u793a\u65b0\u7684\u5206\u6570\n    echo -ne "\\033[1m\\033[3${cScoreValue}m\\033[${y};${x}H${iScore}  "\n    if ((iScore % iScoreEachLevel < line * 2 - 1))\n    then\n        if ((iLevel < 20))\n        then\n            ((iLevel++))\n            ((y = iTop + 14))\n            #\u663e\u793a\u65b0\u7684\u901f\u5ea6\u7ea7\n            echo -ne "\\033[3${cScoreValue}m\\033[${y};${x}H${iLevel}    "\n        fi\n    fi\n    echo -ne "\\033[0m"\n\n\n    #\u91cd\u65b0\u663e\u793a\u80cc\u666f\u65b9\u5757\n    for ((y = 0; y < iTrayHeight; y++))\n    do\n        ((yp = y + iTrayTop + 1))\n        ((xp = iTrayLeft + 1))\n        ((i = y * iTrayWidth))\n        echo -ne "\\033[${yp};${xp}H"\n        for ((x = 0; x < iTrayWidth; x++))\n        do\n            ((j = i + x))\n            if ((${iMap[$j]} == -1))\n            then\n                echo -ne "  "\n            else\n                echo -ne "\\033[1m\\033[7m\\033[3${iMap[$j]}m\\033[4${iMap[$j]}m[]\\033[0m"\n            fi\n        done\n    done\n}\n\n\n#\u4e0b\u843d\u4e00\u884c\nfunction BoxDown()\n{\n    local y s\n    ((y = boxCurY + 1)) #\u65b0\u7684y\u5750\u6807\n    if BoxMove $y $boxCurX    #\u6d4b\u8bd5\u662f\u5426\u53ef\u4ee5\u4e0b\u843d\u4e00\u884c\n    then\n        s="`DrawCurBox 0`"  #\u5c06\u65e7\u7684\u65b9\u5757\u62b9\u53bb\n        ((boxCurY = y))\n        s="$s`DrawCurBox 1`"   #\u663e\u793a\u65b0\u7684\u4e0b\u843d\u540e\u65b9\u5757\n        echo -ne $s\n    else\n        #\u8d70\u5230\u8fd9\u513f, \u5982\u679c\u4e0d\u80fd\u4e0b\u843d\u4e86\n        Box2Map     #\u5c06\u5f53\u524d\u79fb\u52a8\u4e2d\u7684\u65b9\u5757\u8d34\u5230\u80cc\u666f\u65b9\u5757\u4e2d\n        RandomBox   #\u4ea7\u751f\u65b0\u7684\u65b9\u5757\n    fi\n}\n\n#\u5de6\u79fb\u4e00\u5217\nfunction BoxLeft()\n{\n    local x s\n    ((x = boxCurX - 1))\n    if BoxMove $boxCurY $x\n    then\n        s=`DrawCurBox 0`\n        ((boxCurX = x))\n        s=$s`DrawCurBox 1`\n        echo -ne $s\n    fi\n}\n\n#\u53f3\u79fb\u4e00\u5217\nfunction BoxRight()\n{\n    local x s\n    ((x = boxCurX + 1))\n    if BoxMove $boxCurY $x\n    then\n        s=`DrawCurBox 0`\n        ((boxCurX = x))\n        s=$s`DrawCurBox 1`\n        echo -ne $s\n    fi\n}\n\n\n#\u4e0b\u843d\u5230\u5e95\nfunction BoxAllDown()\n{\n    local k j i x y iDown s\n    iDown=$iTrayHeight\n\n    #\u8ba1\u7b97\u4e00\u5171\u9700\u8981\u4e0b\u843d\u591a\u5c11\u884c\n    for ((j = 0; j < 8; j += 2))\n    do\n        ((i = j + 1))\n        ((y = ${boxCur[$j]} + boxCurY))\n        ((x = ${boxCur[$i]} + boxCurX))\n        for ((k = y + 1; k < iTrayHeight; k++))\n        do\n            ((i = k * iTrayWidth + x))\n            if (( ${iMap[$i]} != -1)); then break; fi\n        done\n        ((k -= y + 1))\n        if (( $iDown > $k )); then iDown=$k; fi\n    done\n\n    s=`DrawCurBox 0`    #\u5c06\u65e7\u7684\u65b9\u5757\u62b9\u53bb\n    ((boxCurY += iDown))       \n    s=$s`DrawCurBox 1` #\u663e\u793a\u65b0\u7684\u4e0b\u843d\u540e\u7684\u65b9\u5757\n    echo -ne $s\n    Box2Map     #\u5c06\u5f53\u524d\u79fb\u52a8\u4e2d\u7684\u65b9\u5757\u8d34\u5230\u80cc\u666f\u65b9\u5757\u4e2d\n    RandomBox   #\u4ea7\u751f\u65b0\u7684\u65b9\u5757\n}\n\n\n#\u65cb\u8f6c\u65b9\u5757\nfunction BoxRotate()\n{\n    local iCount iTestRotate boxTest j i s\n    iCount=${countBox[$iBoxCurType]}  #\u5f53\u524d\u7684\u65b9\u5757\u7ecf\u65cb\u8f6c\u53ef\u4ee5\u4ea7\u751f\u7684\u6837\u5f0f\u7684\u6570\u76ee\n\n    #\u8ba1\u7b97\u65cb\u8f6c\u540e\u7684\u65b0\u7684\u6837\u5f0f\n    ((iTestRotate = iBoxCurRotate + 1))\n    if ((iTestRotate >= iCount))\n    then\n        ((iTestRotate = 0))\n    fi\n\n    #\u66f4\u65b0\u5230\u65b0\u7684\u6837\u5f0f, \u4fdd\u5b58\u8001\u7684\u6837\u5f0f(\u4f46\u4e0d\u663e\u793a)\n    for ((j = 0, i = (${offsetBox[$iBoxCurType]} + $iTestRotate) * 8; j < 8; j++, i++))\n    do\n        boxTest[$j]=${boxCur[$j]}\n        boxCur[$j]=${box[$i]}\n    done\n\n    if BoxMove $boxCurY $boxCurX    #\u6d4b\u8bd5\u65cb\u8f6c\u540e\u662f\u5426\u6709\u7a7a\u95f4\u653e\u7684\u4e0b\n    then\n        #\u62b9\u53bb\u65e7\u7684\u65b9\u5757\n        for ((j = 0; j < 8; j++))\n        do\n            boxCur[$j]=${boxTest[$j]}\n        done\n        s=`DrawCurBox 0`\n\n        #\u753b\u4e0a\u65b0\u7684\u65b9\u5757\n        for ((j = 0, i = (${offsetBox[$iBoxCurType]} + $iTestRotate) * 8; j < 8; j++, i++))\n        do\n            boxCur[$j]=${box[$i]}\n        done\n        s=$s`DrawCurBox 1`\n        echo -ne $s\n        iBoxCurRotate=$iTestRotate\n    else\n        #\u4e0d\u80fd\u65cb\u8f6c\uff0c\u8fd8\u662f\u7ee7\u7eed\u4f7f\u7528\u8001\u7684\u6837\u5f0f\n        for ((j = 0; j < 8; j++))\n        do\n            boxCur[$j]=${boxTest[$j]}\n        done\n    fi\n}\n\n\n#DrawCurBox(bDraw), \u7ed8\u5236\u5f53\u524d\u79fb\u52a8\u4e2d\u7684\u65b9\u5757, bDraw\u4e3a1, \u753b\u4e0a, bDraw\u4e3a0, \u62b9\u53bb\u65b9\u5757\u3002\nfunction DrawCurBox()\n{\n    local i j t bDraw sBox s\n    bDraw=$1\n\n    s=""\n    if (( bDraw == 0 ))\n    then\n        sBox="\\040\\040"\n    else\n        sBox="[]"\n        s=$s"\\033[1m\\033[7m\\033[3${cBoxCur}m\\033[4${cBoxCur}m"       \n    fi\n\n    for ((j = 0; j < 8; j += 2))\n    do\n        ((i = iTrayTop + 1 + ${boxCur[$j]} + boxCurY))\n        ((t = iTrayLeft + 1 + 2 * (boxCurX + ${boxCur[$j + 1]})))\n        #\\33[y;xH, \u5149\u6807\u5230(x, y)\u5904\n        s=$s"\\033[${i};${t}H${sBox}"\n    done\n    s=$s"\\033[0m"\n    echo -n $s\n}\n\n\n#\u66f4\u65b0\u65b0\u7684\u65b9\u5757\nfunction RandomBox()\n{\n    local i j t\n\n    #\u66f4\u65b0\u5f53\u524d\u79fb\u52a8\u7684\u65b9\u5757\n    iBoxCurType=${iBoxNewType}\n    iBoxCurRotate=${iBoxNewRotate}\n    cBoxCur=${cBoxNew}\n    for ((j = 0; j < ${#boxNew[@]}; j++))\n    do\n        boxCur[$j]=${boxNew[$j]}\n    done\n\n\n    #\u663e\u793a\u5f53\u524d\u79fb\u52a8\u7684\u65b9\u5757\n    if (( ${#boxCur[@]} == 8 ))\n    then\n        #\u8ba1\u7b97\u5f53\u524d\u65b9\u5757\u8be5\u4ece\u9876\u7aef\u54ea\u4e00\u884c"\u5192"\u51fa\u6765\n        for ((j = 0, t = 4; j < 8; j += 2))\n        do\n            if ((${boxCur[$j]} < t)); then t=${boxCur[$j]}; fi\n        done\n        ((boxCurY = -t))\n        for ((j = 1, i = -4, t = 20; j < 8; j += 2))\n        do\n            if ((${boxCur[$j]} > i)); then i=${boxCur[$j]}; fi\n            if ((${boxCur[$j]} < t)); then t=${boxCur[$j]}; fi\n        done\n        ((boxCurX = (iTrayWidth - 1 - i - t) / 2))\n\n        #\u663e\u793a\u5f53\u524d\u79fb\u52a8\u7684\u65b9\u5757\n        echo -ne `DrawCurBox 1`\n\n        #\u5982\u679c\u65b9\u5757\u4e00\u51fa\u6765\u5c31\u6ca1\u5904\u653e\uff0cGame over!\n        if ! BoxMove $boxCurY $boxCurX\n        then\n            kill -$sigExit ${PPID}\n            ShowExit\n        fi\n    fi\n\n\n\n    #\u6e05\u9664\u53f3\u8fb9\u9884\u663e\u793a\u7684\u65b9\u5757\n    for ((j = 0; j < 4; j++))\n    do\n        ((i = iTop + 1 + j))\n        ((t = iLeft + 2 * iTrayWidth + 7))\n        echo -ne "\\033[${i};${t}H        "\n    done\n\n    #\u968f\u673a\u4ea7\u751f\u65b0\u7684\u65b9\u5757\n    ((iBoxNewType = RANDOM % ${#offsetBox[@]}))\n    ((iBoxNewRotate = RANDOM % ${countBox[$iBoxNewType]}))\n    for ((j = 0, i = (${offsetBox[$iBoxNewType]} + $iBoxNewRotate) * 8; j < 8; j++, i++))\n    do\n        boxNew[$j]=${box[$i]};\n    done\n\n    ((cBoxNew = ${colorTable[RANDOM % ${#colorTable[@]}]}))\n\n    #\u663e\u793a\u53f3\u8fb9\u9884\u663e\u793a\u7684\u65b9\u5757\n    echo -ne "\\033[1m\\033[7m\\033[3${cBoxNew}m\\033[4${cBoxNew}m"\n    for ((j = 0; j < 8; j += 2))\n    do\n        ((i = iTop + 1 + ${boxNew[$j]}))\n        ((t = iLeft + 2 * iTrayWidth + 7 + 2 * ${boxNew[$j + 1]}))\n        echo -ne "\\033[${i};${t}H[]"\n    done\n    echo -ne "\\033[0m"\n}\n\n\n#\u521d\u59cb\u7ed8\u5236\nfunction InitDraw()\n{\n    clear\n    RandomBox   #\u968f\u673a\u4ea7\u751f\u65b9\u5757\uff0c\u8fd9\u65f6\u53f3\u8fb9\u9884\u663e\u793a\u7a97\u53e3\u4e2d\u6709\u65b9\u5feb\u4e86\n    RandomBox   #\u518d\u968f\u673a\u4ea7\u751f\u65b9\u5757\uff0c\u53f3\u8fb9\u9884\u663e\u793a\u7a97\u53e3\u4e2d\u7684\u65b9\u5757\u88ab\u66f4\u65b0\uff0c\u539f\u5148\u7684\u65b9\u5757\u5c06\u5f00\u59cb\u4e0b\u843d\n    local i t1 t2 t3\n\n    #\u663e\u793a\u8fb9\u6846\n    echo -ne "\\033[1m"\n    echo -ne "\\033[3${cBorder}m\\033[4${cBorder}m"\n\n    ((t2 = iLeft + 1))\n    ((t3 = iLeft + iTrayWidth * 2 + 3))\n    for ((i = 0; i < iTrayHeight; i++))\n    do\n        ((t1 = i + iTop + 2))\n        echo -ne "\\033[${t1};${t2}H||"\n        echo -ne "\\033[${t1};${t3}H||"\n    done\n\n    ((t2 = iTop + iTrayHeight + 2))\n    for ((i = 0; i < iTrayWidth + 2; i++))\n    do\n        ((t1 = i * 2 + iLeft + 1))\n        echo -ne "\\033[${iTrayTop};${t1}H=="\n        echo -ne "\\033[${t2};${t1}H=="\n    done\n    echo -ne "\\033[0m"\n\n\n    #\u663e\u793a"Score"\u548c"Level"\u5b57\u6837\n    echo -ne "\\033[1m"\n    ((t1 = iLeft + iTrayWidth * 2 + 7))\n    ((t2 = iTop + 10))\n    echo -ne "\\033[3${cScore}m\\033[${t2};${t1}HScore"\n    ((t2 = iTop + 11))\n    echo -ne "\\033[3${cScoreValue}m\\033[${t2};${t1}H${iScore}"\n    ((t2 = iTop + 13))\n    echo -ne "\\033[3${cScore}m\\033[${t2};${t1}HLevel"\n    ((t2 = iTop + 14))\n    echo -ne "\\033[3${cScoreValue}m\\033[${t2};${t1}H${iLevel}"\n    echo -ne "\\033[0m"\n}\n\n\n#\u9000\u51fa\u65f6\u663e\u793aGameOVer!\nfunction ShowExit()\n{\n    local y\n    ((y = iTrayHeight + iTrayTop + 3))\n    echo -e "\\033[${y};0HGameOver!\\033[0m"\n    exit\n}\n\n\n\n#\u6e38\u620f\u4e3b\u7a0b\u5e8f\u5728\u8fd9\u513f\u5f00\u59cb.\nif [[ $1 != "--show" ]]\nthen\n    bash $0 --show&    #\u4ee5\u53c2\u6570--show\u5c06\u672c\u7a0b\u5e8f\u518d\u8fd0\u884c\u4e00\u904d\n    RunAsKeyReceiver $!    #\u4ee5\u4e0a\u4e00\u884c\u4ea7\u751f\u7684\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\u4f5c\u4e3a\u53c2\u6570\n    exit\nelse\n    #\u5f53\u53d1\u73b0\u5177\u6709\u53c2\u6570--show\u65f6\uff0c\u8fd0\u884c\u663e\u793a\u51fd\u6570\n    RunAsDisplayer       \n    exit\nfi\n'})})]})}function l(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(c,{...n})}):c(n)}},28453:(n,e,i)=>{i.d(e,{R:()=>$,x:()=>s});var o=i(96540);const t={},r=o.createContext(t);function $(n){const e=o.useContext(r);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:$(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);