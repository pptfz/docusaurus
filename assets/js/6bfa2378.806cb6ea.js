"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7452],{74969:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>x,frontMatter:()=>t,metadata:()=>a,toc:()=>l});var r=s(74848),i=s(28453);const t={},o="jenkins\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406\u62a5\u9519",a={id:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/jenkins/jenkins\u77e5\u8bc6\u70b9/jenkins\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406\u62a5\u9519",title:"jenkins\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406\u62a5\u9519",description:"jenkins\u5b98\u65b9\u8bf4\u660e\u6587\u6863",source:"@site/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/jenkins/jenkins\u77e5\u8bc6\u70b9/jenkins\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406\u62a5\u9519.md",sourceDirName:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/jenkins/jenkins\u77e5\u8bc6\u70b9",slug:"/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/jenkins/jenkins\u77e5\u8bc6\u70b9/jenkins\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406\u62a5\u9519",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/jenkins/jenkins\u77e5\u8bc6\u70b9/jenkins\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406\u62a5\u9519",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"jenkins\u4ece\u6784\u5efa\u751f\u6210\u8fdb\u7a0b",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/jenkins/jenkins\u77e5\u8bc6\u70b9/jenkins\u4ece\u6784\u5efa\u751f\u6210\u8fdb\u7a0b"},next:{title:"jenkins\u4fee\u6539\u4e3b\u76ee\u5f55",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/jenkins/jenkins\u77e5\u8bc6\u70b9/jenkins\u4fee\u6539\u4e3b\u76ee\u5f55"}},c={},l=[];function d(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",img:"img",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"jenkins\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406\u62a5\u9519",children:"jenkins\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406\u62a5\u9519"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://www.jenkins.io/doc/book/system-administration/reverse-proxy-configuration-troubleshooting/",children:"jenkins\u5b98\u65b9\u8bf4\u660e\u6587\u6863"})}),"\n",(0,r.jsx)(e.p,{children:"jenkins\u4f7f\u7528nginx\u505a\u53cd\u5411\u4ee3\u7406\uff0cjenkins\u4e2d\u63d0\u793a\u5982\u4e0b"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-10-19%2015.07.27.png",alt:"iShot2021-10-19 15.07.27"})}),"\n",(0,r.jsx)(e.p,{children:"\u539f\u5148nginx\u914d\u7f6e\u5982\u4e0b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-nginx",children:"server {\n  listen 80;\n  server_name jenkins.xxx.com;\n  rewrite ^(.*) https://$server_name$1 permanent;\n}\n\nserver {\n  listen 443 ssl;\n  server_name jenkins.xxx.com;\n  ssl_certificate ssl/xxx.com.pem;\n  ssl_certificate_key ssl/xxx.com.key;\n  ssl_session_timeout 5m;\n  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n  \n  location / {\n    proxy_pass http://127.0.0.1:8080;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header Host $http_host;\n    proxy_set_header X-NginX-Proxy true;\n    proxy_hide_header Server;\n    proxy_redirect off;\n  }  \n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u4fee\u6539nginx\u914d\u7f6e\u4e3a\u5982\u4e0b"}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsxs)(e.p,{children:["\u6ce8\u610f ",(0,r.jsx)(e.code,{children:"root /var/lib/jenkins/;"})," \u914d\u7f6e\uff0c\u5982\u679c\u4fee\u6539\u4e86jenkins\u4e3b\u76ee\u5f55\u5730\u5740\u5219\u9700\u8981\u4fee\u6539\u4e3a\u76f8\u5e94\u5730\u5740"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-nginx",children:'upstream jenkins {\n  keepalive 32; # keepalive connections\n  server 127.0.0.1:8080; # jenkins ip and port\n}\n\n# Required for Jenkins websocket agents\nmap $http_upgrade $connection_upgrade {\n  default upgrade;\n  \'\' close;\n}\n\nserver {\n  listen 80;\n  server_name jenkins.xxx.com;\n  return 302 https://$server_name$request_uri;\n}\n\nserver {\n  listen 443 ssl;    \n  server_name jenkins.xxx.com;  \n  # this is the jenkins web root directory\n  # (mentioned in the /etc/default/jenkins file)\n  root /var/run/jenkins/war/;\n  access_log /var/log/jenkins/jenkins.xxx.com.access.log;\n  error_log /var/log/jenkins/jenkins.xxx.com.error.log;\n  ssl_certificate ssl/xxx.com.pem;\n  ssl_certificate_key ssl/xxx.com.key;\n  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n\n  # pass through headers from Jenkins that Nginx considers invalid\n  ignore_invalid_headers off;\n\n  location ~ "^/static/[0-9a-fA-F]{8}\\/(.*)$" {\n    # rewrite all static files into requests to the root\n    # E.g /static/12345678/css/something.css will become /css/something.css\n    rewrite "^/static/[0-9a-fA-F]{8}\\/(.*)" /$1 last;\n  }\n\n  location /userContent {\n    # have nginx handle all the static requests to userContent folder\n    # note : This is the $JENKINS_HOME dir\n    root /var/lib/jenkins/;\n    if (!-f $request_filename){\n      # this file does not exist, might be a directory or a /**view** url\n      rewrite (.*) /$1 last;\n      break;\n    }\n    sendfile on;\n  }\n\n  location / {\n      sendfile off;\n      proxy_pass         http://jenkins;\n      proxy_redirect     default;\n      proxy_http_version 1.1;\n\n      # Required for Jenkins websocket agents\n      proxy_set_header   Connection        $connection_upgrade;\n      proxy_set_header   Upgrade           $http_upgrade;\n\n      proxy_set_header   Host              $host;\n      proxy_set_header   X-Real-IP         $remote_addr;\n      proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;\n      proxy_set_header   X-Forwarded-Proto $scheme;\n      proxy_max_temp_file_size 0;\n\n      #this is the maximum upload size\n      client_max_body_size       10m;\n      client_body_buffer_size    128k;\n\n      proxy_connect_timeout      90;\n      proxy_send_timeout         90;\n      proxy_read_timeout         90;\n      proxy_buffering            off;\n      proxy_request_buffering    off; # Required for HTTP CLI commands\n      proxy_set_header Connection ""; # Clear for keepalive\n  }\n}\n'})})]})}function x(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>o,x:()=>a});var r=s(96540);const i={},t=r.createContext(i);function o(n){const e=r.useContext(t);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:o(n.components),r.createElement(t.Provider,{value:e},n.children)}}}]);