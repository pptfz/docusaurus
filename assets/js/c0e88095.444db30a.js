"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[4163],{17898:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>t,metadata:()=>o,toc:()=>u});var i=s(74848),r=s(28453);const t={},a="ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items",o={id:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items",title:"ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items",description:"ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items\u4f7f\u7528\u573a\u666f\u4e3a\u5f53\u6211\u4eec\u8981\u5bf9\u67d0\u4e00\u4e9b\u4efb\u52a1\u9700\u8981\u6279\u91cf\u5904\u7406\uff0c\u4f8b\u5982\u91cd\u542f\u670d\u52a1\uff0c\u5982\u679c\u4f7f\u7528\u539f\u5148\u7684service\u6a21\u5757\u662f\u53ea\u80fd\u5199\u4e00\u4e2a\u670d\u52a1\u7684\uff0c\u518d\u6bd4\u5982\u4f7f\u7528copy\u6216\u8005template\u6a21\u5757\u62f7\u8d1d\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u5355\u4e2a\u6a21\u5757\u53ea\u80fd\u62f7\u8d1d\u4e00\u4e2a\u6587\u4ef6\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u7528\u5230\u5faa\u73af\u4e86",source:"@site/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items.md",sourceDirName:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236",slug:"/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude"},next:{title:"ansible\u4efb\u52a1\u63a7\u5236-\u5ffd\u7565\u9519\u8befignore_errors",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5ffd\u7565\u9519\u8befignore_errors"}},l={},u=[{value:"\u4f7f\u7528\u793a\u4f8b",id:"\u4f7f\u7528\u793a\u4f8b",level:2},{value:"\u4f7f\u7528\u793a\u4f8b1\uff0c\u4f7f\u7528service\u6a21\u5757\u540c\u65f6\u91cd\u542f2\u4e2a\u670d\u52a1",id:"\u4f7f\u7528\u793a\u4f8b1\u4f7f\u7528service\u6a21\u5757\u540c\u65f6\u91cd\u542f2\u4e2a\u670d\u52a1",level:3},{value:"\u4f7f\u7528\u793a\u4f8b2\uff0c\u6279\u91cf\u521b\u5efa\u591a\u4e2a\u7528\u6237\u548c\u7ec4",id:"\u4f7f\u7528\u793a\u4f8b2\u6279\u91cf\u521b\u5efa\u591a\u4e2a\u7528\u6237\u548c\u7ec4",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items",children:"ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items"}),"\n",(0,i.jsx)(n.p,{children:"ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items\u4f7f\u7528\u573a\u666f\u4e3a\u5f53\u6211\u4eec\u8981\u5bf9\u67d0\u4e00\u4e9b\u4efb\u52a1\u9700\u8981\u6279\u91cf\u5904\u7406\uff0c\u4f8b\u5982\u91cd\u542f\u670d\u52a1\uff0c\u5982\u679c\u4f7f\u7528\u539f\u5148\u7684service\u6a21\u5757\u662f\u53ea\u80fd\u5199\u4e00\u4e2a\u670d\u52a1\u7684\uff0c\u518d\u6bd4\u5982\u4f7f\u7528copy\u6216\u8005template\u6a21\u5757\u62f7\u8d1d\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u5355\u4e2a\u6a21\u5757\u53ea\u80fd\u62f7\u8d1d\u4e00\u4e2a\u6587\u4ef6\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u7528\u5230\u5faa\u73af\u4e86"}),"\n",(0,i.jsx)(n.h2,{id:"\u4f7f\u7528\u793a\u4f8b",children:"\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,i.jsx)(n.h3,{id:"\u4f7f\u7528\u793a\u4f8b1\u4f7f\u7528service\u6a21\u5757\u540c\u65f6\u91cd\u542f2\u4e2a\u670d\u52a1",children:"\u4f7f\u7528\u793a\u4f8b1\uff0c\u4f7f\u7528service\u6a21\u5757\u540c\u65f6\u91cd\u542f2\u4e2a\u670d\u52a1"}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u8f91yml\u6587\u4ef6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'cat > task_with_items.yml EOF\n- hosts: devops01\n  tasks:\n    - name: restart nginx mysql\n      service:\n        name: \n          "{{ item }}"\n        state:\n          restarted\n      with_items:\n        - nginx\n        - mysqld \nEOF        \n'})}),"\n",(0,i.jsx)(n.p,{children:"\u6267\u884cyml\u6587\u4ef6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ ansible-playbook task_with_items.yml \n\nPLAY [devops01] ****************************************************************************************************************************************\n\nTASK [Gathering Facts] *********************************************************************************************************************************\nok: [devops01]\n\nTASK [restart nginx mysql] *****************************************************************************************************************************\nchanged: [devops01] => (item=nginx)\nchanged: [devops01] => (item=mysqld)\n\nPLAY RECAP *********************************************************************************************************************************************\ndevops01                   : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0  \n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u4f7f\u7528\u793a\u4f8b2\u6279\u91cf\u521b\u5efa\u591a\u4e2a\u7528\u6237\u548c\u7ec4",children:"\u4f7f\u7528\u793a\u4f8b2\uff0c\u6279\u91cf\u521b\u5efa\u591a\u4e2a\u7528\u6237\u548c\u7ec4"}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u8f91yml\u6587\u4ef6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"cat > task_with_items_adduser.yml EOF\n- hosts: devops01\n  tasks:\n  - name: add user1-5 group1-5\n    user:\n      name:\n        \"{{ item.username }}\"\n      groups:\n        \"{{ item.groupname }}\"\n      state:\n        present\n    with_items:\n      - { username: 'user1', groupname: 'root' }\n      - { username: 'user2', groupname: 'root' }\n      - { username: 'user3', groupname: 'root' }\n      - { username: 'user4', groupname: 'root' }\n      - { username: 'user5', groupname: 'root' }\nEOF      \n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6267\u884cyml\u6587\u4ef6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ ansible-playbook task_with_items_adduser.yml \n\nPLAY [devops01] ****************************************************************************************************************************************\n\nTASK [Gathering Facts] *********************************************************************************************************************************\nok: [devops01]\n\nTASK [add user1-5 group1-5] ****************************************************************************************************************************\nchanged: [devops01] => (item={u'username': u'user1', u'groupname': u'root'})\nchanged: [devops01] => (item={u'username': u'user2', u'groupname': u'root'})\nchanged: [devops01] => (item={u'username': u'user3', u'groupname': u'root'})\nchanged: [devops01] => (item={u'username': u'user4', u'groupname': u'root'})\nchanged: [devops01] => (item={u'username': u'user5', u'groupname': u'root'})\n\nPLAY RECAP *********************************************************************************************************************************************\ndevops01                   : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n"})})]})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var i=s(96540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);