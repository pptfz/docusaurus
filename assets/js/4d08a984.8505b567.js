"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[2265],{15689:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>i});var r=s(74848),t=s(28453);const l={},c="python\u57fa\u7840\u4e8c\u5341\u4e03\tpython\u64cd\u4f5cmysql",o={id:"python/python\u57fa\u7840/python\u57fa\u7840\u4e8c\u5341\u4e03 python\u64cd\u4f5cmysql",title:"python\u57fa\u7840\u4e8c\u5341\u4e03 python\u64cd\u4f5cmysql",description:"[toc]",source:"@site/docs/python/python\u57fa\u7840/python\u57fa\u7840\u4e8c\u5341\u4e03 python\u64cd\u4f5cmysql.md",sourceDirName:"python/python\u57fa\u7840",slug:"/python/python\u57fa\u7840/python\u57fa\u7840\u4e8c\u5341\u4e03 python\u64cd\u4f5cmysql",permalink:"/docs/python/python\u57fa\u7840/python\u57fa\u7840\u4e8c\u5341\u4e03 python\u64cd\u4f5cmysql",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"python\u57fa\u7840\u4e8c\u5341\u4e00\tlogging\u65e5\u5fd7",permalink:"/docs/python/python\u57fa\u7840/python\u57fa\u7840\u4e8c\u5341\u4e00 logging\u65e5\u5fd7"},next:{title:"python\u57fa\u7840\u4e8c\u5341\u4e09 \u5f02\u5e38\u5904\u7406",permalink:"/docs/python/python\u57fa\u7840/python\u57fa\u7840\u4e8c\u5341\u4e09 \u5f02\u5e38\u5904\u7406"}},a={},i=[{value:"1.\u5b89\u88c5pymysql",id:"1\u5b89\u88c5pymysql",level:2},{value:"2.python\u8fde\u63a5mysql",id:"2python\u8fde\u63a5mysql",level:2},{value:"2.1 python\u8fde\u63a5mysql\u8bed\u6cd5",id:"21-python\u8fde\u63a5mysql\u8bed\u6cd5",level:3},{value:"2.2 python\u8fde\u63a5mysql\u7b80\u5355\u67e5\u8be2\u793a\u4f8b",id:"22-python\u8fde\u63a5mysql\u7b80\u5355\u67e5\u8be2\u793a\u4f8b",level:3},{value:"3.python\u64cd\u4f5cmysql",id:"3python\u64cd\u4f5cmysql",level:2},{value:"3.1 \u521b\u5efa\u8868\u64cd\u4f5c",id:"31-\u521b\u5efa\u8868\u64cd\u4f5c",level:3},{value:"3.2 \u6570\u636e\u64cd\u4f5c",id:"32-\u6570\u636e\u64cd\u4f5c",level:3},{value:"3.2.1 \u67e5\u8be2\u64cd\u4f5c",id:"321-\u67e5\u8be2\u64cd\u4f5c",level:4},{value:"3.2.2 \u589e\u52a0\u6570\u636e\u64cd\u4f5c",id:"322-\u589e\u52a0\u6570\u636e\u64cd\u4f5c",level:4},{value:"3.2.3 \u5220\u9664\u6570\u636e\u64cd\u4f5c",id:"323-\u5220\u9664\u6570\u636e\u64cd\u4f5c",level:4},{value:"3.2.4 \u4fee\u6539\u6570\u636e\u64cd\u4f5c",id:"324-\u4fee\u6539\u6570\u636e\u64cd\u4f5c",level:4},{value:"4.execute()\u4e4bsql\u6ce8\u5165",id:"4execute\u4e4bsql\u6ce8\u5165",level:2},{value:"4.1 \u5148\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u767b\u9646\u8ba4\u8bc1",id:"41-\u5148\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u767b\u9646\u8ba4\u8bc1",level:3},{value:"4.2 sql\u6ce8\u5165\u7b80\u5355\u793a\u4f8b",id:"42-sql\u6ce8\u5165\u7b80\u5355\u793a\u4f8b",level:3},{value:"4.2.1 \u793a\u4f8b1",id:"421-\u793a\u4f8b1",level:4},{value:"4.2.2 \u793a\u4f8b2",id:"422-\u793a\u4f8b2",level:4},{value:"4.3 sql\u6ce8\u5165\u7b80\u5355\u603b\u7ed3",id:"43-sql\u6ce8\u5165\u7b80\u5355\u603b\u7ed3",level:3},{value:"4.3.1 sql\u6ce8\u5165\u7684\u4e24\u79cd\u65b9\u6cd5",id:"431-sql\u6ce8\u5165\u7684\u4e24\u79cd\u65b9\u6cd5",level:4},{value:"4.3.2 \u901a\u8fc7pymysql\u63d0\u4f9b\u7684excute()\u65b9\u6cd5\u89e3\u51b3\u4e86\u7b80\u5355sql\u6ce8\u5165\u95ee\u9898",id:"432-\u901a\u8fc7pymysql\u63d0\u4f9b\u7684excute\u65b9\u6cd5\u89e3\u51b3\u4e86\u7b80\u5355sql\u6ce8\u5165\u95ee\u9898",level:4}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"[toc]"}),"\n",(0,r.jsx)(e.h1,{id:"python\u57fa\u7840\u4e8c\u5341\u4e03python\u64cd\u4f5cmysql",children:"python\u57fa\u7840\u4e8c\u5341\u4e03\tpython\u64cd\u4f5cmysql"}),"\n",(0,r.jsx)(e.h2,{id:"1\u5b89\u88c5pymysql",children:"1.\u5b89\u88c5pymysql"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"pip3 install pymysql\n"})}),"\n",(0,r.jsx)(e.h2,{id:"2python\u8fde\u63a5mysql",children:"2.python\u8fde\u63a5mysql"}),"\n",(0,r.jsx)(e.h3,{id:"21-python\u8fde\u63a5mysql\u8bed\u6cd5",children:"2.1 python\u8fde\u63a5mysql\u8bed\u6cd5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'//\u5bfc\u5165pymysql\u6a21\u5757\nimport pymysql\n\n//\u6253\u5f00\u6570\u636e\u5e93\u8fde\u63a5\n\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f\u6307\u5b9a\u5b57\u7b26\u96c6\u7684\u65f6\u5019utf-8\u5728\u8fd9\u91cc\u7684\u5199\u6cd5\u4e3autf8\nconn = pymysql.connect("\u6570\u636e\u5e93ip","\u7528\u6237","\u5bc6\u7801","\u6570\u636e\u5e93","\u7aef\u53e3(\u4e0d\u5199\u9ed8\u8ba4\u4e3a3306)","\u5b57\u7b26\u96c6") \n\n//\u4f7f\u7528cursor()\u65b9\u6cd5\u83b7\u53d6\u64cd\u4f5c\u6e38\u6807 \ncursor = conn.cursor()\n\n//\u4f7f\u7528execute()\u65b9\u6cd5\u6267\u884cSQL\u64cd\u4f5c\ncursor.execute("SQL\u8bed\u53e5")  \n\n//\u4f7f\u7528fetchone()\u65b9\u6cd5\u83b7\u53d6\u5355\u6761\u6570\u636e\ndata = cursor.fetchone()                              \nprint ("Database version : %s " %data)\n\n//\u5173\u95ed\u6e38\u6807\ncursor.close()\n\n//\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\nconn.close()                                            \n'})}),"\n",(0,r.jsx)(e.h3,{id:"22-python\u8fde\u63a5mysql\u7b80\u5355\u67e5\u8be2\u793a\u4f8b",children:"2.2 python\u8fde\u63a5mysql\u7b80\u5355\u67e5\u8be2\u793a\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"//\u6570\u636e\u5e93db1\u4e2d\u6709\u4e00\u5f20t1\u8868\uff0c\u8868\u5185\u5bb9\u5982\u4e0b\nmysql> select * from t1;\n+------+--------+\n| id   | name   |\n+------+--------+\n|    1 | \u5c0f\u660e   |\n|    2 | \u5c0f\u9896   |\n|    3 | \u5c0f\u4e3d   |\n+------+--------+\n3 rows in set (0.00 sec)\n\n\n//\u63a5\u4e0b\u6765\u8fde\u63a5\u6570\u636e\u5e93\u8fdb\u884c\u64cd\u4f5c\n#\u5bfc\u5165pymysql\u6a21\u5757\nimport pymysql\n\n#\u6253\u5f00\u6570\u636e\u5e93\u8fde\u63a5\nconn = pymysql.connect(\n        host='xxx', user='xxx', password=\"xxx\",\n        database='db1', port=3306, charset='utf8',\n)\n\n#\u521b\u5efa\u6e38\u6807\ncursor = conn.cursor()\n\n#\u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\uff0c\u5b58\u653esql\u8bed\u53e5\nsql = 'select * from t1'\n\n#\u4f7f\u7528execute()\u65b9\u6cd5\u6267\u884csql\u64cd\u4f5c\ncursor.execute(sql)\n\n#\u4f7f\u7528fetchall()\u65b9\u6cd5\u83b7\u53d6\u6240\u6709\u6570\u636e\ndata = cursor.fetchall()\n\n#\u6253\u5370\u67e5\u8be2\u7684\u5185\u5bb9\nprint(data)\n((1, '\u5c0f\u660e'), (2, '\u5c0f\u9896'), (3, '\u5c0f\u4e3d'))\n\n#\u5173\u95ed\u6e38\u6807\ncursor.close()\n#\u5173\u95ed\u8fde\u63a5\nconn.close()\n"})}),"\n",(0,r.jsx)(e.h2,{id:"3python\u64cd\u4f5cmysql",children:"3.python\u64cd\u4f5cmysql"}),"\n",(0,r.jsx)(e.h3,{id:"31-\u521b\u5efa\u8868\u64cd\u4f5c",children:"3.1 \u521b\u5efa\u8868\u64cd\u4f5c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"#\u5bfc\u5165pymysql\u6a21\u5757\nimport pymysql\n \n#\u6253\u5f00\u6570\u636e\u5e93\u8fde\u63a5\ndb = pymysql.connect(\"localhost\",\"testuser\",\"test123\",\"TESTDB\" )\n \n#\u4f7f\u7528cursor()\u65b9\u6cd5\u521b\u5efa\u4e00\u4e2a\u6e38\u6807\u5bf9\u8c61cursor\ncursor = db.cursor()\n \n#\u4f7f\u7528execute()\u65b9\u6cd5\u6267\u884c SQL\uff0c\u5982\u679c\u8868\u5b58\u5728\u5219\u5220\u9664\ncursor.execute(\"drop table if exists t2\")\n\n#\u4f7f\u7528\u9884\u5904\u7406\u8bed\u53e5\u521b\u5efa\u8868\nsql = \"\"\"create table t2(\n  id int not null,\n  age int not null,\n  name char(10) not null,\n  hobby set('\u5531','\u8df3','rap','\u7bee\u7403'))\"\"\"\n\n#\u6267\u884csql\u8bed\u53e5\ncursor.execute(sql)\n \n#\u67e5\u770b\u7ed3\u679c\nmysql> show tables;\n+---------------+\n| Tables_in_db1 |\n+---------------+\n| t1            |\n| t2            |\n+---------------+\n2 rows in set (0.00 sec)\n\nmysql> desc t2;\n+-------+---------------------------------+------+-----+---------+-------+\n| Field | Type                            | Null | Key | Default | Extra |\n+-------+---------------------------------+------+-----+---------+-------+\n| id    | int(11)                         | NO   |     | NULL    |       |\n| age   | int(11)                         | NO   |     | NULL    |       |\n| name  | char(10)                        | NO   |     | NULL    |       |\n| hobby | set('\u5531','\u8df3','rap','\u7bee\u7403')     | YES  |     | NULL    |       |\n+-------+---------------------------------+------+-----+---------+-------+\n4 rows in set (0.00 sec)\n\n#\u5173\u95ed\u6e38\u6807\ncursor.clos()\n  \n#\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\nconn.close()\n"})}),"\n",(0,r.jsx)(e.h3,{id:"32-\u6570\u636e\u64cd\u4f5c",children:"3.2 \u6570\u636e\u64cd\u4f5c"}),"\n",(0,r.jsx)(e.h4,{id:"321-\u67e5\u8be2\u64cd\u4f5c",children:"3.2.1 \u67e5\u8be2\u64cd\u4f5c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"python\u64cd\u4f5cmysql\u65f6\u83b7\u53d6\u6570\u636e\u7684\u65b9\u6cd5\u67093\u79cd\n\tcursor.fetchone()\t\t#\u67e5\u8be2\u8fd4\u56de\u4e00\u6761\u7ed3\u679c\n\tcursor.fetchmany(n)\t#\u67e5\u8be2\u8fd4\u56de\u6307\u5b9a\u7684\u6761\u6570\uff0cn\u4e3a\u6570\u5b57\n\tcursor.fetchall()\t\t#\u67e5\u8be2\u8fd4\u56de\u6240\u6709\u7684\u7ed3\u679c\n  \n\n//\u6570\u636e\u5e93db1\u4e2d\u6709\u4e00\u5f20t1\u8868\uff0c\u8868\u5185\u5bb9\u5982\u4e0b\nmysql> select * from t1;\n+------+--------+\n| id   | name   |\n+------+--------+\n|    1 | \u5c0f\u660e   |\n|    2 | \u5c0f\u9896   |\n|    3 | \u5c0f\u4e3d   |\n+------+--------+\n3 rows in set (0.00 sec)\n\n\n//\u4f7f\u7528cursor.fetchone()\u65b9\u6cd5\u83b7\u53d6\u4e00\u6761\u7ed3\u679c\ndata = cursor.fetchone()\nprint(data)\n(1, '\u5c0f\u660e')\n\n\n//\u4f7f\u7528cursor.fetchmany(n)\u65b9\u6cd5\u6307\u5b9a\u83b7\u53d6\u7684\u5185\u5bb9\u4e2a\u6570\uff0cn\u4e3a\u6570\u5b57\n#fetchmany\u4e0d\u6307\u5b9a\u83b7\u53d6\u4e2a\u6570\u65f6\u8fd4\u56de\u7684\u5185\u5bb9\ndata = cursor.fetchmany()\nprint(data)\n((1, '\u5c0f\u660e'),)\n\n#fetchmany\u6307\u5b9a\u83b7\u53d6\u4e2a\u6570\u65f6\u8fd4\u56de\u7684\u5185\u5bb9\ndata = cursor.fetchmany(2)\nprint(data)\n((1, '\u5c0f\u660e'), (2, '\u5c0f\u9896'))\n\n\n//\u4f7f\u7528cursor.fetchall()\u65b9\u6cd5\u83b7\u53d6\u5168\u90e8\u5185\u5bb9\ndata = cursor.fetchall()\nprint(data)\n((1, '\u5c0f\u660e'), (2, '\u5c0f\u9896'), (3, '\u5c0f\u4e3d'))\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"fetch\u65b9\u6cd5\u8fd4\u56de\u7684\u7ed3\u679c\u90fd\u662f\u5143\u7ec4\uff0c\u6ca1\u6cd5\u770b\u51fa\u54ea\u4e2a\u6570\u636e\u662f\u5bf9\u5e94\u7684\u54ea\u4e2a\u5b57\u6bb5\uff0c\u53ef\u4ee5\u91c7\u7528\u5b57\u5178\u7684\u65b9\u5f0f\u663e\u793a\uff0c\u8fd9\u6837\u770b\u8d77\u6765\u6bd4\u8f83\u660e\u786e"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"\u53ef\u4ee5\u5728\u521b\u5efa\u6e38\u6807\u7684\u65f6\u5019\uff0c\u52a0\u4e0a\u4e00\u4e2a\u53c2\u6570\u8ba9\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u5b57\u5178\u683c\u5f0f\u5c55\u793a\n\n//\u521b\u5efa\u6e38\u6807\u7684\u65f6\u5019\u52a0\u4e0a\u4e00\u4e2a\u53c2\u6570cursor=pymysql.cursors.DictCursor\u8ba9\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u5b57\u5178\u683c\u5f0f\ncursor = conn.cursor(cursor=pymysql.cursors.DictCursor)\n\ndata = cursor.fetchall()\nprint(data)\n[{'id': 1, 'name': '\u5c0f\u660e'}, {'id': 2, 'name': '\u5c0f\u9896'}, {'id': 3, 'name': '\u5c0f\u4e3d'}]\n"})}),"\n",(0,r.jsx)(e.h4,{id:"322-\u589e\u52a0\u6570\u636e\u64cd\u4f5c",children:"3.2.2 \u589e\u52a0\u6570\u636e\u64cd\u4f5c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"//\u6570\u636e\u5e93\u4e2dt2\u8868\u5185\u5bb9\u4e3a\u7a7a\nmysql> desc t2;\n+-------+---------------------------------+------+-----+---------+-------+\n| Field | Type                            | Null | Key | Default | Extra |\n+-------+---------------------------------+------+-----+---------+-------+\n| id    | int(11)                         | NO   |     | NULL    |       |\n| age   | int(11)                         | NO   |     | NULL    |       |\n| name  | char(10)                        | NO   |     | NULL    |       |\n| hobby | set('\u5531','\u8df3','rap','\u7bee\u7403')     | YES  |     | NULL    |       |\n+-------+---------------------------------+------+-----+---------+-------+\n4 rows in set (0.00 sec)\n\nmysql> select * from t2;\nEmpty set (0.00 sec)\n\n\n//\u73b0\u5728\u5411t2\u8868\u4e2d\u63d2\u5165\u6570\u636e\nimport pymysql\n\nconn = pymysql.connect(\n        host='xxx', user='pptfz', password=\"xxx\",\n        database='db1', port=3306, charset='utf8',\n)\n\ncursor = conn.cursor(cursor=pymysql.cursors.DictCursor)\nsql = \"\"\"\n    insert into t2 values(1,18,'\u5c0f\u660e','\u5531,\u7bee\u7403'),\n                        (2,20,'\u5c0f\u9896','\u5531,\u8df3'),\n                        (3,28,'\u5c0f\u5764','\u5531,\u8df3,rap,\u7bee\u7403')\n\"\"\"\n\ncursor.execute(sql)\nconn.commit()\nconn.close()\n\n\n//\u67e5\u770b\u7ed3\u679c\nsql = 'select * from t2'\ncursor.execute(sql)\ndata = cursor.fetchall()\nprint(data)\n[{'id': 1, 'age': 18, 'name': '\u5c0f\u660e', 'hobby': '\u5531,\u7bee\u7403'}, {'id': 2, 'age': 20, 'name': '\u5c0f\u9896', 'hobby': '\u5531,\u8df3'}, {'id': 3, 'age': 28, 'name': '\u5c0f\u5764', 'hobby': '\u5531,\u8df3,rap,\u7bee\u7403'}]\n"})}),"\n",(0,r.jsx)(e.h4,{id:"323-\u5220\u9664\u6570\u636e\u64cd\u4f5c",children:"3.2.3 \u5220\u9664\u6570\u636e\u64cd\u4f5c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"#\u521b\u5efa\u6e38\u6807\ncursor = conn.cursor(cursor=pymysql.cursors.DictCursor)\n\n#sql\u8bed\u53e5\nsql = 'delete from t2 where id=3'\n\n#\u6267\u884csql\u64cd\u4f5c\uff0c\u53d1\u751f\u9519\u8bef\u56de\u6eda\ntry:\n    cursor.execute(sql)\n    conn.commit()\nexcept:\n    conn.rollback()\n\n#\u5173\u95ed\u8fde\u63a5\nconn.close()\n"})}),"\n",(0,r.jsx)(e.h4,{id:"324-\u4fee\u6539\u6570\u636e\u64cd\u4f5c",children:"3.2.4 \u4fee\u6539\u6570\u636e\u64cd\u4f5c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"#\u521b\u5efa\u6e38\u6807\ncursor = conn.cursor(cursor=pymysql.cursors.DictCursor)\n\n#sql\u8bed\u53e5\nsql = 'update t2 set age=30 where id=2'\n\n#\u6267\u884csql\u64cd\u4f5c\uff0c\u53d1\u751f\u9519\u8bef\u56de\u6eda\ntry:\n    cursor.execute(sql)\n    conn.commit()\nexcept:\n    conn.rollback()\n\n#\u5173\u95ed\u8fde\u63a5\nconn.close()\n"})}),"\n",(0,r.jsx)(e.h2,{id:"4execute\u4e4bsql\u6ce8\u5165",children:"4.execute()\u4e4bsql\u6ce8\u5165"}),"\n",(0,r.jsx)(e.h3,{id:"41-\u5148\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u767b\u9646\u8ba4\u8bc1",children:"4.1 \u5148\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u767b\u9646\u8ba4\u8bc1"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u26a0\ufe0f\u8fd9\u91cc\u7684\u793a\u4f8b\u6709sql\u6ce8\u5165\u7684\u95ee\u9898\uff0c\u4f1a\u5728\u540e\u8fb9\u7684\u793a\u4f8b\u4e2d\u89e3\u51b3"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"//userinfo\u8868\u5185\u5bb9\u5982\u4e0b\nmysql> select * from userinfo;\n+-------+-------+\n| uname | pwd   |\n+-------+-------+\n| admin | admin |\n+-------+-------+\n1 row in set (0.00 sec)\n\n//\u63a5\u4e0b\u6765\u505a\u4e00\u4e2a\u5355\u4e00\u7684\u5224\u65ad\n#\u5bfc\u5165pymysql\nimport pymysql\n\n#\u8fde\u63a5mysql\nconn = pymysql.connect(\n        host='xxx', user='pptfz', password=\"xxx\",\n        database='db1', port=3306, charset='utf8',\n)\n\n#\u521b\u5efa\u6e38\u6807\ncursor = conn.cursor(cursor=pymysql.cursors.DictCursor)\n\n#\u8f93\u5165\u7528\u6237\u6c11\u5171\u548c\u5bc6\u7801\nuname = input('\u8bf7\u8f93\u5165\u7528\u6237\u540d>>>')\npassword = input('\u8bf7\u8f93\u5165\u5bc6\u7801>>>')\n\n#\u6267\u884csql\u8bed\u53e5\uff0c\u8fd4\u56de\u7ed3\u679c\u5927\u4e8e1\u8bf4\u660e\u7528\u6237\u540d\u548c\u5bc6\u7801\u5b58\u5728\uff0c\u5426\u5219\u5c31\u662f\u4e0d\u5b58\u5728\nsql = \"select * from userinfo where uname='%s' and pwd='%s'\"%(uname,password)\n\n#\u6267\u884csql\u8bed\u53e5\ncursor.execute(sql)\n\n#\u67e5\u8be2\u7684\u7ed3\u679c\ndata = cursor.fetchone()\n\n#\u505a\u5224\u65ad\nif data:\n    print('\u767b\u9646\u6210\u529f')\nelse:\n    print('\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef')\nconn.close()\n\n\n\n\u6267\u884c\u7ed3\u679c\u5982\u4e0b\uff1a\n\u5f53\u8f93\u5165\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u5b58\u5728\u4e8euserinfo\u8868\u4e2d\u65f6\uff0c\u8fd9\u91cc\u4e3a\u56fa\u5b9a\u7684\u7528\u6237\u540damin\u5bc6\u7801admin\u8fd4\u56de\u767b\u9646\u6210\u529f\uff0c\u5426\u5219\u8fd4\u56de\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\uff0c\u8fd9\u6837\u5c31\u505a\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u7528\u6237\u767b\u9646\u8ba4\u8bc1\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u767b\u9646\u6210\u529f"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2013.52.00.png",alt:"iShot2020-10-16 13.52.00"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u767b\u9646\u5931\u8d25"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2013.52.21.png",alt:"iShot2020-10-16 13.52.21"})}),"\n",(0,r.jsx)(e.h3,{id:"42-sql\u6ce8\u5165\u7b80\u5355\u793a\u4f8b",children:"4.2 sql\u6ce8\u5165\u7b80\u5355\u793a\u4f8b"}),"\n",(0,r.jsx)(e.h4,{id:"421-\u793a\u4f8b1",children:"4.2.1 \u793a\u4f8b1"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u63a5\u4e0b\u6765\u505a\u4e00\u4e2a\u64cd\u4f5c\uff0c\u5728\u8f93\u5165\u7528\u6237\u540d\u7684\u65f6\u5019\uff0c\u5728\u7528\u6237\u540d\u540e\u8fb9\u52a0\u4e00\u4e2a\u5355\u5f15\u53f7\uff0c\u7136\u540e\u7a7a\u683c\uff0c\u7136\u540e\u5199\u4e0a--\uff0c\u6700\u540e--\u7684\u540e\u9762\u5199\u4e0a\u4efb\u610f\u5b57\u7b26\uff0c\u8fd9\u6837\u5c31\u80fd\u5728\u77e5\u9053\u7528\u6237\u540d\u7684\u60c5\u51b5\u4e0b\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801\u5c31\u53ef\u4ee5\u767b\u9646\u6210\u529f"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"import pymysql\n\nconn = pymysql.connect(\n        host='xxx', user='pptfz', password=\"xxx\",\n        database='db1', port=3306, charset='utf8',\n)\n\ncursor = conn.cursor(cursor=pymysql.cursors.DictCursor)\n\nuname = input('\u8bf7\u8f93\u5165\u7528\u6237\u540d>>>')\npassword = input('\u8bf7\u8f93\u5165\u5bc6\u7801>>>')\n# sql = f'select * from userinfo where uname=\"{uname}\" and pwd=\"{password}\"'\n\nsql = \"select * from userinfo where uname='%s' and pwd='%s';\"%(uname,password)\ncursor.execute(sql)\n\n# data = cursor.fetchall()\ndata = cursor.fetchone()\n\nif data:\n    print('\u767b\u9646\u6210\u529f')\nelse:\n    print('\u767b\u9646\u5931\u8d25')\nconn.close()\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2013.52.45.png",alt:"iShot2020-10-16 13.52.45"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u5206\u6790\u4e00\u4e0b\u7ed3\u679c"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsxs)(e.strong,{children:["\u6b64\u65f6uname\u8fd9\u4e2a\u53d8\u91cf\u7b49\u4e8e",(0,r.jsx)(e.code,{children:"admin' -- xxx"}),"\uff0csql\u8bed\u53e5\u88ab\u5b57\u7b26\u4e32\u66ff\u6362\u4e4b\u540e\u4f1a\u53d8\u6210\u5982\u4e0b"]})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"select * from userinfo where uname='admin' -- xxx' and pwd='';"})})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsxs)(e.strong,{children:["\u5176\u4e2dadmin\u540e\u8fb9\u7684",(0,r.jsx)(e.code,{children:"'"}),"\uff0c\u5728\u8fdb\u884c\u5b57\u7b26\u4e32\u66ff\u6362\u7684\u65f6\u5019\uff0c\u6211\u4eec\u8f93\u5165\u7684\u662f",(0,r.jsx)(e.code,{children:"admin'"}),"\uff0c\u8fd9\u4e2a\u5f15\u53f7\u548c\u524d\u8fb9\u7684\u5f15\u53f7\u7ec4\u6210\u4e86\u4e00\u5bf9\uff0c\u4e5f\u5c31\u662f",(0,r.jsx)(e.code,{children:"select * from userinfo where uname='admin'' -- xxx and pwd=''"})]})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsxs)(e.strong,{children:[(0,r.jsx)(e.code,{children:"--"}),"\u5728sql\u8bed\u53e5\u4e2d\u662f\u6ce8\u91ca\u7684\u610f\u601d\uff0c\u4e5f\u5c31\u662f\u8bf4\u540e\u9762\u7684\u8bed\u53e5\u88ab\u6ce8\u91ca\u4e86\uff0c\u6b64\u65f6\u7684sql\u8bed\u53e5\u53d8\u6210\u4e86",(0,r.jsx)(e.code,{children:"select * from usrinfo where uname='admin'"}),"\uff0c\u540e\u8fb9\u7684",(0,r.jsx)(e.code,{children:"' -- xxx and pwd=''"}),"\u53d8\u6210\u4e86\u6ce8\u91ca"]})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u8fd9\u6837\u7684\u8bdd\u5c31\u662f\u77e5\u9053\u7528\u6237\u540d\u5373\u53ef\u767b\u9646\u6210\u529f\uff0c\u8fd9\u5c31\u662f\u6700\u7b80\u5355\u7684sql\u6ce8\u91ca"})}),"\n",(0,r.jsx)(e.h4,{id:"422-\u793a\u4f8b2",children:"4.2.2 \u793a\u4f8b2"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u7528\u6237\u540d\u548c\u5bc6\u7801\u90fd\u4e0d\u9700\u8981\u8f93\u5165\u5c31\u80fd\u767b\u9646\u6210\u529f"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"or\u540e\u8fb9\u8ddf\u4e86\u4e00\u4e2a\u6c38\u771f\u7684\u6761\u4ef6\uff0c\u56e0\u6b64\u4e0d\u7ba1\u8f93\u5165\u4ec0\u4e48\u90fd\u80fd\u767b\u9646\u6210\u529f"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2013.53.05.png",alt:"iShot2020-10-16 13.53.05"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u6709\u4e9b\u7f51\u7ad9\u76f4\u63a5\u5728\u8f93\u5165\u5185\u5bb9\u7684\u65f6\u5019\uff0c\u5c31\u9650\u5b9a\u4e86\u4e0d\u80fd\u8f93\u5165\u4e00\u4e9b\u7279\u6b8a\u7684\u7b26\u53f7\uff0c\u56e0\u4e3a\u6709\u4e9b\u7279\u6b8a\u7b26\u53f7\u53ef\u4ee5\u6539\u53d8sql\u7684\u6267\u884c\u903b\u8f91\uff0c\u5176\u5b9e\u4e0d\u5149\u662f--\uff0c\u8fd8\u6709\u4e00\u4e9b\u5176\u4ed6\u7684\u7b26\u53f7\u4e5f\u80fd\u6539\u53d8sql\u8bed\u53e5\u7684\u6267\u884c\u903b\u8f91\uff0c\u8fd9\u4e2a\u65b9\u6848\u662f\u5728\u5ba2\u6237\u7aef\u7ed9\u7528\u6237\u8f93\u5165\u7684\u5730\u65b9\u8fdb\u884c\u9650\u5236\uff0c\u4f46\u662f\u522b\u4eba\u53ef\u4e0d\u53ef\u4ee5\u6a21\u62df\u4f60\u7684\u5ba2\u6237\u7aef\u6765\u53d1\u9001\u8bf7\u6c42\uff0c\u662f\u53ef\u4ee5\u7684\uff0c\u4ed6\u6a21\u62df\u4e00\u4e2a\u5ba2\u6237\u7aef\uff0c\u4e0d\u6309\u7167\u4f60\u7684\u5ba2\u6237\u7aef\u7684\u8981\u6c42\u6765\uff0c\u5c31\u53d1\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u4f60\u7684\u5ba2\u6237\u7aef\u662f\u9650\u5236\u4e0d\u4e86\u7684\u3002"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u300b\u6240\u4ee5\u5355\u7eaf\u7684\u5728\u5ba2\u6237\u7aef\u8fdb\u884c\u8fd9\u4e2a\u7279\u6b8a\u5b57\u7b26\u7684\u8fc7\u6ee4\u662f\u4e0d\u80fd\u89e3\u51b3\u6839\u672c\u95ee\u9898\u7684\uff0c\u90a3\u600e\u4e48\u529e\uff1f\u6211\u4eec\u670d\u52a1\u7aef\u4e5f\u9700\u8981\u8fdb\u884c\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b63\u5219\u6765\u5c06\u5ba2\u6237\u7aef\u53d1\u9001\u8fc7\u6765\u7684\u5185\u5bb9\u8fdb\u884c\u7279\u6b8a\u5b57\u7b26\u7684\u5339\u914d\uff0c\u5982\u679c\u6709\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u6211\u4eec\u5c31\u8ba9\u5b83\u767b\u9646\u5931\u8d25\u3002"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u5728\u670d\u52a1\u7aef\u6765\u89e3\u51b3sql\u6ce8\u5165\u7684\u95ee\u9898\uff1a\u4e0d\u8981\u81ea\u5df1\u6765\u8fdb\u884csql\u5b57\u7b26\u4e32\u7684\u62fc\u63a5\u4e86\uff0cpymysql\u80fd\u5e2e\u6211\u4eec\u62fc\u63a5\uff0c\u4ed6\u80fd\u591f\u9632\u6b62sql\u6ce8\u5165\uff0c\u6240\u4ee5\u4ee5\u540e\u6211\u4eec\u518d\u5199sql\u8bed\u53e5\u7684\u65f6\u5019\u6309\u4e0b\u9762\u7684\u65b9\u5f0f\u5199\uff1a"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"//\u4e4b\u524d\u6211\u4eec\u7684sql\u8bed\u53e5\u662f\u8fd9\u6837\u5199\u7684\uff1a\nsql = \"select * from userinfo where uname='%s' and pwd='%s';\"%(uname,passwdor)\n\n//\u4ee5\u540e\u518d\u5199\u7684\u65f6\u5019\uff0csql\u8bed\u53e5\u91cc\u9762\u7684%s\u5de6\u53f3\u7684\u5f15\u53f7\u53bb\u6389\uff0c\u5e76\u4e14\u8bed\u53e5\u540e\u9762\u7684%(uname,pword)\u8fd9\u4e9b\u5185\u5bb9\u4e5f\u4e0d\u8981\u81ea\u5df1\u5199\u4e86\uff0c\u6309\u7167\u4e0b\u9762\u7684\u65b9\u5f0f\u5199\nsql = \"select * from userinfo where username=%s and password=%s;\"\n\n//\u96be\u9053\u6211\u4eec\u4e0d\u4f20\u503c\u4e86\u5417\uff0c\u4e0d\u662f\u7684\uff0c\u6211\u4eec\u901a\u8fc7\u4e0b\u9762\u7684\u5f62\u5f0f\uff0c\u5728excute\u91cc\u9762\u5199\u53c2\u6570\uff1a\n\u5176\u5b9e\u5b83\u672c\u8d28\u4e5f\u662f\u5e2e\u4f60\u8fdb\u884c\u4e86\u5b57\u7b26\u4e32\u7684\u66ff\u6362\uff0c\u53ea\u4e0d\u8fc7\u5b83\u4f1a\u5c06uname\u548cpassword\u91cc\u9762\u7684\u7279\u6b8a\u5b57\u7b26\u7ed9\u8fc7\u6ee4\u6389\ncursor.execute(sql,[uname,password]) \n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u4f7f\u7528cursor.execute\u65b9\u6cd5\u6267\u884csql\u8bed\u53e5\u6b63\u786e\u5199\u6cd5"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"import pymysql\n\nconn = pymysql.connect(\n        host='xxx', user='pptfz', password=\"xxx\",\n        database='db1', port=3306, charset='utf8',\n)\n\ncursor = conn.cursor(cursor=pymysql.cursors.DictCursor)\n\nuname = input('\u8bf7\u8f93\u5165\u7528\u6237\u540d>>>')\npassword = input('\u8bf7\u8f93\u5165\u5bc6\u7801>>>')\n# sql = f'select * from userinfo where uname=\"{uname}\" and pwd=\"{password}\"'\n\nsql = \"select * from userinfo where uname=%s and pwd=%s\"\ncursor.execute(sql,[uname,password])\n# data = cursor.fetchall()\ndata = cursor.fetchone()\n\nif data:\n    print('\u767b\u9646\u6210\u529f')\nelse:\n    print('\u767b\u9646\u5931\u8d25')\nconn.close()\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u4f7f\u75284.2.1\u793a\u4f8b1\u4e2d\u7684\u5199\u6cd5\u767b\u9646\uff0c\u4f1a\u63d0\u793a\u767b\u9646\u5931\u8d25"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2013.53.23.png",alt:"iShot2020-10-16 13.53.23"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u4f7f\u75284.2.2\u793a\u4f8b2\u4e2d\u7684\u5199\u6cd5\u767b\u9646\uff0c\u4f1a\u63d0\u793a\u767b\u9646\u5931\u8d25"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2013.53.42.png",alt:"iShot2020-10-16 13.53.42"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u8fd9\u6837\u4f7f\u7528cursor.execute\u65b9\u6cd5\u5c31\u89e3\u51b3\u4e86\u7b80\u5355sql\u6ce8\u5165\u7684\u95ee\u9898\uff0c\u56e0\u6b64\u4ee5\u540e\u7684\u4efb\u610f\u8bed\u53e5\u90fd\u5fc5\u987b\u4f7f\u7528\u6b64\u5199\u6cd5\u6765\u4ee3\u66ff\u6211\u4eec\u81ea\u5df1\u5199\u7684\u5b57\u7b26\u4e32\u66ff\u6362"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.code,{children:"cursor.execute(sql,[uname,password])"})}),"\n",(0,r.jsx)(e.h3,{id:"43-sql\u6ce8\u5165\u7b80\u5355\u603b\u7ed3",children:"4.3 sql\u6ce8\u5165\u7b80\u5355\u603b\u7ed3"}),"\n",(0,r.jsx)(e.h4,{id:"431-sql\u6ce8\u5165\u7684\u4e24\u79cd\u65b9\u6cd5",children:"4.3.1 sql\u6ce8\u5165\u7684\u4e24\u79cd\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"\u4e24\u79cdsql\u6ce8\u5165\u65b9\u6cd5\n1\u3001sql\u6ce8\u5165\u4e4b\uff1a\u7528\u6237\u5b58\u5728\uff0c\u7ed5\u8fc7\u5bc6\u7801\n\u7528\u6237\u540d' -- \u4efb\u610f\u5b57\u7b26\n\n2\u3001sql\u6ce8\u5165\u4e4b\uff1a\u7528\u6237\u4e0d\u5b58\u5728\uff0c\u7ed5\u8fc7\u7528\u6237\u4e0e\u5bc6\u7801\n\u7528\u6237\u540d' or 1=1 -- \u4efb\u610f\u5b57\u7b26\n"})}),"\n",(0,r.jsx)(e.h4,{id:"432-\u901a\u8fc7pymysql\u63d0\u4f9b\u7684excute\u65b9\u6cd5\u89e3\u51b3\u4e86\u7b80\u5355sql\u6ce8\u5165\u95ee\u9898",children:"4.3.2 \u901a\u8fc7pymysql\u63d0\u4f9b\u7684excute()\u65b9\u6cd5\u89e3\u51b3\u4e86\u7b80\u5355sql\u6ce8\u5165\u95ee\u9898"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"//\u539f\u6765\u662f\u6211\u4eec\u5bf9sql\u8fdb\u884c\u5b57\u7b26\u4e32\u62fc\u63a5\nsql=\"select * from userinfo where uname='%s' and pwd='%s'\" %(uname,password)\nprint(sql)\ndata = cursor.execute(sql)\n\n//\u6539\u5199\u4e3aexecute\u5e2e\u6211\u4eec\u505a\u5b57\u7b26\u4e32\u62fc\u63a5\uff0c\u6211\u4eec\u65e0\u9700\u4e14\u4e00\u5b9a\u4e0d\u80fd\u518d\u4e3a%s\u52a0\u5f15\u53f7\u4e86\nsql=\"select * from userinfo where uname=%s and pwd=%s\" \n\n//\u26a0\ufe0f%s\u9700\u8981\u53bb\u6389\u5f15\u53f7\uff0c\u56e0\u4e3apymysql\u4f1a\u81ea\u52a8\u4e3a\u6211\u4eec\u52a0\u4e0a\ndata = cursor.execute(sql,[uname,password]) #pymysql\u6a21\u5757\u81ea\u52a8\u5e2e\u6211\u4eec\u89e3\u51b3sql\u6ce8\u5165\u7684\u95ee\u9898\uff0c\u53ea\u8981\u6211\u4eec\u6309\u7167pymysql\u7684\u89c4\u77e9\u6765\u3002\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0fsql\u8bed\u53e5\u4e0d\u8981\u81ea\u5df1\u62fc\u63a5\uff0c\u4ea4\u7ed9pymysql\u63d0\u4f9b\u7684execute\u65b9\u6cd5\u89e3\u51b3"})})]})}function p(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>c,x:()=>o});var r=s(96540);const t={},l=r.createContext(t);function c(n){const e=r.useContext(l);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:c(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);