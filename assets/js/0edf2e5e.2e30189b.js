"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1025],{66277:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var s=e(74848),r=e(28453);const i={},o="awk BEGIN\u6a21\u5f0f\u3001END\u6a21\u5f0f",a={id:"linux/linux\u547d\u4ee4/awk/awk BEGIN\u6a21\u5f0f\u3001END\u6a21\u5f0f",title:"awk BEGIN\u6a21\u5f0f\u3001END\u6a21\u5f0f",description:"[toc]",source:"@site/docs/linux/linux\u547d\u4ee4/awk/2.awk BEGIN\u6a21\u5f0f\u3001END\u6a21\u5f0f.md",sourceDirName:"linux/linux\u547d\u4ee4/awk",slug:"/linux/linux\u547d\u4ee4/awk/awk BEGIN\u6a21\u5f0f\u3001END\u6a21\u5f0f",permalink:"/docs/linux/linux\u547d\u4ee4/awk/awk BEGIN\u6a21\u5f0f\u3001END\u6a21\u5f0f",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"awk\u6587\u672c\u5904\u7406\u3001\u8bed\u6cd5\u3001\u5de5\u4f5c\u539f\u7406",permalink:"/docs/linux/linux\u547d\u4ee4/awk/awk\u6587\u672c\u5904\u7406\u3001\u8bed\u6cd5\u3001\u5de5\u4f5c\u539f\u7406"},next:{title:"awk\u5185\u7f6e\u53d8\u91cf",permalink:"/docs/linux/linux\u547d\u4ee4/awk/awk\u5185\u7f6e\u53d8\u91cf"}},l={},d=[{value:"1.BEGIN\u6a21\u5f0f",id:"1begin\u6a21\u5f0f",level:2},{value:"\u4f5c\u7528\u4e00\t\u4fee\u6539\u6807\u9898",id:"\u4f5c\u7528\u4e00\u4fee\u6539\u6807\u9898",level:3},{value:"\u4f5c\u7528\u4e8c\t\u505a\u8fd0\u7b97",id:"\u4f5c\u7528\u4e8c\u505a\u8fd0\u7b97",level:3},{value:"\u4f5c\u7528\u4e09\t\u4fee\u6539awk\u5185\u7f6e\u53d8\u91cf",id:"\u4f5c\u7528\u4e09\u4fee\u6539awk\u5185\u7f6e\u53d8\u91cf",level:3},{value:"FS\t\u6307\u5b9a\u5b57\u6bb5\u5206\u9694\u7b26",id:"fs\u6307\u5b9a\u5b57\u6bb5\u5206\u9694\u7b26",level:4},{value:"OFS\t\u6307\u5b9a\u8f93\u51fa\u5206\u9694\u7b26",id:"ofs\u6307\u5b9a\u8f93\u51fa\u5206\u9694\u7b26",level:4},{value:"RS\t\u6307\u5b9a\u8bb0\u5f55\u5206\u9694\u7b26\uff0c\u5373\u6307\u5b9a\u4ee5\u4ec0\u4e48\u4e3a\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\\n",id:"rs\u6307\u5b9a\u8bb0\u5f55\u5206\u9694\u7b26\u5373\u6307\u5b9a\u4ee5\u4ec0\u4e48\u4e3a\u5206\u9694\u7b26\u9ed8\u8ba4\u4e3an",level:4},{value:"ORS\t\u6307\u5b9a\u8f93\u51fa\u8bb0\u5f55\u5206\u9694\u7b26",id:"ors\u6307\u5b9a\u8f93\u51fa\u8bb0\u5f55\u5206\u9694\u7b26",level:4},{value:"\u6269\u5c55-awk\u547d\u4ee4\u884c\u53c2\u6570",id:"\u6269\u5c55-awk\u547d\u4ee4\u884c\u53c2\u6570",level:3},{value:"ARGC",id:"argc",level:4},{value:"ARGV",id:"argv",level:4},{value:"2.END\u6a21\u5f0f",id:"2end\u6a21\u5f0f",level:2},{value:"\u4f5c\u7528\t\u663e\u793a\u8ba1\u7b97\u7ed3\u679c",id:"\u4f5c\u7528\u663e\u793a\u8ba1\u7b97\u7ed3\u679c",level:3}];function c(n){const t={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"[toc]"}),"\n",(0,s.jsx)(t.h1,{id:"awk-begin\u6a21\u5f0fend\u6a21\u5f0f",children:"awk BEGIN\u6a21\u5f0f\u3001END\u6a21\u5f0f"}),"\n",(0,s.jsx)(t.h2,{id:"1begin\u6a21\u5f0f",children:"1.BEGIN\u6a21\u5f0f"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"BEGIN\u6a21\u5f0f\u5728awk\u7a0b\u5e8f\u6267\u884c\u540e\uff0c\u4f46\u5c1a\u672a\u6267\u884c\u5904\u7406\u52a8\u4f5c\u4e4b\u524d\u9700\u8981\u505a\u7684\u5de5\u4f5c\uff08\u5b9a\u4e49\u53d8\u91cf\uff09"})}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"\u4f5c\u7528\u4e00\u4fee\u6539\u6807\u9898",children:"\u4f5c\u7528\u4e00\t\u4fee\u6539\u6807\u9898"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'//\u6587\u4ef6a.txt\u5185\u5bb9\u5982\u4e0b\n101,abc,CEO\n102,def,CTO\n103,qaz,COO\n\n//\u9ed8\u8ba4\u6253\u5370\n[root@7-test1 ~]# awk \'{print}\' a.txt\n101,abc,CEO\n102,def,CTO\n103,qaz,COO\n\n//\u6253\u5370\u6807\u9898\uff0c\u6ce8\u610fID\u3001name\u5fc5\u987b\u7528\u53cc\u5f15\u53f7\n[root@7-test1 ~]# awk \'BEGIN{print "ID","name","position"}{print}\' a.txt \nID name position\n101,abc,CEO\n102,def,CTO\n103,qaz,COO\n'})}),"\n",(0,s.jsx)(t.h3,{id:"\u4f5c\u7528\u4e8c\u505a\u8fd0\u7b97",children:"\u4f5c\u7528\u4e8c\t\u505a\u8fd0\u7b97"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"\u793a\u4f8b1:\u8ba1\u7b971\u5230100\u7684\u548c"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"[root@7-test1 ~]# awk 'BEGIN{for(i=1;i<=100;i++) sum+=i;print sum}'\n5050\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"\u793a\u4f8b2:\u666e\u901a\u8ba1\u7b97"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"[root@7-test1 ~]# awk 'BEGIN{print 3+3}'\n6\n[root@7-test1 ~]# awk 'BEGIN{print 3*3}'\n9\n[root@7-test1 ~]# awk 'BEGIN{print 3-3}'\n0\n[root@7-test1 ~]# awk 'BEGIN{print 3**3}'\n27\n[root@7-test1 ~]# awk 'BEGIN{print 3%3}'\n0\n[root@7-test1 ~]# awk 'BEGIN{print 3/3}'\n1\n"})}),"\n",(0,s.jsx)(t.h3,{id:"\u4f5c\u7528\u4e09\u4fee\u6539awk\u5185\u7f6e\u53d8\u91cf",children:"\u4f5c\u7528\u4e09\t\u4fee\u6539awk\u5185\u7f6e\u53d8\u91cf"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"record\t\u5b57\u6bb5"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"separator\t\u5206\u9694\u7b26"})}),"\n"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"\u53d8\u91cf\u540d"}),(0,s.jsx)(t.th,{children:"\u5bf9\u5e94\u5355\u8bcd"}),(0,s.jsx)(t.th,{children:"\u542b\u4e49"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"FS"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"field separator"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"\u5b57\u6bb5\u5206\u9694\u7b26,\u9ed8\u8ba4\u7a7a\u683c\u6216tab"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"OFS"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"output field separator"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"\u8f93\u51fa\u5206\u9694\u7b26,\u9ed8\u8ba4\u7a7a\u683c"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"RS"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"record separator"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"\u8bb0\u5f55\u5206\u9694\u7b26,\u9ed8\u8ba4\u6362\u884c\u7b26\\n"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"ORS"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"output record separator"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"\u8f93\u51fa\u8bb0\u5f55\u5206\u9694\u7b26"})})]})]})]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h4,{id:"fs\u6307\u5b9a\u5b57\u6bb5\u5206\u9694\u7b26",children:"FS\t\u6307\u5b9a\u5b57\u6bb5\u5206\u9694\u7b26"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"//passwd.txt\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\n[root@7-test1 ~]# cat passwd.txt\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\n\n\u793a\u4f8b1\uff1a\u4ee5\u5192\u53f7\u4e3a\u5206\u9694\u7b26\uff0c\u6253\u5370\u6587\u4ef6\u7b2c\u4e00\u5217\n//-F\u5199\u6cd5\n[root@7-test1 ~]# awk -F: '{print $1}' passwd.txt \nroot\nbin\ndaemon\n\n//BEGIN {FS}\u5199\u6cd5\n[root@7-test1 ~]# awk 'BEGIN{FS=\":\"}{print $1}' passwd.txt \nroot\nbin\ndaemon\n"})}),"\n",(0,s.jsx)(t.h4,{id:"ofs\u6307\u5b9a\u8f93\u51fa\u5206\u9694\u7b26",children:"OFS\t\u6307\u5b9a\u8f93\u51fa\u5206\u9694\u7b26"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"//\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\n[root@7-test1 ~]# cat a.txt \n1 2 3\n\n\u793a\u4f8b1\uff1a\u6253\u5370\u6587\u4ef6\u7b2c\u4e00\u5217\u548c\u7b2c\u4e09\u5217\uff0c\u4ee5\u5192\u53f7\u4e3a\u5206\u9694\u7b26\n//-v OFS\u5199\u6cd5\n[root@7-test1 ~]# awk -v OFS=: '{print $1,$3}' a.txt \n1:3\n\n//BEGIN {OFS}\u5199\u6cd5\n[root@7-test1 ~]# awk 'BEGIN{OFS=\":\"}{print $1,$3}' a.txt \n1:3\n\n\n\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f\u6ce8\u610f\uff1a\uff01\uff01\uff01\n-v OFS\u5199\u6cd5\u7684\u4e00\u4e2a\u5751\uff1a\u5f53print $0\u7684\u65f6\u5019\uff0c-v OFS\u4f1a\u4e0d\u751f\u6548\n\n//\u6b63\u786e\u8f93\u51fa\u5e94\u8be5\u4e3a1:2:3\n[root@7-test1 ~]# awk -v OFS=: '{print $0}' a.txt \n1 2 3\n\n\u89e3\u51b3\u65b9\u6cd5\n\u5728print$0\u524d\u52a0\u4e00\u4e2a$1=$1\n[root@7-test1 ~]# awk -v OFS=: '{$1=$1;print $0}' a.txt \n1:2:3\n"})}),"\n",(0,s.jsx)(t.h4,{id:"rs\u6307\u5b9a\u8bb0\u5f55\u5206\u9694\u7b26\u5373\u6307\u5b9a\u4ee5\u4ec0\u4e48\u4e3a\u5206\u9694\u7b26\u9ed8\u8ba4\u4e3an",children:"RS\t\u6307\u5b9a\u8bb0\u5f55\u5206\u9694\u7b26\uff0c\u5373\u6307\u5b9a\u4ee5\u4ec0\u4e48\u4e3a\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"//\u6587\u4ef6\u5185\u5bb9\n\u6587\u4ef6\u9ed8\u8ba4\u4ee5\u6362\u884c\u4e3a\u8bb0\u5f55\u5206\u9694\u7b26\n[root@7-test1 ~]# cat passwd.txt\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\n\n\u793a\u4f8b1\uff1a\u5c06\u6587\u4ef6\u7684\u8bb0\u5f55\u5206\u9694\u7b26\u6307\u5b9a\u4e3a/\uff0c\u5373\u6307\u5b9a\u6587\u4ef6\u4ee5/\u4e3a\u6362\u884c\u7b26\n//-v RS\u5199\u6cd5\n[root@7-test1 ~]# awk -v RS=/ '{print $0}' passwd.txt \nroot:x:0:0:root:\nroot:\nbin\nbash\nbin:x:1:1:bin:\nbin:\nsbin\nnologin\n\n//BEGIN {RS}\u5199\u6cd5\n[root@7-test1 ~]# awk 'BEGIN{RS=\"/\"}{print $0}' passwd.txt \nroot:x:0:0:root:\nroot:\nbin\nbash\nbin:x:1:1:bin:\nbin:\nsbin\nnologin\n"})}),"\n",(0,s.jsx)(t.h4,{id:"ors\u6307\u5b9a\u8f93\u51fa\u8bb0\u5f55\u5206\u9694\u7b26",children:"ORS\t\u6307\u5b9a\u8f93\u51fa\u8bb0\u5f55\u5206\u9694\u7b26"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"//\u6587\u4ef6\u5185\u5bb9\n[root@7-test1 ~]# cat a.txt\n1\n2\n3\n\n\u793a\u4f8b1\uff1a\u5c06\u6587\u4ef6\u7684\u8f93\u51fa\u8bb0\u5f55\u5206\u9694\u7b26\u6307\u5b9a\u4e3a/\n//-v ORS\u5199\u6cd5\n[root@7-test1 ~]# awk -v ORS=\"A\" '{print $0}' a.txt\n1A2A3A\n\n//BEGIN {ORS}\u5199\u6cd5\n[root@7-test1 ~]# awk 'BEGIN{ORS=\"A\"}{print $0}' a.txt\n1A2A3A\n"})}),"\n",(0,s.jsx)(t.h3,{id:"\u6269\u5c55-awk\u547d\u4ee4\u884c\u53c2\u6570",children:"\u6269\u5c55-awk\u547d\u4ee4\u884c\u53c2\u6570"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"ARGC\u662f\u547d\u4ee4\u884c\u53c2\u6570\u6570\u91cf"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"ARGV\u662f\u5c06\u547d\u4ee4\u884c\u53c2\u6570\u5b58\u5230\u6570\u7ec4\uff0c\u5143\u7d20\u7531ARGC\u6307\u5b9a\uff0c\u6570\u7ec4\u4e0b\u6807\u4ece0\u5f00\u59cb"})}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"argc",children:"ARGC"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"[root@test1 ~]# awk 'BEGIN{print ARGC}'\n1\n[root@test1 ~]# awk 'BEGIN{print ARGC}' 1 2\n3\n"})}),"\n",(0,s.jsx)(t.h4,{id:"argv",children:"ARGV"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"[root@test1 ~]# awk 'BEGIN{print ARGV[0]}' 1 2\nawk\n[root@test1 ~]# awk 'BEGIN{print ARGV[1]}' 1 2\n1\n[root@test1 ~]# awk 'BEGIN{print ARGV[2]}' 1 2\n2\n"})}),"\n",(0,s.jsx)(t.h2,{id:"2end\u6a21\u5f0f",children:"2.END\u6a21\u5f0f"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"END\u6a21\u5f0f\u5728awk\u8bfb\u53d6\u5b8c\u6587\u4ef6\u4e4b\u540e\u6267\u884c\uff0c\u4e3b\u8981\u4f5c\u7528\u4e3a\u663e\u793a\u8ba1\u7b97\u7ed3\u679c"})}),"\n",(0,s.jsx)(t.h3,{id:"\u4f5c\u7528\u663e\u793a\u8ba1\u7b97\u7ed3\u679c",children:"\u4f5c\u7528\t\u663e\u793a\u8ba1\u7b97\u7ed3\u679c"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"\u793a\u4f8b1:\u7edf\u8ba1/etc/passwd\u6587\u4ef6\u4e2d\u524d10\u884c\u975e\u767b\u9646shell\u7684\u4e2a\u6570"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"//\u6587\u4ef6\u5185\u5bb9\n[root@7-test1 awk]# head -10 /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\n            \n//\u7edf\u8ba1\u6587\u4ef6\u4e2d\u975e\u767b\u9646shell\u7684\u4e2a\u6570\uff0c\u5373\u7edf\u8ba1/sbin/nologin\u7684\u4e2a\u6570\n[root@7-test1 awk]# head -10 /etc/passwd|awk '/nologin/{i++}END{print i}'\n6            \n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"\u793a\u4f8b2:\u7edf\u8ba1/etc/services\u4e2d\u7a7a\u884c\u6570\u91cf"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"[root@7-test1 awk]# awk '/^$/{i++}END{print i}' /etc/services\n17\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"\u793a\u4f8b3:\u7edf\u8ba1nginx\u8bbf\u95ee\u65e5\u5fd7\u4e2d\u8bbf\u95ee\u91cf\u524d10\u7684IP"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"[root@7-test1 ~]# awk '{a[$1]++}END{for(i in a) print a[i],i}' /var/log/nginx/access.log|sort -nr|head\n275 109.98.109.101\n262 146.196.97.242\n210 47.52.155.218\n152 142.234.200.81\n75 72.211.58.142\n10 120.25.208.128\n7 42.236.10.84\n6 42.236.10.92\n3 5.188.210.12\n3 42.236.10.75\n"})})]})}function h(n={}){const{wrapper:t}={...(0,r.R)(),...n.components};return t?(0,s.jsx)(t,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}},28453:(n,t,e)=>{e.d(t,{R:()=>o,x:()=>a});var s=e(96540);const r={},i=s.createContext(r);function o(n){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function a(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),s.createElement(i.Provider,{value:t},n.children)}}}]);