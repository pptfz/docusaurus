"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1047],{93628:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});var i=s(74848),t=s(28453);const l={},c="kvm\u865a\u62df\u673a\u6269\u5bb9\u786c\u76d8",r={id:"linux/kvm/\u77e5\u8bc6\u70b9/kvm\u865a\u62df\u673a\u6269\u5bb9\u786c\u76d8",title:"kvm\u865a\u62df\u673a\u6269\u5bb9\u786c\u76d8",description:"1.\u5bbf\u4e3b\u673a\u67e5\u770bkvm\u865a\u62df\u673a\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f",source:"@site/docs/linux/kvm/\u77e5\u8bc6\u70b9/kvm\u865a\u62df\u673a\u6269\u5bb9\u786c\u76d8.md",sourceDirName:"linux/kvm/\u77e5\u8bc6\u70b9",slug:"/linux/kvm/\u77e5\u8bc6\u70b9/kvm\u865a\u62df\u673a\u6269\u5bb9\u786c\u76d8",permalink:"/docs/linux/kvm/\u77e5\u8bc6\u70b9/kvm\u865a\u62df\u673a\u6269\u5bb9\u786c\u76d8",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"kvm\u865a\u62df\u673a\u5f00\u673a\u81ea\u542f",permalink:"/docs/linux/kvm/\u77e5\u8bc6\u70b9/kvm\u865a\u62df\u673a\u5f00\u673a\u81ea\u542f"},next:{title:"kvm\u865a\u62df\u673a\u7f51\u5361\u6539\u52a8\u65e0\u6cd5\u542f\u52a8\u95ee\u9898",permalink:"/docs/linux/kvm/\u77e5\u8bc6\u70b9/kvm\u865a\u62df\u673a\u7f51\u5361\u6539\u52a8\u65e0\u6cd5\u542f\u52a8\u95ee\u9898"}},a={},o=[{value:"1.\u5bbf\u4e3b\u673a\u67e5\u770bkvm\u865a\u62df\u673a\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f",id:"1\u5bbf\u4e3b\u673a\u67e5\u770bkvm\u865a\u62df\u673a\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f",level:2},{value:"2.\u5bbf\u4e3b\u673a\u6269\u5bb9kvm\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f",id:"2\u5bbf\u4e3b\u673a\u6269\u5bb9kvm\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f",level:2},{value:"3.\u67e5\u770b\u865a\u62df\u673a\u786c\u76d8\u5927\u5c0f",id:"3\u67e5\u770b\u865a\u62df\u673a\u786c\u76d8\u5927\u5c0f",level:2},{value:"4.\u5f00\u59cb\u6269\u5bb9\u786c\u76d8",id:"4\u5f00\u59cb\u6269\u5bb9\u786c\u76d8",level:2},{value:"4.1 \u65b0\u5efa\u4e00\u4e2a\u5206\u533a",id:"41-\u65b0\u5efa\u4e00\u4e2a\u5206\u533a",level:3},{value:"4.2 \u4fee\u6539\u5206\u533a\u683c\u5f0f",id:"42-\u4fee\u6539\u5206\u533a\u683c\u5f0f",level:3},{value:"4.3 \u518d\u6b21\u67e5\u770b\u865a\u62df\u673a\u786c\u76d8",id:"43-\u518d\u6b21\u67e5\u770b\u865a\u62df\u673a\u786c\u76d8",level:3},{value:"4.4 \u67e5\u770b\u65b0\u589e\u7684\u5206\u533a",id:"44-\u67e5\u770b\u65b0\u589e\u7684\u5206\u533a",level:3},{value:"4.5 \u4f7f\u7528lvm\u5f00\u59cb\u6269\u5bb9",id:"45-\u4f7f\u7528lvm\u5f00\u59cb\u6269\u5bb9",level:3},{value:"4.5.1 \u521b\u5efapv",id:"451-\u521b\u5efapv",level:4},{value:"4.5.2 \u5c06\u521b\u5efa\u7684pv\u52a0\u5165vg",id:"452-\u5c06\u521b\u5efa\u7684pv\u52a0\u5165vg",level:4},{value:"4.5.3 \u6269\u5bb9lv",id:"453-\u6269\u5bb9lv",level:4},{value:"4.5.4 \u6269\u5bb9\u786c\u76d8",id:"454-\u6269\u5bb9\u786c\u76d8",level:4}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"kvm\u865a\u62df\u673a\u6269\u5bb9\u786c\u76d8",children:"kvm\u865a\u62df\u673a\u6269\u5bb9\u786c\u76d8"}),"\n",(0,i.jsx)(n.h2,{id:"1\u5bbf\u4e3b\u673a\u67e5\u770bkvm\u865a\u62df\u673a\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f",children:"1.\u5bbf\u4e3b\u673a\u67e5\u770bkvm\u865a\u62df\u673a\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f"}),"\n",(0,i.jsx)(n.p,{children:"\u6b64\u65f6\u6587\u4ef6\u5927\u5c0f\u4e3a50G"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"$ qemu-img info abc.qcow2 \nimage: abc.qcow2\nfile format: qcow2\nvirtual size: 50G (53687091200 bytes)\ndisk size: 2.5G\ncluster_size: 65536\nFormat specific information:\n    compat: 1.1\n    lazy refcounts: true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"2\u5bbf\u4e3b\u673a\u6269\u5bb9kvm\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f",children:"2.\u5bbf\u4e3b\u673a\u6269\u5bb9kvm\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f"}),"\n",(0,i.jsx)(n.p,{children:":::caution\u6ce8\u610f"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:(0,i.jsx)("span",{style:{color:"red"},children:"\u6267\u884c\u6269\u5bb9\u547d\u4ee4\u524d\u4e00\u5b9a\u8981\u5148\u5173\u95ed\u865a\u62df\u673a"})})}),"\n",(0,i.jsx)(n.p,{children:":::"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ qemu-img resize abc.qcow2 500G\nImage resized.\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u518d\u6b21\u67e5\u770bkvm\u865a\u62df\u673a\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f\uff0c\u6b64\u65f6\u5df2\u7ecf\u589e\u52a0"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ qemu-img info abc.qcow2 \nimage: abc.qcow2\nfile format: qcow2\nvirtual size: 500G (536870912000 bytes)\ndisk size: 2.5G\ncluster_size: 65536\nFormat specific information:\n    compat: 1.1\n    lazy refcounts: true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"3\u67e5\u770b\u865a\u62df\u673a\u786c\u76d8\u5927\u5c0f",children:"3.\u67e5\u770b\u865a\u62df\u673a\u786c\u76d8\u5927\u5c0f"}),"\n",(0,i.jsxs)(n.p,{children:["\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u786c\u76d8 ",(0,i.jsx)(n.code,{children:"/dev/sda"})," \u5927\u5c0f\u4e3a500G"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-11-24%2021.23.37.png",alt:"iShot2021-11-24 21.23.37"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528\u547d\u4ee4 ",(0,i.jsx)(n.code,{children:"df -h"})," \u67e5\u770b\uff0c\u6b64\u65f6\u786c\u76d8\u8fd8\u672a\u6269\u5bb9"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-11-24%2021.25.59.png",alt:"iShot2021-11-24 21.25.59"})}),"\n",(0,i.jsx)(n.h2,{id:"4\u5f00\u59cb\u6269\u5bb9\u786c\u76d8",children:"4.\u5f00\u59cb\u6269\u5bb9\u786c\u76d8"}),"\n",(0,i.jsx)(n.h3,{id:"41-\u65b0\u5efa\u4e00\u4e2a\u5206\u533a",children:"4.1 \u65b0\u5efa\u4e00\u4e2a\u5206\u533a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-11-24%2021.30.29.png",alt:"iShot2021-11-24 21.30.29"})}),"\n",(0,i.jsx)(n.h3,{id:"42-\u4fee\u6539\u5206\u533a\u683c\u5f0f",children:"4.2 \u4fee\u6539\u5206\u533a\u683c\u5f0f"}),"\n",(0,i.jsx)(n.p,{children:"\u4fee\u6539\u5206\u533a\u683c\u5f0f\u4e3a8e\uff0c\u5373lvm\u683c\u5f0f"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-11-24%2021.32.40.png",alt:"iShot2021-11-24 21.32.40"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4fdd\u5b58\u540e\u6267\u884c\u4e00\u4e0b ",(0,i.jsx)(n.code,{children:"partprobe "})," \u547d\u4ee4"]}),"\n",(0,i.jsx)(n.h3,{id:"43-\u518d\u6b21\u67e5\u770b\u865a\u62df\u673a\u786c\u76d8",children:"4.3 \u518d\u6b21\u67e5\u770b\u865a\u62df\u673a\u786c\u76d8"}),"\n",(0,i.jsxs)(n.p,{children:["\u53ef\u4ee5\u770b\u5230\u65b0\u5efa\u7684\u5206\u533a ",(0,i.jsx)(n.code,{children:"/dev/sda3"})," \uff0c\u5e76\u4e14\u786c\u76d8Id\u4e3a8e"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-11-24%2021.34.36.png",alt:"iShot2021-11-24 21.34.36"})}),"\n",(0,i.jsx)(n.h3,{id:"44-\u67e5\u770b\u65b0\u589e\u7684\u5206\u533a",children:"4.4 \u67e5\u770b\u65b0\u589e\u7684\u5206\u533a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-11-24%2021.41.06.png",alt:"iShot2021-11-24 21.41.06"})}),"\n",(0,i.jsx)(n.h3,{id:"45-\u4f7f\u7528lvm\u5f00\u59cb\u6269\u5bb9",children:"4.5 \u4f7f\u7528lvm\u5f00\u59cb\u6269\u5bb9"}),"\n",(0,i.jsx)(n.h4,{id:"451-\u521b\u5efapv",children:"4.5.1 \u521b\u5efapv"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'$ pvcreate /dev/sda3\n  Physical volume "/dev/sda3" successfully created.\n'})}),"\n",(0,i.jsx)(n.h4,{id:"452-\u5c06\u521b\u5efa\u7684pv\u52a0\u5165vg",children:"4.5.2 \u5c06\u521b\u5efa\u7684pv\u52a0\u5165vg"}),"\n",(0,i.jsxs)(n.p,{children:["\u6267\u884c\u547d\u4ee4 ",(0,i.jsx)(n.code,{children:"vgdisplay "})," \u67e5\u770bvg\u4fe1\u606f"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ vgdisplay \n  --- Volume group ---\n  VG Name               centos\n  System ID             \n  Format                lvm2\n  Metadata Areas        1\n  Metadata Sequence No  3\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                1\n  Act PV                1\n  VG Size               <49.00 GiB\n  PE Size               4.00 MiB\n  Total PE              12543\n  Alloc PE / Size       12542 / 48.99 GiB\n  Free  PE / Size       1 / 4.00 MiB\n  VG UUID               3uV4Hk-GNAr-fIet-W5He-filb-pzd1-1cC4Os\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5c06\u521b\u5efa\u7684pv\u52a0\u5165vg"}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u91ccvg\u540d\u79f0\u4e3a ",(0,i.jsx)(n.code,{children:"centos"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'$ vgextend centos /dev/sda3\n  Volume group "centos" successfully extended\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u518d\u6b21\u67e5\u770bvg\u4fe1\u606f\uff0c\u53ef\u4ee5\u770b\u5230\u65b0\u589e\u7684450G"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ vgdisplay \n  --- Volume group ---\n  VG Name               centos\n  System ID             \n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  4\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               498.99 GiB\n  PE Size               4.00 MiB\n  Total PE              127742\n  Alloc PE / Size       12542 / 48.99 GiB\n  Free  PE / Size       115200 / 450.00 GiB\n  VG UUID               3uV4Hk-GNAr-fIet-W5He-filb-pzd1-1cC4Os\n"})}),"\n",(0,i.jsx)(n.h4,{id:"453-\u6269\u5bb9lv",children:"4.5.3 \u6269\u5bb9lv"}),"\n",(0,i.jsxs)(n.p,{children:["\u6267\u884c\u547d\u4ee4 ",(0,i.jsx)(n.code,{children:"lvdisplay "})," \u67e5\u770blv\u4fe1\u606f"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ lvdisplay \n  --- Logical volume ---\n  LV Path                /dev/centos/swap\n  LV Name                swap\n  VG Name                centos\n  LV UUID                K5Vifj-QpYD-MABK-NOAE-K8os-9BqR-8M620U\n  LV Write Access        read/write\n  LV Creation host, time templet, 2021-11-15 15:59:43 +0800\n  LV Status              available\n  # open                 2\n  LV Size                2.00 GiB\n  Current LE             512\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     8192\n  Block device           253:1\n   \n  --- Logical volume ---\n  LV Path                /dev/centos/root\n  LV Name                root\n  VG Name                centos\n  LV UUID                uMARyx-VRJh-79dj-v15L-yr7M-XzR7-SKRzMW\n  LV Write Access        read/write\n  LV Creation host, time templet, 2021-11-15 15:59:44 +0800\n  LV Status              available\n  # open                 1\n  LV Size                46.99 GiB\n  Current LE             12030\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     8192\n  Block device           253:0\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6269\u5bb9lv"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ lvextend -L +450G /dev/centos/root \n  Size of logical volume centos/root changed from 46.99 GiB (12030 extents) to 496.99 GiB (127230 extents).\n  Logical volume centos/root successfully resized.\n"})}),"\n",(0,i.jsx)(n.h4,{id:"454-\u6269\u5bb9\u786c\u76d8",children:"4.5.4 \u6269\u5bb9\u786c\u76d8"}),"\n",(0,i.jsx)(n.p,{children:":::tip\u8bf4\u660e"}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c\u786c\u76d8\u5206\u533a\u7c7b\u578b\u662f ",(0,i.jsx)(n.code,{children:"ext4"})," \uff0c\u5219\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"resize2fs"})," \u547d\u4ee4"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c\u786c\u76d8\u5206\u533a\u7c7b\u578b\u662f ",(0,i.jsx)(n.code,{children:"xfs"})," \uff0c\u5219\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"xfs_growfs"})," \u547d\u4ee4"]}),"\n",(0,i.jsx)(n.p,{children:":::"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u91cc\u786c\u76d8\u5206\u533a\u7c7b\u578b\u662fxfs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ xfs_growfs /dev/mapper/centos-root \nmeta-data=/dev/mapper/centos-root isize=512    agcount=4, agsize=3079680 blks\n         =                       sectsz=512   attr=2, projid32bit=1\n         =                       crc=1        finobt=0 spinodes=0\ndata     =                       bsize=4096   blocks=12318720, imaxpct=25\n         =                       sunit=0      swidth=0 blks\nnaming   =version 2              bsize=4096   ascii-ci=0 ftype=1\nlog      =internal               bsize=4096   blocks=6015, version=2\n         =                       sectsz=512   sunit=0 blks, lazy-count=1\nrealtime =none                   extsz=4096   blocks=0, rtextents=0\ndata blocks changed from 12318720 to 130283520\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u67e5\u770b\u78c1\u76d8\uff0c\u6269\u5bb9\u5b8c\u6210"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-11-24%2022.24.06.png",alt:"iShot2021-11-24 22.24.06"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>r});var i=s(96540);const t={},l=i.createContext(t);function c(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);