"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[5092],{25481:(n,i,t)=>{t.r(i),t.d(i,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>p,toc:()=>o});var e=t(74848),s=t(28453);const r={},a="zabbix3.4\u4f7f\u7528\u9489\u9489\u544a\u8b66",p={id:"linux/monitor/zabbix/zabbix3.4/zabbix3.4\u4f7f\u7528\u9489\u9489\u544a\u8b66",title:"zabbix3.4\u4f7f\u7528\u9489\u9489\u544a\u8b66",description:"[toc]",source:"@site/docs/linux/monitor/zabbix/zabbix3.4/11.zabbix3.4\u4f7f\u7528\u9489\u9489\u544a\u8b66.md",sourceDirName:"linux/monitor/zabbix/zabbix3.4",slug:"/linux/monitor/zabbix/zabbix3.4/zabbix3.4\u4f7f\u7528\u9489\u9489\u544a\u8b66",permalink:"/docs/linux/monitor/zabbix/zabbix3.4/zabbix3.4\u4f7f\u7528\u9489\u9489\u544a\u8b66",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:11,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"zabbix3.4\u4f7f\u7528\u4f01\u4e1a\u5fae\u4fe1\u544a\u8b66",permalink:"/docs/linux/monitor/zabbix/zabbix3.4/zabbix3.4\u4f7f\u7528\u4f01\u4e1a\u5fae\u4fe1\u544a\u8b66"},next:{title:"zabbix3.4\u81ea\u52a8\u5316\u76d1\u63a7",permalink:"/docs/linux/monitor/zabbix/zabbix3.4/zabbix3.4\u81ea\u52a8\u5316\u76d1\u63a7"}},c={},o=[{value:"\u7b2c\u4e00\u6b65\u3001\u9489\u9489\u673a\u5668\u4eba\u521b\u5efa",id:"\u7b2c\u4e00\u6b65\u9489\u9489\u673a\u5668\u4eba\u521b\u5efa",level:2},{value:"\u7b2c\u4e8c\u6b65\u3001zabbix-server\u7aef\u7f16\u5199python\u811a\u672c",id:"\u7b2c\u4e8c\u6b65zabbix-server\u7aef\u7f16\u5199python\u811a\u672c",level:2},{value:"\u7b2c\u4e09\u6b65\u3001zabbix web\u754c\u9762\u8bbe\u7f6e",id:"\u7b2c\u4e09\u6b65zabbix-web\u754c\u9762\u8bbe\u7f6e",level:2},{value:"3.1 \u521b\u5efa\u9489\u9489\u544a\u8b66",id:"31-\u521b\u5efa\u9489\u9489\u544a\u8b66",level:3},{value:"3.2 \u4fee\u6539\u544a\u8b66\u64cd\u4f5c",id:"32-\u4fee\u6539\u544a\u8b66\u64cd\u4f5c",level:3},{value:"3.3 \u4fee\u6539\u6062\u590d\u64cd\u4f5c",id:"33-\u4fee\u6539\u6062\u590d\u64cd\u4f5c",level:3},{value:"3.4 \u4fee\u6539\u786e\u8ba4\u4fe1\u606f",id:"34-\u4fee\u6539\u786e\u8ba4\u4fe1\u606f",level:3},{value:"\u7b2c\u56db\u6b65\u3001\u9489\u9489\u9a8c\u8bc1",id:"\u7b2c\u56db\u6b65\u9489\u9489\u9a8c\u8bc1",level:2}];function h(n){const i={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...n.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(i.p,{children:"[toc]"}),"\n",(0,e.jsx)(i.h1,{id:"zabbix34\u4f7f\u7528\u9489\u9489\u544a\u8b66",children:"zabbix3.4\u4f7f\u7528\u9489\u9489\u544a\u8b66"}),"\n",(0,e.jsx)(i.h2,{id:"\u7b2c\u4e00\u6b65\u9489\u9489\u673a\u5668\u4eba\u521b\u5efa",children:"\u7b2c\u4e00\u6b65\u3001\u9489\u9489\u673a\u5668\u4eba\u521b\u5efa"}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u6253\u5f00windows\u9489\u9489\u5ba2\u6237\u7aef--\x3e\u53f3\u4e0a\u89d2\u5934\u50cf\u5904--\x3e\u673a\u5668\u4eba\u7ba1\u7406"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2009.56.36.png",alt:"iShot2020-10-16 09.56.36"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u9009\u62e9\u81ea\u5b9a\u4e49"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2009.56.54.png",alt:"iShot2020-10-16 09.56.54"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u9009\u62e9\u6dfb\u52a0"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2009.57.20.png",alt:"iShot2020-10-16 09.57.20"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u586b\u5199\u673a\u5668\u4eba\u540d\u5b57\u548c\u8981\u6dfb\u52a0\u5230\u7684\u7fa4\u7ec4"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2009.57.39.png",alt:"iShot2020-10-16 09.57.39"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u8fd9\u91cc\u7684webhook\u503c\u9700\u8981\u5199\u5728\u540e\u7eedpython\u811a\u672c\u4e2d"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2009.58.15.png",alt:"iShot2020-10-16 09.58.15"})}),"\n",(0,e.jsx)(i.h2,{id:"\u7b2c\u4e8c\u6b65zabbix-server\u7aef\u7f16\u5199python\u811a\u672c",children:"\u7b2c\u4e8c\u6b65\u3001zabbix-server\u7aef\u7f16\u5199python\u811a\u672c"}),"\n",(0,e.jsx)(i.pre,{children:(0,e.jsx)(i.code,{className:"language-python",children:'#\u5728zabbix-server\u7aef\u7f16\u8f91python\u811a\u672c\n[root@zabbix-server alertscripts]# pwd\n/usr/lib/zabbix/alertscripts\n[root@zabbix-server alertscripts]# cat >/usr/lib/zabbix/alertscripts/dingding.py <<EOF\n#!/usr/bin/python\n# -*- coding: utf-8 -*-\nimport requests\nimport json\nimport sys\nimport os\n\nheaders = {\'Content-Type\': \'application/json;charset=utf-8\'}\napi_url = "https://oapi.dingtalk.com/robot/send?xxx"\t#\u6ce8\u610f\uff0capi_url\u5230\u540e\u8fb9\u7684\u4e00\u4e32\u662f\u4e00\u884c\uff0c\u4e14\u8fd9\u91cc\u7684api_url\u8981\u5199\u6210\u81ea\u5df1\u4f01\u4e1a\u9489\u9489\u4e2d\u521b\u5efa\u7684\u673a\u5668\u4eba\u4e2d\u7684webhook\n \ndef msg(text):\n    json_text= {\n     "msgtype": "text",\n        "at": {\n            "atMobiles": [\n                "17310470653"\n            ],\n            "isAtAll": False\n        },\n        "text": {\n            "content": text\n        }\n    }\n    print requests.post(api_url,json.dumps(json_text),headers=headers).content\n     \nif __name__ == \'__main__\':\n    text = sys.argv[1]\n    msg(text)\nEOF\n\n#\u8d4b\u4e88\u811a\u672c\u6267\u884c\u6743\u9650\n[root@zabbix-server alertscripts]# chmod +x dingding.py\n\n#\u4fee\u6539\u811a\u672c\u6240\u6709\u8005\u4e3azabbix\n[root@zabbix-server alertscripts]# chown zabbix.zabbix dingding.py\n\n#\u5b89\u88c5\u4f9d\u8d56\u5305\n[root@zabbix-server ~]# yum -y install python-pip \n[root@zabbix-server ~]# pip install requests\n\n#\u6267\u884c\u811a\u672c\u8fdb\u884c\u6d4b\u8bd5\uff0c\u8fd4\u56de\u4ee5\u4e0b\u5185\u5bb9\u5373\u4e3a\u6b63\u786e\uff0c\u5e76\u4e14\u9489\u9489\u80fd\u591f\u6536\u5230\u4fe1\u606f\n[root@zabbix-server alertscripts]# ./dingding.py test\n{"errmsg":"ok","errcode":0}\n'})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2009.59.39.png",alt:"iShot2020-10-16 09.59.39"})}),"\n",(0,e.jsx)(i.h2,{id:"\u7b2c\u4e09\u6b65zabbix-web\u754c\u9762\u8bbe\u7f6e",children:"\u7b2c\u4e09\u6b65\u3001zabbix web\u754c\u9762\u8bbe\u7f6e"}),"\n",(0,e.jsx)(i.h3,{id:"31-\u521b\u5efa\u9489\u9489\u544a\u8b66",children:"3.1 \u521b\u5efa\u9489\u9489\u544a\u8b66"}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u7ba1\u7406--\x3e\u62a5\u8b66\u5a92\u4ecb\u7c7b\u578b--\x3e\u521b\u5efa\u5a92\u4f53\u7c7b\u578b"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.00.08.png",alt:"iShot2020-10-16 10.00.08"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsxs)(i.strong,{children:["\u586b\u5199\u76f8\u5173\u4fe1\u606f\uff0c\u6ce8\u610f\u811a\u672c\u53c2\u6570\u5199 ",(0,e.jsx)(i.code,{children:"{ALERT.MESSAGE}"})]})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.00.25.png",alt:"iShot2020-10-16 10.00.25"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.00.43.png",alt:"iShot2020-10-16 10.00.43"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u53f3\u4e0a\u89d2\u5c0f\u4eba\u5934--\x3e\u62a5\u8b66\u5a92\u4ecb--\x3e\u6dfb\u52a0"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.01.07.png",alt:"iShot2020-10-16 10.01.07"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.01.40.png",alt:"iShot2020-10-16 10.01.40"})}),"\n",(0,e.jsx)(i.h3,{id:"32-\u4fee\u6539\u544a\u8b66\u64cd\u4f5c",children:"3.2 \u4fee\u6539\u544a\u8b66\u64cd\u4f5c"}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u4fee\u6539\u64cd\u4f5c\u6807\u9898\u5982\u4e0b"})}),"\n",(0,e.jsx)(i.pre,{children:(0,e.jsx)(i.code,{className:"language-python",children:"\u670d\u52a1\u5668:{HOST.NAME}\u53d1\u751f: {TRIGGER.NAME} \u6545\u969c!\n"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u4fee\u6539\u6d88\u606f\u5185\u5bb9\u5982\u4e0b"})}),"\n",(0,e.jsx)(i.pre,{children:(0,e.jsx)(i.code,{className:"language-python",children:"\u670d\u52a1\u5668:{HOST.NAME}\u53d1\u751f: {TRIGGER.NAME} \u6545\u969c!\n{\n\u544a\u8b66\u4e3b\u673a:{HOST.NAME}\n\u544a\u8b66\u5730\u5740:{HOST.IP}\n\u76d1\u63a7\u9879\u76ee:{ITEM.NAME}\n\u76d1\u63a7\u53d6\u503c:{ITEM.LASTVALUE}\n\u544a\u8b66\u7b49\u7ea7:{TRIGGER.SEVERITY}\n\u5f53\u524d\u72b6\u6001:{TRIGGER.STATUS}\n\u544a\u8b66\u4fe1\u606f:{TRIGGER.NAME}\n\u544a\u8b66\u65f6\u95f4:{EVENT.DATE} {EVENT.TIME}\n\u4e8b\u4ef6ID:{EVENT.ID}\n}\n"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.07.37.png",alt:"iShot2020-10-16 10.07.37"})}),"\n",(0,e.jsx)(i.h3,{id:"33-\u4fee\u6539\u6062\u590d\u64cd\u4f5c",children:"3.3 \u4fee\u6539\u6062\u590d\u64cd\u4f5c"}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u4fee\u6539\u6062\u590d\u6807\u9898\u5982\u4e0b"})}),"\n",(0,e.jsx)(i.pre,{children:(0,e.jsx)(i.code,{className:"language-python",children:"\u670d\u52a1\u5668:{HOST.NAME}: {TRIGGER.NAME} \u5df2\u6062\u590d!\n"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u4fee\u6539\u6062\u590d\u5185\u5bb9\u5982\u4e0b"})}),"\n",(0,e.jsx)(i.pre,{children:(0,e.jsx)(i.code,{className:"language-python",children:"\u670d\u52a1\u5668:{HOST.NAME}: {TRIGGER.NAME} \u5df2\u6062\u590d!\n{\n\u544a\u8b66\u4e3b\u673a:{HOST.NAME}\n\u544a\u8b66\u5730\u5740:{HOST.IP}\n\u76d1\u63a7\u9879\u76ee:{ITEM.NAME}\n\u76d1\u63a7\u53d6\u503c:{ITEM.LASTVALUE}\n\u544a\u8b66\u7b49\u7ea7:{TRIGGER.SEVERITY}\n\u5f53\u524d\u72b6\u6001:{TRIGGER.STATUS}\n\u544a\u8b66\u4fe1\u606f:{TRIGGER.NAME}\n\u544a\u8b66\u65f6\u95f4:{EVENT.DATE} {EVENT.TIME}\n\u6062\u590d\u65f6\u95f4:{EVENT.RECOVERY.DATE} {EVENT.RECOVERY.TIME}\n\u6301\u7eed\u65f6\u95f4:{EVENT.AGE}\n\u4e8b\u4ef6ID:{EVENT.ID}\n}\n"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.33.35.png",alt:"iShot2020-10-16 10.33.35"})}),"\n",(0,e.jsx)(i.h3,{id:"34-\u4fee\u6539\u786e\u8ba4\u4fe1\u606f",children:"3.4 \u4fee\u6539\u786e\u8ba4\u4fe1\u606f"}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u4fee\u6539\u786e\u8ba4\u6807\u9898\u5982\u4e0b"})}),"\n",(0,e.jsx)(i.pre,{children:(0,e.jsx)(i.code,{className:"language-python",children:"\u670d\u52a1\u5668:{HOST.NAME}:  \u62a5\u8b66\u786e\u8ba4\n"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u4fee\u6539\u786e\u8ba4\u5185\u5bb9\u5982\u4e0b"})}),"\n",(0,e.jsx)(i.pre,{children:(0,e.jsx)(i.code,{className:"language-python",children:'\u670d\u52a1\u5668:{HOST.NAME}:  \u62a5\u8b66\u786e\u8ba4\n{\n\u786e\u8ba4\u4eba:{USER.FULLNAME} \n\u65f6\u95f4:{ACK.DATE} {ACK.TIME} \n\u786e\u8ba4\u4fe1\u606f\u5982\u4e0b:\n"{ACK.MESSAGE}"\n\u95ee\u9898\u670d\u52a1\u5668IP:{HOSTNAME1}\n\u95ee\u9898ID:{EVENT.ID}\n\u5f53\u524d\u7684\u95ee\u9898\u662f: {TRIGGER.NAME}\n}\n'})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.34.04.png",alt:"iShot2020-10-16 10.34.04"})}),"\n",(0,e.jsx)(i.h2,{id:"\u7b2c\u56db\u6b65\u9489\u9489\u9a8c\u8bc1",children:"\u7b2c\u56db\u6b65\u3001\u9489\u9489\u9a8c\u8bc1"}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"pc\u7aef\u9489\u9489"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.34.30.png",alt:"iShot2020-10-16 10.34.30"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.strong,{children:"\u624b\u673a\u7aef\u9489\u9489"})}),"\n",(0,e.jsx)(i.p,{children:(0,e.jsx)(i.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-16%2010.35.06.png",alt:"iShot2020-10-16 10.35.06"})})]})}function l(n={}){const{wrapper:i}={...(0,s.R)(),...n.components};return i?(0,e.jsx)(i,{...n,children:(0,e.jsx)(h,{...n})}):h(n)}},28453:(n,i,t)=>{t.d(i,{R:()=>a,x:()=>p});var e=t(96540);const s={},r=e.createContext(s);function a(n){const i=e.useContext(r);return e.useMemo((function(){return"function"==typeof n?n(i):{...i,...n}}),[i,n])}function p(n){let i;return i=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),e.createElement(r.Provider,{value:i},n.children)}}}]);