"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[5211],{79862:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var c=t(74848),s=t(28453);const o={},r="centos7\u642d\u5efaopenstack Rocky\u7248",i={id:"linux/openstack/rocky/centos7.8\u642d\u5efaopenstack Rocky\u7248",title:"centos7.8\u642d\u5efaopenstack Rocky\u7248",description:"[toc]",source:"@site/docs/linux/openstack/rocky/1.centos7.8\u642d\u5efaopenstack Rocky\u7248.md",sourceDirName:"linux/openstack/rocky",slug:"/linux/openstack/rocky/centos7.8\u642d\u5efaopenstack Rocky\u7248",permalink:"/docs/linux/openstack/rocky/centos7.8\u642d\u5efaopenstack Rocky\u7248",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Mitaka\u7248web\u754c\u9762\u542f\u52a8\u4e00\u4e2a\u5b9e\u4f8b",permalink:"/docs/linux/openstack/mitaka/Mitaka\u7248web\u754c\u9762\u542f\u52a8\u4e00\u4e2a\u5b9e\u4f8b"},next:{title:"rocky\u7248\u4f7f\u7528\u547d\u4ee4\u542f\u52a8\u4e00\u4e2a\u5b9e\u4f8b",permalink:"/docs/linux/openstack/rocky/rocky\u7248\u4f7f\u7528\u547d\u4ee4\u542f\u52a8\u4e00\u4e2a\u5b9e\u4f8b"}},a={},l=[{value:"1.\u628arocky\u7248rpm\u5305\u505a\u6210\u672c\u5730yum\u6e90",id:"1\u628arocky\u7248rpm\u5305\u505a\u6210\u672c\u5730yum\u6e90",level:2},{value:"1.1 \u5b89\u88c5 <code>createrepo</code> \u547d\u4ee4",id:"11-\u5b89\u88c5-createrepo-\u547d\u4ee4",level:3},{value:"1.2 \u5236\u4f5c\u4ed3\u5e93",id:"12-\u5236\u4f5c\u4ed3\u5e93",level:3},{value:"1.3 \u5b89\u88c5nginx",id:"13-\u5b89\u88c5nginx",level:3},{value:"1.4 \u914d\u7f6enginx",id:"14-\u914d\u7f6enginx",level:3},{value:"1.5 \u7f16\u8f91\u672c\u5730yum\u4ed3\u5e93\u6587\u4ef6",id:"15-\u7f16\u8f91\u672c\u5730yum\u4ed3\u5e93\u6587\u4ef6",level:3},{value:"1.6 \u751f\u6210\u672c\u5730\u7f13\u5b58",id:"16-\u751f\u6210\u672c\u5730\u7f13\u5b58",level:3},{value:"2.\u57fa\u7840\u73af\u5883\u914d\u7f6e",id:"2\u57fa\u7840\u73af\u5883\u914d\u7f6e",level:2},{value:"2.1 \u5173\u95ed\u9632\u706b\u5899\u548cselinux",id:"21-\u5173\u95ed\u9632\u706b\u5899\u548cselinux",level:3},{value:"2.2 \u914d\u7f6ehosts\u89e3\u6790",id:"22-\u914d\u7f6ehosts\u89e3\u6790",level:3},{value:"2.3 \u914d\u7f6echrony\u670d\u52a1\uff0c\u8981\u4fdd\u8bc1\u6240\u6709\u8282\u70b9\u65f6\u95f4\u4e00\u81f4",id:"23-\u914d\u7f6echrony\u670d\u52a1\u8981\u4fdd\u8bc1\u6240\u6709\u8282\u70b9\u65f6\u95f4\u4e00\u81f4",level:3},{value:"2.3.1 \u5b89\u88c5chrony",id:"231-\u5b89\u88c5chrony",level:4},{value:"2.3.2 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 <code>/etc/chrony.conf</code>",id:"232-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6-etcchronyconf",level:4},{value:"2.3.3 \u542f\u52a8\u670d\u52a1\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f",id:"233-\u542f\u52a8\u670d\u52a1\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f",level:4},{value:"2.3.4 \u9a8c\u8bc1",id:"234-\u9a8c\u8bc1",level:4},{value:"2.4 \u4e0b\u8f7dopenstack\u5b98\u65b9yum\u6e90\u5b89\u88c5openstack\u5ba2\u6237\u7aef",id:"24-\u4e0b\u8f7dopenstack\u5b98\u65b9yum\u6e90\u5b89\u88c5openstack\u5ba2\u6237\u7aef",level:3},{value:"3.\u63a7\u5236\u8282\u70b9\u57fa\u7840\u73af\u5883\u5b89\u88c5",id:"3\u63a7\u5236\u8282\u70b9\u57fa\u7840\u73af\u5883\u5b89\u88c5",level:2},{value:"3.1 \u5b89\u88c5\u914d\u7f6emariadb\u6570\u636e\u5e93",id:"31-\u5b89\u88c5\u914d\u7f6emariadb\u6570\u636e\u5e93",level:3},{value:"3.1.1 \u5b89\u88c5\u5305",id:"311-\u5b89\u88c5\u5305",level:4},{value:"3.1.2 \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6",id:"312-\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6",level:4},{value:"3.1.3 \u542f\u52a8mariadb\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f",id:"313-\u542f\u52a8mariadb\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f",level:4},{value:"3.1.4 \u8fdb\u884c\u6570\u636e\u5e93\u5b89\u5168\u8bbe\u7f6e",id:"314-\u8fdb\u884c\u6570\u636e\u5e93\u5b89\u5168\u8bbe\u7f6e",level:4},{value:"3.2 \u5b89\u88c5\u6d88\u606f\u961f\u5217rabbitmq",id:"32-\u5b89\u88c5\u6d88\u606f\u961f\u5217rabbitmq",level:3},{value:"3.2.1 \u5b89\u88c5\u5305",id:"321-\u5b89\u88c5\u5305",level:4},{value:"3.2.2 \u542f\u52a8rabbitmq\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",id:"322-\u542f\u52a8rabbitmq\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",level:4},{value:"3.2.3 \u6dfb\u52a0openstack\u7528\u6237",id:"323-\u6dfb\u52a0openstack\u7528\u6237",level:4},{value:"3.2.4 \u7ed9openstack\u7528\u6237\u8bbe\u7f6e\u8bfb\u548c\u5199\u6743\u9650",id:"324-\u7ed9openstack\u7528\u6237\u8bbe\u7f6e\u8bfb\u548c\u5199\u6743\u9650",level:4},{value:"3.2.5 \u542f\u52a8rabbitmq\u4e00\u4e2a\u63d2\u4ef6\uff0c\u542f\u52a8\u4e4b\u540e\u4f1a\u76d1\u542ctcp/15672",id:"325-\u542f\u52a8rabbitmq\u4e00\u4e2a\u63d2\u4ef6\u542f\u52a8\u4e4b\u540e\u4f1a\u76d1\u542ctcp15672",level:4},{value:"3.3 \u5b89\u88c5memcached",id:"33-\u5b89\u88c5memcached",level:3},{value:"3.3.1 \u5b89\u88c5\u5305",id:"331-\u5b89\u88c5\u5305",level:4},{value:"3.3.2 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6",id:"332-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6",level:4},{value:"3.3.3 \u542f\u52a8memcached\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",id:"333-\u542f\u52a8memcached\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",level:4},{value:"3.4 \u5b89\u88c5etcd",id:"34-\u5b89\u88c5etcd",level:3},{value:"3.4.1 \u5b89\u88c5\u5305",id:"341-\u5b89\u88c5\u5305",level:4},{value:"3.4.2 \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6",id:"342-\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6",level:4},{value:"3.4.3 \u542f\u52a8etcd\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f",id:"343-\u542f\u52a8etcd\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f",level:4},{value:"4.\u63a7\u5236\u8282\u70b9\u8ba4\u8bc1\u670d\u52a1keystone\u5b89\u88c5",id:"4\u63a7\u5236\u8282\u70b9\u8ba4\u8bc1\u670d\u52a1keystone\u5b89\u88c5",level:2},{value:"4.1 \u521b\u5efakeystone\u6570\u636e\u5e93\u5e76\u6388\u6743",id:"41-\u521b\u5efakeystone\u6570\u636e\u5e93\u5e76\u6388\u6743",level:3},{value:"4.2 \u5b89\u88c5\u548c\u914d\u7f6ekeystron",id:"42-\u5b89\u88c5\u548c\u914d\u7f6ekeystron",level:3},{value:"4.2.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"421-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"4.2.2 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6  <code>/etc/keystone/keystone.conf</code>",id:"422-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6--etckeystonekeystoneconf",level:4},{value:"4.2.3 \u521d\u59cb\u5316\u8eab\u4efd\u8ba4\u8bc1\u670d\u52a1\u7684\u6570\u636e\u5e93",id:"423-\u521d\u59cb\u5316\u8eab\u4efd\u8ba4\u8bc1\u670d\u52a1\u7684\u6570\u636e\u5e93",level:4},{value:"4.2.4 \u521d\u59cb\u5316Fernet key",id:"424-\u521d\u59cb\u5316fernet-key",level:4},{value:"4.2.5 \u5f15\u5bfc\u8eab\u4efd\u670d\u52a1",id:"425-\u5f15\u5bfc\u8eab\u4efd\u670d\u52a1",level:4},{value:"4.2.6 \u914d\u7f6eApache\u670d\u52a1\u5668",id:"426-\u914d\u7f6eapache\u670d\u52a1\u5668",level:4},{value:"4.2.6.1 \u4fee\u6539\u6587\u4ef6",id:"4261-\u4fee\u6539\u6587\u4ef6",level:5},{value:"4.2.6.2 \u521b\u5efa\u6587\u4ef6\u8f6f\u8fde\u63a5",id:"4262-\u521b\u5efa\u6587\u4ef6\u8f6f\u8fde\u63a5",level:5},{value:"4.2.7 \u542f\u52a8Apache\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",id:"427-\u542f\u52a8apache\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",level:4},{value:"4.2.8 \u914d\u7f6e\u7ba1\u7406\u8d26\u6237",id:"428-\u914d\u7f6e\u7ba1\u7406\u8d26\u6237",level:4},{value:"4.3 \u521b\u5efa\u57df\u3001\u9879\u76ee\u3001\u7528\u6237\u548c\u89d2\u8272",id:"43-\u521b\u5efa\u57df\u9879\u76ee\u7528\u6237\u548c\u89d2\u8272",level:3},{value:"4.3.1 \u521b\u5efa\u4e00\u4e2a\u57df",id:"431-\u521b\u5efa\u4e00\u4e2a\u57df",level:4},{value:"4.3.2 \u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u9879\u76ee",id:"432-\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u9879\u76ee",level:4},{value:"4.3.3 \u5e38\u89c4\uff08\u975e\u7ba1\u7406\u5458\uff09\u4efb\u52a1\u5e94\u4f7f\u7528\u65e0\u7279\u6743\u7684\u9879\u76ee\u548c\u7528\u6237",id:"433-\u5e38\u89c4\u975e\u7ba1\u7406\u5458\u4efb\u52a1\u5e94\u4f7f\u7528\u65e0\u7279\u6743\u7684\u9879\u76ee\u548c\u7528\u6237",level:4},{value:"4.3.3.1 \u521b\u5efamyproject\u9879\u76ee",id:"4331-\u521b\u5efamyproject\u9879\u76ee",level:5},{value:"4.3.3.2 \u521b\u5efamyuser\u7528\u6237",id:"4332-\u521b\u5efamyuser\u7528\u6237",level:5},{value:"4.3.3.3 \u521b\u5efamyrole\u89d2\u8272",id:"4333-\u521b\u5efamyrole\u89d2\u8272",level:5},{value:"4.3.3.4 \u5c06myrole\u89d2\u8272\u6dfb\u52a0\u5230myproject\u9879\u76ee\u548cmyuser\u7528\u6237",id:"4334-\u5c06myrole\u89d2\u8272\u6dfb\u52a0\u5230myproject\u9879\u76ee\u548cmyuser\u7528\u6237",level:5},{value:"4.3.4 \u9a8c\u8bc1",id:"434-\u9a8c\u8bc1",level:4},{value:"4.3.4.1 \u53d6\u6d88\u8bbe\u7f6e\u4e34\u65f6\u53d8\u91cf <code>OS_AUTH_URL</code> \u548c <code>OS_PASSWORD</code> \u73af\u5883\u53d8\u91cf",id:"4341-\u53d6\u6d88\u8bbe\u7f6e\u4e34\u65f6\u53d8\u91cf-os_auth_url-\u548c-os_password-\u73af\u5883\u53d8\u91cf",level:5},{value:"4.3.4.2 \u4ee5admin\u7528\u6237\u8eab\u4efd\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c",id:"4342-\u4ee5admin\u7528\u6237\u8eab\u4efd\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c",level:5},{value:"4.3.4.3 \u4f7f\u7528\u4e0a\u4e00\u8282\u4e2d\u521b\u5efa\u7684\u7528\u6237myuser\uff0c\u8bf7\u8bf7\u6c42\u8ba4\u8bc1\u4ee4\u724c",id:"4343-\u4f7f\u7528\u4e0a\u4e00\u8282\u4e2d\u521b\u5efa\u7684\u7528\u6237myuser\u8bf7\u8bf7\u6c42\u8ba4\u8bc1\u4ee4\u724c",level:5},{value:"4.4 \u521b\u5efaOpenStack\u5ba2\u6237\u7aef\u73af\u5883\u811a\u672c",id:"44-\u521b\u5efaopenstack\u5ba2\u6237\u7aef\u73af\u5883\u811a\u672c",level:3},{value:"4.4.1 \u521b\u5efa\u811a\u672c",id:"441-\u521b\u5efa\u811a\u672c",level:4},{value:"4.4.2 \u4f7f\u7528\u811a\u672c",id:"442-\u4f7f\u7528\u811a\u672c",level:4},{value:"4.4.2.1 \u52a0\u8f7d <code>admin-openrc</code> \u6587\u4ef6\u4ee5\u4f7f\u7528\u8eab\u4efd\u670d\u52a1\u7684\u4f4d\u7f6e\u4ee5\u53caadmin\u9879\u76ee\u548c\u7528\u6237\u51ed\u636e\u586b\u5145\u73af\u5883\u53d8\u91cf",id:"4421-\u52a0\u8f7d-admin-openrc-\u6587\u4ef6\u4ee5\u4f7f\u7528\u8eab\u4efd\u670d\u52a1\u7684\u4f4d\u7f6e\u4ee5\u53caadmin\u9879\u76ee\u548c\u7528\u6237\u51ed\u636e\u586b\u5145\u73af\u5883\u53d8\u91cf",level:5},{value:"4.4.2.2 \u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c",id:"4422-\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c",level:5},{value:"5.\u63a7\u5236\u8282\u70b9\u955c\u50cf\u670d\u52a1glance\u5b89\u88c5",id:"5\u63a7\u5236\u8282\u70b9\u955c\u50cf\u670d\u52a1glance\u5b89\u88c5",level:2},{value:"5.1 \u521b\u5efaglance\u6570\u636e\u5e93\u5e76\u6388\u6743",id:"51-\u521b\u5efaglance\u6570\u636e\u5e93\u5e76\u6388\u6743",level:3},{value:"5.2 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee",id:"52-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee",level:3},{value:"5.3 \u521b\u5efa\u670d\u52a1\u51ed\u636e",id:"53-\u521b\u5efa\u670d\u52a1\u51ed\u636e",level:3},{value:"5.3.1 \u521b\u5efa <code>glance</code> \u7528\u6237",id:"531-\u521b\u5efa-glance-\u7528\u6237",level:4},{value:"5.3.2 \u5c06 <code>admin</code> \u89d2\u8272\u6dfb\u52a0\u5230 <code>glance</code> \u7528\u6237\u548c  <code>service</code> \u9879\u76ee",id:"532-\u5c06-admin-\u89d2\u8272\u6dfb\u52a0\u5230-glance-\u7528\u6237\u548c--service-\u9879\u76ee",level:4},{value:"5.3.3 \u521b\u5efa<code>glance</code>\u670d\u52a1\u5b9e\u4f53",id:"533-\u521b\u5efaglance\u670d\u52a1\u5b9e\u4f53",level:4},{value:"5.3.4 \u521b\u5efaImage\u670d\u52a1API\u7aef\u70b9",id:"534-\u521b\u5efaimage\u670d\u52a1api\u7aef\u70b9",level:4},{value:"5.4 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",id:"54-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",level:3},{value:"5.4.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"541-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"5.4.2 \u7f16\u8f91 <code>/etc/glance/glance-api.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"542-\u7f16\u8f91-etcglanceglance-apiconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"5.4.3 \u7f16\u8f91 <code>/etc/glance/glance-registry.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"543-\u7f16\u8f91-etcglanceglance-registryconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"5.4.4 \u540c\u6b65\u6570\u636e\u5e93",id:"544-\u540c\u6b65\u6570\u636e\u5e93",level:4},{value:"5.4.5 \u542f\u52a8glance\u670d\u52a1\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",id:"545-\u542f\u52a8glance\u670d\u52a1\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",level:4},{value:"5.4.6 \u9a8c\u8bc1\u64cd\u4f5c",id:"546-\u9a8c\u8bc1\u64cd\u4f5c",level:4},{value:"5.4.6.1 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",id:"5461-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",level:5},{value:"5.4.6.2 \u4e0b\u8f7d\u6d4b\u8bd5\u955c\u50cf",id:"5462-\u4e0b\u8f7d\u6d4b\u8bd5\u955c\u50cf",level:5},{value:"5.4.6.3 \u4e0a\u4f20\u955c\u50cf",id:"5463-\u4e0a\u4f20\u955c\u50cf",level:5},{value:"5.4.7 \u786e\u8ba4\u4e0a\u4f20\u56fe\u50cf\u5e76\u9a8c\u8bc1\u5c5e\u6027",id:"547-\u786e\u8ba4\u4e0a\u4f20\u56fe\u50cf\u5e76\u9a8c\u8bc1\u5c5e\u6027",level:5},{value:"6.\u63a7\u5236\u8282\u70b9\u548c\u8ba1\u7b97\u8282\u70b9\u8ba1\u7b97\u670d\u52a1nova\u5b89\u88c5",id:"6\u63a7\u5236\u8282\u70b9\u548c\u8ba1\u7b97\u8282\u70b9\u8ba1\u7b97\u670d\u52a1nova\u5b89\u88c5",level:2},{value:"6.1 \u521b\u5efanova\u3001nova_api\u3001nova_cell0\u3001placement\u6570\u636e\u5e93\u5e76\u6388\u6743",id:"61-\u521b\u5efanovanova_apinova_cell0placement\u6570\u636e\u5e93\u5e76\u6388\u6743",level:3},{value:"6.2 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",id:"62-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",level:3},{value:"6.3 \u521b\u5efa\u8ba1\u7b97\u670d\u52a1\u51ed\u636e",id:"63-\u521b\u5efa\u8ba1\u7b97\u670d\u52a1\u51ed\u636e",level:3},{value:"6.3.1 \u521b\u5efa <code>nova</code> \u7528\u6237",id:"631-\u521b\u5efa-nova-\u7528\u6237",level:4},{value:"6.3.2 \u5c06 <code>admin</code> \u89d2\u8272\u6dfb\u52a0\u5230 <code>nova</code> \u7528\u6237",id:"632-\u5c06-admin-\u89d2\u8272\u6dfb\u52a0\u5230-nova-\u7528\u6237",level:4},{value:"6.3.3 \u521b\u5efa <code>nova</code> \u670d\u52a1\u5b9e\u4f53",id:"633-\u521b\u5efa-nova-\u670d\u52a1\u5b9e\u4f53",level:4},{value:"6.3.4 \u521b\u5efa <code>Compute API</code> \u670d\u52a1\u7aef\u70b9",id:"634-\u521b\u5efa-compute-api-\u670d\u52a1\u7aef\u70b9",level:4},{value:"6.3.5 \u521b\u5efa\u5c55\u793a\u4f4d\u7f6e\u670d\u52a1\u7528\u6237 <code>PLACEMENT</code>",id:"635-\u521b\u5efa\u5c55\u793a\u4f4d\u7f6e\u670d\u52a1\u7528\u6237-placement",level:4},{value:"6.3.6 \u4f7f\u7528\u7ba1\u7406\u5458\u89d2\u8272\u5c06 <code>Placement</code> \u7528\u6237\u6dfb\u52a0\u5230\u670d\u52a1\u9879\u76ee\u4e2d",id:"636-\u4f7f\u7528\u7ba1\u7406\u5458\u89d2\u8272\u5c06-placement-\u7528\u6237\u6dfb\u52a0\u5230\u670d\u52a1\u9879\u76ee\u4e2d",level:4},{value:"6.3.7 \u5728\u670d\u52a1\u76ee\u5f55\u4e2d\u521b\u5efa <code>Placement API</code> \u6761\u76ee",id:"637-\u5728\u670d\u52a1\u76ee\u5f55\u4e2d\u521b\u5efa-placement-api-\u6761\u76ee",level:4},{value:"6.3.8 \u521b\u5efa <code>Placement API</code> \u670d\u52a1\u7aef\u70b9",id:"638-\u521b\u5efa-placement-api-\u670d\u52a1\u7aef\u70b9",level:4},{value:"6.4 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",id:"64-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",level:3},{value:"6.4.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"641-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"6.4.2 \u7f16\u8f91 <code>/etc/nova/nova.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"642-\u7f16\u8f91-etcnovanovaconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"6.4.3 \u7531\u4e8e\u5305\u88c5\u9519\u8bef\uff0c\u60a8\u5fc5\u987b\u901a\u8fc7\u5c06\u4ee5\u4e0b\u914d\u7f6e\u6dfb\u52a0\u5230\u6765\u542f\u7528\u5bf9Placement API\u7684\u8bbf\u95ee <code>/etc/httpd/conf.d/00-nova-placement-api.conf</code>",id:"643-\u7531\u4e8e\u5305\u88c5\u9519\u8bef\u60a8\u5fc5\u987b\u901a\u8fc7\u5c06\u4ee5\u4e0b\u914d\u7f6e\u6dfb\u52a0\u5230\u6765\u542f\u7528\u5bf9placement-api\u7684\u8bbf\u95ee-etchttpdconfd00-nova-placement-apiconf",level:4},{value:"6.4.3.1 \u5907\u4efd\u6587\u4ef6\u5e76\u8ffd\u52a0\u5185\u5bb9",id:"6431-\u5907\u4efd\u6587\u4ef6\u5e76\u8ffd\u52a0\u5185\u5bb9",level:5},{value:"6.4.3.2 \u91cd\u542fhttpd",id:"6432-\u91cd\u542fhttpd",level:4},{value:"6.4.3 \u540c\u6b65\u6570\u636e\u5e93\uff0c\u5ffd\u7565\u8f93\u51fa",id:"643-\u540c\u6b65\u6570\u636e\u5e93\u5ffd\u7565\u8f93\u51fa",level:4},{value:"6.4.3.1 \u540c\u6b65\u6570\u636e\u5e93",id:"6431-\u540c\u6b65\u6570\u636e\u5e93",level:5},{value:"6.4.3.2 \u9a8c\u8bc1 <code>nova cell0</code> \u548c <code>cell1</code> \u662f\u5426\u6b63\u786e\u6ce8\u518c",id:"6432-\u9a8c\u8bc1-nova-cell0-\u548c-cell1-\u662f\u5426\u6b63\u786e\u6ce8\u518c",level:5},{value:"6.4.4 \u542f\u52a8Compute\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",id:"644-\u542f\u52a8compute\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",level:4},{value:"6.5 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",id:"65-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",level:3},{value:"6.5.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"651-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"6.5.2 \u7f16\u8f91<code>/etc/nova/nova.conf</code>\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"652-\u7f16\u8f91etcnovanovaconf\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"6.5.3 \u786e\u5b9a\u60a8\u7684\u8ba1\u7b97\u8282\u70b9\u662f\u5426\u652f\u6301\u865a\u62df\u673a\u7684\u786c\u4ef6\u52a0\u901f",id:"653-\u786e\u5b9a\u60a8\u7684\u8ba1\u7b97\u8282\u70b9\u662f\u5426\u652f\u6301\u865a\u62df\u673a\u7684\u786c\u4ef6\u52a0\u901f",level:4},{value:"6.5.4 \u542f\u52a8Compute\u670d\u52a1\u53ca\u5176\u4f9d\u8d56\u9879\uff0c\u5e76\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u81ea\u52a8\u542f\u52a8",id:"654-\u542f\u52a8compute\u670d\u52a1\u53ca\u5176\u4f9d\u8d56\u9879\u5e76\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u81ea\u52a8\u542f\u52a8",level:4},{value:"6.6 \u9a8c\u8bc1Compute\u670d\u52a1\u7684\u8fd0\u884c",id:"66-\u9a8c\u8bc1compute\u670d\u52a1\u7684\u8fd0\u884c",level:3},{value:"6.6.1 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",id:"661-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",level:4},{value:"6.6.2 \u5217\u51fa\u670d\u52a1\u7ec4\u4ef6\u4ee5\u9a8c\u8bc1\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u6210\u529f\u542f\u52a8\u548c\u6ce8\u518c",id:"662-\u5217\u51fa\u670d\u52a1\u7ec4\u4ef6\u4ee5\u9a8c\u8bc1\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u6210\u529f\u542f\u52a8\u548c\u6ce8\u518c",level:4},{value:"6.6.3 \u53d1\u73b0\u8ba1\u7b97\u4e3b\u673a",id:"663-\u53d1\u73b0\u8ba1\u7b97\u4e3b\u673a",level:4},{value:"7.\u63a7\u5236\u8282\u70b9\u3001\u8ba1\u7b97\u8282\u70b9\u7f51\u7edc\u670d\u52a1neutron\u5b89\u88c5",id:"7\u63a7\u5236\u8282\u70b9\u8ba1\u7b97\u8282\u70b9\u7f51\u7edc\u670d\u52a1neutron\u5b89\u88c5",level:2},{value:"7.1 \u521b\u5efa<code>neutron</code>\u6570\u636e\u5e93\u5e76\u6388\u6743",id:"71-\u521b\u5efaneutron\u6570\u636e\u5e93\u5e76\u6388\u6743",level:3},{value:"7.2 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",id:"72-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",level:3},{value:"7.3 \u521b\u5efa\u670d\u52a1\u51ed\u8bc1",id:"73-\u521b\u5efa\u670d\u52a1\u51ed\u8bc1",level:3},{value:"7.3.1 \u521b\u5efa<code>neutron</code>\u7528\u6237",id:"731-\u521b\u5efaneutron\u7528\u6237",level:4},{value:"7.3.2 \u5c06 <code>admin</code> \u89d2\u8272\u6dfb\u52a0\u5230 <code>neutron</code>\u7528\u6237",id:"732-\u5c06-admin-\u89d2\u8272\u6dfb\u52a0\u5230-neutron\u7528\u6237",level:4},{value:"7.3.3 \u521b\u5efa <code>neutron</code> \u670d\u52a1\u5b9e\u4f53",id:"733-\u521b\u5efa-neutron-\u670d\u52a1\u5b9e\u4f53",level:4},{value:"7.4 \u521b\u5efa\u7f51\u7edc\u670d\u52a1API\u7aef\u70b9",id:"74-\u521b\u5efa\u7f51\u7edc\u670d\u52a1api\u7aef\u70b9",level:3},{value:"7.5 \u914d\u7f6e\u7f51\u7edc\u9009\u9879",id:"75-\u914d\u7f6e\u7f51\u7edc\u9009\u9879",level:3},{value:"7.5.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"751-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"7.5.2 \u7f16\u8f91 <code>/etc/neutron/neutron.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"752-\u7f16\u8f91-etcneutronneutronconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"7.6 \u7f16\u8f91 <code>/etc/neutron/plugins/ml2/ml2_conf.ini</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"76-\u7f16\u8f91-etcneutronpluginsml2ml2_confini-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:3},{value:"7.7 \u914d\u7f6elinux\u6865\u63a5\u4ee3\u7406",id:"77-\u914d\u7f6elinux\u6865\u63a5\u4ee3\u7406",level:3},{value:"7.7.1 \u7f16\u8f91<code>/etc/neutron/plugins/ml2/linuxbridge_agent.ini</code>\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"771-\u7f16\u8f91etcneutronpluginsml2linuxbridge_agentini\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"7.7.2 \u4f7fLinux\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u652f\u6301\u7f51\u6865\u8fc7\u6ee4\u56681",id:"772-\u4f7flinux\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u652f\u6301\u7f51\u6865\u8fc7\u6ee4\u56681",level:4},{value:"7.8 \u914d\u7f6eDHCP\u4ee3\u7406",id:"78-\u914d\u7f6edhcp\u4ee3\u7406",level:3},{value:"7.9 \u914d\u7f6e\u5143\u6570\u636e\u4ee3\u7406",id:"79-\u914d\u7f6e\u5143\u6570\u636e\u4ee3\u7406",level:3},{value:"7.10 \u914d\u7f6e\u8ba1\u7b97\u4ee5\u4f7f\u7528\u7f51\u7edc",id:"710-\u914d\u7f6e\u8ba1\u7b97\u4ee5\u4f7f\u7528\u7f51\u7edc",level:3},{value:"7.11 \u5b8c\u6210\u5b89\u88c5",id:"711-\u5b8c\u6210\u5b89\u88c5",level:3},{value:"7.11.1 \u521b\u5efa\u94fe\u63a5\u6587\u4ef6",id:"7111-\u521b\u5efa\u94fe\u63a5\u6587\u4ef6",level:4},{value:"7.11.2 \u540c\u6b65\u6570\u636e\u5e93\uff0c\u6700\u540e\u63d0\u793aOK\u5373\u4e3a\u6b63\u786e",id:"7112-\u540c\u6b65\u6570\u636e\u5e93\u6700\u540e\u63d0\u793aok\u5373\u4e3a\u6b63\u786e",level:4},{value:"7.11.3 \u91cd\u65b0\u542f\u52a8Compute API\u670d\u52a1",id:"7113-\u91cd\u65b0\u542f\u52a8compute-api\u670d\u52a1",level:4},{value:"7.11.4 \u542f\u52a8\u7f51\u7edc\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",id:"7114-\u542f\u52a8\u7f51\u7edc\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",level:4},{value:"7.11.5 \u9a8c\u8bc1",id:"7115-\u9a8c\u8bc1",level:4},{value:"7.12 \u5b89\u88c5\u5305",id:"712-\u5b89\u88c5\u5305",level:3},{value:"7.13 \u914d\u7f6e\u516c\u5171\u7ec4\u4ef6",id:"713-\u914d\u7f6e\u516c\u5171\u7ec4\u4ef6",level:3},{value:"7.14 \u914d\u7f6e\u7f51\u7edc\u9009\u9879",id:"714-\u914d\u7f6e\u7f51\u7edc\u9009\u9879",level:3},{value:"7.14.1 \u914d\u7f6e\u6865\u63a5\u4ee3\u7406",id:"7141-\u914d\u7f6e\u6865\u63a5\u4ee3\u7406",level:4},{value:"7.14.1.1 \u7f16\u8f91 <code>/etc/neutron/plugins/ml2/linuxbridge_agent.ini</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"71411-\u7f16\u8f91-etcneutronpluginsml2linuxbridge_agentini-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:5},{value:"7.14.1.2 \u4f7fLinux\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u652f\u6301\u7f51\u6865\u8fc7\u6ee4\u56681",id:"71412-\u4f7flinux\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u652f\u6301\u7f51\u6865\u8fc7\u6ee4\u56681",level:5},{value:"7.14.2 \u914d\u7f6e\u8ba1\u7b97\u4ee5\u4f7f\u7528\u7f51\u7edc",id:"7142-\u914d\u7f6e\u8ba1\u7b97\u4ee5\u4f7f\u7528\u7f51\u7edc",level:4},{value:"7.15 \u5b8c\u6210\u5b89\u88c5",id:"715-\u5b8c\u6210\u5b89\u88c5",level:3},{value:"7.15.1 \u91cd\u65b0\u542f\u52a8Compute\u670d\u52a1",id:"7151-\u91cd\u65b0\u542f\u52a8compute\u670d\u52a1",level:4},{value:"7.15.2 \u542f\u52a8Linux\u7f51\u6865\u4ee3\u7406\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",id:"7152-\u542f\u52a8linux\u7f51\u6865\u4ee3\u7406\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",level:4},{value:"7.16 \u9a8c\u8bc1",id:"716-\u9a8c\u8bc1",level:3},{value:"8.\u63a7\u5236\u8282\u70b9horizon web\u754c\u9762Dashboard\u5b89\u88c5",id:"8\u63a7\u5236\u8282\u70b9horizon-web\u754c\u9762dashboard\u5b89\u88c5",level:2},{value:"8.1 \u5b89\u88c5\u5305",id:"81-\u5b89\u88c5\u5305",level:3},{value:"8.2 \u7f16\u8f91 <code>/etc/openstack-dashboard/local_settings</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"82-\u7f16\u8f91-etcopenstack-dashboardlocal_settings-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:3},{value:"8.3 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff0c\u5426\u5219\u540e\u7eed\u8bbf\u95eedashboard\u4f1a\u62a5500\u9519\u8bef",id:"83-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u5426\u5219\u540e\u7eed\u8bbf\u95eedashboard\u4f1a\u62a5500\u9519\u8bef",level:3},{value:"8.3.1 \u7f16\u8f91 <code>/etc/httpd/conf.d/openstack-dashboard.conf</code>",id:"831-\u7f16\u8f91-etchttpdconfdopenstack-dashboardconf",level:4},{value:"8.3.2 \u91cd\u542fhttpd\u548cmemcache",id:"832-\u91cd\u542fhttpd\u548cmemcache",level:4},{value:"8.4 \u767b\u9646dashboard",id:"84-\u767b\u9646dashboard",level:3},{value:"9.\u63a7\u5236\u8282\u70b9\u548c\u5b58\u50a8\u8282\u70b9\u5757\u5b58\u50a8\u670d\u52a1cinder\u5b89\u88c5",id:"9\u63a7\u5236\u8282\u70b9\u548c\u5b58\u50a8\u8282\u70b9\u5757\u5b58\u50a8\u670d\u52a1cinder\u5b89\u88c5",level:2},{value:"9.1 \u521b\u5efacinder\u6570\u636e\u5e93\u5e76\u6388\u6743",id:"91-\u521b\u5efacinder\u6570\u636e\u5e93\u5e76\u6388\u6743",level:3},{value:"9.2 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee",id:"92-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee",level:3},{value:"9.3 \u521b\u5efa\u670d\u52a1\u51ed\u8bc1",id:"93-\u521b\u5efa\u670d\u52a1\u51ed\u8bc1",level:3},{value:"9.3.1 \u521b\u5efa <code>cinder</code>\u7528\u6237",id:"931-\u521b\u5efa-cinder\u7528\u6237",level:4},{value:"9.3.2 \u5c06<code>admin</code>\u89d2\u8272\u6dfb\u52a0\u5230<code>cinder</code>\u7528\u6237",id:"932-\u5c06admin\u89d2\u8272\u6dfb\u52a0\u5230cinder\u7528\u6237",level:4},{value:"9.3.3 \u521b\u5efa <code>cinderv2</code> \u548c <code>cinderv3</code> \u670d\u52a1\u5b9e\u4f53",id:"933-\u521b\u5efa-cinderv2-\u548c-cinderv3-\u670d\u52a1\u5b9e\u4f53",level:4},{value:"9.4 \u521b\u5efa\u5757\u5b58\u50a8\u670d\u52a1API\u7aef\u70b9",id:"94-\u521b\u5efa\u5757\u5b58\u50a8\u670d\u52a1api\u7aef\u70b9",level:3},{value:"9.5 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",id:"95-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",level:3},{value:"9.5.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"951-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"9.5.2 \u7f16\u8f91 <code>/etc/cinder/cinder.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"952-\u7f16\u8f91-etccindercinderconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"9.5.3 \u540c\u6b65\u6570\u636e\u5e93",id:"953-\u540c\u6b65\u6570\u636e\u5e93",level:4},{value:"9.6 \u914d\u7f6e\u8ba1\u7b97\u5df2\u4f7f\u7528\u5757\u5b58\u50a8",id:"96-\u914d\u7f6e\u8ba1\u7b97\u5df2\u4f7f\u7528\u5757\u5b58\u50a8",level:3},{value:"9.7 \u5b8c\u6210\u5b89\u88c5",id:"97-\u5b8c\u6210\u5b89\u88c5",level:3},{value:"9.7.1 \u91cd\u542fCompute API\u670d\u52a1",id:"971-\u91cd\u542fcompute-api\u670d\u52a1",level:4},{value:"9.7.2 \u542f\u52a8\u5757\u5b58\u50a8\u670d\u52a1\uff0c\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",id:"972-\u542f\u52a8\u5757\u5b58\u50a8\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",level:4},{value:"9.8 \u9a8c\u8bc1",id:"98-\u9a8c\u8bc1",level:3},{value:"9.9 \u524d\u63d0\u6761\u4ef6",id:"99-\u524d\u63d0\u6761\u4ef6",level:3},{value:"9.9.1 \u5b89\u88c5\u5305",id:"991-\u5b89\u88c5\u5305",level:4},{value:"9.9.2 \u542f\u52a8LVM\u5143\u6570\u636e\u670d\u52a1\uff0c\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",id:"992-\u542f\u52a8lvm\u5143\u6570\u636e\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",level:4},{value:"9.9.3 \u521b\u5efaLVM\u7269\u7406\u5377 <code>/dev/vdb</code>",id:"993-\u521b\u5efalvm\u7269\u7406\u5377-devvdb",level:4},{value:"9.9.4 \u521b\u5efaLVM\u5377\u7ec4<code>cinder-volumes</code>",id:"994-\u521b\u5efalvm\u5377\u7ec4cinder-volumes",level:4},{value:"9.9.5 \u5173\u4e8elvm\u7684\u95ee\u9898",id:"995-\u5173\u4e8elvm\u7684\u95ee\u9898",level:4},{value:"9.10 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",id:"910-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",level:3},{value:"9.10.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"9101-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"9.10.2 \u7f16\u8f91 <code>/etc/cinder/cinder.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"9102-\u7f16\u8f91-etccindercinderconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"9.10.3 \u542f\u52a8\u5757\u5b58\u50a8\u5377\u670d\u52a1\u53ca\u5176\u76f8\u5173\u6027\uff0c\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",id:"9103-\u542f\u52a8\u5757\u5b58\u50a8\u5377\u670d\u52a1\u53ca\u5176\u76f8\u5173\u6027\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",level:4},{value:"10.\u63a7\u5236\u8282\u70b9\u548c\u5bf9\u8c61\u8282\u70b9\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1swift\u5b89\u88c5",id:"10\u63a7\u5236\u8282\u70b9\u548c\u5bf9\u8c61\u8282\u70b9\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1swift\u5b89\u88c5",level:2},{value:"10.1 \u521b\u5efa\u8eab\u4efd\u670d\u52a1\u51ed\u636e",id:"101-\u521b\u5efa\u8eab\u4efd\u670d\u52a1\u51ed\u636e",level:3},{value:"10.1.1 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee",id:"1011-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee",level:4},{value:"10.1.2 \u521b\u5efa <code>swift</code> \u7528\u6237",id:"1012-\u521b\u5efa-swift-\u7528\u6237",level:4},{value:"10.1.3 \u5c06 <code>admin</code> \u89d2\u8272\u6dfb\u52a0\u5230 <code>swift</code> \u7528\u6237",id:"1013-\u5c06-admin-\u89d2\u8272\u6dfb\u52a0\u5230-swift-\u7528\u6237",level:4},{value:"10.1.4 \u521b\u5efa <code>swift</code> \u670d\u52a1\u5b9e\u4f53",id:"1014-\u521b\u5efa-swift-\u670d\u52a1\u5b9e\u4f53",level:4},{value:"10.2 \u521b\u5efa\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1API\u7aef\u70b9",id:"102-\u521b\u5efa\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1api\u7aef\u70b9",level:3},{value:"10.3 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",id:"103-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",level:3},{value:"10.3.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"1031-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"10.3.2 \u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u83b7\u53d6\u4ee3\u7406\u670d\u52a1\u914d\u7f6e\u6587\u4ef6",id:"1032-\u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u83b7\u53d6\u4ee3\u7406\u670d\u52a1\u914d\u7f6e\u6587\u4ef6",level:4},{value:"10.3.3 \u7f16\u8f91 <code>/etc/swift/proxy-server.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"1033-\u7f16\u8f91-etcswiftproxy-serverconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"10.4 \u524d\u63d0\u6761\u4ef6",id:"104-\u524d\u63d0\u6761\u4ef6",level:3},{value:"10.4.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"1041-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"10.4.2 \u5c06<code>/dev/sdb</code>\u548c<code>/dev/sdc</code>\u8bbe\u5907\u683c\u5f0f\u5316\u4e3aXFS",id:"1042-\u5c06devsdb\u548cdevsdc\u8bbe\u5907\u683c\u5f0f\u5316\u4e3axfs",level:4},{value:"10.4.3 \u521b\u5efa\u5b89\u88c5\u70b9\u76ee\u5f55\u7ed3\u6784",id:"1043-\u521b\u5efa\u5b89\u88c5\u70b9\u76ee\u5f55\u7ed3\u6784",level:4},{value:"10.4.4 \u7f16\u8f91 <code>/etc/fstab</code> \u6587\u4ef6\u5e76\u5411\u5176\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9",id:"1044-\u7f16\u8f91-etcfstab-\u6587\u4ef6\u5e76\u5411\u5176\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9",level:4},{value:"10.4.5 \u6302\u8f7d\u76ee\u5f55",id:"1045-\u6302\u8f7d\u76ee\u5f55",level:4},{value:"10.4.6 \u521b\u5efa\u6216\u7f16\u8f91 <code>/etc/rsyncd.conf</code> \u6587\u4ef6\u4ee5\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9",id:"1046-\u521b\u5efa\u6216\u7f16\u8f91-etcrsyncdconf-\u6587\u4ef6\u4ee5\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9",level:4},{value:"10.5 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",id:"105-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",level:3},{value:"10.5.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"1051-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:4},{value:"10.5.2 \u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u4e2d\u83b7\u53d6\u8ba1\u8d39\uff0c\u5bb9\u5668\u548c\u5bf9\u8c61\u670d\u52a1\u914d\u7f6e\u6587\u4ef6",id:"1052-\u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u4e2d\u83b7\u53d6\u8ba1\u8d39\u5bb9\u5668\u548c\u5bf9\u8c61\u670d\u52a1\u914d\u7f6e\u6587\u4ef6",level:4},{value:"10.5.3 \u7f16\u8f91 <code>/etc/swift/account-server.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"1053-\u7f16\u8f91-etcswiftaccount-serverconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"10.5.4 \u7f16\u8f91 <code>/etc/swift/container-server.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"1054-\u7f16\u8f91-etcswiftcontainer-serverconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"10.5.5 \u7f16\u8f91<code>/etc/swift/object-server.conf</code>\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"1055-\u7f16\u8f91etcswiftobject-serverconf\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"10.5.6 \u786e\u4fdd\u5bf9\u5b89\u88c5\u70b9\u76ee\u5f55\u7ed3\u6784\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743",id:"1056-\u786e\u4fdd\u5bf9\u5b89\u88c5\u70b9\u76ee\u5f55\u7ed3\u6784\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743",level:4},{value:"10.5.7 \u521b\u5efa <code>recon</code> \u76ee\u5f55\u5e76\u786e\u4fdd\u5bf9\u5176\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743",id:"1057-\u521b\u5efa-recon-\u76ee\u5f55\u5e76\u786e\u4fdd\u5bf9\u5176\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743",level:4},{value:"10.6 \u521b\u5efa\u548c\u5206\u53d1\u521d\u59cb\u73af",id:"106-\u521b\u5efa\u548c\u5206\u53d1\u521d\u59cb\u73af",level:3},{value:"10.7 \u521b\u5efa\u5e10\u6237\u73af",id:"107-\u521b\u5efa\u5e10\u6237\u73af",level:3},{value:"10.7.1 \u8981\u5207\u6362\u5230<code>/etc/swift</code>\u76ee\u5f55",id:"1071-\u8981\u5207\u6362\u5230etcswift\u76ee\u5f55",level:4},{value:"10.7.2 \u521b\u5efa\u57fa\u7840<code>account.builder</code>\u6587\u4ef6",id:"1072-\u521b\u5efa\u57fa\u7840accountbuilder\u6587\u4ef6",level:4},{value:"10.7.3 \u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af",id:"1073-\u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af",level:4},{value:"10.7.4 \u9a8c\u8bc1",id:"1074-\u9a8c\u8bc1",level:4},{value:"10.7.5 \u91cd\u65b0\u5e73\u8861\u6743\u91cd",id:"1075-\u91cd\u65b0\u5e73\u8861\u6743\u91cd",level:4},{value:"10.8 \u521b\u5efa\u5bb9\u5668\u73af",id:"108-\u521b\u5efa\u5bb9\u5668\u73af",level:3},{value:"10.8.1 \u8f6c\u5230 <code>/etc/swift</code> \u76ee\u5f55",id:"1081-\u8f6c\u5230-etcswift-\u76ee\u5f55",level:4},{value:"10.8.2 \u521b\u5efa\u57fa\u7840<code>container.builder</code>\u6587\u4ef6",id:"1082-\u521b\u5efa\u57fa\u7840containerbuilder\u6587\u4ef6",level:4},{value:"10.8.3 \u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af",id:"1083-\u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af",level:4},{value:"10.8.4 \u9a8c\u8bc1",id:"1084-\u9a8c\u8bc1",level:4},{value:"10.8.5 \u91cd\u65b0\u5e73\u8861\u6743\u91cd",id:"1085-\u91cd\u65b0\u5e73\u8861\u6743\u91cd",level:4},{value:"10.9 \u521b\u5efa\u5bf9\u8c61\u73af",id:"109-\u521b\u5efa\u5bf9\u8c61\u73af",level:3},{value:"10.9.1 \u8f6c\u5230 <code>/etc/swift</code> \u76ee\u5f55",id:"1091-\u8f6c\u5230-etcswift-\u76ee\u5f55",level:4},{value:"10.9.2 \u521b\u5efa\u57fa\u7840 <code>object.builder</code> \u6587\u4ef6",id:"1092-\u521b\u5efa\u57fa\u7840-objectbuilder-\u6587\u4ef6",level:4},{value:"10.9.3 \u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af",id:"1093-\u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af",level:4},{value:"10.9.4 \u9a8c\u8bc1",id:"1094-\u9a8c\u8bc1",level:4},{value:"10.9.5 \u91cd\u65b0\u5e73\u8861\u6743\u91cd",id:"1095-\u91cd\u65b0\u5e73\u8861\u6743\u91cd",level:4},{value:"10.10 \u5206\u53d1\u73af\u7f51\u914d\u7f6e\u6587\u4ef6",id:"1010-\u5206\u53d1\u73af\u7f51\u914d\u7f6e\u6587\u4ef6",level:3},{value:"10.11 \u5b8c\u6210\u5b89\u88c5",id:"1011-\u5b8c\u6210\u5b89\u88c5",level:3},{value:"10.11.1 <code>/etc/swift/swift.conf</code>\u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u4e2d\u83b7\u53d6\u6587\u4ef6",id:"10111-etcswiftswiftconf\u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u4e2d\u83b7\u53d6\u6587\u4ef6",level:4},{value:"10.11.2 \u7f16\u8f91 <code>/etc/swift/swift.conf</code> \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"10112-\u7f16\u8f91-etcswiftswiftconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:4},{value:"10.11.3 \u5c06 <code>swift.conf</code> \u6587\u4ef6\u590d\u5236\u5230 <code>/etc/swift</code> \u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u4ee5\u53ca\u8fd0\u884c\u4ee3\u7406\u670d\u52a1\u7684\u6240\u6709\u5176\u4ed6\u8282\u70b9\u4e0a\u7684\u76ee\u5f55\u4e2d",id:"10113-\u5c06-swiftconf-\u6587\u4ef6\u590d\u5236\u5230-etcswift-\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u4ee5\u53ca\u8fd0\u884c\u4ee3\u7406\u670d\u52a1\u7684\u6240\u6709\u5176\u4ed6\u8282\u70b9\u4e0a\u7684\u76ee\u5f55\u4e2d",level:4},{value:"10.11.4 \u5728\u6240\u6709\u8282\u70b9\u4e0a\uff0c\u786e\u4fdd\u5bf9\u914d\u7f6e\u76ee\u5f55\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743",id:"10114-\u5728\u6240\u6709\u8282\u70b9\u4e0a\u786e\u4fdd\u5bf9\u914d\u7f6e\u76ee\u5f55\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743",level:4},{value:"10.11.5 \u5728\u63a7\u5236\u5668\u8282\u70b9\u548c\u8fd0\u884c\u4ee3\u7406\u670d\u52a1\u7684\u4efb\u4f55\u5176\u4ed6\u8282\u70b9\u4e0a\uff0c\u542f\u52a8\u5bf9\u8c61\u5b58\u50a8\u4ee3\u7406\u670d\u52a1\u53ca\u5176\u76f8\u5173\u6027\uff0c\u5e76\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",id:"10115-\u5728\u63a7\u5236\u5668\u8282\u70b9\u548c\u8fd0\u884c\u4ee3\u7406\u670d\u52a1\u7684\u4efb\u4f55\u5176\u4ed6\u8282\u70b9\u4e0a\u542f\u52a8\u5bf9\u8c61\u5b58\u50a8\u4ee3\u7406\u670d\u52a1\u53ca\u5176\u76f8\u5173\u6027\u5e76\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",level:4},{value:"10.11.6 \u5728\u5b58\u50a8\u8282\u70b9\u4e0a\uff0c\u542f\u52a8\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",id:"10116-\u5728\u5b58\u50a8\u8282\u70b9\u4e0a\u542f\u52a8\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",level:4},{value:"10.12 \u9a8c\u8bc1\u64cd\u4f5c",id:"1012-\u9a8c\u8bc1\u64cd\u4f5c",level:3},{value:"10.12.1 \u83b7\u53d6demo\u51ed\u8bc1",id:"10121-\u83b7\u53d6demo\u51ed\u8bc1",level:3},{value:"10.12.2 \u663e\u793a\u670d\u52a1\u72b6\u6001",id:"10122-\u663e\u793a\u670d\u52a1\u72b6\u6001",level:4},{value:"10.12.3 \u521b\u5efa<code>container1</code>\u5bb9\u5668",id:"10123-\u521b\u5efacontainer1\u5bb9\u5668",level:4},{value:"10.12.4 \u5c06\u6d4b\u8bd5\u6587\u4ef6\u4e0a\u4f20\u5230<code>container1</code>\u5bb9\u5668",id:"10124-\u5c06\u6d4b\u8bd5\u6587\u4ef6\u4e0a\u4f20\u5230container1\u5bb9\u5668",level:4},{value:"10.12.5 \u5217\u51fa<code>container1</code>\u5bb9\u5668\u4e2d\u7684\u6587\u4ef6",id:"10125-\u5217\u51facontainer1\u5bb9\u5668\u4e2d\u7684\u6587\u4ef6",level:4},{value:"10.12.6 \u4ece<code>container1</code>\u5bb9\u5668\u4e0b\u8f7d\u6d4b\u8bd5\u6587\u4ef6",id:"10126-\u4ececontainer1\u5bb9\u5668\u4e0b\u8f7d\u6d4b\u8bd5\u6587\u4ef6",level:4},{value:"11.\u5b89\u88c5\u548c\u914d\u7f6e\u5907\u4efd\u670d\u52a1(\u53ef\u9009)",id:"11\u5b89\u88c5\u548c\u914d\u7f6e\u5907\u4efd\u670d\u52a1\u53ef\u9009",level:2},{value:"11.1 \u5b89\u88c5\u8f6f\u4ef6\u5305",id:"111-\u5b89\u88c5\u8f6f\u4ef6\u5305",level:3},{value:"11.2 \u7f16\u8f91<code>/etc/cinder/cinder.conf</code>\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",id:"112-\u7f16\u8f91etccindercinderconf\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",level:3},{value:"11.3 \u542f\u52a8\u5757\u5b58\u50a8\u5907\u4efd\u670d\u52a1\uff0c\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",id:"113-\u542f\u52a8\u5757\u5b58\u50a8\u5907\u4efd\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",level:3}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.p,{children:"[toc]"}),"\n",(0,c.jsx)(n.h1,{id:"centos7\u642d\u5efaopenstack-rocky\u7248",children:"centos7\u642d\u5efaopenstack Rocky\u7248"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/install-guide/",children:"\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"rocky\u7248\u4e2d\u7684\u5bc6\u7801\u8bf4\u660e"})}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u6570\u636e\u5e93\u5bc6\u7801\uff08\u672a\u4f7f\u7528\u53d8\u91cf\uff09"}),(0,c.jsx)(n.th,{children:"\u6570\u636e\u5e93\u7684\u6839\u5bc6\u7801"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"ADMIN_PASS"})}),(0,c.jsxs)(n.td,{children:["\u7528\u6237\u5bc6\u7801 ",(0,c.jsx)(n.code,{children:"admin"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"CINDER_DBPASS"})}),(0,c.jsx)(n.td,{children:"\u5757\u5b58\u50a8\u670d\u52a1\u7684\u6570\u636e\u5e93\u5bc6\u7801"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"CINDER_PASS"})}),(0,c.jsxs)(n.td,{children:["\u5757\u5b58\u50a8\u670d\u52a1\u7528\u6237\u5bc6\u7801 ",(0,c.jsx)(n.code,{children:"cinder"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"DASH_DBPASS"})}),(0,c.jsx)(n.td,{children:"\u4eea\u8868\u677f\u7684\u6570\u636e\u5e93\u5bc6\u7801"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"DEMO_PASS"})}),(0,c.jsxs)(n.td,{children:["\u7528\u6237\u5bc6\u7801 ",(0,c.jsx)(n.code,{children:"demo"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"GLANCE_DBPASS"})}),(0,c.jsx)(n.td,{children:"\u955c\u50cf\u670d\u52a1\u7684\u6570\u636e\u5e93\u5bc6\u7801"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"GLANCE_PASS"})}),(0,c.jsxs)(n.td,{children:["\u56fe\u7247\u670d\u52a1\u7528\u6237\u5bc6\u7801 ",(0,c.jsx)(n.code,{children:"glance"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"KEYSTONE_DBPASS"})}),(0,c.jsx)(n.td,{children:"\u8eab\u4efd\u670d\u52a1\u7684\u6570\u636e\u5e93\u5bc6\u7801"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"METADATA_SECRET"})}),(0,c.jsx)(n.td,{children:"\u5143\u6570\u636e\u4ee3\u7406\u7684\u79d8\u5bc6"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"NEUTRON_DBPASS"})}),(0,c.jsx)(n.td,{children:"\u7f51\u7edc\u670d\u52a1\u7684\u6570\u636e\u5e93\u5bc6\u7801"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"NEUTRON_PASS"})}),(0,c.jsxs)(n.td,{children:["\u7f51\u7edc\u670d\u52a1\u7528\u6237\u5bc6\u7801 ",(0,c.jsx)(n.code,{children:"neutron"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"NOVA_DBPASS"})}),(0,c.jsx)(n.td,{children:"\u8ba1\u7b97\u670d\u52a1\u7684\u6570\u636e\u5e93\u5bc6\u7801"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"NOVA_PASS"})}),(0,c.jsxs)(n.td,{children:["\u8ba1\u7b97\u670d\u52a1\u7528\u6237\u5bc6\u7801 ",(0,c.jsx)(n.code,{children:"nova"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"PLACEMENT_PASS"})}),(0,c.jsxs)(n.td,{children:["\u5c55\u793a\u4f4d\u7f6e\u670d\u52a1\u7528\u6237\u7684\u5bc6\u7801 ",(0,c.jsx)(n.code,{children:"placement"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"RABBIT_PASS"})}),(0,c.jsxs)(n.td,{children:["RabbitMQ\u7528\u6237\u5bc6\u7801 ",(0,c.jsx)(n.code,{children:"openstack"})]})]})]})]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5b9e\u9a8c\u73af\u5883"})}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u89d2\u8272"}),(0,c.jsx)(n.th,{children:"IP"}),(0,c.jsx)(n.th,{children:"\u4e3b\u673a\u540d"}),(0,c.jsx)(n.th,{children:"\u9ed8\u8ba4\u7f51\u5173"}),(0,c.jsx)(n.th,{children:"\u786c\u4ef6\u73af\u5883"}),(0,c.jsx)(n.th,{children:"\u865a\u62df\u5316"}),(0,c.jsx)(n.th,{children:"\u9632\u706b\u5899\u3001selinux"}),(0,c.jsx)(n.th,{children:"\u64cd\u4f5c\u7cfb\u7edf"}),(0,c.jsx)(n.th,{children:"\u5185\u6838\u7248\u672c"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"\u63a7\u5236\u8282\u70b9"}),(0,c.jsx)(n.td,{children:"172.30.100.4/16"}),(0,c.jsx)(n.td,{children:"openstack-controller"}),(0,c.jsx)(n.td,{children:"172.30.255.253"}),(0,c.jsx)(n.td,{children:"4c16g\uff0c40g+100g"}),(0,c.jsx)(n.td,{children:"\u5f00\u542f"}),(0,c.jsx)(n.td,{children:"\u5173\u95ed"}),(0,c.jsx)(n.td,{children:"CentOS7.6"}),(0,c.jsx)(n.td,{children:"3.10.0-957.21.3.el7.x86_64"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"\u8ba1\u7b97\u8282\u70b91"}),(0,c.jsx)(n.td,{children:"172.30.100.5/16"}),(0,c.jsx)(n.td,{children:"openstack-compute01"}),(0,c.jsx)(n.td,{children:"172.30.255.253"}),(0,c.jsx)(n.td,{children:"4c16g\uff0c40g+100g"}),(0,c.jsx)(n.td,{children:"\u5f00\u542f"}),(0,c.jsx)(n.td,{children:"\u5173\u95ed"}),(0,c.jsx)(n.td,{children:"CentOS7.6"}),(0,c.jsx)(n.td,{children:"3.10.0-957.21.3.el7.x86_64"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"\u5b58\u50a8\u8282\u70b91"}),(0,c.jsx)(n.td,{children:"172.30.100.6/16"}),(0,c.jsx)(n.td,{children:"openstack-block01"}),(0,c.jsx)(n.td,{children:"172.30.255.253"}),(0,c.jsx)(n.td,{children:"4c16g\uff0c40g+100g"}),(0,c.jsx)(n.td,{children:"\u5f00\u542f"}),(0,c.jsx)(n.td,{children:"\u5173\u95ed"}),(0,c.jsx)(n.td,{children:"CentOS7.6"}),(0,c.jsx)(n.td,{children:"3.10.0-957.21.3.el7.x86_64"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"\u5bf9\u8c61\u8282\u70b91"}),(0,c.jsx)(n.td,{children:"172.30.100.7/16"}),(0,c.jsx)(n.td,{children:"openstack-object01"}),(0,c.jsx)(n.td,{children:"172.30.255.253"}),(0,c.jsx)(n.td,{children:"4c16g\uff0c40g+50g+50g"}),(0,c.jsx)(n.td,{children:"\u5f00\u542f"}),(0,c.jsx)(n.td,{children:"\u5173\u95ed"}),(0,c.jsx)(n.td,{children:"CentOS7.6"}),(0,c.jsx)(n.td,{children:"3.10.0-957.21.3.el7.x86_64"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"\u5bf9\u8c61\u8282\u70b92"}),(0,c.jsx)(n.td,{children:"172.30.100.8/16"}),(0,c.jsx)(n.td,{children:"openstack-object02"}),(0,c.jsx)(n.td,{children:"172.30.255.253"}),(0,c.jsx)(n.td,{children:"4c16g\uff0c40g+50g+50g"}),(0,c.jsx)(n.td,{children:"\u5f00\u542f"}),(0,c.jsx)(n.td,{children:"\u5173\u95ed"}),(0,c.jsx)(n.td,{children:"CentOS7.6"}),(0,c.jsx)(n.td,{children:"3.10.0-957.21.3.el7.x86_64"})]})]})]}),"\n",(0,c.jsx)(n.h2,{id:"1\u628arocky\u7248rpm\u5305\u505a\u6210\u672c\u5730yum\u6e90",children:"1.\u628arocky\u7248rpm\u5305\u505a\u6210\u672c\u5730yum\u6e90"}),"\n",(0,c.jsxs)(n.p,{children:["rocky\u7248\u79bb\u7ebf\u5305\u5df2\u4e0a\u4f20\u81f3 ",(0,c.jsx)(n.a,{href:"https://pan.baidu.com/s/1q3d2iImmWOWE1tXjc3g8sQ",children:"\u767e\u5ea6\u7f51\u76d8 \u63d0\u53d6\u7801: 4gam"})]}),"\n",(0,c.jsx)(n.admonition,{type:"tip",children:(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u7531\u4e8erocky\u5b98\u65b9yum\u6e90\u53d1\u751f\u53d8\u66f4\uff0c\u5728centos7\u4e0a\u4f7f\u7528\u5b98\u65b9yum\u6e90\u5b89\u88c5\u4f1a\u6709\u90e8\u5206\u5305\u65e0\u6cd5\u5b89\u88c5\uff0c\u56e0\u6b64\u91c7\u7528\u79bb\u7ebf\u5305\u5236\u4f5c\u672c\u5730yum\u6e90\u65b9\u5f0f\u5b89\u88c5"})})}),"\n",(0,c.jsxs)(n.h3,{id:"11-\u5b89\u88c5-createrepo-\u547d\u4ee4",children:["1.1 \u5b89\u88c5 ",(0,c.jsx)(n.code,{children:"createrepo"})," \u547d\u4ee4"]}),"\n",(0,c.jsx)(n.p,{children:"\u63a7\u5236\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"yum -y install createrepo \n"})}),"\n",(0,c.jsx)(n.h3,{id:"12-\u5236\u4f5c\u4ed3\u5e93",children:"1.2 \u5236\u4f5c\u4ed3\u5e93"}),"\n",(0,c.jsx)(n.p,{children:"\u63a7\u5236\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"createrepo openstack-rocky\n"})}),"\n",(0,c.jsx)(n.h3,{id:"13-\u5b89\u88c5nginx",children:"1.3 \u5b89\u88c5nginx"}),"\n",(0,c.jsx)(n.p,{children:"\u63a7\u5236\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"yum -y install nginx\nsystemctl enable nginx && systemctl start nginx\n"})}),"\n",(0,c.jsx)(n.h3,{id:"14-\u914d\u7f6enginx",children:"1.4 \u914d\u7f6enginx"}),"\n",(0,c.jsx)(n.p,{children:"\u63a7\u5236\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-nginx",children:"# \u7f16\u8f91nginx\u914d\u7f6e\u6587\u4ef6\uff0cyum\u5b89\u88c5\u7684nginx\u6839\u76ee\u5f55\u662f/usr/share/nginx/html\uff0c\u8fd9\u91cc\u4e2a\u4eba\u4e60\u60ef\u9009\u62e9\u542f\u7528\u4e00\u4e2a\u865a\u62df\u4e3b\u673a\uff0c\u76d1\u542c88\u7aef\u53e3\ncat > /etc/nginx/conf.d/openstack-rocky.repo.conf <<EOF\nserver {\n    listen 88;\n    root /opt;\n    location /openstack-rocky {\n        autoindex on;\n        autoindex_exact_size off;\n        autoindex_localtime on;\n    }\n}\nEOF\n"})}),"\n",(0,c.jsx)(n.h3,{id:"15-\u7f16\u8f91\u672c\u5730yum\u4ed3\u5e93\u6587\u4ef6",children:"1.5 \u7f16\u8f91\u672c\u5730yum\u4ed3\u5e93\u6587\u4ef6"}),"\n",(0,c.jsx)(n.p,{children:"\u6240\u6709\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"# \u6307\u5b9arepo\u6587\u4ef6\uff0c\u628a\u63d0\u524d\u51c6\u5907\u597d\u7684\u79bb\u7ebf\u5305\u4e0a\u4f20\u5230/opt\u4e0b\uff0c\u76ee\u5f55\u540d\u79f0\u4e3aopenstack-rocky\ncat >/etc/yum.repos.d/openstack-rocky.repo <<EOF\n[openstack]\nname=openstack\nbaseurl=http://172.30.100.4:88/openstack-rocky\nenabled=1\ngpgcheck=0\nEOF\n"})}),"\n",(0,c.jsx)(n.h3,{id:"16-\u751f\u6210\u672c\u5730\u7f13\u5b58",children:"1.6 \u751f\u6210\u672c\u5730\u7f13\u5b58"}),"\n",(0,c.jsx)(n.p,{children:"\u6240\u6709\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"yum makecache\n"})}),"\n",(0,c.jsx)(n.h2,{id:"2\u57fa\u7840\u73af\u5883\u914d\u7f6e",children:"2.\u57fa\u7840\u73af\u5883\u914d\u7f6e"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/install-guide/",children:"\u57fa\u7840\u73af\u5883\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.h3,{id:"21-\u5173\u95ed\u9632\u706b\u5899\u548cselinux",children:"2.1 \u5173\u95ed\u9632\u706b\u5899\u548cselinux"}),"\n",(0,c.jsx)(n.p,{children:"\u6240\u6709\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"# \u5173\u95ed\u9632\u706b\u5899\nsystemctl stop firewalld && systemctl disable firewalld\n\n# \u7981\u7528selinux\n// \u4e34\u65f6\u4fee\u6539\nsetenforce 0\n\n// \u6c38\u4e45\u4fee\u6539\uff0c\u91cd\u542f\u670d\u52a1\u5668\u540e\u751f\u6548\nsed -i '7s/enforcing/disabled/' /etc/selinux/config\n"})}),"\n",(0,c.jsx)(n.h3,{id:"22-\u914d\u7f6ehosts\u89e3\u6790",children:"2.2 \u914d\u7f6ehosts\u89e3\u6790"}),"\n",(0,c.jsx)(n.p,{children:"\u6240\u6709\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"cat >> /etc/hosts << EOF\n172.30.100.4 openstack-controller\n172.30.100.5 openstack-compute01\n172.30.100.6 openstack-block01\n172.30.100.7 openstack-object01\n172.30.100.8 openstack-object02\nEOF\n"})}),"\n",(0,c.jsx)(n.h3,{id:"23-\u914d\u7f6echrony\u670d\u52a1\u8981\u4fdd\u8bc1\u6240\u6709\u8282\u70b9\u65f6\u95f4\u4e00\u81f4",children:"2.3 \u914d\u7f6echrony\u670d\u52a1\uff0c\u8981\u4fdd\u8bc1\u6240\u6709\u8282\u70b9\u65f6\u95f4\u4e00\u81f4"}),"\n",(0,c.jsx)(n.h4,{id:"231-\u5b89\u88c5chrony",children:"2.3.1 \u5b89\u88c5chrony"}),"\n",(0,c.jsx)(n.p,{children:"\u6240\u6709\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"yum -y install chrony\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"232-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6-etcchronyconf",children:["2.3.2 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 ",(0,c.jsx)(n.code,{children:"/etc/chrony.conf"})]}),"\n",(0,c.jsx)(n.p,{children:"\u63a7\u5236\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"sed -i.bak '3,6d' /etc/chrony.conf && \\\nsed -i '3cserver ntp1.aliyun.com iburst' /etc/chrony.conf && \\\nsed -i '23callow 172.30.0.0/16' /etc/chrony.conf\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u8ba1\u7b97\u3001\u5b58\u50a8\u3001\u5bf9\u8c61\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"sed -i '3,6d' /etc/chrony.conf && \\\nsed -i '3cserver openstack-controller iburst' /etc/chrony.conf  \n"})}),"\n",(0,c.jsx)(n.h4,{id:"233-\u542f\u52a8\u670d\u52a1\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f",children:"2.3.3 \u542f\u52a8\u670d\u52a1\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f"}),"\n",(0,c.jsx)(n.p,{children:"\u6240\u6709\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"systemctl enable chronyd && systemctl start chronyd\n"})}),"\n",(0,c.jsx)(n.h4,{id:"234-\u9a8c\u8bc1",children:"2.3.4 \u9a8c\u8bc1"}),"\n",(0,c.jsx)(n.p,{children:"\u63a7\u5236\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ chronyc sources\n210 Number of sources = 1\nMS Name/IP address         Stratum Poll Reach LastRx Last sample               \n===============================================================================\n^* 120.25.115.20                 2   6    37    29    +43us[ -830us] +/-   22ms\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u8ba1\u7b97\u3001\u5b58\u50a8\u3001\u5bf9\u8c61\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:"$ chronyc sources\n210 Number of sources = 1\nMS Name/IP address         Stratum Poll Reach LastRx Last sample               \n===============================================================================\n^? openstack-controller                    3   6   200    50  +1319ms[+1319ms] +/-  14.4s\n"})}),"\n",(0,c.jsx)(n.h3,{id:"24-\u4e0b\u8f7dopenstack\u5b98\u65b9yum\u6e90\u5b89\u88c5openstack\u5ba2\u6237\u7aef",children:"2.4 \u4e0b\u8f7dopenstack\u5b98\u65b9yum\u6e90\u5b89\u88c5openstack\u5ba2\u6237\u7aef"}),"\n",(0,c.jsx)(n.p,{children:"\u6240\u6709\u8282\u70b9\u64cd\u4f5c"}),"\n",(0,c.jsxs)(n.p,{children:["\u672c\u6587\u4f7f\u7528\u672c\u5730\u6e90\u5b89\u88c5\uff0c\u4e0d\u9700\u8981\u5b89\u88c5 ",(0,c.jsx)(n.code,{children:"centos-release-openstack-rocky"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"# yum -y install centos-release-openstack-rocky\nyum -y install python-openstackclient\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5230\u6b64\uff0c\u6240\u6709\u8282\u70b9\u57fa\u7840\u73af\u5883\u914d\u7f6e\u5b8c\u6210\uff01\uff01\uff01"})}),"\n",(0,c.jsx)(n.h2,{id:"3\u63a7\u5236\u8282\u70b9\u57fa\u7840\u73af\u5883\u5b89\u88c5",children:"3.\u63a7\u5236\u8282\u70b9\u57fa\u7840\u73af\u5883\u5b89\u88c5"}),"\n",(0,c.jsx)(n.h3,{id:"31-\u5b89\u88c5\u914d\u7f6emariadb\u6570\u636e\u5e93",children:"3.1 \u5b89\u88c5\u914d\u7f6emariadb\u6570\u636e\u5e93"}),"\n",(0,c.jsx)(n.h4,{id:"311-\u5b89\u88c5\u5305",children:"3.1.1 \u5b89\u88c5\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install mariadb mariadb-server python2-PyMySQL\n"})}),"\n",(0,c.jsx)(n.h4,{id:"312-\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6",children:"3.1.2 \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"cat > /etc/my.cnf.d/openstack.cnf <<EOF\n[mysqld]\nbind-address = 172.30.100.4\n\ndefault-storage-engine = innodb\ninnodb_file_per_table = on\nmax_connections = 4096\ncollation-server = utf8_general_ci\ncharacter-set-server = utf8\nEOF\n"})}),"\n",(0,c.jsx)(n.h4,{id:"313-\u542f\u52a8mariadb\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f",children:"3.1.3 \u542f\u52a8mariadb\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable mariadb && systemctl start mariadb\n"})}),"\n",(0,c.jsx)(n.h4,{id:"314-\u8fdb\u884c\u6570\u636e\u5e93\u5b89\u5168\u8bbe\u7f6e",children:"3.1.4 \u8fdb\u884c\u6570\u636e\u5e93\u5b89\u5168\u8bbe\u7f6e"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ mysql_secure_installation\nEnter current password for root (enter for none):\t\t# \u6ca1\u6709\u5bc6\u7801\uff0c\u76f4\u63a5\u56de\u8f66\nSet root password? [Y/n] n\t\t\t\t\t\t\t            # \u4e0d\u8bbe\u7f6eroot\u5bc6\u7801\nRemove anonymous users? [Y/n] y\t\t\t\t\t            # \u79fb\u9664\u533f\u540d\u7528\u6237\nDisallow root login remotely? [Y/n] y\t\t\t\t\t      # \u7981\u6b62root\u8fdc\u7a0b\u767b\u9646\nRemove test database and access to it? [Y/n] y\t\t  # \u79fb\u9664test\u6570\u636e\u5e93\nReload privilege tables now? [Y/n] y\t\t\t\t\t      # \u5237\u65b0\u6743\u9650\u8868\n"})}),"\n",(0,c.jsx)(n.h3,{id:"32-\u5b89\u88c5\u6d88\u606f\u961f\u5217rabbitmq",children:"3.2 \u5b89\u88c5\u6d88\u606f\u961f\u5217rabbitmq"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["OpenStack \u4f7f\u7528 ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/mitaka/zh_CN/install-guide-rdo/common/glossary.html#term-message-queue",children:(0,c.jsx)(n.em,{children:"message queue"})})," \u534f\u8c03\u64cd\u4f5c\u548c\u5404\u670d\u52a1\u7684\u72b6\u6001\u4fe1\u606f\u3002\u6d88\u606f\u961f\u5217\u670d\u52a1\u4e00\u822c\u8fd0\u884c\u5728\u63a7\u5236\u8282\u70b9\u4e0a"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"rabbitmq\u4f1a\u542f\u52a82\u4e2a\u7aef\u53e3"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"tcp/5672\t\trabbitmq\u670d\u52a1\u7aef\u53e3"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"tcp/25672\t  \u591a\u4e2arabbitmq\u901a\u4fe1\u7528\u5230\u7684\u7aef\u53e3"})}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"321-\u5b89\u88c5\u5305",children:"3.2.1 \u5b89\u88c5\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"yum -y install rabbitmq-server\n"})}),"\n",(0,c.jsx)(n.h4,{id:"322-\u542f\u52a8rabbitmq\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",children:"3.2.2 \u542f\u52a8rabbitmq\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"systemctl enable rabbitmq-server && systemctl start rabbitmq-server\n"})}),"\n",(0,c.jsx)(n.h4,{id:"323-\u6dfb\u52a0openstack\u7528\u6237",children:"3.2.3 \u6dfb\u52a0openstack\u7528\u6237"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ rabbitmqctl add_user openstack RABBIT_PASS\nCreating user "openstack"\n'})}),"\n",(0,c.jsx)(n.h4,{id:"324-\u7ed9openstack\u7528\u6237\u8bbe\u7f6e\u8bfb\u548c\u5199\u6743\u9650",children:"3.2.4 \u7ed9openstack\u7528\u6237\u8bbe\u7f6e\u8bfb\u548c\u5199\u6743\u9650"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["*",(0,c.jsxs)(n.em,{children:["3\u4e2a.",(0,c.jsx)(n.em,{children:"\u5206\u522b\u662f \u53ef\u8bfb\u3001\u53ef\u5199\u3001\u53ef\u914d\u7f6e"})]})]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ rabbitmqctl set_permissions openstack ".*" ".*" ".*"\nSetting permissions for user "openstack" in vhost "/"\n'})}),"\n",(0,c.jsx)(n.h4,{id:"325-\u542f\u52a8rabbitmq\u4e00\u4e2a\u63d2\u4ef6\u542f\u52a8\u4e4b\u540e\u4f1a\u76d1\u542ctcp15672",children:"3.2.5 \u542f\u52a8rabbitmq\u4e00\u4e2a\u63d2\u4ef6\uff0c\u542f\u52a8\u4e4b\u540e\u4f1a\u76d1\u542ctcp/15672"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u662f\u4e00\u4e2aweb\u7ba1\u7406\u754c\u9762\uff0c\u9ed8\u8ba4\u7528\u6237\u540d\u548c\u5bc6\u7801\u90fd\u662f",(0,c.jsx)(n.code,{children:"guest"})]})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ rabbitmq-plugins enable rabbitmq_management\nThe following plugins have been enabled:\n  amqp_client\n  cowlib\n  cowboy\n  rabbitmq_web_dispatch\n  rabbitmq_management_agent\n  rabbitmq_management\n\nApplying plugin configuration to rabbit@openstack-controller... started 6 plugins.\n"})}),"\n",(0,c.jsx)(n.h3,{id:"33-\u5b89\u88c5memcached",children:"3.3 \u5b89\u88c5memcached"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u8ba4\u8bc1\u670d\u52a1\u8ba4\u8bc1\u7f13\u5b58\u4f7f\u7528Memcached\u7f13\u5b58\u4ee4\u724c\u3002\u7f13\u5b58\u670d\u52a1memecached\u8fd0\u884c\u5728\u63a7\u5236\u8282\u70b9\u3002\u5728\u751f\u4ea7\u90e8\u7f72\u4e2d\uff0c\u6211\u4eec\u63a8\u8350\u8054\u5408\u542f\u7528\u9632\u706b\u5899\u3001\u8ba4\u8bc1\u548c\u52a0\u5bc6\u4fdd\u8bc1\u5b83\u7684\u5b89\u5168\u3002"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"memcache\u76d1\u542c tcp/udp 11211\u7aef\u53e3"})}),"\n",(0,c.jsx)(n.h4,{id:"331-\u5b89\u88c5\u5305",children:"3.3.1 \u5b89\u88c5\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install memcached python-memcached\n"})}),"\n",(0,c.jsx)(n.h4,{id:"332-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6",children:"3.3.2 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u914d\u7f6e\u670d\u52a1\u4ee5\u4f7f\u7528\u63a7\u5236\u5668\u8282\u70b9\u7684\u7ba1\u7406IP\u5730\u5740\u3002\u8fd9\u662f\u4e3a\u4e86\u5141\u8bb8\u5176\u4ed6\u8282\u70b9\u901a\u8fc7\u7ba1\u7406\u7f51\u7edc\u8fdb\u884c\u8bbf\u95ee\uff1a"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"sed -i.bak '/OPTIONS/c OPTIONS=\"-l 127.0.0.1,::1,openstack-controller\"' /etc/sysconfig/memcached \n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4fee\u6539\u540e\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ cat /etc/sysconfig/memcached\nPORT="11211"\nUSER="memcached"\nMAXCONN="1024"\nCACHESIZE="64"\nOPTIONS="-l 127.0.0.1,::1,openstack-controller"\n'})}),"\n",(0,c.jsx)(n.h4,{id:"333-\u542f\u52a8memcached\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",children:"3.3.3 \u542f\u52a8memcached\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable memcached && systemctl start memcached\n"})}),"\n",(0,c.jsx)(n.h3,{id:"34-\u5b89\u88c5etcd",children:"3.4 \u5b89\u88c5etcd"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"OpenStack\u670d\u52a1\u53ef\u4ee5\u4f7f\u7528Etcd\uff08\u5206\u5e03\u5f0f\u53ef\u9760\u952e\u503c\u5b58\u50a8\uff09\u6765\u8fdb\u884c\u5206\u5e03\u5f0f\u952e\u9501\u5b9a\uff0c\u5b58\u50a8\u914d\u7f6e\uff0c\u8ddf\u8e2a\u670d\u52a1\u6d3b\u52a8\u6027\u548c\u5176\u4ed6\u60c5\u51b5\u3002"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"etcd\u670d\u52a1\u5728\u63a7\u5236\u5668\u8282\u70b9\u4e0a\u8fd0\u884c\u3002"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"etcd\u670d\u52a1\u542f\u52a8\u540e\u63d0\u4f9b\u7ed9\u5916\u90e8\u5ba2\u6237\u7aef\u901a\u4fe1\u7684\u7aef\u53e3\u662f2379\uff0c\u800cetcd\u670d\u52a1\u4e2d\u6210\u5458\u95f4\u7684\u901a\u4fe1\u7aef\u53e3\u662f2380"})}),"\n",(0,c.jsx)(n.h4,{id:"341-\u5b89\u88c5\u5305",children:"3.4.1 \u5b89\u88c5\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"yum -y install etcd\n"})}),"\n",(0,c.jsx)(n.h4,{id:"342-\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6",children:"3.4.2 \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u7f16\u8f91",(0,c.jsx)(n.code,{children:"/etc/etcd/etcd.conf"}),"\u6587\u4ef6\uff0c\u5e76\u8bbe\u7f6e",(0,c.jsx)(n.code,{children:"ETCD_INITIAL_CLUSTER"}),"\uff0c ",(0,c.jsx)(n.code,{children:"ETCD_INITIAL_ADVERTISE_PEER_URLS"}),"\uff0c",(0,c.jsx)(n.code,{children:"ETCD_ADVERTISE_CLIENT_URLS"}),"\uff0c ",(0,c.jsx)(n.code,{children:"ETCD_LISTEN_CLIENT_URLS"}),"\u63a7\u5236\u5668\u8282\u70b9\uff0c\u4ee5\u4f7f\u7ecf\u7531\u7ba1\u7406\u7f51\u7edc\u901a\u8fc7\u5176\u4ed6\u8282\u70b9\u7684\u8bbf\u95ee\u7684\u7ba1\u7406IP\u5730\u5740\uff1a"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'export CONTROLLER_IP=172.30.100.4\ncat > /etc/etcd/etcd.conf << EOF\n# [Member]\nETCD_DATA_DIR="/var/lib/etcd/default.etcd"\nETCD_LISTEN_PEER_URLS="http://${CONTROLLER_IP}:2380"\nETCD_LISTEN_CLIENT_URLS="http://${CONTROLLER_IP}:2379"\nETCD_NAME="openstack-controller"\n\n# [Clustering]\nETCD_INITIAL_ADVERTISE_PEER_URLS="http://${CONTROLLER_IP}:2380"\nETCD_ADVERTISE_CLIENT_URLS="http://${CONTROLLER_IP}:2379"\nETCD_INITIAL_CLUSTER="openstack-controller=http://${CONTROLLER_IP}:2380"\nETCD_INITIAL_CLUSTER_TOKEN="etcd-cluster-01"\nETCD_INITIAL_CLUSTER_STATE="new"\nEOF\n'})}),"\n",(0,c.jsx)(n.h4,{id:"343-\u542f\u52a8etcd\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f",children:"3.4.3 \u542f\u52a8etcd\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable etcd && systemctl restart etcd\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5230\u6b64\uff0c\u63a7\u5236\u8282\u70b9\u73af\u5883\u5b89\u88c5\u5b8c\u6210\uff01\uff01\uff01"})}),"\n",(0,c.jsx)(n.h2,{id:"4\u63a7\u5236\u8282\u70b9\u8ba4\u8bc1\u670d\u52a1keystone\u5b89\u88c5",children:"4.\u63a7\u5236\u8282\u70b9\u8ba4\u8bc1\u670d\u52a1keystone\u5b89\u88c5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/keystone/rocky/install/index-rdo.html",children:"rocky\u7248\u8ba4\u8bc1\u670d\u52a1keystone\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"keystone\u8ba4\u8bc1\u670d\u52a1\u529f\u80fd\uff1a\u8ba4\u8bc1\u7ba1\u7406\u3001\u6388\u6743\u7ba1\u7406\u3001\u670d\u52a1\u76ee\u5f55"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u8ba4\u8bc1\uff1a\u7528\u6237\u540d\u548c\u5bc6\u7801"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u6388\u6743\uff1a\u6388\u6743\u7ba1\u7406\uff0c\u4f8b\u5982\u4e00\u4e9b\u6280\u672f\u7f51\u7ad9(\u6398\u91d1\u3001csdn)\u53ef\u4ee5\u6388\u6743\u5fae\u4fe1\u3001QQ\u767b\u9646"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u670d\u52a1\u76ee\u5f55\uff1a\u76f8\u5f53\u4e8e\u901a\u8baf\u5f55\uff0c\u5373\u8981\u8bbf\u95eeopenstack\u7684\u955c\u50cf\u3001\u7f51\u7edc\u3001\u5b58\u50a8\u7b49\u670d\u52a1\uff0c\u53ea\u9700\u8981\u627e\u5230keystone\u5373\u53ef\uff0c\u800c\u4e0d\u9700\u8981\u518d\u5355\u72ec\u8bb0\u4f4f\u5404\u4e2a\u670d\u52a1\u7684\u8bbf\u95ee\u5730\u5740"})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u540e\u7eed\u6bcf\u5b89\u88c5\u4e00\u4e2a\u670d\u52a1\u90fd\u9700\u8981\u5728keystone\u4e0a\u6ce8\u518c"})}),"\n",(0,c.jsx)(n.h3,{id:"41-\u521b\u5efakeystone\u6570\u636e\u5e93\u5e76\u6388\u6743",children:"4.1 \u521b\u5efakeystone\u6570\u636e\u5e93\u5e76\u6388\u6743"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"mysql -e \"CREATE DATABASE keystone;\"\nmysql -e \"GRANT ALL PRIVILEGES ON keystone.* TO 'keystone'@'localhost' \\\nIDENTIFIED BY 'KEYSTONE_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON keystone.* TO 'keystone'@'%' \\\nIDENTIFIED BY 'KEYSTONE_DBPASS';\"\n"})}),"\n",(0,c.jsx)(n.h3,{id:"42-\u5b89\u88c5\u548c\u914d\u7f6ekeystron",children:"4.2 \u5b89\u88c5\u548c\u914d\u7f6ekeystron"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"keystone\u501f\u52a9apache\u8bbf\u95ee"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"mod_wsgi\u662f\u5e2e\u52a9apache\u8fde\u63a5python\u7a0b\u5e8f"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u76d1\u542c\u7aef\u53e3 5000"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"421-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"4.2.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-keystone httpd mod_wsgi openstack-utils.noarch\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"422-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6--etckeystonekeystoneconf",children:["4.2.2 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6  ",(0,c.jsx)(n.code,{children:"/etc/keystone/keystone.conf"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:"# \u5728 [database] \u90e8\u5206\uff0c\u914d\u7f6e\u6570\u636e\u5e93\u8bbf\u95ee\uff1a\n[database]\nconnection = mysql+pymysql://keystone:KEYSTONE_DBPASS@controller/keystone\n\n# \u5728[token]\u90e8\u5206\uff0c\u914d\u7f6eFernet UUID\u4ee4\u724c\u7684\u63d0\u4f9b\u8005\n[token]\nprovider = fernet\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/keystone/keystone.conf{,.bak}\ngrep -Ev '^$|#' /etc/keystone/keystone.conf.bak >/etc/keystone/keystone.conf\nopenstack-config --set /etc/keystone/keystone.conf database connection mysql+pymysql://keystone:KEYSTONE_DBPASS@openstack-controller/keystone\nopenstack-config --set /etc/keystone/keystone.conf token provider fernet\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"md5sum /etc/keystone/keystone.conf\ne12c017255f580f414e3693bd4ccaa1a  /etc/keystone/keystone.conf\n"})}),"\n",(0,c.jsx)(n.h4,{id:"423-\u521d\u59cb\u5316\u8eab\u4efd\u8ba4\u8bc1\u670d\u52a1\u7684\u6570\u636e\u5e93",children:"4.2.3 \u521d\u59cb\u5316\u8eab\u4efd\u8ba4\u8bc1\u670d\u52a1\u7684\u6570\u636e\u5e93"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u547d\u4ee4\u7684\u542b\u4e49\u662f\u5207\u6362\u5230keystone\u7528\u6237\uff0c\u4f7f\u7528\u7684shell\u662f/bin/sh\uff0c\u6267\u884c -c\u540e\u7684\u547d\u4ee4"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'su -s /bin/sh -c "keystone-manage db_sync" keystone\n'})}),"\n",(0,c.jsx)(n.p,{children:"\u4e0a\u4e00\u6b65\u64cd\u4f5c\u4e3a\u5bfc\u5165\u8868\uff0c\u4ee5\u4e0b\u547d\u4ee4\u6267\u884c\u8fd4\u56de\u6709\u8868\u5373\u4e3a\u6b63\u786e"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ mysql keystone -e "show tables;"|wc -l\n45\n'})}),"\n",(0,c.jsx)(n.h4,{id:"424-\u521d\u59cb\u5316fernet-key",children:"4.2.4 \u521d\u59cb\u5316Fernet key"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"keystone-manage fernet_setup --keystone-user keystone --keystone-group keystone\nkeystone-manage credential_setup --keystone-user keystone --keystone-group keystone\n"})}),"\n",(0,c.jsx)(n.h4,{id:"425-\u5f15\u5bfc\u8eab\u4efd\u670d\u52a1",children:"4.2.5 \u5f15\u5bfc\u8eab\u4efd\u670d\u52a1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"keystone-manage bootstrap --bootstrap-password ADMIN_PASS \\\n--bootstrap-admin-url http://openstack-controller:5000/v3/ \\\n--bootstrap-internal-url http://openstack-controller:5000/v3/ \\\n--bootstrap-public-url http://openstack-controller:5000/v3/ \\\n--bootstrap-region-id RegionOne\n"})}),"\n",(0,c.jsx)(n.h4,{id:"426-\u914d\u7f6eapache\u670d\u52a1\u5668",children:"4.2.6 \u914d\u7f6eApache\u670d\u52a1\u5668"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u7f16\u8f91",(0,c.jsx)(n.code,{children:"/etc/httpd/conf/httpd.conf"}),"\u6587\u4ef6\uff0c\u914d\u7f6e",(0,c.jsx)(n.code,{children:"ServerName"})," \u9009\u9879\u4e3a\u63a7\u5236\u8282\u70b9"]})}),"\n",(0,c.jsx)(n.h5,{id:"4261-\u4fee\u6539\u6587\u4ef6",children:"4.2.6.1 \u4fee\u6539\u6587\u4ef6"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/httpd/conf/httpd.conf{,.bak}\nsed -i.bak -e '96cServerName openstack-controller' -e '/^Listen/c Listen 8080' /etc/httpd/conf/httpd.conf\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/httpd/conf/httpd.conf\n812165839ec4f2e87a31c1ff2ba423aa  /etc/httpd/conf/httpd.conf\n"})}),"\n",(0,c.jsx)(n.h5,{id:"4262-\u521b\u5efa\u6587\u4ef6\u8f6f\u8fde\u63a5",children:"4.2.6.2 \u521b\u5efa\u6587\u4ef6\u8f6f\u8fde\u63a5"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:"ln -sf /usr/share/keystone/wsgi-keystone.conf /etc/httpd/conf.d/\n"})}),"\n",(0,c.jsx)(n.h4,{id:"427-\u542f\u52a8apache\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",children:"4.2.7 \u542f\u52a8Apache\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable httpd && systemctl start httpd\n"})}),"\n",(0,c.jsx)(n.h4,{id:"428-\u914d\u7f6e\u7ba1\u7406\u8d26\u6237",children:"4.2.8 \u914d\u7f6e\u7ba1\u7406\u8d26\u6237"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u4ee5\u4e0b\u4e3a\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u6237",(0,c.jsx)(n.code,{children:"admin"}),"\uff0c\u5bc6\u7801\u4e3a",(0,c.jsx)(n.code,{children:"ADMIN_PASS"})]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"export OS_USERNAME=admin\nexport OS_PASSWORD=ADMIN_PASS\nexport OS_PROJECT_NAME=admin\nexport OS_USER_DOMAIN_NAME=Default\nexport OS_PROJECT_DOMAIN_NAME=Default\nexport OS_AUTH_URL=http://openstack-controller:5000/v3\nexport OS_IDENTITY_API_VERSION=3\n"})}),"\n",(0,c.jsx)(n.h3,{id:"43-\u521b\u5efa\u57df\u9879\u76ee\u7528\u6237\u548c\u89d2\u8272",children:"4.3 \u521b\u5efa\u57df\u3001\u9879\u76ee\u3001\u7528\u6237\u548c\u89d2\u8272"}),"\n",(0,c.jsx)(n.h4,{id:"431-\u521b\u5efa\u4e00\u4e2a\u57df",children:"4.3.1 \u521b\u5efa\u4e00\u4e2a\u57df"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ openstack domain create --description "An Example Domain" example\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | An Example Domain                |\n| enabled     | True                             |\n| id          | ab6f853144384043a5dd648c154d0efe |\n| name        | example                          |\n| tags        | []                               |\n+-------------+----------------------------------+\n'})}),"\n",(0,c.jsx)(n.h4,{id:"432-\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u9879\u76ee",children:"4.3.2 \u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u9879\u76ee"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'# service\uff0c\u540e\u671f\u7528\u4e8e\u5173\u8054openstack\u7cfb\u7edf\u7528\u6237glance\u3001nova\u3001neutron\n$ openstack project create --domain default \\\n--description "Service Project" service\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | Service Project                  |\n| domain_id   | default                          |\n| enabled     | True                             |\n| id          | f6696bc9511043ae9ec72d1c31a494f3 |\n| is_domain   | False                            |\n| name        | service                          |\n| parent_id   | default                          |\n| tags        | []                               |\n+-------------+----------------------------------+\n'})}),"\n",(0,c.jsx)(n.h4,{id:"433-\u5e38\u89c4\u975e\u7ba1\u7406\u5458\u4efb\u52a1\u5e94\u4f7f\u7528\u65e0\u7279\u6743\u7684\u9879\u76ee\u548c\u7528\u6237",children:"4.3.3 \u5e38\u89c4\uff08\u975e\u7ba1\u7406\u5458\uff09\u4efb\u52a1\u5e94\u4f7f\u7528\u65e0\u7279\u6743\u7684\u9879\u76ee\u548c\u7528\u6237"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u4f8b\u5982\uff0c\u672c\u6307\u5357\u521b\u5efa",(0,c.jsx)(n.code,{children:"myproject"}),"\u9879\u76ee\u548c",(0,c.jsx)(n.code,{children:"myuser"})," \u7528\u6237"]})}),"\n",(0,c.jsx)(n.h5,{id:"4331-\u521b\u5efamyproject\u9879\u76ee",children:"4.3.3.1 \u521b\u5efamyproject\u9879\u76ee"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ openstack project create --domain default \\\n--description "Demo Project" myproject\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | Demo Project                     |\n| domain_id   | default                          |\n| enabled     | True                             |\n| id          | 5b9ccd294c364cc68747df85f9598c89 |\n| is_domain   | False                            |\n| name        | myproject                        |\n| parent_id   | default                          |\n| tags        | []                               |\n+-------------+----------------------------------+\n'})}),"\n",(0,c.jsx)(n.h5,{id:"4332-\u521b\u5efamyuser\u7528\u6237",children:"4.3.3.2 \u521b\u5efamyuser\u7528\u6237"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5bc6\u7801\u8bbe\u7f6e\u4e3a ",(0,c.jsx)(n.code,{children:"MYUSER_PASS"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u4ea4\u4e92\u5f0f\u4e0e\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801\u9009\u62e9\u5176\u4e2d\u4e00\u79cd"})}),"\n",(0,c.jsx)(n.p,{children:"\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack user create --domain default \\\n--password MYUSER_PASS myuser\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | f7985ae93ad24f7784a5ea3e1f22109a |\n| name                | myuser                           |\n| options             | {}                               |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack user create --domain default \\\n--password-prompt myuser\n"})}),"\n",(0,c.jsx)(n.h5,{id:"4333-\u521b\u5efamyrole\u89d2\u8272",children:"4.3.3.3 \u521b\u5efamyrole\u89d2\u8272"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack role create myrole\n+-----------+----------------------------------+\n| Field     | Value                            |\n+-----------+----------------------------------+\n| domain_id | None                             |\n| id        | 9cb289f07a6d4bd6898dd863d616b164 |\n| name      | myrole                           |\n+-----------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.h5,{id:"4334-\u5c06myrole\u89d2\u8272\u6dfb\u52a0\u5230myproject\u9879\u76ee\u548cmyuser\u7528\u6237",children:"4.3.3.4 \u5c06myrole\u89d2\u8272\u6dfb\u52a0\u5230myproject\u9879\u76ee\u548cmyuser\u7528\u6237"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack role add --project myproject --user myuser myrole\n"})}),"\n",(0,c.jsx)(n.h4,{id:"434-\u9a8c\u8bc1",children:"4.3.4 \u9a8c\u8bc1"}),"\n",(0,c.jsxs)(n.h5,{id:"4341-\u53d6\u6d88\u8bbe\u7f6e\u4e34\u65f6\u53d8\u91cf-os_auth_url-\u548c-os_password-\u73af\u5883\u53d8\u91cf",children:["4.3.4.1 \u53d6\u6d88\u8bbe\u7f6e\u4e34\u65f6\u53d8\u91cf ",(0,c.jsx)(n.code,{children:"OS_AUTH_URL"})," \u548c ",(0,c.jsx)(n.code,{children:"OS_PASSWORD"})," \u73af\u5883\u53d8\u91cf"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"unset OS_AUTH_URL OS_PASSWORD\n"})}),"\n",(0,c.jsx)(n.h5,{id:"4342-\u4ee5admin\u7528\u6237\u8eab\u4efd\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c",children:"4.3.4.2 \u4ee5admin\u7528\u6237\u8eab\u4efd\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5bc6\u7801\u662f ",(0,c.jsx)(n.code,{children:"ADMIN_PASS"})]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack --os-auth-url http://openstack-controller:5000/v3 \\\n--os-project-domain-name Default --os-user-domain-name Default \\\n--os-project-name admin --os-username admin token issue\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field      | Value                                                                                                                                                                                   |\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| expires    | 2021-11-04T03:32:38+0000                                                                                                                                                                |\n| id         | gAAAAABhg0ZG2yKJ00Myq8FQ33ibR6tN3I1Fu2xXJRN17usVIVPHiVJ2eJYQviKz9HeKWKEjmH_MLaWeiDZcW3QBQGjnT_Mbe9EEKqHSXKBJxo2etnI_kPCvxRoLPGE-XbevIWW6DYmsJqCJr32TdUG5wysC12ZbSWyVp25qyX_BKl_8KGSXXyM |\n| project_id | a6c250532966417cae11b1dfb5f0f6cc                                                                                                                                                        |\n| user_id    | 20b791e627a741ed8b21e41027638986                                                                                                                                                        |\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n"})}),"\n",(0,c.jsx)(n.h5,{id:"4343-\u4f7f\u7528\u4e0a\u4e00\u8282\u4e2d\u521b\u5efa\u7684\u7528\u6237myuser\u8bf7\u8bf7\u6c42\u8ba4\u8bc1\u4ee4\u724c",children:"4.3.4.3 \u4f7f\u7528\u4e0a\u4e00\u8282\u4e2d\u521b\u5efa\u7684\u7528\u6237myuser\uff0c\u8bf7\u8bf7\u6c42\u8ba4\u8bc1\u4ee4\u724c"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5bc6\u7801\u662f ",(0,c.jsx)(n.code,{children:"MYUSER_PASS"})]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack --os-auth-url http://openstack-controller:5000/v3 \\\n--os-project-domain-name Default --os-user-domain-name Default \\\n--os-project-name myproject --os-username myuser token issue\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field      | Value                                                                                                                                                                                   |\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| expires    | 2021-11-04T03:35:19+0000                                                                                                                                                                |\n| id         | gAAAAABhg0bnYFRoP2qjzgTRmT7lojzV3WO9GkYv6qFu5Nhx9_WbhIV6EDfNBbuJa7EHjmfz5BvYAza9J6wC6ZF36_nHfVPVkq3xO4E7fHNTa914q79UKTkpikR2i5NfPNgo1FqeIa0snUQ2M2-JSqteLCZxLMYZRTa_ckdV12i9OTle5_-6wk8 |\n| project_id | a150277718cd41439adbf88bbac6d1fe                                                                                                                                                        |\n| user_id    | d7d0fdf398d949038719c5f0c22fc379                                                                                                                                                        |\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n"})}),"\n",(0,c.jsx)(n.h3,{id:"44-\u521b\u5efaopenstack\u5ba2\u6237\u7aef\u73af\u5883\u811a\u672c",children:"4.4 \u521b\u5efaOpenStack\u5ba2\u6237\u7aef\u73af\u5883\u811a\u672c"}),"\n",(0,c.jsx)(n.h4,{id:"441-\u521b\u5efa\u811a\u672c",children:"4.4.1 \u521b\u5efa\u811a\u672c"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u521b\u5efa\u548c\u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"admin-openrc"})," \u6587\u4ef6\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff0c\u8fd9\u91cc\u653e\u5728/opt\u4e0b"]})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"cat > /opt/admin-openrc <<EOF\nexport OS_PROJECT_DOMAIN_NAME=Default\nexport OS_USER_DOMAIN_NAME=Default\nexport OS_PROJECT_NAME=admin\nexport OS_USERNAME=admin\nexport OS_PASSWORD=ADMIN_PASS\nexport OS_AUTH_URL=http://openstack-controller:5000/v3\nexport OS_IDENTITY_API_VERSION=3\nexport OS_IMAGE_API_VERSION=2\nEOF\n"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u521b\u5efa\u548c\u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"demo-openrc"})," \u6587\u4ef6\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9"]})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"cat > /opt/demo-openrc <<EOF\nexport OS_PROJECT_DOMAIN_NAME=Default\nexport OS_USER_DOMAIN_NAME=Default\nexport OS_PROJECT_NAME=myproject\nexport OS_USERNAME=myuser\nexport OS_PASSWORD=MYUSER_PASS\nexport OS_AUTH_URL=http://openstack-controller:5000/v3\nexport OS_IDENTITY_API_VERSION=3\nexport OS_IMAGE_API_VERSION=2\nEOF\n"})}),"\n",(0,c.jsx)(n.h4,{id:"442-\u4f7f\u7528\u811a\u672c",children:"4.4.2 \u4f7f\u7528\u811a\u672c"}),"\n",(0,c.jsxs)(n.h5,{id:"4421-\u52a0\u8f7d-admin-openrc-\u6587\u4ef6\u4ee5\u4f7f\u7528\u8eab\u4efd\u670d\u52a1\u7684\u4f4d\u7f6e\u4ee5\u53caadmin\u9879\u76ee\u548c\u7528\u6237\u51ed\u636e\u586b\u5145\u73af\u5883\u53d8\u91cf",children:["4.4.2.1 \u52a0\u8f7d ",(0,c.jsx)(n.code,{children:"admin-openrc"})," \u6587\u4ef6\u4ee5\u4f7f\u7528\u8eab\u4efd\u670d\u52a1\u7684\u4f4d\u7f6e\u4ee5\u53caadmin\u9879\u76ee\u548c\u7528\u6237\u51ed\u636e\u586b\u5145\u73af\u5883\u53d8\u91cf"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"source /opt/admin-openrc\n"})}),"\n",(0,c.jsx)(n.h5,{id:"4422-\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c",children:"4.4.2.2 \u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u6ce8\u610fexpires\u4e2d\u662fUTC\u65f6\u95f4\uff0c\u843d\u540e\u4e2d\u56fd8\u4e2a\u5c0f\u65f6\uff0c\u6211\u56fd\u662f\u4e1c\u516b\u533a\uff0c\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"timedatectl"})," \u67e5\u770b\u65f6\u95f4\u53ca\u65f6\u533a\uff0c\u9ed8\u8ba4\u8fc7\u671f\u65f6\u95f41\u5c0f\u65f6"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack token issue\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field      | Value                                                                                                                                                                                   |\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| expires    | 2021-11-04T03:47:51+0000                                                                                                                                                                |\n| id         | gAAAAABhg0nXv43sRRJ5ahS0P2z86nPoZGz7g-Y2v3jcLhW-QM5eTIj_39ncEktjGu1R1SAOM9cqMpmOHF26j8ur7L26fYJ8gyNoA-JC51ZWesc5mnr1FapD0dxqCmteL22RmA5gRtzjC5qHfbn_RjVNe-AjBNSL_OmtAEdr-kY5B2IO7kvt7ko |\n| project_id | a6c250532966417cae11b1dfb5f0f6cc                                                                                                                                                        |\n| user_id    | 20b791e627a741ed8b21e41027638986                                                                                                                                                        |\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5230\u6b64\uff0c\u63a7\u5236\u8282\u70b9\u8ba4\u8bc1\u670d\u52a1keystone\u5b89\u88c5\u5b8c\u6210\uff01\uff01\uff01"})}),"\n",(0,c.jsx)(n.h2,{id:"5\u63a7\u5236\u8282\u70b9\u955c\u50cf\u670d\u52a1glance\u5b89\u88c5",children:"5.\u63a7\u5236\u8282\u70b9\u955c\u50cf\u670d\u52a1glance\u5b89\u88c5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/glance/rocky/install/install-rdo.html",children:"rocky\u7248\u955c\u50cf\u670d\u52a1glance\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"OpenStack\u955c\u50cf\u670d\u52a1\u5305\u62ec\u4ee5\u4e0b\u7ec4\u4ef6\uff1a"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"glance-api\t\t\t\u63a5\u6536\u955c\u50cfAPI\u7684\u8c03\u7528\uff0c\u8bf8\u5982\u955c\u50cf\u53d1\u73b0\u3001\u6062\u590d\u3001\u5b58\u50a8"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"glance-registry\t\u5b58\u50a8\u3001\u5904\u7406\u548c\u6062\u590d\u955c\u50cf\u7684\u5143\u6570\u636e(\u5c5e\u6027)\uff0c\u5143\u6570\u636e\u5305\u62ec\u9879\u8bf8\u5982\u5927\u5c0f\u548c\u7c7b\u578b"})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"glance\u670d\u52a1\u76d1\u542c\u4e24\u4e2a\u7aef\u53e3"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"glance-api\t9292"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"glance-registry\t9191"})}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"51-\u521b\u5efaglance\u6570\u636e\u5e93\u5e76\u6388\u6743",children:"5.1 \u521b\u5efaglance\u6570\u636e\u5e93\u5e76\u6388\u6743"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"mysql -e \"CREATE DATABASE glance;\"\nmysql -e \"GRANT ALL PRIVILEGES ON glance.* TO 'glance'@'localhost' \\\nIDENTIFIED BY 'GLANCE_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON glance.* TO 'glance'@'%' \\\nIDENTIFIED BY 'GLANCE_DBPASS';\"\n"})}),"\n",(0,c.jsx)(n.h3,{id:"52-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee",children:"5.2 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"source /opt/admin-openrc\n"})}),"\n",(0,c.jsx)(n.h3,{id:"53-\u521b\u5efa\u670d\u52a1\u51ed\u636e",children:"5.3 \u521b\u5efa\u670d\u52a1\u51ed\u636e"}),"\n",(0,c.jsxs)(n.h4,{id:"531-\u521b\u5efa-glance-\u7528\u6237",children:["5.3.1 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"glance"})," \u7528\u6237"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5bc6\u7801\u8bbe\u7f6e\u4e3a ",(0,c.jsx)(n.code,{children:"GLANCE_PASS"})]})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u4ea4\u4e92\u5f0f\u4e0e\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801\u9009\u62e9\u5176\u4e2d\u4e00\u79cd"})}),"\n",(0,c.jsx)(n.p,{children:"\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack user create --domain default --password GLANCE_PASS glance\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | 36a88bb288464126837ebc19758bead6 |\n| name                | glance                           |\n| options             | {}                               |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack user create --domain default --password-prompt glance\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"532-\u5c06-admin-\u89d2\u8272\u6dfb\u52a0\u5230-glance-\u7528\u6237\u548c--service-\u9879\u76ee",children:["5.3.2 \u5c06 ",(0,c.jsx)(n.code,{children:"admin"})," \u89d2\u8272\u6dfb\u52a0\u5230 ",(0,c.jsx)(n.code,{children:"glance"})," \u7528\u6237\u548c  ",(0,c.jsx)(n.code,{children:"service"})," \u9879\u76ee"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"openstack role add --project service --user glance admin\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"533-\u521b\u5efaglance\u670d\u52a1\u5b9e\u4f53",children:["5.3.3 \u521b\u5efa",(0,c.jsx)(n.code,{children:"glance"}),"\u670d\u52a1\u5b9e\u4f53"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'$ openstack service create --name glance \\\n--description "OpenStack Image" image\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | OpenStack Image                  |\n| enabled     | True                             |\n| id          | ce5a424428d640c9adec06865d211916 |\n| name        | glance                           |\n| type        | image                            |\n+-------------+----------------------------------+  \n'})}),"\n",(0,c.jsx)(n.h4,{id:"534-\u521b\u5efaimage\u670d\u52a1api\u7aef\u70b9",children:"5.3.4 \u521b\u5efaImage\u670d\u52a1API\u7aef\u70b9"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack endpoint create --region RegionOne \\\nimage public http://openstack-controller:9292\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | bed29b8924114eee8b427f7a83f2cd64 |\n| interface    | public                           |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | ce5a424428d640c9adec06865d211916 |\n| service_name | glance                           |\n| service_type | image                            |\n| url          | http://controller:9292           |\n+--------------+----------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nimage internal http://openstack-controller:9292\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 94f84d946e6f4463af82041caf2877b5 |\n| interface    | internal                         |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | ce5a424428d640c9adec06865d211916 |\n| service_name | glance                           |\n| service_type | image                            |\n| url          | http://controller:9292           |\n+--------------+----------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nimage admin http://openstack-controller:9292\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 16e947838d7948e6a0ec7feb7910b415 |\n| interface    | admin                            |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | ce5a424428d640c9adec06865d211916 |\n| service_name | glance                           |\n| service_type | image                            |\n| url          | http://controller:9292           |\n+--------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5220\u9664API\u7aef\u70b9\u4f7f\u7528\u547d\u4ee4",(0,c.jsx)(n.code,{children:"openstack endpoint delete <endpoint-id>"})]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u4f7f\u7528\u547d\u4ee4",(0,c.jsx)(n.code,{children:"openstack endpoint list"}),"\u67e5\u770b",(0,c.jsx)(n.code,{children:"endpoint-id"}),"\u7136\u540e\u6839\u636eid\u5220\u9664"]})}),"\n",(0,c.jsx)(n.h3,{id:"54-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",children:"5.4 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6"}),"\n",(0,c.jsx)(n.h4,{id:"541-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"5.4.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-glance\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"542-\u7f16\u8f91-etcglanceglance-apiconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["5.4.2 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/glance/glance-api.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u8be5[database]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u6570\u636e\u5e93\u8bbf\u95ee\n[database]\n# ...\nconnection = mysql+pymysql://glance:GLANCE_DBPASS@openstack-controller/glance\n    \n2.\u5728[keystone_authtoken]\u548c[paste_deploy]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8eab\u4efd\u670d\u52a1\u8bbf\u95ee\n[keystone_authtoken]\n# ...\nwww_authenticate_uri  = http://openstack-controller:5000\nauth_url = http://openstack-controller:5000\nmemcached_servers = openstack-controller:11211\nauth_type = password\nproject_domain_name = Default\nuser_domain_name = Default\nproject_name = service\nusername = glance\npassword = GLANCE_PASS\n\n[paste_deploy]\n# ...\nflavor = keystone\n\n3.\u5728\u8be5[glance_store]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u5b58\u50a8\u548c\u56fe\u50cf\u6587\u4ef6\u7684\u4f4d\u7f6e\n[glance_store]\n# ...\nstores = file,http\ndefault_store = file\nfilesystem_store_datadir = /var/lib/glance/images/\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/glance/glance-api.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/glance/glance-api.conf.bak >/etc/glance/glance-api.conf\nopenstack-config --set /etc/glance/glance-api.conf  database  connection  mysql+pymysql://glance:GLANCE_DBPASS@openstack-controller/glance\nopenstack-config --set /etc/glance/glance-api.conf keystone_authtoken www_authenticate_uri http://openstack-controller:5000     \nopenstack-config --set /etc/glance/glance-api.conf keystone_authtoken auth_url http://openstack-controller:5000\nopenstack-config --set /etc/glance/glance-api.conf keystone_authtoken memcached_servers openstack-controller:11211\nopenstack-config --set /etc/glance/glance-api.conf keystone_authtoken auth_type password\nopenstack-config --set /etc/glance/glance-api.conf keystone_authtoken project_domain_name Default\nopenstack-config --set /etc/glance/glance-api.conf keystone_authtoken user_domain_name Default\nopenstack-config --set /etc/glance/glance-api.conf keystone_authtoken project_name service\nopenstack-config --set /etc/glance/glance-api.conf keystone_authtoken username glance\nopenstack-config --set /etc/glance/glance-api.conf keystone_authtoken password GLANCE_PASS\nopenstack-config --set /etc/glance/glance-api.conf paste_deploy flavor keystone\nopenstack-config --set /etc/glance/glance-api.conf glance_store stores file,http\nopenstack-config --set /etc/glance/glance-api.conf glance_store default_store file\nopenstack-config --set /etc/glance/glance-api.conf glance_store filesystem_store_datadir /var/lib/glance/images/\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/glance/glance-api.conf\n768bce1167f1545fb55115ad7e4fe3ff  /etc/glance/glance-api.conf\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"543-\u7f16\u8f91-etcglanceglance-registryconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["5.4.3 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/glance/glance-registry.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u8be5[database]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u6570\u636e\u5e93\u8bbf\u95ee\n[database]\n# ...\nconnection = mysql+pymysql://glance:GLANCE_DBPASS@openstack-controller/glance\n    \n2.\u5728[keystone_authtoken]\u548c[paste_deploy]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8eab\u4efd\u670d\u52a1\u8bbf\u95ee\n[keystone_authtoken]\n# ...\nwww_authenticate_uri = http://openstack-controller:5000\nauth_url = http://openstack-controller:5000\nmemcached_servers = openstack-controller:11211\nauth_type = password\nproject_domain_name = Default\nuser_domain_name = Default\nproject_name = service\nusername = glance\npassword = GLANCE_PASS\n\n[paste_deploy]\n# ...\nflavor = keystone\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/glance/glance-registry.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/glance/glance-registry.conf.bak > /etc/glance/glance-registry.conf\nopenstack-config --set /etc/glance/glance-registry.conf database connection mysql+pymysql://glance:GLANCE_DBPASS@openstack-controller/glance\nopenstack-config --set /etc/glance/glance-registry.conf keystone_authtoken www_authenticate_uri http://openstack-controller:5000\nopenstack-config --set /etc/glance/glance-registry.conf keystone_authtoken auth_url http://openstack-controller:5000\nopenstack-config --set /etc/glance/glance-registry.conf keystone_authtoken memcached_servers openstack-controller:11211\nopenstack-config --set /etc/glance/glance-registry.conf keystone_authtoken auth_type password\nopenstack-config --set /etc/glance/glance-registry.conf keystone_authtoken project_domain_name Default\nopenstack-config --set /etc/glance/glance-registry.conf keystone_authtoken user_domain_name Default\nopenstack-config --set /etc/glance/glance-registry.conf keystone_authtoken project_name service\nopenstack-config --set /etc/glance/glance-registry.conf keystone_authtoken username glance\nopenstack-config --set /etc/glance/glance-registry.conf keystone_authtoken password GLANCE_PASS\nopenstack-config --set /etc/glance/glance-registry.conf paste_deploy flavor keystone\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/glance/glance-registry.conf\nca0383d969bf7d1e9125b836769c9a2e  /etc/glance/glance-registry.conf\n"})}),"\n",(0,c.jsx)(n.h4,{id:"544-\u540c\u6b65\u6570\u636e\u5e93",children:"5.4.4 \u540c\u6b65\u6570\u636e\u5e93"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5ffd\u7565\u6b64\u8f93\u51fa\u4e2d\u7684\u4efb\u4f55\u5f03\u7528\u6d88\u606f"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ su -s /bin/sh -c \"glance-manage db_sync\" glance\n/usr/lib/python2.7/site-packages/oslo_db/sqlalchemy/enginefacade.py:1352: OsloDBDeprecationWarning: EngineFacade is deprecated; please use oslo_db.sqlalchemy.enginefacade\n  expire_on_commit=expire_on_commit, _conf=conf)\nINFO  [alembic.runtime.migration] Context impl MySQLImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nINFO  [alembic.runtime.migration] Running upgrade  -> liberty, liberty initial\nINFO  [alembic.runtime.migration] Running upgrade liberty -> mitaka01, add index on created_at and updated_at columns of 'images' table\nINFO  [alembic.runtime.migration] Running upgrade mitaka01 -> mitaka02, update metadef os_nova_server\nINFO  [alembic.runtime.migration] Running upgrade mitaka02 -> ocata_expand01, add visibility to images\nINFO  [alembic.runtime.migration] Running upgrade ocata_expand01 -> pike_expand01, empty expand for symmetry with pike_contract01\nINFO  [alembic.runtime.migration] Running upgrade pike_expand01 -> queens_expand01\nINFO  [alembic.runtime.migration] Running upgrade queens_expand01 -> rocky_expand01, add os_hidden column to images table\nINFO  [alembic.runtime.migration] Running upgrade rocky_expand01 -> rocky_expand02, add os_hash_algo and os_hash_value columns to images table\nINFO  [alembic.runtime.migration] Context impl MySQLImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nUpgraded database to: rocky_expand02, current revision(s): rocky_expand02\nINFO  [alembic.runtime.migration] Context impl MySQLImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nINFO  [alembic.runtime.migration] Context impl MySQLImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nDatabase migration is up to date. No migration needed.\nINFO  [alembic.runtime.migration] Context impl MySQLImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nINFO  [alembic.runtime.migration] Context impl MySQLImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nINFO  [alembic.runtime.migration] Running upgrade mitaka02 -> ocata_contract01, remove is_public from images\nINFO  [alembic.runtime.migration] Running upgrade ocata_contract01 -> pike_contract01, drop glare artifacts tables\nINFO  [alembic.runtime.migration] Running upgrade pike_contract01 -> queens_contract01\nINFO  [alembic.runtime.migration] Running upgrade queens_contract01 -> rocky_contract01\nINFO  [alembic.runtime.migration] Running upgrade rocky_contract01 -> rocky_contract02\nINFO  [alembic.runtime.migration] Context impl MySQLImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nUpgraded database to: rocky_contract02, current revision(s): rocky_contract02\nINFO  [alembic.runtime.migration] Context impl MySQLImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nDatabase is synced successfully.\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6709\u8868\u5373\u4e3a\u6b63\u786e"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ mysql glance -e "show tables;" | wc -l\n16\n'})}),"\n",(0,c.jsx)(n.h4,{id:"545-\u542f\u52a8glance\u670d\u52a1\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f",children:"5.4.5 \u542f\u52a8glance\u670d\u52a1\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u542f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable openstack-glance-api openstack-glance-registry\nsystemctl start openstack-glance-api openstack-glance-registry\n"})}),"\n",(0,c.jsx)(n.h4,{id:"546-\u9a8c\u8bc1\u64cd\u4f5c",children:"5.4.6 \u9a8c\u8bc1\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.h5,{id:"5461-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",children:"5.4.6.1 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"source /opt/admin-openrc\n"})}),"\n",(0,c.jsx)(n.h5,{id:"5462-\u4e0b\u8f7d\u6d4b\u8bd5\u955c\u50cf",children:"5.4.6.2 \u4e0b\u8f7d\u6d4b\u8bd5\u955c\u50cf"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"wget http://download.cirros-cloud.net/0.4.0/cirros-0.4.0-x86_64-disk.img\n"})}),"\n",(0,c.jsx)(n.h5,{id:"5463-\u4e0a\u4f20\u955c\u50cf",children:"5.4.6.3 \u4e0a\u4f20\u955c\u50cf"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u4f7f\u7528QCOW2\u78c1\u76d8\u683c\u5f0f\uff0c\u88f8\u5bb9\u5668\u683c\u5f0f\u548c\u516c\u5171\u53ef\u89c1\u6027\u5c06\u6620\u50cf\u4e0a\u8f7d\u5230\u6620\u50cf\u670d\u52a1 \uff0c\u4ee5\u4fbf\u6240\u6709\u9879\u76ee\u90fd\u53ef\u4ee5\u8bbf\u95ee\u5b83"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5220\u9664\u955c\u50cf\u4f7f\u7528\u547d\u4ee4 ",(0,c.jsx)(n.code,{children:"glance image-delete \u955c\u50cfid"})]})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u8fd9\u4e00\u6b65\u4e00\u5b9a\u8981\u770b\u6267\u884c\u540e\u8f93\u51fa\u7ed3\u679c\u4e2dsize\u5927\u5c0f\uff0c\u5982\u679c\u4e3a0\u5219\u8bf4\u660e\u955c\u50cf\u4e0a\u8f7d\u6709\u95ee\u9898"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack image create \"cirros\" \\\n--file cirros-0.4.0-x86_64-disk.img \\\n--disk-format qcow2 --container-format bare \\\n--public\n+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Field            | Value                                                                                                                                                                                      |\n+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| checksum         | 443b7623e27ecf03dc9e01ee93f67afe                                                                                                                                                           |\n| container_format | bare                                                                                                                                                                                       |\n| created_at       | 2021-11-04T03:56:55Z                                                                                                                                                                       |\n| disk_format      | qcow2                                                                                                                                                                                      |\n| file             | /v2/images/ff6ea9e3-e409-41e1-a871-daf3f8ebfb9e/file                                                                                                                                       |\n| id               | ff6ea9e3-e409-41e1-a871-daf3f8ebfb9e                                                                                                                                                       |\n| min_disk         | 0                                                                                                                                                                                          |\n| min_ram          | 0                                                                                                                                                                                          |\n| name             | cirros                                                                                                                                                                                     |\n| owner            | a6c250532966417cae11b1dfb5f0f6cc                                                                                                                                                           |\n| properties       | os_hash_algo='sha512', os_hash_value='6513f21e44aa3da349f248188a44bc304a3653a04122d8fb4535423c8e1d14cd6a153f735bb0982e2161b5b5186106570c17a9e58b64dd39390617cd5a350f78', os_hidden='False' |\n| protected        | False                                                                                                                                                                                      |\n| schema           | /v2/schemas/image                                                                                                                                                                          |\n| size             | 12716032                                                                                                                                                                                   |\n| status           | active                                                                                                                                                                                     |\n| tags             |                                                                                                                                                                                            |\n| updated_at       | 2021-11-04T03:56:56Z                                                                                                                                                                       |\n| virtual_size     | None                                                                                                                                                                                       |\n| visibility       | public                                                                                                                                                                                     |\n+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n"})}),"\n",(0,c.jsx)(n.h5,{id:"547-\u786e\u8ba4\u4e0a\u4f20\u56fe\u50cf\u5e76\u9a8c\u8bc1\u5c5e\u6027",children:"5.4.7 \u786e\u8ba4\u4e0a\u4f20\u56fe\u50cf\u5e76\u9a8c\u8bc1\u5c5e\u6027"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack image list\n+--------------------------------------+--------+--------+\n| ID                                   | Name   | Status |\n+--------------------------------------+--------+--------+\n| 94c96aab-d0b3-4340-835c-9a97108d0554 | cirros | active |\n+--------------------------------------+--------+--------+\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5230\u6b64\uff0c\u63a7\u5236\u8282\u70b9\u955c\u50cf\u670d\u52a1glance\u5b89\u88c5\u5b8c\u6210\uff01\uff01\uff01"})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"6\u63a7\u5236\u8282\u70b9\u548c\u8ba1\u7b97\u8282\u70b9\u8ba1\u7b97\u670d\u52a1nova\u5b89\u88c5",children:"6.\u63a7\u5236\u8282\u70b9\u548c\u8ba1\u7b97\u8282\u70b9\u8ba1\u7b97\u670d\u52a1nova\u5b89\u88c5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"nova\u76f8\u5173\u670d\u52a1"})}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u670d\u52a1\u540d\u79f0"}),(0,c.jsx)(n.th,{children:"\u4f5c\u7528"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-api"})}),(0,c.jsx)(n.td,{children:"\u63a5\u53d7\u5e76\u54cd\u5e94\u6700\u7ec8\u7528\u6237\u7684\u8ba1\u7b97API\u8c03\u7528\u3002\u8be5\u670d\u52a1\u652f\u6301OpenStack Compute API\u3002\u5b83\u6267\u884c\u4e00\u4e9b\u7b56\u7565\u5e76\u542f\u52a8\u5927\u591a\u6570\u7f16\u6392\u6d3b\u52a8\uff0c\u4f8b\u5982\u8fd0\u884c\u5b9e\u4f8b"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-api-metadata"})}),(0,c.jsxs)(n.td,{children:["\u63a5\u53d7\u6765\u81ea\u5b9e\u4f8b\u7684\u5143\u6570\u636e\u8bf7\u6c42\u3002",(0,c.jsx)(n.code,{children:"nova-api-metadata"}),"\u5f53\u60a8\u5728",(0,c.jsx)(n.code,{children:"nova-network"})," \u5b89\u88c5\u65f6\u4ee5\u591a\u4e3b\u673a\u6a21\u5f0f\u8fd0\u884c\u65f6\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528\u8be5\u670d\u52a1"]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-compute"})}),(0,c.jsx)(n.td,{children:"\u901a\u8fc7\u5b88\u62a4\u7a0b\u5e8fAPI\u521b\u5efa\u548c\u7ec8\u6b62\u865a\u62df\u673a\u5b9e\u4f8b\u7684\u8f85\u52a9\u7a0b\u5e8f\u5b88\u62a4\u7a0b\u5e8f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-placement-api"})}),(0,c.jsx)(n.td,{children:"\u8ddf\u8e2a\u6bcf\u4e2a\u63d0\u4f9b\u5546\u7684\u5e93\u5b58\u548c\u4f7f\u7528\u60c5\u51b5"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-scheduler"})}),(0,c.jsx)(n.td,{children:"\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u865a\u62df\u673a\u5b9e\u4f8b\u8bf7\u6c42\uff0c\u5e76\u786e\u5b9a\u5b83\u5728\u54ea\u53f0\u8ba1\u7b97\u670d\u52a1\u5668\u4e3b\u673a\u4e0a\u8fd0\u884c"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-conductor"})}),(0,c.jsx)(n.td,{children:"\u8c03\u89e3nova\u8ba1\u7b97\u670d\u52a1\u548c\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u4ea4\u4e92\u3002\u5b83\u6d88\u9664\u4e86nova\u8ba1\u7b97\u670d\u52a1\u5bf9\u4e91\u6570\u636e\u5e93\u7684\u76f4\u63a5\u8bbf\u95ee\u3002nova\u5bfc\u4f53\u6a21\u5757\u6c34\u5e73\u4f38\u7f29\u3002\u4f46\u662f\uff0c\u4e0d\u8981\u5728nova\u8ba1\u7b97\u670d\u52a1\u8fd0\u884c\u7684\u8282\u70b9\u4e0a\u90e8\u7f72\u5b83"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-consoleauth"})}),(0,c.jsxs)(n.td,{children:["\u4e3a\u63a7\u5236\u53f0\u4ee3\u7406\u63d0\u4f9b\u7684\u7528\u6237\u6388\u6743\u4ee4\u724c\u3002\u8bf7\u53c2\u9605 ",(0,c.jsx)(n.code,{children:"nova-novncproxy"}),"\u548c",(0,c.jsx)(n.code,{children:"nova-xvpvncproxy"}),"\u3002\u8be5\u670d\u52a1\u5fc5\u987b\u6b63\u5728\u8fd0\u884c\uff0c\u63a7\u5236\u53f0\u4ee3\u7406\u624d\u80fd\u8d77\u4f5c\u7528\u3002\u60a8\u53ef\u4ee5\u5728\u96c6\u7fa4\u914d\u7f6e\u4e2d\u9488\u5bf9\u5355\u4e2anova-consoleauth\u670d\u52a1\u8fd0\u884c\u8fd9\u4e24\u79cd\u7c7b\u578b\u7684\u4ee3\u7406 rocky\u7248\u4e0d\u63a8\u8350\u4f7f\u7528\uff0c\u5e76\u4e14\u4ee5\u540e\u4f1a\u5220\u9664"]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-novncproxy"})}),(0,c.jsx)(n.td,{children:"\u63d0\u4f9b\u7528\u4e8e\u901a\u8fc7VNC\u8fde\u63a5\u8bbf\u95ee\u6b63\u5728\u8fd0\u884c\u7684\u5b9e\u4f8b\u7684\u4ee3\u7406\u3002\u652f\u6301\u57fa\u4e8e\u6d4f\u89c8\u5668\u7684novnc\u5ba2\u6237\u7aef\u3002"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-spicehtml5proxy"})}),(0,c.jsx)(n.td,{children:"\u63d0\u4f9b\u7528\u4e8e\u901a\u8fc7SPICE\u8fde\u63a5\u8bbf\u95ee\u6b63\u5728\u8fd0\u884c\u7684\u5b9e\u4f8b\u7684\u4ee3\u7406\u3002\u652f\u6301\u57fa\u4e8e\u6d4f\u89c8\u5668\u7684HTML5\u5ba2\u6237\u7aef\u3002"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"nova-xvpvncproxy"})}),(0,c.jsx)(n.td,{children:"\u63d0\u4f9b\u7528\u4e8e\u901a\u8fc7VNC\u8fde\u63a5\u8bbf\u95ee\u6b63\u5728\u8fd0\u884c\u7684\u5b9e\u4f8b\u7684\u4ee3\u7406\u3002\u652f\u6301\u7279\u5b9a\u4e8eOpenStack\u7684Java\u5ba2\u6237\u7aef\u3002"})]})]})]}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u5b89\u88c5\u548c\u914d\u7f6e\u63a7\u5236\u8282\u70b9"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/nova/rocky/install/controller-install-rdo.html",children:"rocky\u7248\u63a7\u5236\u8282\u70b9\u8ba1\u7b97\u670d\u52a1nova\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.h3,{id:"61-\u521b\u5efanovanova_apinova_cell0placement\u6570\u636e\u5e93\u5e76\u6388\u6743",children:"6.1 \u521b\u5efanova\u3001nova_api\u3001nova_cell0\u3001placement\u6570\u636e\u5e93\u5e76\u6388\u6743"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"mysql -e \"CREATE DATABASE nova_api;\"\nmysql -e \"CREATE DATABASE nova;\"\nmysql -e \"CREATE DATABASE nova_cell0;\"\nmysql -e \"CREATE DATABASE placement;\"\nmysql -e \"GRANT ALL PRIVILEGES ON nova_api.* TO 'nova'@'localhost' \\\nIDENTIFIED BY 'NOVA_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON nova_api.* TO 'nova'@'%' \\\nIDENTIFIED BY 'NOVA_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON nova.* TO 'nova'@'localhost' \\\nIDENTIFIED BY 'NOVA_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON nova.* TO 'nova'@'%' \\\nIDENTIFIED BY 'NOVA_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON nova_cell0.* TO 'nova'@'localhost' \\\nIDENTIFIED BY 'NOVA_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON nova_cell0.* TO 'nova'@'%' \\\nIDENTIFIED BY 'NOVA_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'localhost' \\\nIDENTIFIED BY 'PLACEMENT_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'%' \\\nIDENTIFIED BY 'PLACEMENT_DBPASS';\"\n"})}),"\n",(0,c.jsx)(n.h3,{id:"62-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",children:"6.2 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"source /opt/admin-openrc\n"})}),"\n",(0,c.jsx)(n.h3,{id:"63-\u521b\u5efa\u8ba1\u7b97\u670d\u52a1\u51ed\u636e",children:"6.3 \u521b\u5efa\u8ba1\u7b97\u670d\u52a1\u51ed\u636e"}),"\n",(0,c.jsxs)(n.h4,{id:"631-\u521b\u5efa-nova-\u7528\u6237",children:["6.3.1 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"nova"})," \u7528\u6237"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5bc6\u7801\u8bbe\u7f6e\u4e3a ",(0,c.jsx)(n.code,{children:"NOVA_PASS"})]})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u4ea4\u4e92\u5f0f\u4e0e\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801\u9009\u62e9\u5176\u4e2d\u4e00\u79cd"})}),"\n",(0,c.jsx)(n.p,{children:"\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack user create --domain default \\\n--password NOVA_PASS nova\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | ebe9b1934a2e4c8ca9c177af647851b1 |\n| name                | nova                             |\n| options             | {}                               |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack user create --domain default --password-prompt nova\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"632-\u5c06-admin-\u89d2\u8272\u6dfb\u52a0\u5230-nova-\u7528\u6237",children:["6.3.2 \u5c06 ",(0,c.jsx)(n.code,{children:"admin"})," \u89d2\u8272\u6dfb\u52a0\u5230 ",(0,c.jsx)(n.code,{children:"nova"})," \u7528\u6237"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"openstack role add --project service --user nova admin\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"633-\u521b\u5efa-nova-\u670d\u52a1\u5b9e\u4f53",children:["6.3.3 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"nova"})," \u670d\u52a1\u5b9e\u4f53"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'$ openstack service create --name nova \\\n--description "OpenStack Compute" compute\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | OpenStack Compute                |\n| enabled     | True                             |\n| id          | 412f485718f44759b6c3cd46b1d624e6 |\n| name        | nova                             |\n| type        | compute                          |\n+-------------+----------------------------------+  \n'})}),"\n",(0,c.jsxs)(n.h4,{id:"634-\u521b\u5efa-compute-api-\u670d\u52a1\u7aef\u70b9",children:["6.3.4 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"Compute API"})," \u670d\u52a1\u7aef\u70b9"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack endpoint create --region RegionOne \\\ncompute public http://openstack-controller:8774/v2.1\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | cc0a7c21acd0450998760841dd9a11c0 |\n| interface    | public                           |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 412f485718f44759b6c3cd46b1d624e6 |\n| service_name | nova                             |\n| service_type | compute                          |\n| url          | http://controller:8774/v2.1      |\n+--------------+----------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\ncompute internal http://openstack-controller:8774/v2.1\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 69acbdd4f0114a339f8b62d9118ce137 |\n| interface    | internal                         |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 412f485718f44759b6c3cd46b1d624e6 |\n| service_name | nova                             |\n| service_type | compute                          |\n| url          | http://controller:8774/v2.1      |\n+--------------+----------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\ncompute admin http://openstack-controller:8774/v2.1\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 5382d617406a4dba8280dc375dd53329 |\n| interface    | admin                            |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 412f485718f44759b6c3cd46b1d624e6 |\n| service_name | nova                             |\n| service_type | compute                          |\n| url          | http://controller:8774/v2.1      |\n+--------------+----------------------------------+\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"635-\u521b\u5efa\u5c55\u793a\u4f4d\u7f6e\u670d\u52a1\u7528\u6237-placement",children:["6.3.5 \u521b\u5efa\u5c55\u793a\u4f4d\u7f6e\u670d\u52a1\u7528\u6237 ",(0,c.jsx)(n.code,{children:"PLACEMENT"})]}),"\n",(0,c.jsxs)(n.admonition,{title:"\u8bf4\u660e",type:"tip",children:[(0,c.jsxs)(n.p,{children:["\u5bc6\u7801\u8bbe\u7f6e\u4e3a",(0,c.jsx)(n.code,{children:"PLACEMENT_PASS"})]}),(0,c.jsx)(n.p,{children:"\u4ea4\u4e92\u5f0f\u4e0e\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801\u9009\u62e9\u5176\u4e2d\u4e00\u79cd"})]}),"\n",(0,c.jsx)(n.p,{children:"\u975e\u4ea4\u4e92\u5f0f\u521b\u5efa\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack user create --domain default --password PLACEMENT_PASS placement\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | 5ab24083149e4adf978c43439b87c982 |\n| name                | placement                        |\n| options             | {}                               |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4ea4\u4e92\u5f0f\u521b\u5efa\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack user create --domain default --password-prompt placement\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"636-\u4f7f\u7528\u7ba1\u7406\u5458\u89d2\u8272\u5c06-placement-\u7528\u6237\u6dfb\u52a0\u5230\u670d\u52a1\u9879\u76ee\u4e2d",children:["6.3.6 \u4f7f\u7528\u7ba1\u7406\u5458\u89d2\u8272\u5c06 ",(0,c.jsx)(n.code,{children:"Placement"})," \u7528\u6237\u6dfb\u52a0\u5230\u670d\u52a1\u9879\u76ee\u4e2d"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack role add --project service --user placement admin\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"637-\u5728\u670d\u52a1\u76ee\u5f55\u4e2d\u521b\u5efa-placement-api-\u6761\u76ee",children:["6.3.7 \u5728\u670d\u52a1\u76ee\u5f55\u4e2d\u521b\u5efa ",(0,c.jsx)(n.code,{children:"Placement API"})," \u6761\u76ee"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'$ openstack service create --name placement \\\n--description "Placement API" placement\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | Placement API                    |\n| enabled     | True                             |\n| id          | 274104c9a16f4b728bd7f484d3c54d3e |\n| name        | placement                        |\n| type        | placement                        |\n+-------------+----------------------------------+\n'})}),"\n",(0,c.jsxs)(n.h4,{id:"638-\u521b\u5efa-placement-api-\u670d\u52a1\u7aef\u70b9",children:["6.3.8 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"Placement API"})," \u670d\u52a1\u7aef\u70b9"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack endpoint create --region RegionOne \\\nplacement public http://openstack-controller:8778\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | c3afd275f71a4406a701d16ad24aa325 |\n| interface    | public                           |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 274104c9a16f4b728bd7f484d3c54d3e |\n| service_name | placement                        |\n| service_type | placement                        |\n| url          | http://controller:8778           |\n+--------------+----------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nplacement internal http://openstack-controller:8778\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 2ddc86a3b46d45489ebbedbd54fc3c0c |\n| interface    | internal                         |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 274104c9a16f4b728bd7f484d3c54d3e |\n| service_name | placement                        |\n| service_type | placement                        |\n| url          | http://controller:8778           |\n+--------------+----------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nplacement admin http://openstack-controller:8778\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | d0714a417aa44c0180d59be843e1d40d |\n| interface    | admin                            |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 274104c9a16f4b728bd7f484d3c54d3e |\n| service_name | placement                        |\n| service_type | placement                        |\n| url          | http://controller:8778           |\n+--------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.h3,{id:"64-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",children:"6.4 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6"}),"\n",(0,c.jsx)(n.h4,{id:"641-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"6.4.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-nova-api openstack-nova-conductor \\\nopenstack-nova-console openstack-nova-novncproxy \\\nopenstack-nova-scheduler openstack-nova-placement-api\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"642-\u7f16\u8f91-etcnovanovaconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["6.4.2 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/nova/nova.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u6b64[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u4ec5\u542f\u7528\u8ba1\u7b97\u548c\u5143\u6570\u636eAPI\n[DEFAULT]\n# ...\nenabled_apis = osapi_compute,metadata\n\n2.\u5728[api_database]\uff0c[database]\u548c[placement_database] \u90e8\u5206\uff0c\u914d\u7f6e\u6570\u636e\u5e93\u8bbf\u95ee\n[api_database]\n# ...\nconnection = mysql+pymysql://nova:NOVA_DBPASS@controller/nova_api\n\n[database]\n# ...\nconnection = mysql+pymysql://nova:NOVA_DBPASS@controller/nova\n\n[placement_database]\n# ...\nconnection = mysql+pymysql://placement:PLACEMENT_DBPASS@controller/placement\n    \n3.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6eRabbitMQ\u6d88\u606f\u961f\u5217\u8bbf\u95ee\n[DEFAULT]\n# ...\ntransport_url = rabbit://openstack:RABBIT_PASS@controller\n\n4.\u5728[api]\u548c[keystone_authtoken]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8eab\u4efd\u670d\u52a1\u8bbf\u95ee\n[api]\n# ...\nauth_strategy = keystone\n\n[keystone_authtoken]\n# ...\nauth_url = http://controller:5000/v3\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = Default\nuser_domain_name = Default\nproject_name = service\nusername = nova\npassword = NOVA_PASS\n\n5.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6emy_ip\u9009\u9879\u4ee5\u4f7f\u7528\u63a7\u5236\u5668\u8282\u70b9\u7684\u7ba1\u7406\u63a5\u53e3IP\u5730\u5740\n[DEFAULT]\n# ...\nmy_ip = 10.0.0.11\n\n6.\u5728\u672c[DEFAULT]\u8282\u4e2d\uff0c\u542f\u7528\u5bf9\u7f51\u7edc\u670d\u52a1\u7684\u652f\u6301\n[DEFAULT]\n# ...\nuse_neutron = true\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cCompute\u4f7f\u7528\u5185\u90e8\u9632\u706b\u5899\u9a71\u52a8\u7a0b\u5e8f\u3002\u7531\u4e8e\u7f51\u7edc\u670d\u52a1\u5305\u542b\u9632\u706b\u5899\u9a71\u52a8\u7a0b\u5e8f\uff0c\u56e0\u6b64\u5fc5\u987b\u4f7f\u7528nova.virt.firewall.NoopFirewallDriver\u9632\u706b\u5899\u9a71\u52a8\u7a0b\u5e8f\u7981\u7528\u8ba1\u7b97\u9632\u706b\u5899\u9a71\u52a8 \u7a0b\u5e8f\n\n7.\u5728\u8be5[vnc]\u90e8\u5206\u4e2d\uff0c\u5c06VNC\u4ee3\u7406\u914d\u7f6e\u4e3a\u4f7f\u7528\u63a7\u5236\u5668\u8282\u70b9\u7684\u7ba1\u7406\u63a5\u53e3IP\u5730\u5740\n[vnc]\nenabled = true\n# ...\nserver_listen = $my_ip\nserver_proxyclient_address = $my_ip\n\n8.\u5728\u8be5[glance]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u56fe\u50cf\u670d\u52a1API\u7684\u4f4d\u7f6e\n[glance]\n# ...\napi_servers = http://controller:9292\n    \n9.\u5728\u8be5[oslo_concurrency]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u9501\u5b9a\u8def\u5f84\n[oslo_concurrency]\n# ...\nlock_path = /var/lib/nova/tmp\n\n10.\u5728\u8be5[placement]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6ePlacement API\n[placement]\n# ...\nregion_name = RegionOne\nproject_domain_name = Default\nproject_name = service\nauth_type = password\nuser_domain_name = Default\nauth_url = http://controller:5000/v3\nusername = placement\npassword = PLACEMENT_PASS\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/nova/nova.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/nova/nova.conf.bak >/etc/nova/nova.conf\nopenstack-config --set /etc/nova/nova.conf DEFAULT enabled_apis osapi_compute,metadata\nopenstack-config --set /etc/nova/nova.conf DEFAULT transport_url rabbit://openstack:RABBIT_PASS@openstack-controller\nopenstack-config --set /etc/nova/nova.conf DEFAULT my_ip 172.30.100.4\nopenstack-config --set /etc/nova/nova.conf DEFAULT use_neutron true\nopenstack-config --set /etc/nova/nova.conf DEFAULT firewall_driver nova.virt.firewall.NoopFirewallDriver\nopenstack-config --set /etc/nova/nova.conf api_database connection mysql+pymysql://nova:NOVA_DBPASS@openstack-controller/nova_api\nopenstack-config --set /etc/nova/nova.conf database connection mysql+pymysql://nova:NOVA_DBPASS@openstack-controller/nova\nopenstack-config --set /etc/nova/nova.conf placement_database connection mysql+pymysql://placement:PLACEMENT_DBPASS@openstack-controller/placement\nopenstack-config --set /etc/nova/nova.conf api auth_strategy keystone\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken auth_url http://openstack-controller:5000/v3\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken memcached_servers openstack-controller:11211\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken auth_type password\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken project_domain_name Default\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken user_domain_name Default\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken project_name service\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken username nova\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken password NOVA_PASS\nopenstack-config --set /etc/nova/nova.conf vnc enabled true\nopenstack-config --set /etc/nova/nova.conf vnc server_listen '$my_ip'\nopenstack-config --set /etc/nova/nova.conf vnc server_proxyclient_address '$my_ip'\nopenstack-config --set /etc/nova/nova.conf glance api_servers http://openstack-controller:9292\nopenstack-config --set /etc/nova/nova.conf oslo_concurrency lock_path /var/lib/nova/tmp\nopenstack-config --set /etc/nova/nova.conf placement region_name RegionOne\nopenstack-config --set /etc/nova/nova.conf placement project_domain_name Default\nopenstack-config --set /etc/nova/nova.conf placement project_name service\nopenstack-config --set /etc/nova/nova.conf placement auth_type password\nopenstack-config --set /etc/nova/nova.conf placement user_domain_name Default\nopenstack-config --set /etc/nova/nova.conf placement auth_url http://openstack-controller:5000/v3\nopenstack-config --set /etc/nova/nova.conf placement username placement\nopenstack-config --set /etc/nova/nova.conf placement password PLACEMENT_PASS\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/nova/nova.conf\n44436fe1f334fdfdf0b5efdbf4250e94  /etc/nova/nova.conf\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"643-\u7531\u4e8e\u5305\u88c5\u9519\u8bef\u60a8\u5fc5\u987b\u901a\u8fc7\u5c06\u4ee5\u4e0b\u914d\u7f6e\u6dfb\u52a0\u5230\u6765\u542f\u7528\u5bf9placement-api\u7684\u8bbf\u95ee-etchttpdconfd00-nova-placement-apiconf",children:["6.4.3 \u7531\u4e8e",(0,c.jsx)(n.a,{href:"https://bugzilla.redhat.com/show_bug.cgi?id=1430540",children:"\u5305\u88c5\u9519\u8bef"}),"\uff0c\u60a8\u5fc5\u987b\u901a\u8fc7\u5c06\u4ee5\u4e0b\u914d\u7f6e\u6dfb\u52a0\u5230\u6765\u542f\u7528\u5bf9Placement API\u7684\u8bbf\u95ee ",(0,c.jsx)(n.code,{children:"/etc/httpd/conf.d/00-nova-placement-api.conf"})]}),"\n",(0,c.jsx)(n.h5,{id:"6431-\u5907\u4efd\u6587\u4ef6\u5e76\u8ffd\u52a0\u5185\u5bb9",children:"6.4.3.1 \u5907\u4efd\u6587\u4ef6\u5e76\u8ffd\u52a0\u5185\u5bb9"}),"\n",(0,c.jsx)(n.p,{children:"\u8ffd\u52a0\u5185\u5bb9\u65f6\u8981\u6dfb\u52a0\u4e00\u884c\u7a7a\u884c\uff0c\u5426\u5219\u683c\u5f0f\u4f1a\u6709\u9519\u8bef(\u8fd9\u91cc\u6dfb\u52a0\u4e86\u4e24\u884c\u7a7a\u884c\uff0c\u5176\u4e2d\u7b2c\u4e00\u884c\u662f\u4e3a\u4e86\u683c\u5f0f\u6b63\u786e\uff0c\u7b2c\u4e8c\u884c\u662f\u4e3a\u4e86\u683c\u5f0f\u89c4\u8303\uff0c\u5373\u6807\u7b7e\u4e0e\u6807\u7b7e\u4e4b\u95f4\u6709\u4e00\u884c\u7a7a\u884c)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/httpd/conf.d/00-nova-placement-api.conf{,.bak}\ncat >> /etc/httpd/conf.d/00-nova-placement-api.conf <<EOF\n\n\n<Directory /usr/bin>\n   <IfVersion >= 2.4>\n      Require all granted\n   </IfVersion>\n   <IfVersion < 2.4>\n      Order allow,deny\n      Allow from all\n   </IfVersion>\n</Directory>\nEOF\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/httpd/conf.d/00-nova-placement-api.conf\n4b31341049e863449951b0c76fe17bde  /etc/httpd/conf.d/00-nova-placement-api.conf\n"})}),"\n",(0,c.jsx)(n.h4,{id:"6432-\u91cd\u542fhttpd",children:"6.4.3.2 \u91cd\u542fhttpd"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"systemctl restart httpd\n"})}),"\n",(0,c.jsx)(n.h4,{id:"643-\u540c\u6b65\u6570\u636e\u5e93\u5ffd\u7565\u8f93\u51fa",children:"6.4.3 \u540c\u6b65\u6570\u636e\u5e93\uff0c\u5ffd\u7565\u8f93\u51fa"}),"\n",(0,c.jsx)(n.h5,{id:"6431-\u540c\u6b65\u6570\u636e\u5e93",children:"6.4.3.1 \u540c\u6b65\u6570\u636e\u5e93"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# \u540c\u6b65nova-api\u548cplacement\u6570\u636e\u5e93\n$ su -s /bin/sh -c "nova-manage api_db sync" nova\n\n# \u6ce8\u518ccell0\u6570\u636e\u5e93\n$ su -s /bin/sh -c "nova-manage cell_v2 map_cell0" nova\n\n# \u521b\u5efacell1\u5355\u5143\u683c\n$ su -s /bin/sh -c "nova-manage cell_v2 create_cell --name=cell1 --verbose" nova\n536383cb-03e4-48bb-bb77-4eeb1bfb9d80\n\n# \u540c\u6b65nova\u6570\u636e\u5e93\n$ su -s /bin/sh -c "nova-manage db sync" nova\n/usr/lib/python2.7/site-packages/pymysql/cursors.py:170: Warning: (1831, u\'Duplicate index `block_device_mapping_instance_uuid_virtual_name_device_name_idx`. This is deprecated and will be disallowed in a future release.\')\n  result = self._query(query)\n/usr/lib/python2.7/site-packages/pymysql/cursors.py:170: Warning: (1831, u\'Duplicate index `uniq_instances0uuid`. This is deprecated and will be disallowed in a future release.\')\n  result = self._query(query)\n'})}),"\n",(0,c.jsxs)(n.h5,{id:"6432-\u9a8c\u8bc1-nova-cell0-\u548c-cell1-\u662f\u5426\u6b63\u786e\u6ce8\u518c",children:["6.4.3.2 \u9a8c\u8bc1 ",(0,c.jsx)(n.code,{children:"nova cell0"})," \u548c ",(0,c.jsx)(n.code,{children:"cell1"})," \u662f\u5426\u6b63\u786e\u6ce8\u518c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ su -s /bin/sh -c "nova-manage cell_v2 list_cells" nova\n+-------+--------------------------------------+------------------------------------+-------------------------------------------------+----------+\n|  Name |                 UUID                 |           Transport URL            |               Database Connection               | Disabled |\n+-------+--------------------------------------+------------------------------------+-------------------------------------------------+----------+\n| cell0 | 00000000-0000-0000-0000-000000000000 |               none:/               | mysql+pymysql://nova:****@controller/nova_cell0 |  False   |\n| cell1 | 536383cb-03e4-48bb-bb77-4eeb1bfb9d80 | rabbit://openstack:****@controller |    mysql+pymysql://nova:****@controller/nova    |  False   |\n+-------+--------------------------------------+------------------------------------+-------------------------------------------------+----------+\n'})}),"\n",(0,c.jsx)(n.h4,{id:"644-\u542f\u52a8compute\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",children:"6.4.4 \u542f\u52a8Compute\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"nova-consoleauth"}),"\u81ea18.0.0\uff08Rocky\uff09\u8d77\u4e0d\u63a8\u8350\u4f7f\u7528\uff0c\u5e76\u5c06\u5728\u4ee5\u540e\u7684\u7248\u672c\u4e2d\u5220\u9664\u3002\u6bcf\u4e2a\u5355\u5143\u5e94\u90e8\u7f72\u63a7\u5236\u53f0\u4ee3\u7406\u3002\u5982\u679c\u6267\u884c\u5168\u65b0\u5b89\u88c5\uff08\u800c\u975e\u5347\u7ea7\uff09\uff0c\u5219\u53ef\u80fd\u4e0d\u9700\u8981\u5b89\u88c5",(0,c.jsx)(n.code,{children:"nova-consoleauth"})," \u670d\u52a1\u3002\u6709\u5173",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/nova/rocky/configuration/config.html#workarounds.enable_consoleauth",children:(0,c.jsx)(n.code,{children:"workarounds.enable_consoleauth"})}),"\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u3002"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable openstack-nova-api.service \\\nopenstack-nova-consoleauth openstack-nova-scheduler.service \\\nopenstack-nova-conductor.service openstack-nova-novncproxy.service\n\nsystemctl start openstack-nova-api.service \\\nopenstack-nova-consoleauth openstack-nova-scheduler.service \\\nopenstack-nova-conductor.service openstack-nova-novncproxy.service\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5b89\u88c5\u5b8c\u6210\u540e\u4f1a\u6709no VNC    172.30.100.4:6080"})}),"\n",(0,c.jsxs)(n.p,{children:["![iShot2021-11-04 14.48.13](",(0,c.jsx)(n.a,{href:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/master/img/iShot2021-11-04",children:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/master/img/iShot2021-11-04"})," 14.48.13.png)"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u5b89\u88c5\u548c\u914d\u7f6e\u8ba1\u7b97\u8282\u70b9"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/nova/rocky/install/compute-install-rdo.html",children:"rocky\u7248\u8ba1\u7b97\u8282\u70b9\u8ba1\u7b97\u670d\u52a1nova\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.h3,{id:"65-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",children:"6.5 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6"}),"\n",(0,c.jsx)(n.h4,{id:"651-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"6.5.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-nova-compute openstack-utils\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"652-\u7f16\u8f91etcnovanovaconf\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["6.5.2 \u7f16\u8f91",(0,c.jsx)(n.code,{children:"/etc/nova/nova.conf"}),"\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u6b64[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u4ec5\u542f\u7528\u8ba1\u7b97\u548c\u5143\u6570\u636eAPI\n[DEFAULT]\n# ...\nenabled_apis = osapi_compute,metadata\n\n2.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6eRabbitMQ\u6d88\u606f\u961f\u5217\u8bbf\u95ee\uff1a\n[DEFAULT]\n# ...\ntransport_url = rabbit://openstack:RABBIT_PASS@controller\n    \n3.\u5728[api]\u548c[keystone_authtoken]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8eab\u4efd\u670d\u52a1\u8bbf\u95ee\uff1a\n[api]\n# ...\nauth_strategy = keystone\n\n[keystone_authtoken]\n# ...\nauth_url = http://controller:5000/v3\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = Default\nuser_domain_name = Default\nproject_name = service\nusername = nova\npassword = NOVA_PASS\n\n4.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6emy_ip\u9009\u9879\uff1aMANAGEMENT_INTERFACE_IP_ADDRESS\u4e3a\u8ba1\u7b97\u8282\u70b9\u4e0a\u7ba1\u7406\u7f51\u7edc\u63a5\u53e3\u7684IP\u5730\u5740 my_ip = MANAGEMENT_INTERFACE_IP_ADDRESS\n[DEFAULT]\n# ...\nmy_ip = 10.0.0.31\n\n5.\u5728\u672c[DEFAULT]\u8282\u4e2d\uff0c\u542f\u7528\u5bf9\u7f51\u7edc\u670d\u52a1\u7684\u652f\u6301\uff1a\n[DEFAULT]\n# ...\nuse_neutron = true\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\n6.\u5728\u672c[DEFAULT]\u8282\u4e2d\uff0c\u542f\u7528\u5bf9\u7f51\u7edc\u670d\u52a1\u7684\u652f\u6301\uff1a\n[DEFAULT]\n# ...\nuse_neutron = true\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\n7.\u5728\u8be5[vnc]\u90e8\u5206\u4e2d\uff0c\u542f\u7528\u548c\u914d\u7f6e\u8fdc\u7a0b\u63a7\u5236\u53f0\u8bbf\u95ee\uff1a\n[vnc]\n# ...\nenabled = true\nserver_listen = 0.0.0.0\nserver_proxyclient_address = $my_ip\nnovncproxy_base_url = http://controller:6080/vnc_auto.html\n    \n8.\u5728\u8be5[glance]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u56fe\u50cf\u670d\u52a1API\u7684\u4f4d\u7f6e\uff1a\n[glance]\n# ...\napi_servers = http://controller:9292    \n    \n9.\u5728\u8be5[oslo_concurrency]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u9501\u5b9a\u8def\u5f84\uff1a\n[oslo_concurrency]\n# ...\nlock_path = /var/lib/nova/tmp    \n\n10.\u5728\u8be5[placement]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6ePlacement API\uff1a\n[placement]\n# ...\nregion_name = RegionOne\nproject_domain_name = Default\nproject_name = service\nauth_type = password\nuser_domain_name = Default\nauth_url = http://controller:5000/v3\nusername = placement\npassword = PLACEMENT_PASS\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/nova/nova.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/nova/nova.conf.bak >/etc/nova/nova.conf\nopenstack-config --set /etc/nova/nova.conf DEFAULT enabled_apis osapi_compute,metadata\nopenstack-config --set /etc/nova/nova.conf DEFAULT transport_url rabbit://openstack:RABBIT_PASS@controller\nopenstack-config --set /etc/nova/nova.conf DEFAULT my_ip 172.30.100.5\nopenstack-config --set /etc/nova/nova.conf DEFAULT use_neutron true\nopenstack-config --set /etc/nova/nova.conf DEFAULT firewall_driver nova.virt.firewall.NoopFirewallDriver\nopenstack-config --set /etc/nova/nova.conf api auth_strategy keystone\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken auth_url http://controller:5000/v3\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken memcached_servers controller:11211\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken auth_type password\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken project_domain_name Default\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken user_domain_name Default\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken project_name service\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken username nova\nopenstack-config --set /etc/nova/nova.conf keystone_authtoken password NOVA_PASS\nopenstack-config --set /etc/nova/nova.conf vnc enabled true\nopenstack-config --set /etc/nova/nova.conf vnc server_listen 0.0.0.0\nopenstack-config --set /etc/nova/nova.conf vnc server_proxyclient_address '$my_ip'\nopenstack-config --set /etc/nova/nova.conf vnc novncproxy_base_url http://controller:6080/vnc_auto.html\nopenstack-config --set /etc/nova/nova.conf glance api_servers http://controller:9292\nopenstack-config --set /etc/nova/nova.conf oslo_concurrency lock_path /var/lib/nova/tmp\nopenstack-config --set /etc/nova/nova.conf placement region_name RegionOne\nopenstack-config --set /etc/nova/nova.conf placement project_domain_name Default\nopenstack-config --set /etc/nova/nova.conf placement project_name service\nopenstack-config --set /etc/nova/nova.conf placement auth_type password\nopenstack-config --set /etc/nova/nova.conf placement user_domain_name Default\nopenstack-config --set /etc/nova/nova.conf placement auth_url http://controller:5000/v3\nopenstack-config --set /etc/nova/nova.conf placement username placement\nopenstack-config --set /etc/nova/nova.conf placement password PLACEMENT_PASS\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/nova/nova.conf\nfa0ddace12aaa14c6bcfe86b70efac24  /etc/nova/nova.conf\n"})}),"\n",(0,c.jsx)(n.h4,{id:"653-\u786e\u5b9a\u60a8\u7684\u8ba1\u7b97\u8282\u70b9\u662f\u5426\u652f\u6301\u865a\u62df\u673a\u7684\u786c\u4ef6\u52a0\u901f",children:"6.5.3 \u786e\u5b9a\u60a8\u7684\u8ba1\u7b97\u8282\u70b9\u662f\u5426\u652f\u6301\u865a\u62df\u673a\u7684\u786c\u4ef6\u52a0\u901f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ egrep -c '(vmx|svm)' /proc/cpuinfo\n2\n"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"\u5982\u679c\u6b64\u547d\u4ee4\u8fd4\u56de\u503c1\u6216\u66f4\u5927\uff0c\u5219\u8ba1\u7b97\u8282\u70b9\u652f\u6301\u786c\u4ef6\u52a0\u901f\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u5176\u4ed6\u914d\u7f6e\u3002\n\u5982\u679c\u6b64\u547d\u4ee4\u8fd4\u56de\u503c\u4e3a0\uff0c\u5219\u8ba1\u7b97\u8282\u70b9\u4e0d\u652f\u6301\u786c\u4ef6\u52a0\u901f\uff0c\u60a8\u5fc5\u987b\u5c06libvirt\u914d\u7f6e\u4e3a\u4f7f\u7528QEMU\u800c\u4e0d\u662fKVM\u3002"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack-config --set /etc/nova/nova.conf libvirt virt_type qemu\n"})}),"\n",(0,c.jsx)(n.h4,{id:"654-\u542f\u52a8compute\u670d\u52a1\u53ca\u5176\u4f9d\u8d56\u9879\u5e76\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u81ea\u52a8\u542f\u52a8",children:"6.5.4 \u542f\u52a8Compute\u670d\u52a1\u53ca\u5176\u4f9d\u8d56\u9879\uff0c\u5e76\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u81ea\u52a8\u542f\u52a8"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"systemctl enable libvirtd.service openstack-nova-compute.service\nsystemctl start libvirtd.service openstack-nova-compute.service\n"})}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u9a8c\u8bc1\u64cd\u4f5c\uff0c\u5728\u63a7\u5236\u8282\u70b9\u6267\u884c"}),"\n",(0,c.jsx)(n.h3,{id:"66-\u9a8c\u8bc1compute\u670d\u52a1\u7684\u8fd0\u884c",children:"6.6 \u9a8c\u8bc1Compute\u670d\u52a1\u7684\u8fd0\u884c"}),"\n",(0,c.jsx)(n.h4,{id:"661-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",children:"6.6.1 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"source /opt/admin-openrc\n"})}),"\n",(0,c.jsx)(n.h4,{id:"662-\u5217\u51fa\u670d\u52a1\u7ec4\u4ef6\u4ee5\u9a8c\u8bc1\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u6210\u529f\u542f\u52a8\u548c\u6ce8\u518c",children:"6.6.2 \u5217\u51fa\u670d\u52a1\u7ec4\u4ef6\u4ee5\u9a8c\u8bc1\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u6210\u529f\u542f\u52a8\u548c\u6ce8\u518c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack compute service list --service nova-compute\n+----+--------------+---------------------+------+---------+-------+----------------------------+\n| ID | Binary       | Host                | Zone | Status  | State | Updated At                 |\n+----+--------------+---------------------+------+---------+-------+----------------------------+\n|  6 | nova-compute | openstack-compute01 | nova | enabled | up    | 2021-11-04T07:29:47.000000 |\n+----+--------------+---------------------+------+---------+-------+----------------------------+\n"})}),"\n",(0,c.jsx)(n.h4,{id:"663-\u53d1\u73b0\u8ba1\u7b97\u4e3b\u673a",children:"6.6.3 \u53d1\u73b0\u8ba1\u7b97\u4e3b\u673a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ su -s /bin/sh -c \"nova-manage cell_v2 discover_hosts --verbose\" nova\nFound 2 cell mappings.\nSkipping cell0 since it does not contain hosts.\nGetting computes from cell 'cell1': 536383cb-03e4-48bb-bb77-4eeb1bfb9d80\nChecking host mapping for compute host 'compute1': 83452da0-a693-4860-bcd8-028743169f0f\nCreating host mapping for compute host 'compute1': 83452da0-a693-4860-bcd8-028743169f0f\nFound 1 unmapped computes in cell: 536383cb-03e4-48bb-bb77-4eeb1bfb9d80\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5230\u6b64\uff0c\u63a7\u5236\u8282\u70b9\u548c\u8ba1\u7b97\u8282\u70b9\u8ba1\u7b97\u670d\u52a1nova\u5b89\u88c5\u5b8c\u6210\uff01\uff01\uff01"})}),"\n",(0,c.jsx)(n.h2,{id:"7\u63a7\u5236\u8282\u70b9\u8ba1\u7b97\u8282\u70b9\u7f51\u7edc\u670d\u52a1neutron\u5b89\u88c5",children:"7.\u63a7\u5236\u8282\u70b9\u3001\u8ba1\u7b97\u8282\u70b9\u7f51\u7edc\u670d\u52a1neutron\u5b89\u88c5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"neutron\u76f8\u5173\u670d\u52a1"})}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u670d\u52a1\u540d"}),(0,c.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"neutron-server"})}),(0,c.jsx)(n.td,{children:"\u7aef\u53e3(9696)  api\t\u63a5\u53d7\u548c\u54cd\u5e94\u5916\u90e8\u7684\u7f51\u7edc\u7ba1\u7406\u8bf7\u6c42"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"neutron-linuxbridge-agent"})}),(0,c.jsx)(n.td,{children:"\u8d1f\u8d23\u521b\u5efa\u6865\u63a5\u7f51\u5361"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"neutron-dhcp-agent"})}),(0,c.jsx)(n.td,{children:"\u8d1f\u8d23\u5206\u914dIP"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"neutron-metadata-agent"}),(0,c.jsx)(n.td,{children:"\u914d\u5408nova-metadata-api\u5b9e\u73b0\u865a\u62df\u673a\u7684\u5b9a\u5236\u5316\u64cd\u4f5c"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"L3-agent"})}),(0,c.jsx)(n.td,{children:"\u5b9e\u73b0\u4e09\u5c42\u7f51\u7edc(\u7f51\u7edc\u5c42)"})]})]})]}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u5b89\u88c5\u548c\u914d\u7f6e\u63a7\u5236\u8282\u70b9"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/neutron/rocky/install/controller-install-rdo.html",children:"rocky\u7248\u63a7\u5236\u8282\u70b9\u7f51\u7edc\u670d\u52a1neutron\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsxs)(n.h3,{id:"71-\u521b\u5efaneutron\u6570\u636e\u5e93\u5e76\u6388\u6743",children:["7.1 \u521b\u5efa",(0,c.jsx)(n.code,{children:"neutron"}),"\u6570\u636e\u5e93\u5e76\u6388\u6743"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"mysql -e \"CREATE DATABASE neutron;\"\nmysql -e \"GRANT ALL PRIVILEGES ON neutron.* TO 'neutron'@'localhost' \\\nIDENTIFIED BY 'NEUTRON_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON neutron.* TO 'neutron'@'%' \\\nIDENTIFIED BY 'NEUTRON_DBPASS';\"\n"})}),"\n",(0,c.jsx)(n.h3,{id:"72-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650",children:"7.2 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee\u6743\u9650"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"source /opt/admin-openrc \n"})}),"\n",(0,c.jsx)(n.h3,{id:"73-\u521b\u5efa\u670d\u52a1\u51ed\u8bc1",children:"7.3 \u521b\u5efa\u670d\u52a1\u51ed\u8bc1"}),"\n",(0,c.jsxs)(n.h4,{id:"731-\u521b\u5efaneutron\u7528\u6237",children:["7.3.1 \u521b\u5efa",(0,c.jsx)(n.code,{children:"neutron"}),"\u7528\u6237"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5bc6\u7801\u8bbe\u7f6e\u4e3a ",(0,c.jsx)(n.code,{children:"NEUTRON_PASS"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u4ea4\u4e92\u5f0f\u4e0e\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801\u9009\u62e9\u5176\u4e2d\u4e00\u79cd"})}),"\n",(0,c.jsx)(n.p,{children:"\u975e\u4ea4\u4e92\u5f0f\u521b\u5efa\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack user create --domain default --password NEUTRON_PASS neutron\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | 014a7629fb0548899be31c87494e1156 |\n| name                | neutron                          |\n| options             | {}                               |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4ea4\u4e92\u5f0f\u521b\u5efa\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack user create --domain default --password-prompt neutron\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"732-\u5c06-admin-\u89d2\u8272\u6dfb\u52a0\u5230-neutron\u7528\u6237",children:["7.3.2 \u5c06 ",(0,c.jsx)(n.code,{children:"admin"})," \u89d2\u8272\u6dfb\u52a0\u5230 ",(0,c.jsx)(n.code,{children:"neutron"}),"\u7528\u6237"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"openstack role add --project service --user neutron admin\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"733-\u521b\u5efa-neutron-\u670d\u52a1\u5b9e\u4f53",children:["7.3.3 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"neutron"})," \u670d\u52a1\u5b9e\u4f53"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'$ openstack service create --name neutron \\\n--description "OpenStack Networking" network\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | OpenStack Networking             |\n| enabled     | True                             |\n| id          | 9e74ccbdaa85421894cf61c97f355dc7 |\n| name        | neutron                          |\n| type        | network                          |\n+-------------+----------------------------------+\n'})}),"\n",(0,c.jsx)(n.h3,{id:"74-\u521b\u5efa\u7f51\u7edc\u670d\u52a1api\u7aef\u70b9",children:"7.4 \u521b\u5efa\u7f51\u7edc\u670d\u52a1API\u7aef\u70b9"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack endpoint create --region RegionOne \\\nnetwork public http://controller:9696\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | abe8c37741934ade89308da46501ea03 |\n| interface    | public                           |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 9e74ccbdaa85421894cf61c97f355dc7 |\n| service_name | neutron                          |\n| service_type | network                          |\n| url          | http://controller:9696           |\n+--------------+----------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nnetwork internal http://controller:9696\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | 0c32f6cb44a74ec5b653ba79153e3d68 |\n| interface    | internal                         |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 9e74ccbdaa85421894cf61c97f355dc7 |\n| service_name | neutron                          |\n| service_type | network                          |\n| url          | http://controller:9696           |\n+--------------+----------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nnetwork admin http://controller:9696\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | d2c77ff079c94591bc8ea0b4e51be936 |\n| interface    | admin                            |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | 9e74ccbdaa85421894cf61c97f355dc7 |\n| service_name | neutron                          |\n| service_type | network                          |\n| url          | http://controller:9696           |\n+--------------+----------------------------------+\n"})}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u5b89\u88c5\u548c\u914d\u7f6e\u63a7\u5236\u8282\u70b9"}),"\n",(0,c.jsx)(n.h3,{id:"75-\u914d\u7f6e\u7f51\u7edc\u9009\u9879",children:"7.5 \u914d\u7f6e\u7f51\u7edc\u9009\u9879"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/neutron/rocky/install/controller-install-rdo.html",children:"\u5b98\u7f51\u5173\u4e8e\u4e24\u79cd\u7f51\u7edc\u7684\u8bf4\u660e"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u60a8\u53ef\u4ee5\u4f7f\u7528\u9009\u98791\u548c2\u8868\u793a\u7684\u4e24\u79cd\u4f53\u7cfb\u7ed3\u6784\u4e4b\u4e00\u6765\u90e8\u7f72\u7f51\u7edc\u670d\u52a1\u3002"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u9009\u98791\u90e8\u7f72\u4e86\u6700\u7b80\u5355\u7684\u67b6\u6784\uff0c\u8be5\u67b6\u6784\u4ec5\u652f\u6301\u5c06\u5b9e\u4f8b\u9644\u52a0\u5230\u63d0\u4f9b\u7a0b\u5e8f\uff08\u5916\u90e8\uff09\u7f51\u7edc\u3002\u6ca1\u6709\u81ea\u52a9\u670d\u52a1\uff08\u4e13\u7528\uff09\u7f51\u7edc\uff0c\u8def\u7531\u5668\u6216\u6d6e\u52a8IP\u5730\u5740\u3002\u53ea\u6709",(0,c.jsx)(n.code,{children:"admin"}),"\u6216\u5176\u4ed6\u7279\u6743\u7528\u6237\u53ef\u4ee5\u7ba1\u7406\u63d0\u4f9b\u5546\u7f51\u7edc\u3002"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u9009\u98792\u901a\u8fc7\u652f\u6301\u5c06\u5b9e\u4f8b\u9644\u52a0\u5230\u81ea\u52a9\u670d\u52a1\u7f51\u7edc\u7684\u7b2c3\u5c42\u670d\u52a1\u589e\u5f3a\u4e86\u9009\u98791\u3002\u8be5",(0,c.jsx)(n.code,{children:"demo"}),"\u975e\u7279\u6743\u7528\u6237\u6216\u5176\u4ed6\u975e\u7279\u6743\u7528\u6237\u53ef\u4ee5\u7ba1\u7406\u81ea\u52a9\u670d\u52a1\u7f51\u7edc\uff0c\u5305\u62ec\u5728\u81ea\u52a9\u670d\u52a1\u7f51\u7edc\u4e0e\u63d0\u4f9b\u5546\u7f51\u7edc\u4e4b\u95f4\u63d0\u4f9b\u8fde\u63a5\u7684\u8def\u7531\u5668\u3002\u6b64\u5916\uff0c\u6d6e\u52a8IP\u5730\u5740\u4f7f\u7528\u81ea\u52a9\u670d\u52a1\u7f51\u7edc\u4ece\u5916\u90e8\u7f51\u7edc\uff08\u4f8b\u5982Internet\uff09\u63d0\u4f9b\u5230\u5b9e\u4f8b\u7684\u8fde\u63a5\u3002"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u81ea\u52a9\u670d\u52a1\u7f51\u7edc\u901a\u5e38\u4f7f\u7528\u8986\u76d6\u7f51\u7edc\u3002\u8bf8\u5982VXLAN\u4e4b\u7c7b\u7684\u8986\u76d6\u7f51\u7edc\u534f\u8bae\u5305\u62ec\u5176\u4ed6\u6807\u5934\uff0c\u8fd9\u4e9b\u6807\u5934\u589e\u52a0\u4e86\u5f00\u9500\u5e76\u51cf\u5c11\u4e86\u53ef\u7528\u4e8e\u6709\u6548\u8d1f\u8f7d\u6216\u7528\u6237\u6570\u636e\u7684\u7a7a\u95f4\u3002\u5728\u4e0d\u4e86\u89e3\u865a\u62df\u7f51\u7edc\u57fa\u7840\u7ed3\u6784\u7684\u60c5\u51b5\u4e0b\uff0c\u5b9e\u4f8b\u5c1d\u8bd5\u4f7f\u7528\u9ed8\u8ba4\u76841500\u5b57\u8282\u4ee5\u592a\u7f51\u6700\u5927\u4f20\u8f93\u5355\u5143\uff08MTU\uff09\u53d1\u9001\u6570\u636e\u5305\u3002\u7f51\u7edc\u670d\u52a1\u4f1a\u901a\u8fc7DHCP\u81ea\u52a8\u4e3a\u5b9e\u4f8b\u63d0\u4f9b\u6b63\u786e\u7684MTU\u503c\u3002\u4f46\u662f\uff0c\u67d0\u4e9b\u4e91\u6620\u50cf\u4e0d\u4f7f\u7528DHCP\u6216\u5ffd\u7565DHCP MTU\u9009\u9879\uff0c\u800c\u662f\u9700\u8981\u4f7f\u7528\u5143\u6570\u636e\u6216\u811a\u672c\u8fdb\u884c\u914d\u7f6e\u3002"})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/neutron/rocky/install/controller-install-option1-rdo.html",children:"\u7f51\u7edc\u9009\u98791:\u63d0\u4f9b\u5546\u7f51\u7edc"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/neutron/rocky/install/controller-install-option2-rdo.html",children:"\u7f51\u7edc\u9009\u98792:\u81ea\u52a9\u670d\u52a1\u7f51\u7edc"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/neutron/rocky/install/controller-install-rdo.html#neutron-controller-metadata-agent-rdo",children:"\u4ee5\u4e0a\u4e24\u79cd\u7f51\u7edc\u4efb\u9009\u4e00\u79cd\u5b8c\u6210\u540e\u8fd4\u56de\u8fd9\u91cc\u914d\u7f6e\u5143\u6570\u636e\u4ee3\u7406"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u8fd9\u91cc\u9009\u62e9\u7f51\u8def\u9009\u98791"})}),"\n",(0,c.jsx)(n.h4,{id:"751-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"7.5.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-neutron openstack-neutron-ml2 \\\nopenstack-neutron-linuxbridge ebtables\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"752-\u7f16\u8f91-etcneutronneutronconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["7.5.2 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/neutron/neutron.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u8be5[database]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u6570\u636e\u5e93\u8bbf\u95ee\n[database]\n# ...\nconnection = mysql+pymysql://neutron:NEUTRON_DBPASS@controller/neutron\n    \n2.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u542f\u7528\u6a21\u5757\u5316\u7b2c2\u5c42\uff08ML2\uff09\u63d2\u4ef6\u5e76\u7981\u7528\u5176\u4ed6\u63d2\u4ef6\uff1a\n[DEFAULT]\n# ...\ncore_plugin = ml2\nservice_plugins =\n   \n3.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6eRabbitMQ \u6d88\u606f\u961f\u5217\u8bbf\u95ee\uff1a\n[DEFAULT]\n# ...\ntransport_url = rabbit://openstack:RABBIT_PASS@controller  \n    \n4.\u5728[DEFAULT]\u548c[keystone_authtoken]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8eab\u4efd\u670d\u52a1\u8bbf\u95ee\n[DEFAULT]\n# ...\nauth_strategy = keystone\n\n[keystone_authtoken]\n# ...\nwww_authenticate_uri = http://controller:5000\nauth_url = http://controller:5000\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = neutron\npassword = NEUTRON_PASS\n\n5.\u5728[DEFAULT]\u548c[nova]\u90e8\u5206\u4e2d\uff0c\u5c06\u7f51\u7edc\u914d\u7f6e\u4e3a\u901a\u77e5Compute\u7f51\u7edc\u62d3\u6251\u66f4\u6539\n[DEFAULT]\n# ...\nnotify_nova_on_port_status_changes = true\nnotify_nova_on_port_data_changes = true\n\n[nova]\n# ...\nauth_url = http://controller:5000\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nregion_name = RegionOne\nproject_name = service\nusername = nova\npassword = NOVA_PASS\n\n6.\u5728\u8be5[oslo_concurrency]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u9501\u5b9a\u8def\u5f84\n[oslo_concurrency]\n# ...\nlock_path = /var/lib/neutron/tmp\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/neutron/neutron.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/neutron/neutron.conf.bak >/etc/neutron/neutron.conf\nopenstack-config --set /etc/neutron/neutron.conf database connection mysql+pymysql://neutron:NEUTRON_DBPASS@controller/neutron\nopenstack-config --set /etc/neutron/neutron.conf DEFAULT core_plugin ml2   \nopenstack-config --set /etc/neutron/neutron.conf DEFAULT service_plugins\nopenstack-config --set /etc/neutron/neutron.conf DEFAULT transport_url rabbit://openstack:RABBIT_PASS@controller\nopenstack-config --set /etc/neutron/neutron.conf DEFAULT auth_strategy keystone\nopenstack-config --set /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_status_changes true\nopenstack-config --set /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_data_changes true\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken www_authenticate_uri http://controller:5000\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken www_authenticate_uri http://controller:5000\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_url http://controller:5000\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken memcached_servers controller:11211\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_type password\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_domain_name default\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken user_domain_name default\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_name service\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken username neutron\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken password NEUTRON_PASS\nopenstack-config --set /etc/neutron/neutron.conf nova auth_url http://controller:5000\nopenstack-config --set /etc/neutron/neutron.conf nova auth_type password\nopenstack-config --set /etc/neutron/neutron.conf nova project_domain_name default\nopenstack-config --set /etc/neutron/neutron.conf nova user_domain_name default\nopenstack-config --set /etc/neutron/neutron.conf nova region_name RegionOne\nopenstack-config --set /etc/neutron/neutron.conf nova project_name service\nopenstack-config --set /etc/neutron/neutron.conf nova username nova\nopenstack-config --set /etc/neutron/neutron.conf nova password NOVA_PASS\nopenstack-config --set /etc/neutron/neutron.conf oslo_concurrency lock_path /var/lib/neutron/tmp\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/neutron/neutron.conf\n1c4b4339f83596fa6bfdbec7a622a35e  /etc/neutron/neutron.conf\n"})}),"\n",(0,c.jsxs)(n.h3,{id:"76-\u7f16\u8f91-etcneutronpluginsml2ml2_confini-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["7.6 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/neutron/plugins/ml2/ml2_conf.ini"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"ML2\u63d2\u4ef6\u4f7f\u7528Linux\u6865\u63a5\u673a\u5236\u4e3a\u5b9e\u4f8b\u6784\u5efa\u7b2c2\u5c42\uff08\u6865\u63a5\u548c\u4ea4\u6362\uff09\u865a\u62df\u7f51\u7edc\u57fa\u7840\u67b6\u6784"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u672c[ml2]\u8282\u4e2d\uff0c\u542f\u7528\u5e73\u9762\u548cVLAN\u7f51\u7edc\n[ml2]\n# ...\ntype_drivers = flat,vlan\n\n2.\u5728\u8be5[ml2]\u90e8\u5206\u4e2d\uff0c\u7981\u7528\u81ea\u52a9\u670d\u52a1\u7f51\u7edc\uff1a\n[ml2]\n# ...\ntenant_network_types =\n\n3.\u5728\u672c[ml2]\u8282\u4e2d\uff0c\u542f\u7528Linux\u6865\u63a5\u673a\u5236\uff1a\n[ml2]\n# ...\nmechanism_drivers = linuxbridge\n\n4.\u5728\u6b64[ml2]\u90e8\u5206\u4e2d\uff0c\u542f\u7528\u7aef\u53e3\u5b89\u5168\u6269\u5c55\u9a71\u52a8\u7a0b\u5e8f\uff1a\n[ml2]\n# ...\nextension_drivers = port_security\n\n5.\u5728\u672c[ml2_type_flat]\u8282\u4e2d\uff0c\u5c06\u63d0\u4f9b\u8005\u865a\u62df\u7f51\u7edc\u914d\u7f6e\u4e3a\u5e73\u9762\u7f51\u7edc\uff1a\n[ml2_type_flat]\n# ...\nflat_networks = provider\n\n6.\u5728\u672c[securitygroup]\u8282\u4e2d\uff0c\u542f\u7528ipset\u4ee5\u63d0\u9ad8\u5b89\u5168\u7ec4\u89c4\u5219\u7684\u6548\u7387\uff1a\n[securitygroup]\n# ...\nenable_ipset = true\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/neutron/plugins/ml2/ml2_conf.ini{,.bak}\ngrep '^[a-Z\\[]' /etc/neutron/plugins/ml2/ml2_conf.ini.bak >/etc/neutron/plugins/ml2/ml2_conf.ini\nopenstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2 type_drivers flat,vlan\nopenstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2 tenant_network_types\nopenstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2 mechanism_drivers linuxbridge\nopenstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2 extension_drivers port_security\nopenstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini ml2_type_flat flat_networks provider\nopenstack-config --set /etc/neutron/plugins/ml2/ml2_conf.ini securitygroup enable_ipset true\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/neutron/plugins/ml2/ml2_conf.ini\neb38c10cfd26c1cc308a050c9a5d8aa1  /etc/neutron/plugins/ml2/ml2_conf.ini\n"})}),"\n",(0,c.jsx)(n.h3,{id:"77-\u914d\u7f6elinux\u6865\u63a5\u4ee3\u7406",children:"7.7 \u914d\u7f6elinux\u6865\u63a5\u4ee3\u7406"}),"\n",(0,c.jsxs)(n.h4,{id:"771-\u7f16\u8f91etcneutronpluginsml2linuxbridge_agentini\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["7.7.1 \u7f16\u8f91",(0,c.jsx)(n.code,{children:"/etc/neutron/plugins/ml2/linuxbridge_agent.ini"}),"\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Linux\u7f51\u6865\u4ee3\u7406\u4e3a\u5b9e\u4f8b\u6784\u5efa\u7b2c2\u5c42\uff08\u6865\u63a5\u548c\u4ea4\u6362\uff09\u865a\u62df\u7f51\u7edc\u57fa\u7840\u67b6\u6784\u5e76\u5904\u7406\u5b89\u5168\u7ec4"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u672c[linux_bridge]\u8282\u4e2d\uff0c\u5c06\u63d0\u4f9b\u8005\u865a\u62df\u7f51\u7edc\u6620\u5c04\u5230\u63d0\u4f9b\u8005\u7269\u7406\u7f51\u7edc\u63a5\u53e3\uff1a\n[linux_bridge]\nphysical_interface_mappings = provider:PROVIDER_INTERFACE_NAME\n\u66ff\u6362PROVIDER_INTERFACE_NAME\u4e3a\u57fa\u7840\u63d0\u4f9b\u5546\u7269\u7406\u7f51\u7edc\u63a5\u53e3\u7684\u540d\u79f0\u3002\u8fd9\u91cc\u662feth0\n\n2.\u5728\u8be5[vxlan]\u90e8\u5206\u4e2d\uff0c\u7981\u7528VXLAN\u8986\u76d6\u7f51\u7edc\uff1a\n[vxlan]\nenable_vxlan = false\n\n3.\u5728\u8be5[securitygroup]\u90e8\u5206\u4e2d\uff0c\u542f\u7528\u5b89\u5168\u7ec4\u5e76\u914d\u7f6eLinux\u7f51\u6865iptables\u9632\u706b\u5899\u9a71\u52a8\u7a0b\u5e8f\uff1a\n[securitygroup]\n# ...\nenable_security_group = true\nfirewall_driver = neutron.agent.linux.iptables_firewall.IptablesFirewallDriver\n\u901a\u8fc7\u9a8c\u8bc1\u4ee5\u4e0b\u6240\u6709sysctl\u503c\u662f\u5426\u8bbe\u7f6e\u4e3a\u786e\u4fddLinux\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u652f\u6301\u7f51\u6865\u8fc7\u6ee4\u56681\uff1a\n\nnet.bridge.bridge-nf-call-iptables\nnet.bridge.bridge-nf-call-ip6tables\n\u8981\u542f\u7528\u7f51\u7edc\u6865\u63a5\u5668\u652f\u6301\uff0c\u901a\u5e38br_netfilter\u9700\u8981\u52a0\u8f7d\u5185\u6838\u6a21\u5757\u3002\u67e5\u770b\u64cd\u4f5c\u7cfb\u7edf\u7684\u6587\u6863\uff0c\u4ee5\u83b7\u53d6\u6709\u5173\u542f\u7528\u6b64\u6a21\u5757\u7684\u5176\u4ed6\u8be6\u7ec6\u4fe1\u606f\u3002\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/neutron/plugins/ml2/linuxbridge_agent.ini{,.bak}\ngrep '^[a-Z\\[]' /etc/neutron/plugins/ml2/linuxbridge_agent.ini.bak >/etc/neutron/plugins/ml2/linuxbridge_agent.ini\nopenstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini linux_bridge physical_interface_mappings  provider:eth0\nopenstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan enable_vxlan false  \nopenstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup enable_security_group true\nopenstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup firewall_driver neutron.agent.linux.iptables_firewall.IptablesFirewallDriver\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/neutron/plugins/ml2/linuxbridge_agent.ini\n794b19995c83e2fc0c3fd42f506904f1  /etc/neutron/plugins/ml2/linuxbridge_agent.ini\n"})}),"\n",(0,c.jsx)(n.h4,{id:"772-\u4f7flinux\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u652f\u6301\u7f51\u6865\u8fc7\u6ee4\u56681",children:"7.7.2 \u4f7fLinux\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u652f\u6301\u7f51\u6865\u8fc7\u6ee4\u56681"}),"\n",(0,c.jsxs)(n.p,{children:["\u5411 ",(0,c.jsx)(n.code,{children:"/etc/sysctl.d/openstack-rocky-bridge.conf"})," \u5199\u5165\u4ee5\u4e0b\u5185\u5bb9"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"cat >> /etc/sysctl.d/openstack-rocky-bridge.conf <<EOF\nnet.bridge.bridge-nf-call-iptables = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nEOF\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u751f\u6548"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ modprobe br_netfilter && sysctl -p /etc/sysctl.d/openstack-rocky-bridge.conf \nnet.bridge.bridge-nf-call-iptables = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\n"})}),"\n",(0,c.jsx)(n.h3,{id:"78-\u914d\u7f6edhcp\u4ee3\u7406",children:"7.8 \u914d\u7f6eDHCP\u4ee3\u7406"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"DHCP\u4ee3\u7406\u4e3a\u865a\u62df\u7f51\u7edc\u63d0\u4f9bDHCP\u670d\u52a1"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/neutron/dhcp_agent.ini"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"\u5728\u672c[DEFAULT]\u8282\u4e2d\uff0c\u914d\u7f6eLinux\u6865\u63a5\u53e3\u9a71\u52a8\u7a0b\u5e8fDnsmasq DHCP\u9a71\u52a8\u7a0b\u5e8f\uff0c\u5e76\u542f\u7528\u9694\u79bb\u7684\u5143\u6570\u636e\uff0c\u4ee5\u4fbf\u63d0\u4f9b\u5546\u7f51\u7edc\u4e0a\u7684\u5b9e\u4f8b\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u5143\u6570\u636e\n[DEFAULT]\n# ...\ninterface_driver = linuxbridge\ndhcp_driver = neutron.agent.linux.dhcp.Dnsmasq\nenable_isolated_metadata = true\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/neutron/dhcp_agent.ini{,.bak} \ngrep '^[a-Z\\[]' /etc/neutron/dhcp_agent.ini.bak >/etc/neutron/dhcp_agent.ini \nopenstack-config --set /etc/neutron/dhcp_agent.ini DEFAULT interface_driver linuxbridge\nopenstack-config --set /etc/neutron/dhcp_agent.ini DEFAULT dhcp_driver neutron.agent.linux.dhcp.Dnsmasq\nopenstack-config --set /etc/neutron/dhcp_agent.ini DEFAULT enable_isolated_metadata true\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/neutron/dhcp_agent.ini\n33a1e93e1853796070d5da0773496665  /etc/neutron/dhcp_agent.ini \n"})}),"\n",(0,c.jsx)(n.h3,{id:"79-\u914d\u7f6e\u5143\u6570\u636e\u4ee3\u7406",children:"7.9 \u914d\u7f6e\u5143\u6570\u636e\u4ee3\u7406"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u6240\u8ff0\u5143\u6570\u636e\u4ee3\u7406\u63d0\u4f9b\u914d\u7f6e\u4fe1\u606f\u7684\u8bf8\u5982\u51ed\u636e\u5b9e\u4f8b\u3002"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/neutron/metadata_agent.ini"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u5143\u6570\u636e\u4e3b\u673a\u548c\u5171\u4eab\u673a\u5bc6\uff1a\n[DEFAULT]\n# ...\nnova_metadata_host = controller\nmetadata_proxy_shared_secret = METADATA_SECRET\n\u66ff\u6362METADATA_SECRET\u4e3a\u5143\u6570\u636e\u4ee3\u7406\u7684\u9002\u5f53\u673a\u5bc6\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/neutron/metadata_agent.ini{,.bak}\ngrep '^[a-Z\\[]' /etc/neutron/metadata_agent.ini.bak >/etc/neutron/metadata_agent.ini\nopenstack-config --set /etc/neutron/metadata_agent.ini DEFAULT nova_metadata_host controller\nopenstack-config --set /etc/neutron/metadata_agent.ini DEFAULT metadata_proxy_shared_secret METADATA_SECRET\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/neutron/metadata_agent.ini\ne8b90a011b94fece31d33edfd8bc72b6  /etc/neutron/metadata_agent.ini\n"})}),"\n",(0,c.jsx)(n.h3,{id:"710-\u914d\u7f6e\u8ba1\u7b97\u4ee5\u4f7f\u7528\u7f51\u7edc",children:"7.10 \u914d\u7f6e\u8ba1\u7b97\u4ee5\u4f7f\u7528\u7f51\u7edc"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/nova/nova.conf"})," \u6587\u4ef6\u5e76\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"\u5728\u8be5[neutron]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8bbf\u95ee\u53c2\u6570\uff0c\u542f\u7528\u5143\u6570\u636e\u4ee3\u7406\uff0c\u5e76\u914d\u7f6e\u673a\u5bc6\uff1a\n\n[neutron]\n# ...\nurl = http://controller:9696\nauth_url = http://controller:5000\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nregion_name = RegionOne\nproject_name = service\nusername = neutron\npassword = NEUTRON_PASS\nservice_metadata_proxy = true\nmetadata_proxy_shared_secret = METADATA_SECRET\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack-config --set /etc/nova/nova.conf neutron url http://controller:9696\nopenstack-config --set /etc/nova/nova.conf neutron auth_url http://controller:5000\nopenstack-config --set /etc/nova/nova.conf neutron auth_type password\nopenstack-config --set /etc/nova/nova.conf neutron project_domain_name default\nopenstack-config --set /etc/nova/nova.conf neutron user_domain_name default\nopenstack-config --set /etc/nova/nova.conf neutron region_name RegionOne\nopenstack-config --set /etc/nova/nova.conf neutron project_name service\nopenstack-config --set /etc/nova/nova.conf neutron username neutron\nopenstack-config --set /etc/nova/nova.conf neutron password NEUTRON_PASS\nopenstack-config --set /etc/nova/nova.conf neutron service_metadata_proxy true\nopenstack-config --set /etc/nova/nova.conf neutron metadata_proxy_shared_secret METADATA_SECRET\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/nova/nova.conf\n81feca9d18ee91397cc973d455bfa271  /etc/nova/nova.conf\n"})}),"\n",(0,c.jsx)(n.h3,{id:"711-\u5b8c\u6210\u5b89\u88c5",children:"7.11 \u5b8c\u6210\u5b89\u88c5"}),"\n",(0,c.jsx)(n.h4,{id:"7111-\u521b\u5efa\u94fe\u63a5\u6587\u4ef6",children:"7.11.1 \u521b\u5efa\u94fe\u63a5\u6587\u4ef6"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u7f51\u7edc\u670d\u52a1\u521d\u59cb\u5316\u811a\u672c\u9700\u8981 ",(0,c.jsx)(n.code,{children:"/etc/neutron/plugin.ini"})," \u6307\u5411ML2\u63d2\u4ef6\u914d\u7f6e\u6587\u4ef6\u7684\u7b26\u53f7\u94fe\u63a5 ",(0,c.jsx)(n.code,{children:"/etc/neutron/plugins/ml2/ml2_conf.ini"}),"\u3002\u5982\u679c\u6b64\u7b26\u53f7\u94fe\u63a5\u4e0d\u5b58\u5728\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u5b83"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"ln -s /etc/neutron/plugins/ml2/ml2_conf.ini /etc/neutron/plugin.ini\n"})}),"\n",(0,c.jsx)(n.h4,{id:"7112-\u540c\u6b65\u6570\u636e\u5e93\u6700\u540e\u63d0\u793aok\u5373\u4e3a\u6b63\u786e",children:"7.11.2 \u540c\u6b65\u6570\u636e\u5e93\uff0c\u6700\u540e\u63d0\u793aOK\u5373\u4e3a\u6b63\u786e"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'su -s /bin/sh -c "neutron-db-manage --config-file /etc/neutron/neutron.conf \\\n--config-file /etc/neutron/plugins/ml2/ml2_conf.ini upgrade head" neutron\n'})}),"\n",(0,c.jsx)(n.h4,{id:"7113-\u91cd\u65b0\u542f\u52a8compute-api\u670d\u52a1",children:"7.11.3 \u91cd\u65b0\u542f\u52a8Compute API\u670d\u52a1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl restart openstack-nova-api.service\n"})}),"\n",(0,c.jsx)(n.h4,{id:"7114-\u542f\u52a8\u7f51\u7edc\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",children:"7.11.4 \u542f\u52a8\u7f51\u7edc\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5bf9\u4e8e\u5b98\u7f51\u4e2d\u7684\u4e24\u79cd\u7f51\u7edc\uff0c\u8fd9\u91cc\u9009\u62e9\u7684\u662f\u7b2c\u4e00\u79cd\u7f51\u7edc"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable neutron-server.service \\\nneutron-linuxbridge-agent.service neutron-dhcp-agent.service \\\nneutron-metadata-agent.service\n\nsystemctl start neutron-server.service \\\nneutron-linuxbridge-agent.service neutron-dhcp-agent.service \\\nneutron-metadata-agent.service\n"})}),"\n",(0,c.jsx)(n.h4,{id:"7115-\u9a8c\u8bc1",children:"7.11.5 \u9a8c\u8bc1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"# \u542f\u52a8\u670d\u52a1\u540e\u63d0\u793a\u5982\u4e0b\u5373\u4e3a\u6b63\u786e\uff0calive\u5904\u90fd\u4e3a\u7b11\u8138     \n$ neutron agent-list\nneutron CLI is deprecated and will be removed in the future. Use openstack CLI instead.\n+--------------------------------------+--------------------+------------+-------------------+-------+----------------+---------------------------+\n| id                                   | agent_type         | host       | availability_zone | alive | admin_state_up | binary                    |\n+--------------------------------------+--------------------+------------+-------------------+-------+----------------+---------------------------+\n| beffcac6-745e-449f-bad8-7f2e4fa973f2 | Linux bridge agent | controller |                   | :-)   | True           | neutron-linuxbridge-agent |\n+--------------------------------------+--------------------+------------+-------------------+-------+----------------+---------------------------+\n"})}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u5b89\u88c5\u548c\u914d\u7f6e\u8ba1\u7b97\u8282\u70b9"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/neutron/rocky/install/compute-install-rdo.html",children:"rocky\u7248\u8ba1\u7b97\u8282\u70b9\u7f51\u7edc\u670d\u52a1neutron\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.h3,{id:"712-\u5b89\u88c5\u5305",children:"7.12 \u5b89\u88c5\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-neutron-linuxbridge ebtables ipset openstack-utils\n"})}),"\n",(0,c.jsx)(n.h3,{id:"713-\u914d\u7f6e\u516c\u5171\u7ec4\u4ef6",children:"7.13 \u914d\u7f6e\u516c\u5171\u7ec4\u4ef6"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/neutron/neutron.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6eRabbitMQ \u6d88\u606f\u961f\u5217\u8bbf\u95ee\uff1a\n[DEFAULT]\n# ...\ntransport_url = rabbit://openstack:RABBIT_PASS@controller\n    \n2.\u5728[DEFAULT]\u548c[keystone_authtoken]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8eab\u4efd\u670d\u52a1\u8bbf\u95ee\uff1a\n[DEFAULT]\n# ...\nauth_strategy = keystone\n\n[keystone_authtoken]\n# ...\nwww_authenticate_uri = http://controller:5000\nauth_url = http://controller:5000\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = neutron\npassword = NEUTRON_PASS\n\n3.\u5728\u8be5[oslo_concurrency]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u9501\u5b9a\u8def\u5f84\uff1a\n[oslo_concurrency]\n# ...\nlock_path = /var/lib/neutron/tmp\n\n#\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539\n\\cp /etc/neutron/neutron.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/neutron/neutron.conf.bak >/etc/neutron/neutron.conf\nopenstack-config --set /etc/neutron/neutron.conf DEFAULT transport_url rabbit://openstack:RABBIT_PASS@controller\nopenstack-config --set /etc/neutron/neutron.conf DEFAULT auth_strategy keystone\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken www_authenticate_uri http://controller:5000\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_url http://controller:5000\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken memcached_servers controller:11211\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_type password\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_domain_name default\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken user_domain_name default\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_name service\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken username neutron\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken password NEUTRON_PASS\nopenstack-config --set /etc/neutron/neutron.conf oslo_concurrency lock_path /var/lib/neutron/tmp\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/neutron/neutron.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/neutron/neutron.conf.bak >/etc/neutron/neutron.conf\nopenstack-config --set /etc/neutron/neutron.conf DEFAULT transport_url rabbit://openstack:RABBIT_PASS@controller\nopenstack-config --set /etc/neutron/neutron.conf DEFAULT auth_strategy keystone\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken www_authenticate_uri http://controller:5000\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_url http://controller:5000\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken memcached_servers controller:11211\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken auth_type password\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_domain_name default\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken user_domain_name default\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken project_name service\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken username neutron\nopenstack-config --set /etc/neutron/neutron.conf keystone_authtoken password NEUTRON_PASS\nopenstack-config --set /etc/neutron/neutron.conf oslo_concurrency lock_path /var/lib/neutron/tmp\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/neutron/neutron.conf\n9c47ffb59b23516b59e7de84a39bcbe8  /etc/neutron/neutron.conf\n"})}),"\n",(0,c.jsx)(n.h3,{id:"714-\u914d\u7f6e\u7f51\u7edc\u9009\u9879",children:"7.14 \u914d\u7f6e\u7f51\u7edc\u9009\u9879"}),"\n",(0,c.jsx)(n.h4,{id:"7141-\u914d\u7f6e\u6865\u63a5\u4ee3\u7406",children:"7.14.1 \u914d\u7f6e\u6865\u63a5\u4ee3\u7406"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Linux\u7f51\u6865\u4ee3\u7406\u4e3a\u5b9e\u4f8b\u6784\u5efa\u7b2c2\u5c42\uff08\u6865\u63a5\u548c\u4ea4\u6362\uff09\u865a\u62df\u7f51\u7edc\u57fa\u7840\u7ed3\u6784\u5e76\u5904\u7406\u5b89\u5168\u7ec4"})}),"\n",(0,c.jsxs)(n.h5,{id:"71411-\u7f16\u8f91-etcneutronpluginsml2linuxbridge_agentini-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["7.14.1.1 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/neutron/plugins/ml2/linuxbridge_agent.ini"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u672c[linux_bridge]\u8282\u4e2d\uff0c\u5c06\u63d0\u4f9b\u8005\u865a\u62df\u7f51\u7edc\u6620\u5c04\u5230\u63d0\u4f9b\u8005\u7269\u7406\u7f51\u7edc\u63a5\u53e3\uff1a\n[linux_bridge]\nphysical_interface_mappings = provider:PROVIDER_INTERFACE_NAME\n\u66ff\u6362PROVIDER_INTERFACE_NAME\u4e3a\u57fa\u7840\u63d0\u4f9b\u5546\u7269\u7406\u7f51\u7edc\u63a5\u53e3\u7684\u540d\u79f0\u3002\u8fd9\u91cc\u4e3aeth0\n\n2.\u5728\u8be5[vxlan]\u90e8\u5206\u4e2d\uff0c\u7981\u7528VXLAN\u8986\u76d6\u7f51\u7edc\uff1a\n[vxlan]\nenable_vxlan = false\n\n3.\u5728\u8be5[securitygroup]\u90e8\u5206\u4e2d\uff0c\u542f\u7528\u5b89\u5168\u7ec4\u5e76\u914d\u7f6eLinux\u7f51\u6865iptables\u9632\u706b\u5899\u9a71\u52a8\u7a0b\u5e8f\uff1a\n[securitygroup]\n# ...\nenable_security_group = true\nfirewall_driver = neutron.agent.linux.iptables_firewall.IptablesFirewallDriver\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/neutron/plugins/ml2/linuxbridge_agent.ini{,.bak} \ngrep '^[a-Z\\[]' /etc/neutron/plugins/ml2/linuxbridge_agent.ini.bak >/etc/neutron/plugins/ml2/linuxbridge_agent.ini \nopenstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini linux_bridge physical_interface_mappings provider:eth0\nopenstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan enable_vxlan false\nopenstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup enable_security_group true\nopenstack-config --set /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup firewall_driver neutron.agent.linux.iptables_firewall.IptablesFirewallDriver\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/neutron/plugins/ml2/linuxbridge_agent.ini\n794b19995c83e2fc0c3fd42f506904f1  /etc/neutron/plugins/ml2/linuxbridge_agent.ini\n"})}),"\n",(0,c.jsx)(n.h5,{id:"71412-\u4f7flinux\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u652f\u6301\u7f51\u6865\u8fc7\u6ee4\u56681",children:"7.14.1.2 \u4f7fLinux\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u652f\u6301\u7f51\u6865\u8fc7\u6ee4\u56681"}),"\n",(0,c.jsxs)(n.p,{children:["\u5411 ",(0,c.jsx)(n.code,{children:"/etc/sysctl.d/openstack-rocky-bridge.conf"})," \u5199\u5165\u4ee5\u4e0b\u5185\u5bb9"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"cat >> /etc/sysctl.d/openstack-rocky-bridge.conf <<EOF\nnet.bridge.bridge-nf-call-iptables = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nEOF\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u751f\u6548"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ modprobe br_netfilter && sysctl -p /etc/sysctl.d/openstack-rocky-bridge.conf \nnet.bridge.bridge-nf-call-iptables = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\n"})}),"\n",(0,c.jsx)(n.h4,{id:"7142-\u914d\u7f6e\u8ba1\u7b97\u4ee5\u4f7f\u7528\u7f51\u7edc",children:"7.14.2 \u914d\u7f6e\u8ba1\u7b97\u4ee5\u4f7f\u7528\u7f51\u7edc"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/nova/nova.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"\u5728\u8be5[neutron]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8bbf\u95ee\u53c2\u6570\uff1a\n[neutron]\n# ...\nurl = http://controller:9696\nauth_url = http://controller:5000\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nregion_name = RegionOne\nproject_name = service\nusername = neutron\npassword = NEUTRON_PASS\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack-config --set /etc/nova/nova.conf neutron url http://controller:9696\nopenstack-config --set /etc/nova/nova.conf neutron auth_url http://controller:5000\nopenstack-config --set /etc/nova/nova.conf neutron auth_type password\nopenstack-config --set /etc/nova/nova.conf neutron project_domain_name default\nopenstack-config --set /etc/nova/nova.conf neutron user_domain_name default\nopenstack-config --set /etc/nova/nova.conf neutron region_name RegionOne\nopenstack-config --set /etc/nova/nova.conf neutron project_name service\nopenstack-config --set /etc/nova/nova.conf neutron username neutron\nopenstack-config --set /etc/nova/nova.conf neutron password NEUTRON_PASS\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/nova/nova.conf\n9b96b21ae709f89c96cc559018ba7058  /etc/nova/nova.conf\n"})}),"\n",(0,c.jsx)(n.h3,{id:"715-\u5b8c\u6210\u5b89\u88c5",children:"7.15 \u5b8c\u6210\u5b89\u88c5"}),"\n",(0,c.jsx)(n.h4,{id:"7151-\u91cd\u65b0\u542f\u52a8compute\u670d\u52a1",children:"7.15.1 \u91cd\u65b0\u542f\u52a8Compute\u670d\u52a1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl restart openstack-nova-compute.service\n"})}),"\n",(0,c.jsx)(n.h4,{id:"7152-\u542f\u52a8linux\u7f51\u6865\u4ee3\u7406\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",children:"7.15.2 \u542f\u52a8Linux\u7f51\u6865\u4ee3\u7406\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable neutron-linuxbridge-agent.service\nsystemctl start neutron-linuxbridge-agent.service\n"})}),"\n",(0,c.jsx)(n.h3,{id:"716-\u9a8c\u8bc1",children:"7.16 \u9a8c\u8bc1"}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u63a7\u5236\u8282\u70b9\u6267\u884c"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u8f93\u51fa\u5e94\u6307\u793a\u63a7\u5236\u5668\u8282\u70b9\u4e0a\u7684\u4e09\u4e2a\u4ee3\u7406\uff0c\u6bcf\u4e2a\u8ba1\u7b97\u8282\u70b9\u4e0a\u7684\u4e00\u4e2a\u4ee3\u7406"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack network agent list\n+--------------------------------------+--------------------+------------+-------------------+-------+-------+---------------------------+\n| ID                                   | Agent Type         | Host       | Availability Zone | Alive | State | Binary                    |\n+--------------------------------------+--------------------+------------+-------------------+-------+-------+---------------------------+\n| 42cfe05b-0a9c-40ce-8f99-06ba76938c50 | Linux bridge agent | controller | None              | :-)   | UP    | neutron-linuxbridge-agent |\n| 749cb43f-a5db-4918-a3f5-8765e92e851c | DHCP agent         | controller | nova              | :-)   | UP    | neutron-dhcp-agent        |\n| 856ecf5f-6018-4ac4-a66b-f6f88784db0e | Metadata agent     | controller | None              | :-)   | UP    | neutron-metadata-agent    |\n| b5c2309c-fefc-46d0-b98e-37b05861095c | Linux bridge agent | compute1   | None              | :-)   | UP    | neutron-linuxbridge-agent |\n+--------------------------------------+--------------------+------------+-------------------+-------+-------+---------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5230\u6b64\uff0c\u63a7\u5236\u8282\u70b9\u3001\u8ba1\u7b97\u8282\u70b9\u7f51\u7edc\u670d\u52a1neutron\u5b89\u88c5\u5b8c\u6210\uff01\uff01\uff01"})}),"\n",(0,c.jsx)(n.h2,{id:"8\u63a7\u5236\u8282\u70b9horizon-web\u754c\u9762dashboard\u5b89\u88c5",children:"8.\u63a7\u5236\u8282\u70b9horizon web\u754c\u9762Dashboard\u5b89\u88c5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/horizon/rocky/install/install-rdo.html",children:"rocky\u7248\u63a7\u5236\u8282\u70b9horizon web\u8282\u70b9dashboard\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/horizon/rocky/install/plugin-registry.html",children:"horizon\u63d2\u4ef6\u6ce8\u518c\u8868\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.h3,{id:"81-\u5b89\u88c5\u5305",children:"8.1 \u5b89\u88c5\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-dashboard\n"})}),"\n",(0,c.jsxs)(n.h3,{id:"82-\u7f16\u8f91-etcopenstack-dashboardlocal_settings-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["8.2 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/openstack-dashboard/local_settings"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u56e0\u4e3a\u6709\u4e00\u4e9b\u5185\u5bb9\u662f\u5220\u9664\u4e4b\u540e\u7c98\u8d34\u7684\uff0c\u6240\u4ee5\u4e00\u4e9b\u884c\u6570\u5e76\u4e0d\u662f\u5f88\u51c6\u786e\uff0c\u4f46\u662f\u884c\u6570\u8bef\u5dee\u4e0d\u8d85\u8fc73\u884c"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u914d\u7f6e\u4eea\u8868\u677f\u4ee5\u5728controller\u8282\u70b9\u4e0a\u4f7f\u7528OpenStack\u670d\u52a1 \uff1a\n184\u884c\tOPENSTACK_HOST = \"127.0.0.1\"\n\u4fee\u6539\u4e3a\tOPENSTACK_HOST = \"controller\"\n\n2.\u5141\u8bb8\u4e3b\u673a\u8bbf\u95ee\u4eea\u8868\u677f\uff1a\nALLOWED_HOSTS\u4e5f\u53ef\u4ee5\u662f['*']\u4ee5\u63a5\u53d7\u6240\u6709\u4e3b\u673a\u3002\u8fd9\u5bf9\u4e8e\u5f00\u53d1\u5de5\u4f5c\u53ef\u80fd\u6709\u7528\uff0c\u4f46\u662f\u53ef\u80fd\u4e0d\u5b89\u5168\uff0c\u56e0\u6b64\u4e0d\u5e94\u5728\u751f\u4ea7\u4e2d\u4f7f\u7528\u3002\u6709\u5173 \u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 https://docs.djangoproject.com/en/dev/ref/settings/#allowed-hosts\u3002\n38\u884c\tALLOWED_HOSTS = ['one.example.com', 'two.example.com']\n\u4fee\u6539\u4e3a\tALLOWED_HOSTS = ['*', ]\n\n3.\u914d\u7f6ememcached\u4f1a\u8bdd\u5b58\u50a8\u670d\u52a1\uff1a\n161\u884c\uff0cCACHES\u4e0a\u52a0\u4e00\u884c SESSION_ENGINE\uff0c\u5e76\u4e14\u4fee\u6539\u4e3a\u5982\u4e0b\u5185\u5bb9\nSESSION_ENGINE = 'django.contrib.sessions.backends.cache'\n\nCACHES = {\n    'default': {\n         'BACKEND': 'django.core.cache.backends.memcached.MemcachedCache',\n         'LOCATION': 'controller:11211',\n    }\n}\n\n4.\u542f\u7528\u8eab\u4efdAPI\u7248\u672c3\uff1a\n187\u884c\uff0c\u4e0d\u7528\u4fee\u6539\nOPENSTACK_KEYSTONE_URL = \"http://%s:5000/v3\" % OPENSTACK_HOST\n\n5.\u542f\u7528\u5bf9\u57df\u7684\u652f\u6301\uff1a\n75\u884c\t#OPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT = False\n\u4fee\u6539\u4e3a\tOPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT = True\n\n6.\u914d\u7f6eAPI\u7248\u672c\uff1a\n64\u884c\uff0c\u539f\u5148\u4e3a\u6ce8\u91ca\uff0c\n#OPENSTACK_API_VERSIONS = {\n#    \"data-processing\": 1.1,\n#    \"identity\": 3,\n#    \"image\": 2,\n#    \"volume\": 2,\n#    \"compute\": 2,\n#}\n\n\u4fee\u6539\u4e3a\u5982\u4e0b\nOPENSTACK_API_VERSIONS = {\n    \"identity\": 3,\n    \"image\": 2,\n    \"volume\": 2,\n}\n\n7.\u914d\u7f6eDefault\u4e3a\u901a\u8fc7\u4eea\u8868\u677f\u521b\u5efa\u7684\u7528\u6237\u7684\u9ed8\u8ba4\u57df\uff1a\n95\u884c\t#OPENSTACK_KEYSTONE_DEFAULT_DOMAIN = 'Default'\n\u4fee\u6539\u4e3a\tOPENSTACK_KEYSTONE_DEFAULT_DOMAIN = \"Default\"\n\n8.\u914d\u7f6euser\u4e3a\u901a\u8fc7\u4eea\u8868\u677f\u521b\u5efa\u7684\u7528\u6237\u7684\u9ed8\u8ba4\u89d2\u8272\uff1a\n186\u884c\tOPENSTACK_KEYSTONE_DEFAULT_ROLE = \"_member_\"\n\u4fee\u6539\u4e3a\tOPENSTACK_KEYSTONE_DEFAULT_ROLE = \"user\"\n\n9.\u5982\u679c\u9009\u62e9\u7f51\u7edc\u9009\u98791\uff0c\u8bf7\u7981\u7528\u5bf9\u7b2c3\u5c42\u7f51\u7edc\u670d\u52a1\u7684\u652f\u6301\uff1a\n324\u884c\nOPENSTACK_NEUTRON_NETWORK = {\n    'enable_router': True,\n    'enable_quotas': True,\n    'enable_ipv6': True,\n    'enable_distributed_router': False,\n    'enable_ha_router': False,\n    'enable_fip_topology_check': True,\n  \n\u4fee\u6539\u4e3a\u5982\u4e0b  \nOPENSTACK_NEUTRON_NETWORK = {\n    'enable_router': False,\n    'enable_quotas': False,\n    'enable_distributed_router': False,\n    'enable_ha_router': False,\n    'enable_lb': False,\n    'enable_firewall': False,\n    'enable_vpn': False,\n    'enable_fip_topology_check': False,\n\n10.\u914d\u7f6e\u65f6\u533a\uff1a\n467\u884c\tTIME_ZONE = \"TIME_ZONE\"  \n\u4fee\u6539\u4e3a\tTIME_ZONE = \"Asia/Shanghai\"  \n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5907\u4efd\u4e00\u4e0b\u6587\u4ef6"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"\\cp /etc/openstack-dashboard/local_settings{,.bak}\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u91c7\u7528 ",(0,c.jsx)(n.code,{children:"cat EOF"})," \u65b9\u5f0f\u53ef\u80fd\u4f1a\u6709\u683c\u5f0f\u95ee\u9898\uff0c\u56e0\u4e3a\u6587\u4ef6\u5185\u5bb9\u592a\u591a\u4e86\uff0c\u8fd9\u91cc\u5fc5\u987b\u4f7f\u7528vi\u6253\u5f00\u6587\u4ef6\u7136\u540e\u590d\u5236\u7c98\u8d34\u5185\u5bb9\uff0c\u4e0d\u80fd\u4f7f\u7528vim\u4f1a\u6709\u683c\u5f0f\u9519\u8bef"]})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"/etc/openstack-dashboard/local_settings"}),"\u6587\u4ef6\u5185\u5bb9"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"# -*- coding: utf-8 -*-\n\nimport os\n\nfrom django.utils.translation import ugettext_lazy as _\n\n\nfrom openstack_dashboard.settings import HORIZON_CONFIG\n\nDEBUG = False\n\n# This setting controls whether or not compression is enabled. Disabling\n# compression makes Horizon considerably slower, but makes it much easier\n# to debug JS and CSS changes\n#COMPRESS_ENABLED = not DEBUG\n\n# This setting controls whether compression happens on the fly, or offline\n# with `python manage.py compress`\n# See https://django-compressor.readthedocs.io/en/latest/usage/#offline-compression\n# for more information\n#COMPRESS_OFFLINE = not DEBUG\n\n# WEBROOT is the location relative to Webserver root\n# should end with a slash.\nWEBROOT = '/dashboard/'\n#LOGIN_URL = WEBROOT + 'auth/login/'\n#LOGOUT_URL = WEBROOT + 'auth/logout/'\n#\n# LOGIN_REDIRECT_URL can be used as an alternative for\n# HORIZON_CONFIG.user_home, if user_home is not set.\n# Do not set it to '/home/', as this will cause circular redirect loop\n#LOGIN_REDIRECT_URL = WEBROOT\n\n# If horizon is running in production (DEBUG is False), set this\n# with the list of host/domain names that the application can serve.\n# For more information see:\n# https://docs.djangoproject.com/en/dev/ref/settings/#allowed-hosts\nALLOWED_HOSTS = ['*', ]\n\n# Set SSL proxy settings:\n# Pass this header from the proxy after terminating the SSL,\n# and don't forget to strip it from the client's request.\n# For more information see:\n# https://docs.djangoproject.com/en/dev/ref/settings/#secure-proxy-ssl-header\n#SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https')\n\n# If Horizon is being served through SSL, then uncomment the following two\n# settings to better secure the cookies from security exploits\n#CSRF_COOKIE_SECURE = True\n#SESSION_COOKIE_SECURE = True\n\n# The absolute path to the directory where message files are collected.\n# The message file must have a .json file extension. When the user logins to\n# horizon, the message files collected are processed and displayed to the user.\n#MESSAGES_PATH=None\n\n# Overrides for OpenStack API versions. Use this setting to force the\n# OpenStack dashboard to use a specific API version for a given service API.\n# Versions specified here should be integers or floats, not strings.\n# NOTE: The version should be formatted as it appears in the URL for the\n# service API. For example, The identity service APIs have inconsistent\n# use of the decimal point, so valid options would be 2.0 or 3.\n# Minimum compute version to get the instance locked status is 2.9.\nOPENSTACK_API_VERSIONS = {\n    \"identity\": 3,\n    \"image\": 2,\n    \"volume\": 2,\n}\n\n# Set this to True if running on a multi-domain model. When this is enabled, it\n# will require the user to enter the Domain name in addition to the username\n# for login.\nOPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT = True\n\n# Set this to True if you want available domains displayed as a dropdown menu\n# on the login screen. It is strongly advised NOT to enable this for public\n# clouds, as advertising enabled domains to unauthenticated customers\n# irresponsibly exposes private information. This should only be used for\n# private clouds where the dashboard sits behind a corporate firewall.\n#OPENSTACK_KEYSTONE_DOMAIN_DROPDOWN = False\n\n# If OPENSTACK_KEYSTONE_DOMAIN_DROPDOWN is enabled, this option can be used to\n# set the available domains to choose from. This is a list of pairs whose first\n# value is the domain name and the second is the display name.\n#OPENSTACK_KEYSTONE_DOMAIN_CHOICES = (\n#  ('Default', 'Default'),\n#)\n\n# Overrides the default domain used when running on single-domain model\n# with Keystone V3. All entities will be created in the default domain.\n# NOTE: This value must be the name of the default domain, NOT the ID.\n# Also, you will most likely have a value in the keystone policy file like this\n#    \"cloud_admin\": \"rule:admin_required and domain_id:<your domain id>\"\n# This value must be the name of the domain whose ID is specified there.\nOPENSTACK_KEYSTONE_DEFAULT_DOMAIN = 'Default'\n\n# Set this to True to enable panels that provide the ability for users to\n# manage Identity Providers (IdPs) and establish a set of rules to map\n# federation protocol attributes to Identity API attributes.\n# This extension requires v3.0+ of the Identity API.\n#OPENSTACK_KEYSTONE_FEDERATION_MANAGEMENT = False\n\n# Set Console type:\n# valid options are \"AUTO\"(default), \"VNC\", \"SPICE\", \"RDP\", \"SERIAL\", \"MKS\"\n# or None. Set to None explicitly if you want to deactivate the console.\n#CONSOLE_TYPE = \"AUTO\"\n\n# Toggle showing the openrc file for Keystone V2.\n# If set to false the link will be removed from the user dropdown menu\n# and the API Access page\n#SHOW_KEYSTONE_V2_RC = True\n\n# If provided, a \"Report Bug\" link will be displayed in the site header\n# which links to the value of this setting (ideally a URL containing\n# information on how to report issues).\n#HORIZON_CONFIG[\"bug_url\"] = \"http://bug-report.example.com\"\n\n# Show backdrop element outside the modal, do not close the modal\n# after clicking on backdrop.\n#HORIZON_CONFIG[\"modal_backdrop\"] = \"static\"\n\n# Specify a regular expression to validate user passwords.\n#HORIZON_CONFIG[\"password_validator\"] = {\n#    \"regex\": '.*',\n#    \"help_text\": _(\"Your password does not meet the requirements.\"),\n#}\n\n# Turn off browser autocompletion for forms including the login form and\n# the database creation workflow if so desired.\n#HORIZON_CONFIG[\"password_autocomplete\"] = \"off\"\n\n# Setting this to True will disable the reveal button for password fields,\n# including on the login form.\n#HORIZON_CONFIG[\"disable_password_reveal\"] = False\n\nLOCAL_PATH = '/tmp'\n\n# Set custom secret key:\n# You can either set it to a specific value or you can let horizon generate a\n# default secret key that is unique on this machine, e.i. regardless of the\n# amount of Python WSGI workers (if used behind Apache+mod_wsgi): However,\n# there may be situations where you would want to set this explicitly, e.g.\n# when multiple dashboard instances are distributed on different machines\n# (usually behind a load-balancer). Either you have to make sure that a session\n# gets all requests routed to the same dashboard instance or you set the same\n# SECRET_KEY for all of them.\nSECRET_KEY='f9ed41e34c2b04178998'\n\n# We recommend you use memcached for development; otherwise after every reload\n# of the django development server, you will have to login again. To use\n# memcached set CACHES to something like\n#CACHES = {\n#    'default': {\n#        'BACKEND': 'django.core.cache.backends.memcached.MemcachedCache',\n#        'LOCATION': '127.0.0.1:11211',\n#    },\n#}\nSESSION_ENGINE = 'django.contrib.sessions.backends.cache'\n\nCACHES = {\n    'default': {\n         'BACKEND': 'django.core.cache.backends.memcached.MemcachedCache',\n         'LOCATION': 'controller:11211',\n    }\n}\n\n# Send email to the console by default\nEMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'\n# Or send them to /dev/null\n#EMAIL_BACKEND = 'django.core.mail.backends.dummy.EmailBackend'\n\n# Configure these for your outgoing email host\n#EMAIL_HOST = 'smtp.my-company.com'\n#EMAIL_PORT = 25\n#EMAIL_HOST_USER = 'djangomail'\n#EMAIL_HOST_PASSWORD = 'top-secret!'\n\n# For multiple regions uncomment this configuration, and add (endpoint, title).\n#AVAILABLE_REGIONS = [\n#    ('http://cluster1.example.com:5000/v3', 'cluster1'),\n#    ('http://cluster2.example.com:5000/v3', 'cluster2'),\n#]\n\nOPENSTACK_HOST = \"controller\"\nOPENSTACK_KEYSTONE_URL = \"http://%s:5000/v3\" % OPENSTACK_HOST\nOPENSTACK_KEYSTONE_DEFAULT_ROLE = \"user\"\n\n# For setting the default service region on a per-endpoint basis. Note that the\n# default value for this setting is {}, and below is just an example of how it\n# should be specified.\n# A key of '*' is an optional global default if no other key matches.\n#DEFAULT_SERVICE_REGIONS = {\n#    '*': 'RegionOne'\n#    OPENSTACK_KEYSTONE_URL: 'RegionTwo'\n#}\n\n# Enables keystone web single-sign-on if set to True.\n#WEBSSO_ENABLED = False\n\n# Authentication mechanism to be selected as default.\n# The value must be a key from WEBSSO_CHOICES.\n#WEBSSO_INITIAL_CHOICE = \"credentials\"\n\n# The list of authentication mechanisms which include keystone\n# federation protocols and identity provider/federation protocol\n# mapping keys (WEBSSO_IDP_MAPPING). Current supported protocol\n# IDs are 'saml2' and 'oidc'  which represent SAML 2.0, OpenID\n# Connect respectively.\n# Do not remove the mandatory credentials mechanism.\n# Note: The last two tuples are sample mapping keys to a identity provider\n# and federation protocol combination (WEBSSO_IDP_MAPPING).\n#WEBSSO_CHOICES = (\n#    (\"credentials\", _(\"Keystone Credentials\")),\n#    (\"oidc\", _(\"OpenID Connect\")),\n#    (\"saml2\", _(\"Security Assertion Markup Language\")),\n#    (\"acme_oidc\", \"ACME - OpenID Connect\"),\n#    (\"acme_saml2\", \"ACME - SAML2\"),\n#)\n\n# A dictionary of specific identity provider and federation protocol\n# combinations. From the selected authentication mechanism, the value\n# will be looked up as keys in the dictionary. If a match is found,\n# it will redirect the user to a identity provider and federation protocol\n# specific WebSSO endpoint in keystone, otherwise it will use the value\n# as the protocol_id when redirecting to the WebSSO by protocol endpoint.\n# NOTE: The value is expected to be a tuple formatted as: (<idp_id>, <protocol_id>).\n#WEBSSO_IDP_MAPPING = {\n#    \"acme_oidc\": (\"acme\", \"oidc\"),\n#    \"acme_saml2\": (\"acme\", \"saml2\"),\n#}\n\n# If set this URL will be used for web single-sign-on authentication\n# instead of OPENSTACK_KEYSTONE_URL. This is needed in the deployment\n# scenarios where network segmentation is used per security requirement.\n# In this case, the controllers are not reachable from public network.\n# Therefore, user's browser will not be able to access OPENSTACK_KEYSTONE_URL\n# if it is set to the internal endpoint.\n#WEBSSO_KEYSTONE_URL = \"http://keystone-public.example.com/v3\"\n\n# The Keystone Provider drop down uses Keystone to Keystone federation\n# to switch between Keystone service providers.\n# Set display name for Identity Provider (dropdown display name)\n#KEYSTONE_PROVIDER_IDP_NAME = \"Local Keystone\"\n# This id is used for only for comparison with the service provider IDs. This ID\n# should not match any service provider IDs.\n#KEYSTONE_PROVIDER_IDP_ID = \"localkeystone\"\n\n# Disable SSL certificate checks (useful for self-signed certificates):\n#OPENSTACK_SSL_NO_VERIFY = True\n\n# The CA certificate to use to verify SSL connections\n#OPENSTACK_SSL_CACERT = '/path/to/cacert.pem'\n\n# The OPENSTACK_KEYSTONE_BACKEND settings can be used to identify the\n# capabilities of the auth backend for Keystone.\n# If Keystone has been configured to use LDAP as the auth backend then set\n# can_edit_user to False and name to 'ldap'.\n#\n# TODO(tres): Remove these once Keystone has an API to identify auth backend.\nOPENSTACK_KEYSTONE_BACKEND = {\n    'name': 'native',\n    'can_edit_user': True,\n    'can_edit_group': True,\n    'can_edit_project': True,\n    'can_edit_domain': True,\n    'can_edit_role': True,\n}\n\n# Setting this to True, will add a new \"Retrieve Password\" action on instance,\n# allowing Admin session password retrieval/decryption.\n#OPENSTACK_ENABLE_PASSWORD_RETRIEVE = False\n\n# The Launch Instance user experience has been significantly enhanced.\n# You can choose whether to enable the new launch instance experience,\n# the legacy experience, or both. The legacy experience will be removed\n# in a future release, but is available as a temporary backup setting to ensure\n# compatibility with existing deployments. Further development will not be\n# done on the legacy experience. Please report any problems with the new\n# experience via the Launchpad tracking system.\n#\n# Toggle LAUNCH_INSTANCE_LEGACY_ENABLED and LAUNCH_INSTANCE_NG_ENABLED to\n# determine the experience to enable.  Set them both to true to enable\n# both.\n#LAUNCH_INSTANCE_LEGACY_ENABLED = True\n#LAUNCH_INSTANCE_NG_ENABLED = False\n\n# A dictionary of settings which can be used to provide the default values for\n# properties found in the Launch Instance modal.\n#LAUNCH_INSTANCE_DEFAULTS = {\n#    'config_drive': False,\n#    'enable_scheduler_hints': True,\n#    'disable_image': False,\n#    'disable_instance_snapshot': False,\n#    'disable_volume': False,\n#    'disable_volume_snapshot': False,\n#    'create_volume': True,\n#}\n\n# The Xen Hypervisor has the ability to set the mount point for volumes\n# attached to instances (other Hypervisors currently do not). Setting\n# can_set_mount_point to True will add the option to set the mount point\n# from the UI.\nOPENSTACK_HYPERVISOR_FEATURES = {\n    'can_set_mount_point': False,\n    'can_set_password': False,\n    'requires_keypair': False,\n    'enable_quotas': True\n}\n\n# This settings controls whether IP addresses of servers are retrieved from\n# neutron in the project instance table. Setting this to ``False`` may mitigate\n# a performance issue in the project instance table in large deployments.\n#OPENSTACK_INSTANCE_RETRIEVE_IP_ADDRESSES = True\n\n# The OPENSTACK_CINDER_FEATURES settings can be used to enable optional\n# services provided by cinder that is not exposed by its extension API.\nOPENSTACK_CINDER_FEATURES = {\n    'enable_backup': False,\n}\n\n# The OPENSTACK_NEUTRON_NETWORK settings can be used to enable optional\n# services provided by neutron. Options currently available are load\n# balancer service, security groups, quotas, VPN service.\nOPENSTACK_NEUTRON_NETWORK = {\n    'enable_router': False,\n    'enable_quotas': False,\n    'enable_distributed_router': False,\n    'enable_ha_router': False,\n    'enable_lb': False,\n    'enable_firewall': False,\n    'enable_vpn': False,\n    'enable_fip_topology_check': False,\n\n    # Default dns servers you would like to use when a subnet is\n    # created.  This is only a default, users can still choose a different\n    # list of dns servers when creating a new subnet.\n    # The entries below are examples only, and are not appropriate for\n    # real deployments\n    # 'default_dns_nameservers': [\"8.8.8.8\", \"8.8.4.4\", \"208.67.222.222\"],\n\n    # Set which provider network types are supported. Only the network types\n    # in this list will be available to choose from when creating a network.\n    # Network types include local, flat, vlan, gre, vxlan and geneve.\n    # 'supported_provider_types': ['*'],\n\n    # You can configure available segmentation ID range per network type\n    # in your deployment.\n    # 'segmentation_id_range': {\n    #     'vlan': [1024, 2048],\n    #     'vxlan': [4094, 65536],\n    # },\n\n    # You can define additional provider network types here.\n    # 'extra_provider_types': {\n    #     'awesome_type': {\n    #         'display_name': 'Awesome New Type',\n    #         'require_physical_network': False,\n    #         'require_segmentation_id': True,\n    #     }\n    # },\n\n    # Set which VNIC types are supported for port binding. Only the VNIC\n    # types in this list will be available to choose from when creating a\n    # port.\n    # VNIC types include 'normal', 'direct', 'direct-physical', 'macvtap',\n    # 'baremetal' and 'virtio-forwarder'\n    # Set to empty list or None to disable VNIC type selection.\n    'supported_vnic_types': ['*'],\n\n    # Set list of available physical networks to be selected in the physical\n    # network field on the admin create network modal. If it's set to an empty\n    # list, the field will be a regular input field.\n    # e.g. ['default', 'test']\n    'physical_networks': [],\n\n}\n\n# The OPENSTACK_HEAT_STACK settings can be used to disable password\n# field required while launching the stack.\nOPENSTACK_HEAT_STACK = {\n    'enable_user_pass': True,\n}\n\n# The OPENSTACK_IMAGE_BACKEND settings can be used to customize features\n# in the OpenStack Dashboard related to the Image service, such as the list\n# of supported image formats.\n#OPENSTACK_IMAGE_BACKEND = {\n#    'image_formats': [\n#        ('', _('Select format')),\n#        ('aki', _('AKI - Amazon Kernel Image')),\n#        ('ami', _('AMI - Amazon Machine Image')),\n#        ('ari', _('ARI - Amazon Ramdisk Image')),\n#        ('docker', _('Docker')),\n#        ('iso', _('ISO - Optical Disk Image')),\n#        ('ova', _('OVA - Open Virtual Appliance')),\n#        ('qcow2', _('QCOW2 - QEMU Emulator')),\n#        ('raw', _('Raw')),\n#        ('vdi', _('VDI - Virtual Disk Image')),\n#        ('vhd', _('VHD - Virtual Hard Disk')),\n#        ('vhdx', _('VHDX - Large Virtual Hard Disk')),\n#        ('vmdk', _('VMDK - Virtual Machine Disk')),\n#    ],\n#}\n\n# The IMAGE_CUSTOM_PROPERTY_TITLES settings is used to customize the titles for\n# image custom property attributes that appear on image detail pages.\nIMAGE_CUSTOM_PROPERTY_TITLES = {\n    \"architecture\": _(\"Architecture\"),\n    \"kernel_id\": _(\"Kernel ID\"),\n    \"ramdisk_id\": _(\"Ramdisk ID\"),\n    \"image_state\": _(\"Euca2ools state\"),\n    \"project_id\": _(\"Project ID\"),\n    \"image_type\": _(\"Image Type\"),\n}\n\n# The IMAGE_RESERVED_CUSTOM_PROPERTIES setting is used to specify which image\n# custom properties should not be displayed in the Image Custom Properties\n# table.\nIMAGE_RESERVED_CUSTOM_PROPERTIES = []\n\n# Set to 'legacy' or 'direct' to allow users to upload images to glance via\n# Horizon server. When enabled, a file form field will appear on the create\n# image form. If set to 'off', there will be no file form field on the create\n# image form. See documentation for deployment considerations.\n#HORIZON_IMAGES_UPLOAD_MODE = 'legacy'\n\n# Allow a location to be set when creating or updating Glance images.\n# If using Glance V2, this value should be False unless the Glance\n# configuration and policies allow setting locations.\n#IMAGES_ALLOW_LOCATION = False\n\n# A dictionary of default settings for create image modal.\n#CREATE_IMAGE_DEFAULTS = {\n#    'image_visibility': \"public\",\n#}\n\n# OPENSTACK_ENDPOINT_TYPE specifies the endpoint type to use for the endpoints\n# in the Keystone service catalog. Use this setting when Horizon is running\n# external to the OpenStack environment. The default is 'publicURL'.\n#OPENSTACK_ENDPOINT_TYPE = \"publicURL\"\n\n# SECONDARY_ENDPOINT_TYPE specifies the fallback endpoint type to use in the\n# case that OPENSTACK_ENDPOINT_TYPE is not present in the endpoints\n# in the Keystone service catalog. Use this setting when Horizon is running\n# external to the OpenStack environment. The default is None. This\n# value should differ from OPENSTACK_ENDPOINT_TYPE if used.\n#SECONDARY_ENDPOINT_TYPE = None\n\n# The number of objects (Swift containers/objects or images) to display\n# on a single page before providing a paging element (a \"more\" link)\n# to paginate results.\nAPI_RESULT_LIMIT = 1000\nAPI_RESULT_PAGE_SIZE = 20\n\n# The size of chunk in bytes for downloading objects from Swift\nSWIFT_FILE_TRANSFER_CHUNK_SIZE = 512 * 1024\n\n# The default number of lines displayed for instance console log.\nINSTANCE_LOG_LENGTH = 35\n\n# Specify a maximum number of items to display in a dropdown.\nDROPDOWN_MAX_ITEMS = 30\n\n# The timezone of the server. This should correspond with the timezone\n# of your entire OpenStack installation, and hopefully be in UTC.\nTIME_ZONE = \"Asia/Shanghai\"\n\n# When launching an instance, the menu of available flavors is\n# sorted by RAM usage, ascending. If you would like a different sort order,\n# you can provide another flavor attribute as sorting key. Alternatively, you\n# can provide a custom callback method to use for sorting. You can also provide\n# a flag for reverse sort. For more info, see\n# http://docs.python.org/2/library/functions.html#sorted\n#CREATE_INSTANCE_FLAVOR_SORT = {\n#    'key': 'name',\n#     # or\n#    'key': my_awesome_callback_method,\n#    'reverse': False,\n#}\n\n# Set this to True to display an 'Admin Password' field on the Change Password\n# form to verify that it is indeed the admin logged-in who wants to change\n# the password.\n#ENFORCE_PASSWORD_CHECK = False\n\n# Modules that provide /auth routes that can be used to handle different types\n# of user authentication. Add auth plugins that require extra route handling to\n# this list.\n#AUTHENTICATION_URLS = [\n#    'openstack_auth.urls',\n#]\n\n# The Horizon Policy Enforcement engine uses these values to load per service\n# policy rule files. The content of these files should match the files the\n# OpenStack services are using to determine role based access control in the\n# target installation.\n\n# Path to directory containing policy.json files\nPOLICY_FILES_PATH = '/etc/openstack-dashboard'\n\n# Map of local copy of service policy files.\n# Please insure that your identity policy file matches the one being used on\n# your keystone servers. There is an alternate policy file that may be used\n# in the Keystone v3 multi-domain case, policy.v3cloudsample.json.\n# This file is not included in the Horizon repository by default but can be\n# found at\n# http://git.openstack.org/cgit/openstack/keystone/tree/etc/ \\\n# policy.v3cloudsample.json\n# Having matching policy files on the Horizon and Keystone servers is essential\n# for normal operation. This holds true for all services and their policy files.\n#POLICY_FILES = {\n#    'identity': 'keystone_policy.json',\n#    'compute': 'nova_policy.json',\n#    'volume': 'cinder_policy.json',\n#    'image': 'glance_policy.json',\n#    'network': 'neutron_policy.json',\n#}\n\n# Change this patch to the appropriate list of tuples containing\n# a key, label and static directory containing two files:\n# _variables.scss and _styles.scss\n#AVAILABLE_THEMES = [\n#    ('default', 'Default', 'themes/default'),\n#    ('material', 'Material', 'themes/material'),\n#]\n\nLOGGING = {\n    'version': 1,\n    # When set to True this will disable all logging except\n    # for loggers specified in this configuration dictionary. Note that\n    # if nothing is specified here and disable_existing_loggers is True,\n    # django.db.backends will still log unless it is disabled explicitly.\n    'disable_existing_loggers': False,\n    # If apache2 mod_wsgi is used to deploy OpenStack dashboard\n    # timestamp is output by mod_wsgi. If WSGI framework you use does not\n    # output timestamp for logging, add %(asctime)s in the following\n    # format definitions.\n    'formatters': {\n        'console': {\n            'format': '%(levelname)s %(name)s %(message)s'\n        },\n        'operation': {\n            # The format of \"%(message)s\" is defined by\n            # OPERATION_LOG_OPTIONS['format']\n            'format': '%(message)s'\n        },\n    },\n    'handlers': {\n        'null': {\n            'level': 'DEBUG',\n            'class': 'logging.NullHandler',\n        },\n        'console': {\n            # Set the level to \"DEBUG\" for verbose output logging.\n            'level': 'INFO',\n            'class': 'logging.StreamHandler',\n            'formatter': 'console',\n        },\n        'operation': {\n            'level': 'INFO',\n            'class': 'logging.StreamHandler',\n            'formatter': 'operation',\n        },\n    },\n    'loggers': {\n        'horizon': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'horizon.operation_log': {\n            'handlers': ['operation'],\n            'level': 'INFO',\n            'propagate': False,\n        },\n        'openstack_dashboard': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'novaclient': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'cinderclient': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'keystoneauth': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'keystoneclient': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'glanceclient': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'neutronclient': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'swiftclient': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'oslo_policy': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'openstack_auth': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        'django': {\n            'handlers': ['console'],\n            'level': 'DEBUG',\n            'propagate': False,\n        },\n        # Logging from django.db.backends is VERY verbose, send to null\n        # by default.\n        'django.db.backends': {\n            'handlers': ['null'],\n            'propagate': False,\n        },\n        'requests': {\n            'handlers': ['null'],\n            'propagate': False,\n        },\n        'urllib3': {\n            'handlers': ['null'],\n            'propagate': False,\n        },\n        'chardet.charsetprober': {\n            'handlers': ['null'],\n            'propagate': False,\n        },\n        'iso8601': {\n            'handlers': ['null'],\n            'propagate': False,\n        },\n        'scss': {\n            'handlers': ['null'],\n            'propagate': False,\n        },\n    },\n}\n\n# 'direction' should not be specified for all_tcp/udp/icmp.\n# It is specified in the form.\nSECURITY_GROUP_RULES = {\n    'all_tcp': {\n        'name': _('All TCP'),\n        'ip_protocol': 'tcp',\n        'from_port': '1',\n        'to_port': '65535',\n    },\n    'all_udp': {\n        'name': _('All UDP'),\n        'ip_protocol': 'udp',\n        'from_port': '1',\n        'to_port': '65535',\n    },\n    'all_icmp': {\n        'name': _('All ICMP'),\n        'ip_protocol': 'icmp',\n        'from_port': '-1',\n        'to_port': '-1',\n    },\n    'ssh': {\n        'name': 'SSH',\n        'ip_protocol': 'tcp',\n        'from_port': '22',\n        'to_port': '22',\n    },\n    'smtp': {\n        'name': 'SMTP',\n        'ip_protocol': 'tcp',\n        'from_port': '25',\n        'to_port': '25',\n    },\n    'dns': {\n        'name': 'DNS',\n        'ip_protocol': 'tcp',\n        'from_port': '53',\n        'to_port': '53',\n    },\n    'http': {\n        'name': 'HTTP',\n        'ip_protocol': 'tcp',\n        'from_port': '80',\n        'to_port': '80',\n    },\n    'pop3': {\n        'name': 'POP3',\n        'ip_protocol': 'tcp',\n        'from_port': '110',\n        'to_port': '110',\n    },\n    'imap': {\n        'name': 'IMAP',\n        'ip_protocol': 'tcp',\n        'from_port': '143',\n        'to_port': '143',\n    },\n    'ldap': {\n        'name': 'LDAP',\n        'ip_protocol': 'tcp',\n        'from_port': '389',\n        'to_port': '389',\n    },\n    'https': {\n        'name': 'HTTPS',\n        'ip_protocol': 'tcp',\n        'from_port': '443',\n        'to_port': '443',\n    },\n    'smtps': {\n        'name': 'SMTPS',\n        'ip_protocol': 'tcp',\n        'from_port': '465',\n        'to_port': '465',\n    },\n    'imaps': {\n        'name': 'IMAPS',\n        'ip_protocol': 'tcp',\n        'from_port': '993',\n        'to_port': '993',\n    },\n    'pop3s': {\n        'name': 'POP3S',\n        'ip_protocol': 'tcp',\n        'from_port': '995',\n        'to_port': '995',\n    },\n    'ms_sql': {\n        'name': 'MS SQL',\n        'ip_protocol': 'tcp',\n        'from_port': '1433',\n        'to_port': '1433',\n    },\n    'mysql': {\n        'name': 'MYSQL',\n        'ip_protocol': 'tcp',\n        'from_port': '3306',\n        'to_port': '3306',\n    },\n    'rdp': {\n        'name': 'RDP',\n        'ip_protocol': 'tcp',\n        'from_port': '3389',\n        'to_port': '3389',\n    },\n}\n\n# Deprecation Notice:\n#\n# The setting FLAVOR_EXTRA_KEYS has been deprecated.\n# Please load extra spec metadata into the Glance Metadata Definition Catalog.\n#\n# The sample quota definitions can be found in:\n# <glance_source>/etc/metadefs/compute-quota.json\n#\n# The metadata definition catalog supports CLI and API:\n#  $glance --os-image-api-version 2 help md-namespace-import\n#  $glance-manage db_load_metadefs <directory_with_definition_files>\n#\n# See Metadata Definitions on:\n# https://docs.openstack.org/glance/latest/user/glancemetadefcatalogapi.html\n\n# The hash algorithm to use for authentication tokens. This must\n# match the hash algorithm that the identity server and the\n# auth_token middleware are using. Allowed values are the\n# algorithms supported by Python's hashlib library.\n#OPENSTACK_TOKEN_HASH_ALGORITHM = 'md5'\n\n# AngularJS requires some settings to be made available to\n# the client side. Some settings are required by in-tree / built-in horizon\n# features. These settings must be added to REST_API_REQUIRED_SETTINGS in the\n# form of ['SETTING_1','SETTING_2'], etc.\n#\n# You may remove settings from this list for security purposes, but do so at\n# the risk of breaking a built-in horizon feature. These settings are required\n# for horizon to function properly. Only remove them if you know what you\n# are doing. These settings may in the future be moved to be defined within\n# the enabled panel configuration.\n# You should not add settings to this list for out of tree extensions.\n# See: https://wiki.openstack.org/wiki/Horizon/RESTAPI\nREST_API_REQUIRED_SETTINGS = ['OPENSTACK_HYPERVISOR_FEATURES',\n                              'LAUNCH_INSTANCE_DEFAULTS',\n                              'OPENSTACK_IMAGE_FORMATS',\n                              'OPENSTACK_KEYSTONE_BACKEND',\n                              'OPENSTACK_KEYSTONE_DEFAULT_DOMAIN',\n                              'CREATE_IMAGE_DEFAULTS',\n                              'ENFORCE_PASSWORD_CHECK']\n\n# Additional settings can be made available to the client side for\n# extensibility by specifying them in REST_API_ADDITIONAL_SETTINGS\n# !! Please use extreme caution as the settings are transferred via HTTP/S\n# and are not encrypted on the browser. This is an experimental API and\n# may be deprecated in the future without notice.\n#REST_API_ADDITIONAL_SETTINGS = []\n\n# DISALLOW_IFRAME_EMBED can be used to prevent Horizon from being embedded\n# within an iframe. Legacy browsers are still vulnerable to a Cross-Frame\n# Scripting (XFS) vulnerability, so this option allows extra security hardening\n# where iframes are not used in deployment. Default setting is True.\n# For more information see:\n# http://tinyurl.com/anticlickjack\n#DISALLOW_IFRAME_EMBED = True\n\n# Help URL can be made available for the client. To provide a help URL, edit the\n# following attribute to the URL of your choice.\n#HORIZON_CONFIG[\"help_url\"] = \"http://openstack.mycompany.org\"\n\n# Settings for OperationLogMiddleware\n# OPERATION_LOG_ENABLED is flag to use the function to log an operation on\n# Horizon.\n# mask_targets is arrangement for appointing a target to mask.\n# method_targets is arrangement of HTTP method to output log.\n# format is the log contents.\n#OPERATION_LOG_ENABLED = False\n#OPERATION_LOG_OPTIONS = {\n#    'mask_fields': ['password'],\n#    'target_methods': ['POST'],\n#    'ignored_urls': ['/js/', '/static/', '^/api/'],\n#    'format': (\"[%(client_ip)s] [%(domain_name)s]\"\n#        \" [%(domain_id)s] [%(project_name)s]\"\n#        \" [%(project_id)s] [%(user_name)s] [%(user_id)s] [%(request_scheme)s]\"\n#        \" [%(referer_url)s] [%(request_url)s] [%(message)s] [%(method)s]\"\n#        \" [%(http_status)s] [%(param)s]\"),\n#}\n\n# The default date range in the Overview panel meters - either <today> minus N\n# days (if the value is integer N), or from the beginning of the current month\n# until today (if set to None). This setting should be used to limit the amount\n# of data fetched by default when rendering the Overview panel.\n#OVERVIEW_DAYS_RANGE = 1\n\n# To allow operators to require users provide a search criteria first\n# before loading any data into the views, set the following dict\n# attributes to True in each one of the panels you want to enable this feature.\n# Follow the convention <dashboard>.<view>\n#FILTER_DATA_FIRST = {\n#    'admin.instances': False,\n#    'admin.images': False,\n#    'admin.networks': False,\n#    'admin.routers': False,\n#    'admin.volumes': False,\n#    'identity.users': False,\n#    'identity.projects': False,\n#    'identity.groups': False,\n#    'identity.roles': False\n#}\n\n# Dict used to restrict user private subnet cidr range.\n# An empty list means that user input will not be restricted\n# for a corresponding IP version. By default, there is\n# no restriction for IPv4 or IPv6. To restrict\n# user private subnet cidr range set ALLOWED_PRIVATE_SUBNET_CIDR\n# to something like\n#ALLOWED_PRIVATE_SUBNET_CIDR = {\n#    'ipv4': ['10.0.0.0/8', '192.168.0.0/16'],\n#    'ipv6': ['fc00::/7']\n#}\nALLOWED_PRIVATE_SUBNET_CIDR = {'ipv4': [], 'ipv6': []}\n\n# Projects and users can have extra attributes as defined by keystone v3.\n# Horizon has the ability to display these extra attributes via this setting.\n# If you'd like to display extra data in the project or user tables, set the\n# corresponding dict key to the attribute name, followed by the display name.\n# For more information, see horizon's customization\n# (https://docs.openstack.org/horizon/latest/configuration/customizing.html#horizon-customization-module-overrides)\n#PROJECT_TABLE_EXTRA_INFO = {\n#   'phone_num': _('Phone Number'),\n#}\n#USER_TABLE_EXTRA_INFO = {\n#   'phone_num': _('Phone Number'),\n#}\n\n# Password will have an expiration date when using keystone v3 and enabling the\n# feature.\n# This setting allows you to set the number of days that the user will be alerted\n# prior to the password expiration.\n# Once the password expires keystone will deny the access and users must\n# contact an admin to change their password.\n#PASSWORD_EXPIRES_WARNING_THRESHOLD_DAYS = 0\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/openstack-dashboard/local_settings\n0e53f197affdd94c9e25a4f6f7fdf14b  /etc/openstack-dashboard/local_settings\n"})}),"\n",(0,c.jsx)(n.h3,{id:"83-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u5426\u5219\u540e\u7eed\u8bbf\u95eedashboard\u4f1a\u62a5500\u9519\u8bef",children:"8.3 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff0c\u5426\u5219\u540e\u7eed\u8bbf\u95eedashboard\u4f1a\u62a5500\u9519\u8bef"}),"\n",(0,c.jsxs)(n.h4,{id:"831-\u7f16\u8f91-etchttpdconfdopenstack-dashboardconf",children:["8.3.1 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/httpd/conf.d/openstack-dashboard.conf"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"sed -i.bak  '3aWSGIApplicationGroup %{GLOBAL}' /etc/httpd/conf.d/openstack-dashboard.conf\n"})}),"\n",(0,c.jsx)(n.h4,{id:"832-\u91cd\u542fhttpd\u548cmemcache",children:"8.3.2 \u91cd\u542fhttpd\u548cmemcache"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"systemctl restart httpd.service memcached.service\n"})}),"\n",(0,c.jsx)(n.h3,{id:"84-\u767b\u9646dashboard",children:"8.4 \u767b\u9646dashboard"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"172.30.100.4:8080/dashboard"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u57df\uff1adefault"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u7528\u6237\u540d\uff1aadmin"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5bc6\u7801\uff1aADMIN_PASS"})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/master/img/iShot2020-05-2620.16.57.png",alt:"iShot2020-05-2620.16.57"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u767b\u9646\u540e\u9996\u754c\u9762"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/master/img/iShot2020-05-2620.18.46.png",alt:"iShot2020-05-2620.18.46"})}),"\n",(0,c.jsx)(n.p,{children:"\u5982\u679c\u767b\u9646\u62a5\u9519\u5982\u4e0b"}),"\n",(0,c.jsxs)(n.p,{children:["![iShot2021-11-04 17.09.24](",(0,c.jsx)(n.a,{href:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/master/img/iShot2021-11-04",children:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/master/img/iShot2021-11-04"})," 17.09.24.png)"]}),"\n",(0,c.jsx)(n.p,{children:"\u89e3\u51b3\u65b9\u6cd5"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"\u5728\u5b89\u88c5dashboard\u8282\u70b9\u505a\u4ee5\u4e0b\u64cd\u4f5c"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"1.\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 /etc/openstack-dashboard/local_settings\n\u4fee\u6539        SESSION_ENGINE = 'django.contrib.sessions.backends.cache'\n\u4fee\u6539\u4e3a     SESSION_ENGINE = 'django.contrib.sessions.backends.file'    \n\n2.\u91cd\u542fhttpd\nsystemctl restart httpd\n"})}),"\n",(0,c.jsx)(n.h2,{id:"9\u63a7\u5236\u8282\u70b9\u548c\u5b58\u50a8\u8282\u70b9\u5757\u5b58\u50a8\u670d\u52a1cinder\u5b89\u88c5",children:"9.\u63a7\u5236\u8282\u70b9\u548c\u5b58\u50a8\u8282\u70b9\u5757\u5b58\u50a8\u670d\u52a1cinder\u5b89\u88c5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/cinder/rocky/install/index-rdo.html",children:"rocky\u7248\u5757\u5b58\u50a8cinder\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5b98\u65b9\u5bf9",(0,c.jsx)(n.code,{children:"cidner"}),"\u670d\u52a1\u7684\u8bf4\u660e"]})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u672c\u8282\u4ecb\u7ecd\u5982\u4f55\u4e3a\u5757\u5b58\u50a8\u670d\u52a1\u5b89\u88c5\u548c\u914d\u7f6e\u5b58\u50a8\u8282\u70b9\u3002\u4e3a\u7b80\u5355\u8d77\u89c1\uff0c\u6b64\u914d\u7f6e\u5f15\u7528\u4e00\u4e2a\u5177\u6709\u7a7a\u672c\u5730\u5757\u5b58\u50a8\u8bbe\u5907\u7684\u5b58\u50a8\u8282\u70b9\u3002\u6307\u4ee4\u4f7f\u7528",(0,c.jsx)(n.code,{children:"/dev/sdb"}),"\uff0c\u4f46\u662f\u60a8\u53ef\u4ee5\u5c06\u7279\u5b9a\u8282\u70b9\u66ff\u6362\u4e3a\u5176\u4ed6\u503c\u3002"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u8be5\u670d\u52a1\u4f7f\u7528",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/cinder/rocky/common/glossary.html#term-logical-volume-manager-lvm",children:"LVM"}),"\u9a71\u52a8\u7a0b\u5e8f\u5728\u8be5\u8bbe\u5907\u4e0a\u7f6e\u5907\u903b\u8f91\u5377\uff0c \u5e76\u901a\u8fc7",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/cinder/rocky/common/glossary.html#term-iscsi-qualified-name-iqn",children:"iSCSI"}),"\u4f20\u8f93\u5c06\u5176\u63d0\u4f9b\u7ed9\u5b9e\u4f8b\u3002\u60a8\u53ef\u4ee5\u5bf9\u8fd9\u4e9b\u8bf4\u660e\u8fdb\u884c\u5c11\u91cf\u4fee\u6539\uff0c\u4ee5\u901a\u8fc7\u5176\u4ed6\u5b58\u50a8\u8282\u70b9\u6c34\u5e73\u6269\u5c55\u60a8\u7684\u73af\u5883\u3002"]})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"cinder\u76f8\u5173\u670d\u52a1"})}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u670d\u52a1\u540d"}),(0,c.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"cinder-volume"})}),(0,c.jsx)(n.td,{children:"\u63d0\u4f9b\u5b58\u50a8\u7a7a\u95f4\uff0c\u5305\u62eclvm\u3001nfs\u3001glusterfs\u3001ceph\u7b49\u7b49\u5b58\u50a8"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"cinder-api"})}),(0,c.jsx)(n.td,{children:"\u63a5\u6536\u5916\u90e8\u7684api\u8bf7\u6c42"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"cinder-scheduler"})}),(0,c.jsx)(n.td,{children:"\u8c03\u5ea6\u5668\uff0c\u51b3\u5b9a\u7531\u54ea\u4e00\u4e2acinder-volume\u63d0\u4f9b\u5b58\u50a8\u7a7a\u95f4"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"cinder-backup"})}),(0,c.jsx)(n.td,{children:"\u5907\u4efd\u521b\u5efa\u7684\u5377"})]})]})]}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u5b89\u88c5\u548c\u914d\u7f6e\u63a7\u5236\u8282\u70b9"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/cinder/rocky/install/cinder-controller-install-rdo.html",children:"rocky\u7248\u63a7\u5236\u8282\u70b9\u5757\u5b58\u50a8\u670d\u52a1cinder\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.h3,{id:"91-\u521b\u5efacinder\u6570\u636e\u5e93\u5e76\u6388\u6743",children:"9.1 \u521b\u5efacinder\u6570\u636e\u5e93\u5e76\u6388\u6743"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"mysql -e \"CREATE DATABASE cinder;\"\nmysql -e \"GRANT ALL PRIVILEGES ON cinder.* TO 'cinder'@'localhost' \\\nIDENTIFIED BY 'CINDER_DBPASS';\"\nmysql -e \"GRANT ALL PRIVILEGES ON cinder.* TO 'cinder'@'%' \\\nIDENTIFIED BY 'CINDER_DBPASS';\"\n"})}),"\n",(0,c.jsx)(n.h3,{id:"92-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee",children:"9.2 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"source /opt/admin-openrc\n"})}),"\n",(0,c.jsx)(n.h3,{id:"93-\u521b\u5efa\u670d\u52a1\u51ed\u8bc1",children:"9.3 \u521b\u5efa\u670d\u52a1\u51ed\u8bc1"}),"\n",(0,c.jsxs)(n.h4,{id:"931-\u521b\u5efa-cinder\u7528\u6237",children:["9.3.1 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"cinder"}),"\u7528\u6237"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5bc6\u7801\u8bbe\u7f6e\u4e3a ",(0,c.jsx)(n.code,{children:"CIDNER_PASS"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u4ea4\u4e92\u5f0f\u4e0e\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801\u9009\u62e9\u5176\u4e2d\u4e00\u79cd"})}),"\n",(0,c.jsx)(n.p,{children:"\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack user create --domain default --password CINDER_PASS cinder\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | 65b5343859e6409994d007f2de30570b |\n| name                | cinder                           |\n| options             | {}                               |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack user create --domain default --password-prompt cinder\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"932-\u5c06admin\u89d2\u8272\u6dfb\u52a0\u5230cinder\u7528\u6237",children:["9.3.2 \u5c06",(0,c.jsx)(n.code,{children:"admin"}),"\u89d2\u8272\u6dfb\u52a0\u5230",(0,c.jsx)(n.code,{children:"cinder"}),"\u7528\u6237"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"openstack role add --project service --user cinder admin\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"933-\u521b\u5efa-cinderv2-\u548c-cinderv3-\u670d\u52a1\u5b9e\u4f53",children:["9.3.3 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"cinderv2"})," \u548c ",(0,c.jsx)(n.code,{children:"cinderv3"})," \u670d\u52a1\u5b9e\u4f53"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5757\u5b58\u50a8\u670d\u52a1\u9700\u8981\u4e24\u4e2a\u670d\u52a1\u5b9e\u4f53"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'$ openstack service create --name cinderv2 \\\n--description "OpenStack Block Storage" volumev2\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | OpenStack Block Storage          |\n| enabled     | True                             |\n| id          | efcdff53520142d2ac6b0953cf532340 |\n| name        | cinderv2                         |\n| type        | volumev2                         |\n+-------------+----------------------------------+\n\n$ openstack service create --name cinderv3 \\\n--description "OpenStack Block Storage" volumev3\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | OpenStack Block Storage          |\n| enabled     | True                             |\n| id          | 910b223e07244359ae0480d579a0231a |\n| name        | cinderv3                         |\n| type        | volumev3                         |\n+-------------+----------------------------------+\n'})}),"\n",(0,c.jsx)(n.h3,{id:"94-\u521b\u5efa\u5757\u5b58\u50a8\u670d\u52a1api\u7aef\u70b9",children:"9.4 \u521b\u5efa\u5757\u5b58\u50a8\u670d\u52a1API\u7aef\u70b9"}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa",(0,c.jsx)(n.code,{children:"cinderv2"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack endpoint create --region RegionOne \\\nvolumev2 public http://controller:8776/v2/%\\(project_id\\)s\n+--------------+------------------------------------------+\n| Field        | Value                                    |\n+--------------+------------------------------------------+\n| enabled      | True                                     |\n| id           | dcd7a491205f4c8a8a1af94fbd95d452         |\n| interface    | public                                   |\n| region       | RegionOne                                |\n| region_id    | RegionOne                                |\n| service_id   | efcdff53520142d2ac6b0953cf532340         |\n| service_name | cinderv2                                 |\n| service_type | volumev2                                 |\n| url          | http://controller:8776/v2/%(project_id)s |\n+--------------+------------------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nvolumev2 internal http://controller:8776/v2/%\\(project_id\\)s\n+--------------+------------------------------------------+\n| Field        | Value                                    |\n+--------------+------------------------------------------+\n| enabled      | True                                     |\n| id           | e044f276dd624336b5c4bb51aa343a55         |\n| interface    | internal                                 |\n| region       | RegionOne                                |\n| region_id    | RegionOne                                |\n| service_id   | efcdff53520142d2ac6b0953cf532340         |\n| service_name | cinderv2                                 |\n| service_type | volumev2                                 |\n| url          | http://controller:8776/v2/%(project_id)s |\n+--------------+------------------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nvolumev2 admin http://controller:8776/v2/%\\(project_id\\)s\n+--------------+------------------------------------------+\n| Field        | Value                                    |\n+--------------+------------------------------------------+\n| enabled      | True                                     |\n| id           | e9c888a00e354a2cab3035b70b9e6c30         |\n| interface    | admin                                    |\n| region       | RegionOne                                |\n| region_id    | RegionOne                                |\n| service_id   | efcdff53520142d2ac6b0953cf532340         |\n| service_name | cinderv2                                 |\n| service_type | volumev2                                 |\n| url          | http://controller:8776/v2/%(project_id)s |\n+--------------+------------------------------------------+\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa",(0,c.jsx)(n.code,{children:"cinderv3"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack endpoint create --region RegionOne \\\nvolumev3 public http://controller:8776/v3/%\\(project_id\\)s\n+--------------+------------------------------------------+\n| Field        | Value                                    |\n+--------------+------------------------------------------+\n| enabled      | True                                     |\n| id           | 4f818560bac745dfa493dc53b3106cc3         |\n| interface    | public                                   |\n| region       | RegionOne                                |\n| region_id    | RegionOne                                |\n| service_id   | 910b223e07244359ae0480d579a0231a         |\n| service_name | cinderv3                                 |\n| service_type | volumev3                                 |\n| url          | http://controller:8776/v3/%(project_id)s |\n+--------------+------------------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nvolumev3 internal http://controller:8776/v3/%\\(project_id\\)s\n+--------------+------------------------------------------+\n| Field        | Value                                    |\n+--------------+------------------------------------------+\n| enabled      | True                                     |\n| id           | e102e7b28f5f47409e4e231af0af4776         |\n| interface    | internal                                 |\n| region       | RegionOne                                |\n| region_id    | RegionOne                                |\n| service_id   | 910b223e07244359ae0480d579a0231a         |\n| service_name | cinderv3                                 |\n| service_type | volumev3                                 |\n| url          | http://controller:8776/v3/%(project_id)s |\n+--------------+------------------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nvolumev3 admin http://controller:8776/v3/%\\(project_id\\)s\n+--------------+------------------------------------------+\n| Field        | Value                                    |\n+--------------+------------------------------------------+\n| enabled      | True                                     |\n| id           | 4585dc9397b041b7a1a45d063d515dcb         |\n| interface    | admin                                    |\n| region       | RegionOne                                |\n| region_id    | RegionOne                                |\n| service_id   | 910b223e07244359ae0480d579a0231a         |\n| service_name | cinderv3                                 |\n| service_type | volumev3                                 |\n| url          | http://controller:8776/v3/%(project_id)s |\n+--------------+------------------------------------------+\n"})}),"\n",(0,c.jsx)(n.h3,{id:"95-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",children:"9.5 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6"}),"\n",(0,c.jsx)(n.h4,{id:"951-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"9.5.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-cinder\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"952-\u7f16\u8f91-etccindercinderconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["9.5.2 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/cinder/cinder.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u8be5[database]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u6570\u636e\u5e93\u8bbf\u95ee\uff1a\n[database]\n# ...\nconnection = mysql+pymysql://cinder:CINDER_DBPASS@controller/cinder\n    \n2.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6eRabbitMQ \u6d88\u606f\u961f\u5217\u8bbf\u95ee\uff1a\n[DEFAULT]\n# ...\ntransport_url = rabbit://openstack:RABBIT_PASS@controller \n    \n3.\u5728[DEFAULT]\u548c[keystone_authtoken]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8eab\u4efd\u670d\u52a1\u8bbf\u95ee\uff1a\n[DEFAULT]\n# ...\nauth_strategy = keystone\n\n[keystone_authtoken]\n# ...\nwww_authenticate_uri = http://controller:5000\nauth_url = http://controller:5000\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_id = default\nuser_domain_id = default\nproject_name = service\nusername = cinder\npassword = CINDER_PASS    \n\n4.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6emy_ip\u9009\u9879\u4ee5\u4f7f\u7528\u63a7\u5236\u5668\u8282\u70b9\u7684\u7ba1\u7406\u63a5\u53e3IP\u5730\u5740\uff1a\n[DEFAULT]\n# ...\nmy_ip = 10.0.0.11\n\n5.\u5728\u8be5[oslo_concurrency]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u9501\u5b9a\u8def\u5f84\uff1a\n[oslo_concurrency]\n# ...\nlock_path = /var/lib/cinder/tmp\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/cinder/cinder.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/cinder/cinder.conf.bak > /etc/cinder/cinder.conf\nopenstack-config --set /etc/cinder/cinder.conf database connection mysql+pymysql://cinder:CINDER_DBPASS@controller/cinder\nopenstack-config --set /etc/cinder/cinder.conf DEFAULT transport_url rabbit://openstack:RABBIT_PASS@controller \nopenstack-config --set /etc/cinder/cinder.conf DEFAULT auth_strategy keystone  \nopenstack-config --set /etc/cinder/cinder.conf DEFAULT my_ip 172.30.100.4\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken www_authenticate_uri http://controller:5000\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_url http://controller:5000\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken memcached_servers controller:11211\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_type password\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken project_domain_id default\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken user_domain_id default\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken project_name service\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken username cinder\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken password CINDER_PASS\nopenstack-config --set /etc/cinder/cinder.conf oslo_concurrency lock_path /var/lib/cinder/tmp\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/cinder/cinder.conf\na5023d5b6df47ce8d186d5d32623c076  /etc/cinder/cinder.conf\n"})}),"\n",(0,c.jsx)(n.h4,{id:"953-\u540c\u6b65\u6570\u636e\u5e93",children:"9.5.3 \u540c\u6b65\u6570\u636e\u5e93"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ su -s /bin/sh -c "cinder-manage db sync" cinder\nDeprecated: Option "logdir" from group "DEFAULT" is deprecated. Use option "log-dir" from group "DEFAULT"\n'})}),"\n",(0,c.jsx)(n.p,{children:"\u6709\u8868\u5373\u4e3a\u6b63\u786e"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ mysql cinder -e "show tables"|wc -l\n36\n'})}),"\n",(0,c.jsx)(n.h3,{id:"96-\u914d\u7f6e\u8ba1\u7b97\u5df2\u4f7f\u7528\u5757\u5b58\u50a8",children:"9.6 \u914d\u7f6e\u8ba1\u7b97\u5df2\u4f7f\u7528\u5757\u5b58\u50a8"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/nova/nova.conf"})," \u6587\u4ef6\u5e76\u5411\u5176\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack-config --set /etc/nova/nova.conf cinder os_region_name RegionOne\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/nova/nova.conf\n606a18d1be80cd7e0a57150ca0e5040f  /etc/nova/nova.conf\n"})}),"\n",(0,c.jsx)(n.h3,{id:"97-\u5b8c\u6210\u5b89\u88c5",children:"9.7 \u5b8c\u6210\u5b89\u88c5"}),"\n",(0,c.jsx)(n.h4,{id:"971-\u91cd\u542fcompute-api\u670d\u52a1",children:"9.7.1 \u91cd\u542fCompute API\u670d\u52a1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl restart openstack-nova-api.service\n"})}),"\n",(0,c.jsx)(n.h4,{id:"972-\u542f\u52a8\u5757\u5b58\u50a8\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",children:"9.7.2 \u542f\u52a8\u5757\u5b58\u50a8\u670d\u52a1\uff0c\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable openstack-cinder-api.service openstack-cinder-scheduler.service\nsystemctl start openstack-cinder-api.service openstack-cinder-scheduler.service\n"})}),"\n",(0,c.jsx)(n.h3,{id:"98-\u9a8c\u8bc1",children:"9.8 \u9a8c\u8bc1"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u8fd4\u56de\u7684\u7ed3\u679c\u662f ",(0,c.jsx)(n.code,{children:"cinder-api"})," \u63d0\u4f9b\u7684\uff0c\u5e76\u4e14 ",(0,c.jsx)(n.code,{children:"cinder-scheduler"})," \u7684\u72b6\u6001\u662fup"]})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ cinder service-list\n+------------------+------------+------+---------+-------+----------------------------+-----------------+\n| Binary           | Host       | Zone | Status  | State | Updated_at                 | Disabled Reason |\n+------------------+------------+------+---------+-------+----------------------------+-----------------+\n| cinder-scheduler | controller | nova | enabled | up    | 2020-05-29T10:58:08.000000 | -               |\n+------------------+------------+------+---------+-------+----------------------------+-----------------+\n"})}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u5b89\u88c5\u548c\u914d\u7f6e\u5757\u5b58\u50a8\u8282\u70b9"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/cinder/rocky/install/cinder-storage-install-rdo.html",children:"rocky\u7248\u5757\u5b58\u50a8\u8282\u70b9\u5757\u5b58\u50a8\u670d\u52a1cinder\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.h3,{id:"99-\u524d\u63d0\u6761\u4ef6",children:"9.9 \u524d\u63d0\u6761\u4ef6"}),"\n",(0,c.jsx)(n.h4,{id:"991-\u5b89\u88c5\u5305",children:"9.9.1 \u5b89\u88c5\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install lvm2 device-mapper-persistent-data openstack-utils.noarch\n"})}),"\n",(0,c.jsx)(n.h4,{id:"992-\u542f\u52a8lvm\u5143\u6570\u636e\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",children:"9.9.2 \u542f\u52a8LVM\u5143\u6570\u636e\u670d\u52a1\uff0c\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable lvm2-lvmetad.service\nsystemctl start lvm2-lvmetad.service\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"993-\u521b\u5efalvm\u7269\u7406\u5377-devvdb",children:["9.9.3 \u521b\u5efaLVM\u7269\u7406\u5377 ",(0,c.jsx)(n.code,{children:"/dev/vdb"})]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5982\u679c\u662f\u5728\u865a\u62df\u673a\u4e2d\uff0c\u9700\u8981\u6dfb\u52a0\u4e00\u5757\u6570\u636e\u76d8\uff0c\u4f7f\u7528\u547d\u4ee4 ",(0,c.jsx)(n.code,{children:'echo "- - -" >/sys/class/scsi_host/host0/scan'})," \u5b9e\u73b0\u70ed\u52a0\u8f7d\uff08\u4e0d\u4e00\u5b9a\u4e3ahost0\uff0c\u4e5f\u53ef\u80fd\u662f\u5176\u4ed6\u6570\u5b57\uff0c\u6bd4\u59821\u30012\u30013\u7b49\uff09"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u67e5\u770b\u6dfb\u52a0\u7684\u78c1\u76d8"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ fdisk -l /dev/vdb\n\nDisk /dev/vdb: 107.4 GB, 107374182400 bytes, 209715200 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u521b\u5efa\u7269\u7406\u5377pv"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'$ pvcreate /dev/vdb\nPhysical volume "/dev/vdb" successfully created.\n'})}),"\n",(0,c.jsxs)(n.h4,{id:"994-\u521b\u5efalvm\u5377\u7ec4cinder-volumes",children:["9.9.4 \u521b\u5efaLVM\u5377\u7ec4",(0,c.jsx)(n.code,{children:"cinder-volumes"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'$ vgcreate cinder-volumes /dev/vdb\nVolume group "cinder-volumes" successfully created\n'})}),"\n",(0,c.jsx)(n.h4,{id:"995-\u5173\u4e8elvm\u7684\u95ee\u9898",children:"9.9.5 \u5173\u4e8elvm\u7684\u95ee\u9898"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u53ea\u6709\u5b9e\u4f8b\u53ef\u4ee5\u8bbf\u95ee\u5757\u5b58\u50a8\u5377\u3002\u4f46\u662f\uff0c\u5e95\u5c42\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u4e0e\u5377\u5173\u8054\u7684\u8bbe\u5907\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cLVM\u5377\u626b\u63cf\u5de5\u5177\u4f1a\u5728 ",(0,c.jsx)(n.code,{children:"/dev"})," \u76ee\u5f55\u4e2d\u626b\u63cf\u5305\u542b\u5377\u7684\u5757\u5b58\u50a8\u8bbe\u5907\u3002\u5982\u679c\u9879\u76ee\u5728\u5176\u5377\u4e0a\u4f7f\u7528LVM\uff0c\u5219\u626b\u63cf\u5de5\u5177\u4f1a\u68c0\u6d4b\u5230\u8fd9\u4e9b\u5377\u5e76\u5c1d\u8bd5\u5bf9\u5176\u8fdb\u884c\u7f13\u5b58\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u57fa\u7840\u64cd\u4f5c\u7cfb\u7edf\u5377\u548c\u9879\u76ee\u5377\u51fa\u73b0\u5404\u79cd\u95ee\u9898\u3002\u60a8\u5fc5\u987b\u5c06LVM\u91cd\u65b0\u914d\u7f6e\u4e3a\u4ec5\u626b\u63cf\u5305\u542b ",(0,c.jsx)(n.code,{children:"cinder-volumes"})," \u5377\u7ec4\u7684\u8bbe\u5907"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5982\u679c\u5b58\u50a8\u8282\u70b9\u5728\u64cd\u4f5c\u7cfb\u7edf\u78c1\u76d8\u4e0a\u4f7f\u7528LVM\uff0c\u5219\u8fd8\u5fc5\u987b\u5c06\u5173\u8054\u7684\u8bbe\u5907\u6dfb\u52a0\u5230\u8fc7\u6ee4\u5668\u4e2d\u3002\u4f8b\u5982\uff0c\u5982\u679c ",(0,c.jsx)(n.code,{children:"/dev/vda"})," \u8bbe\u5907\u5305\u542b\u64cd\u4f5c\u7cfb\u7edf\uff1a"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'filter = [ "a/vda/", "a/vdb/", "r/.*/"]\n'})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u540c\u6837\uff0c\u5982\u679c\u60a8\u7684\u8ba1\u7b97\u8282\u70b9\u5728\u64cd\u4f5c\u7cfb\u7edf\u78c1\u76d8\u4e0a\u4f7f\u7528LVM\uff0c\u5219\u8fd8\u5fc5\u987b ",(0,c.jsx)(n.code,{children:"/etc/lvm/lvm.conf"})," \u5728\u8fd9\u4e9b\u8282\u70b9\u4e0a\u7684\u6587\u4ef6\u4e2d\u4fee\u6539\u8fc7\u6ee4\u5668\uff0c \u4f7f\u5176\u4ec5\u5305\u62ec\u64cd\u4f5c\u7cfb\u7edf\u78c1\u76d8\u3002\u4f8b\u5982\uff0c\u5982\u679c ",(0,c.jsx)(n.code,{children:"/dev/vda"})," \u8bbe\u5907\u5305\u542b\u64cd\u4f5c\u7cfb\u7edf\uff1a"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'filter = [ "a/vda/", "r/.*/"]\n'})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u56e0\u4e3a\u4f7f\u7528\u7684\u865a\u62df\u673a\u5728\u5b89\u88c5\u7684\u65f6\u5019\u662f\u91c7\u7528\u7684lvm\uff0c\u6240\u4ee5\u914d\u7f6e\u6587\u4ef6\u4e2d\u5e94\u5f53\u628a\u7cfb\u7edf\u76d8",(0,c.jsx)(n.code,{children:"/dev/vda"}),"\u4e5f\u6dfb\u52a0"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u7f16\u8f91  ",(0,c.jsx)(n.code,{children:"/etc/lvm/lvm.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'\u5728\u8be5devices\u90e8\u5206\u4e2d\uff0c\u6dfb\u52a0\u4e00\u4e2a\u63a5\u53d7/dev/sdb\u8bbe\u5907\u5e76\u62d2\u7edd\u6240\u6709\u5176\u4ed6\u8bbe\u5907\u7684\u8fc7\u6ee4 \u5668\uff1a\ndevices {\n...\nfilter = [ "a/vdb/", "r/.*/"]\n'})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u6ee4\u6ce2\u5668\u9635\u5217\u4e2d\u7684\u6bcf\u4e2a\u9879\u76ee\u5f00\u59cb\u4e8e",(0,c.jsx)(n.code,{children:"a"}),"\u7528\u4e8e\u63a5\u53d7\u6216 ",(0,c.jsx)(n.code,{children:"r"}),"\u7528\u4e8e\u62d2\u7edd\uff0c\u5e76\u4e14\u5305\u62ec\u7528\u4e8e\u6240\u8ff0\u88c5\u7f6e\u540d\u79f0\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u8be5\u9635\u5217\u5fc5\u987b",(0,c.jsx)(n.code,{children:"r/.*/"}),"\u4ee5\u62d2\u7edd\u4efb\u4f55\u5269\u4f59\u7684\u8bbe\u5907\u7ed3\u5c3e\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528vgs -vvvv\u547d\u4ee4\u6d4b\u8bd5\u8fc7\u6ee4\u5668"]})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'\\cp /etc/lvm/lvm.conf{,.bak} \negrep -v \'^$|#\' /etc/lvm/lvm.conf.bak > /etc/lvm/lvm.conf\nsed -i \'/^devices/a\\\\tfilter = [ "a/vda/", "a/vdb/", "r/.*/"]\' /etc/lvm/lvm.conf\n'})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/lvm/lvm.conf\n572157ddd9d8b095ac37e89f4d1e603a  /etc/lvm/lvm.conf\n"})}),"\n",(0,c.jsx)(n.h3,{id:"910-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",children:"9.10 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6"}),"\n",(0,c.jsx)(n.h4,{id:"9101-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"9.10.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"targetcli\u662fiscsi\u7684\u5305"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-cinder targetcli python-keystone\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"9102-\u7f16\u8f91-etccindercinderconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["9.10.2 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/cinder/cinder.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 ",(0,c.jsx)(n.code,{children:"[DEFAULT]"})," \u533a\u57df\uff0c\u9ed8\u8ba4\u5b98\u65b9\u5b9a\u4e49\u7684\u540e\u7aeflvm\u5377\u540d\u79f0\u5c31\u662flvm\uff0c\u8fd9\u4e2a\u540d\u79f0\u662f\u4efb\u610f\u7684\uff0c\u5e76\u4e14DEFAULT\u533a\u57df\u7684enabled_backends\u5b9a\u4e49\u7684\u540d\u79f0\u662f\u6709\u5355\u72ec\u7684\u4e00\u4e2a\u533a\u57df\uff0c\u4f8b\u5982"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"# default\u533a\u57df\u5185\u5bb9\u5982\u4e0b\n[DEFAULT]\nenabled_backends = lvm\n\n# \u5219\u5982\u4e0b\u533a\u57df\u5185\u5bb9\u548cDEFAULT\u533a\u57df\u5b9a\u4e49\u7684\u540d\u79f0\u4e00\u4e00\u5bf9\u5e94\u7684\n[lvm]\nvolume_driver = cinder.volume.drivers.lvm.LVMVolumeDriver \t# \u9a71\u52a8\nvolume_group = cinder-volumes\t\t# \u5377\u7ec4\u540d\niscsi_protocol = iscsi\t\t\t\t\t\niscsi_helper = lioadm\n\n\n\u5982\u679c\u6709\u591a\u4e2alvm\u5377\uff0c\u5219DEFAULT\u533a\u57df\u53ef\u4ee5\u5199\u6210\u5982\u4e0b\uff0c\u5e76\u4e14\u6700\u540e\u8981\u5199\u4e0a\u4e00\u4e00\u5bf9\u5e94\u7684\u5185\u5bb9\n[DEFAULT]\nenabled_backends = lvm,lvm2,lvm3\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"# \u540e\u6bb5\u540d\u79f0\u4efb\u610f\uff0c\u8fd9\u91cc\u6211\u4eec\u5b9a\u4e49\u4e3a\u666e\u901a\u78c1\u76d8sata\uff0c\u56fa\u6001\u786c\u76d8ssd\n[DEFAULT]\nenabled_backends = sata,ssd\n\n[sata]\nvolume_driver = cinder.volume.drivers.lvm.LVMVolumeDriver\nvolume_group = cinder-volumes\niscsi_protocol = iscsi\niscsi_helper = lioadm\nvolume_backend_name = sata\n\n[ssd]\nvolume_driver = cinder.volume.drivers.lvm.LVMVolumeDriver\nvolume_group = cinder-ssd\niscsi_protocol = iscsi\niscsi_helper = lioadm\nvolume_backend_name = ssd\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"1.\u5728\u8be5[database]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u6570\u636e\u5e93\u8bbf\u95ee\uff1a\n[database]\n# ...\nconnection = mysql+pymysql://cinder:CINDER_DBPASS@controller/cinder\n    \n2.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6eRabbitMQ \u6d88\u606f\u961f\u5217\u8bbf\u95ee\uff1a\n[DEFAULT]\n# ...\ntransport_url = rabbit://openstack:RABBIT_PASS@controller    \n    \n3.\u5728[DEFAULT]\u548c[keystone_authtoken]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8eab\u4efd\u670d\u52a1\u8bbf\u95ee\uff1a\n[DEFAULT]\n# ...\nauth_strategy = keystone\n\n[keystone_authtoken]\n# ...\nwww_authenticate_uri = http://controller:5000\nauth_url = http://controller:5000\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_id = default\nuser_domain_id = default\nproject_name = service\nusername = cinder\npassword = CINDER_PASS \n\n4.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6emy_ip\u9009\u9879\uff1a\u66ff\u6362MANAGEMENT_INTERFACE_IP_ADDRESS\u4e3a\u5b58\u50a8\u8282\u70b9\u4e0a\u7ba1\u7406\u7f51\u7edc\u63a5\u53e3\u7684IP\u5730\u5740\uff0c\u5bf9\u4e8e\u793a\u4f8b\u4f53\u7cfb\u7ed3\u6784\u4e2d\u7684\u7b2c\u4e00\u4e2a\u8282\u70b9\uff0c\u901a\u5e38\u4e3a10.0.0.41\n[DEFAULT]\n# ...\nmy_ip = MANAGEMENT_INTERFACE_IP_ADDRESS\n\n5.\u5728\u8be5[lvm]\u90e8\u5206\u4e2d\uff0c\u4e3aLVM\u540e\u7aef\u914d\u7f6eLVM\u9a71\u52a8\u7a0b\u5e8f\uff0ccinder-volumes\u5377\u7ec4\uff0ciSCSI\u534f\u8bae\u548c\u9002\u5f53\u7684iSCSI\u670d\u52a1\u3002\u5982\u679c\u8be5[lvm]\u90e8\u5206\u4e0d\u5b58\u5728\uff0c\u8bf7\u521b\u5efa\u5b83\uff1a\n[lvm]\nvolume_driver = cinder.volume.drivers.lvm.LVMVolumeDriver\nvolume_group = cinder-volumes\niscsi_protocol = iscsi\niscsi_helper = lioadm\n\n6.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u542f\u7528LVM\u540e\u7aef\uff1a\t\u540e\u7aef\u540d\u79f0\u662f\u4efb\u610f\u7684\u3002\u4f8b\u5982\uff0c\u672c\u6307\u5357\u4f7f\u7528\u9a71\u52a8\u7a0b\u5e8f\u7684\u540d\u79f0\u4f5c\u4e3a\u540e\u7aef\u7684\u540d\u79f0\u3002\n[DEFAULT]\n# ...\nenabled_backends = lvm\n\n7.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u56fe\u50cf\u670d\u52a1API\u7684\u4f4d\u7f6e\uff1a\n[DEFAULT]\n# ...\nglance_api_servers = http://controller:9292\n    \n8.\u5728\u8be5[oslo_concurrency]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u9501\u5b9a\u8def\u5f84\uff1a\n[oslo_concurrency]\n# ...\nlock_path = /var/lib/cinder/tmp \n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/cinder/cinder.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/cinder/cinder.conf.bak > /etc/cinder/cinder.conf\nopenstack-config --set /etc/cinder/cinder.conf database connection mysql+pymysql://cinder:CINDER_DBPASS@controller/cinder\nopenstack-config --set /etc/cinder/cinder.conf DEFAULT transport_url rabbit://openstack:RABBIT_PASS@controller\nopenstack-config --set /etc/cinder/cinder.conf DEFAULT auth_strategy keystone\nopenstack-config --set /etc/cinder/cinder.conf DEFAULT my_ip 172.30.100.6\nopenstack-config --set /etc/cinder/cinder.conf DEFAULT enabled_backends lvm\nopenstack-config --set /etc/cinder/cinder.conf DEFAULT glance_api_servers http://controller:9292\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken www_authenticate_uri http://controller:5000  \nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_url http://controller:5000\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken memcached_servers controller:11211\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken auth_type password\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken project_domain_id default\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken user_domain_id default\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken project_name service\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken username cinder\nopenstack-config --set /etc/cinder/cinder.conf keystone_authtoken password CINDER_PASS\nopenstack-config --set /etc/cinder/cinder.conf lvm volume_driver cinder.volume.drivers.lvm.LVMVolumeDriver\nopenstack-config --set /etc/cinder/cinder.conf lvm volume_group cinder-volumes\nopenstack-config --set /etc/cinder/cinder.conf lvm iscsi_protocol iscsi\nopenstack-config --set /etc/cinder/cinder.conf lvm iscsi_helper lioadm\nopenstack-config --set /etc/cinder/cinder.conf oslo_concurrency lock_path /var/lib/cinder/tmp\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6587\u4ef6md5\u503c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ md5sum /etc/cinder/cinder.conf\nc88237e48f728cbe389b57c75b2be155  /etc/cinder/cinder.conf\n"})}),"\n",(0,c.jsx)(n.h4,{id:"9103-\u542f\u52a8\u5757\u5b58\u50a8\u5377\u670d\u52a1\u53ca\u5176\u76f8\u5173\u6027\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",children:"9.10.3 \u542f\u52a8\u5757\u5b58\u50a8\u5377\u670d\u52a1\u53ca\u5176\u76f8\u5173\u6027\uff0c\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable openstack-cinder-volume.service target.service\nsystemctl start openstack-cinder-volume.service target.service\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5230\u6b64\uff0c\u63a7\u5236\u8282\u70b9\u548c\u5757\u5b58\u50a8\u8282\u70b9\u5757\u5b58\u50a8\u670d\u52a1cinder\u5b89\u88c5\u5b8c\u6210\uff01\uff01\uff01"})}),"\n",(0,c.jsx)(n.h2,{id:"10\u63a7\u5236\u8282\u70b9\u548c\u5bf9\u8c61\u8282\u70b9\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1swift\u5b89\u88c5",children:"10.\u63a7\u5236\u8282\u70b9\u548c\u5bf9\u8c61\u8282\u70b9\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1swift\u5b89\u88c5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"OpenStack\u5bf9\u8c61\u5b58\u50a8\u662f\u4e00\u4e2a\u591a\u79df\u6237\u5bf9\u8c61\u5b58\u50a8\u7cfb\u7edf\u3002\u5b83\u5177\u6709\u9ad8\u5ea6\u7684\u53ef\u6269\u5c55\u6027\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7RESTful HTTP API\u4ee5\u4f4e\u6210\u672c\u7ba1\u7406\u5927\u91cf\u975e\u7ed3\u6784\u5316\u6570\u636e\u3002"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"swift\u76f8\u5173\u7ec4\u4ef6"})}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u540d\u79f0"}),(0,c.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"\u4ee3\u7406\u670d\u52a1\u5668\uff08swift-proxy-server\uff09"})}),(0,c.jsx)(n.td,{children:"\u63a5\u53d7OpenStack\u5bf9\u8c61\u5b58\u50a8API\u548c\u539f\u59cbHTTP\u8bf7\u6c42\uff0c\u4ee5\u4e0a\u4f20\u6587\u4ef6\uff0c\u4fee\u6539\u5143\u6570\u636e\u548c\u521b\u5efa\u5bb9\u5668\u3002\u5b83\u8fd8\u5411\u7f51\u7edc\u6d4f\u89c8\u5668\u63d0\u4f9b\u6587\u4ef6\u6216\u5bb9\u5668\u5217\u8868\u3002\u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd\uff0c\u4ee3\u7406\u670d\u52a1\u5668\u53ef\u4ee5\u4f7f\u7528\u901a\u5e38\u4e0ememcache\u4e00\u8d77\u90e8\u7f72\u7684\u53ef\u9009\u7f13\u5b58\u3002"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"\u5e10\u6237\u670d\u52a1\u5668\uff08swift-account-server\uff09"})}),(0,c.jsx)(n.td,{children:"\u7ba1\u7406\u4f7f\u7528\u5bf9\u8c61\u5b58\u50a8\u5b9a\u4e49\u7684\u5e10\u6237"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"\u5bb9\u5668\u670d\u52a1\u5668\uff08swift\u5bb9\u5668\u670d\u52a1\u5668\uff09"})}),(0,c.jsx)(n.td,{children:"\u5728\u5bf9\u8c61\u5b58\u50a8\u4e2d\u7ba1\u7406\u5bb9\u5668\u6216\u6587\u4ef6\u5939\u7684\u6620\u5c04"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"\u5bf9\u8c61\u670d\u52a1\u5668\uff08swift-object-server\uff09"})}),(0,c.jsx)(n.td,{children:"\u7ba1\u7406\u5b58\u50a8\u8282\u70b9\u4e0a\u7684\u5b9e\u9645\u5bf9\u8c61\uff0c\u4f8b\u5982\u6587\u4ef6"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"\u5404\u79cd\u5468\u671f\u6027\u8fc7\u7a0b"})}),(0,c.jsx)(n.td,{children:"\u5728\u5927\u578b\u6570\u636e\u5b58\u50a8\u4e0a\u6267\u884c\u5185\u52a1\u5904\u7406\u4efb\u52a1\u3002\u590d\u5236\u670d\u52a1\u53ef\u786e\u4fdd\u6574\u4e2a\u7fa4\u96c6\u7684\u4e00\u81f4\u6027\u548c\u53ef\u7528\u6027\u3002\u5176\u4ed6\u5b9a\u671f\u8fc7\u7a0b\u5305\u62ec\u5ba1\u6838\u5458\uff0c\u66f4\u65b0\u8005\u548c\u6536\u5272\u8005"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"WSGI\u4e2d\u95f4\u4ef6"})}),(0,c.jsx)(n.td,{children:"\u5904\u7406\u8eab\u4efd\u9a8c\u8bc1\uff0c\u901a\u5e38\u662fOpenStack\u8eab\u4efd"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"swift client"})}),(0,c.jsx)(n.td,{children:"\u4f7f\u7528\u6237\u80fd\u591f\u901a\u8fc7\u6388\u6743\u4e3a\u7ba1\u7406\u5458\u7528\u6237\uff0c\u4ee3\u7406\u5546\u7528\u6237\u6216\u5feb\u901f\u7528\u6237\u7684\u547d\u4ee4\u884c\u5ba2\u6237\u7aef\u5c06\u547d\u4ee4\u63d0\u4ea4\u5230REST API"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"swift-init"})}),(0,c.jsxs)(n.td,{children:["\u811a\u672c\u521d\u59cb\u5316\u73af\u6587\u4ef6\u7684\u6784\u5efa\uff0c\u4ee5\u5b88\u62a4\u7a0b\u5e8f\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\u5e76\u63d0\u4f9b\u547d\u4ee4\u3002\u8bb0\u5f55\u5728 ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/latest/admin_guide.html#managing-services",children:"https://docs.openstack.org/swift/latest/admin_guide.html#managing-services\u4e2d"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"swift-recon"})}),(0,c.jsx)(n.td,{children:"cli\u5de5\u5177\uff0c\u7528\u4e8e\u68c0\u7d22swift-recon\u4e2d\u95f4\u4ef6\u5df2\u6536\u96c6\u7684\u6709\u5173\u7fa4\u96c6\u7684\u5404\u79cd\u5ea6\u91cf\u548c\u9065\u6d4b\u4fe1\u606f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.strong,{children:"swift-ring-builder"})}),(0,c.jsxs)(n.td,{children:["\u5b58\u50a8\u73af\u6784\u5efa\u548c\u91cd\u65b0\u5e73\u8861\u5b9e\u7528\u7a0b\u5e8f\u3002\u5728 ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/latest/admin_guide.html#managing-the-rings",children:"https://docs.openstack.org/swift/latest/admin_guide.html#managing-the-rings\u4e2d\u8bb0\u5f55"})]})]})]})]}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u5b89\u88c5\u548c\u914d\u7f6e\u63a7\u5236\u8282\u70b9"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/controller-install-rdo.html",children:"rocky\u7248\u63a7\u5236\u8282\u70b9\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1swift\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.h3,{id:"101-\u521b\u5efa\u8eab\u4efd\u670d\u52a1\u51ed\u636e",children:"10.1 \u521b\u5efa\u8eab\u4efd\u670d\u52a1\u51ed\u636e"}),"\n",(0,c.jsx)(n.h4,{id:"1011-\u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458cli\u547d\u4ee4\u7684\u8bbf\u95ee",children:"10.1.1 \u83b7\u53d6\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u83b7\u53d6\u5bf9\u4ec5\u7ba1\u7406\u5458CLI\u547d\u4ee4\u7684\u8bbf\u95ee"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"source /opt/admin-openrc\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1012-\u521b\u5efa-swift-\u7528\u6237",children:["10.1.2 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"swift"})," \u7528\u6237"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5bc6\u7801\u8bbe\u7f6e\u4e3a ",(0,c.jsx)(n.code,{children:"SWIFT_PASS"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u4ea4\u4e92\u5f0f\u4e0e\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801\u9009\u62e9\u5176\u4e2d\u4e00\u79cd"})}),"\n",(0,c.jsx)(n.p,{children:"\u975e\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ openstack user create --domain default --password SWIFT_PASS swift\n+---------------------+----------------------------------+\n| Field               | Value                            |\n+---------------------+----------------------------------+\n| domain_id           | default                          |\n| enabled             | True                             |\n| id                  | 312ab4f320434d30b76c9486463e2dea |\n| name                | swift                            |\n| options             | {}                               |\n| password_expires_at | None                             |\n+---------------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4ea4\u4e92\u5f0f\u8bbe\u7f6e\u5bc6\u7801"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"openstack user create --domain default --password-prompt swift\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1013-\u5c06-admin-\u89d2\u8272\u6dfb\u52a0\u5230-swift-\u7528\u6237",children:["10.1.3 \u5c06 ",(0,c.jsx)(n.code,{children:"admin"})," \u89d2\u8272\u6dfb\u52a0\u5230 ",(0,c.jsx)(n.code,{children:"swift"})," \u7528\u6237"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"openstack role add --project service --user swift admin\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1014-\u521b\u5efa-swift-\u670d\u52a1\u5b9e\u4f53",children:["10.1.4 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"swift"})," \u670d\u52a1\u5b9e\u4f53"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'$ openstack service create --name swift \\\n--description "OpenStack Object Storage" object-store\n+-------------+----------------------------------+\n| Field       | Value                            |\n+-------------+----------------------------------+\n| description | OpenStack Object Storage         |\n| enabled     | True                             |\n| id          | a41ace8ca3bb42ec92e27a29503828e7 |\n| name        | swift                            |\n| type        | object-store                     |\n+-------------+----------------------------------+\n'})}),"\n",(0,c.jsx)(n.h3,{id:"102-\u521b\u5efa\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1api\u7aef\u70b9",children:"10.2 \u521b\u5efa\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1API\u7aef\u70b9"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ openstack endpoint create --region RegionOne \\\nobject-store public http://controller:8080/v1/AUTH_%\\(project_id\\)s\n+--------------+-----------------------------------------------+\n| Field        | Value                                         |\n+--------------+-----------------------------------------------+\n| enabled      | True                                          |\n| id           | 25063822e1c947f38189af370d97a0c2              |\n| interface    | public                                        |\n| region       | RegionOne                                     |\n| region_id    | RegionOne                                     |\n| service_id   | a41ace8ca3bb42ec92e27a29503828e7              |\n| service_name | swift                                         |\n| service_type | object-store                                  |\n| url          | http://controller:8080/v1/AUTH_%(project_id)s |\n+--------------+-----------------------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nobject-store internal http://controller:8080/v1/AUTH_%\\(project_id\\)s\n+--------------+-----------------------------------------------+\n| Field        | Value                                         |\n+--------------+-----------------------------------------------+\n| enabled      | True                                          |\n| id           | 6f36da03e9344d84906f98a31a09ebe9              |\n| interface    | internal                                      |\n| region       | RegionOne                                     |\n| region_id    | RegionOne                                     |\n| service_id   | a41ace8ca3bb42ec92e27a29503828e7              |\n| service_name | swift                                         |\n| service_type | object-store                                  |\n| url          | http://controller:8080/v1/AUTH_%(project_id)s |\n+--------------+-----------------------------------------------+\n\n$ openstack endpoint create --region RegionOne \\\nobject-store admin http://controller:8080/v1\n+--------------+----------------------------------+\n| Field        | Value                            |\n+--------------+----------------------------------+\n| enabled      | True                             |\n| id           | ffe6a96aeb224d8abe3e0c3de6c9e072 |\n| interface    | admin                            |\n| region       | RegionOne                        |\n| region_id    | RegionOne                        |\n| service_id   | a41ace8ca3bb42ec92e27a29503828e7 |\n| service_name | swift                            |\n| service_type | object-store                     |\n| url          | http://controller:8080/v1        |\n+--------------+----------------------------------+\n"})}),"\n",(0,c.jsx)(n.h3,{id:"103-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",children:"10.3 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6"}),"\n",(0,c.jsx)(n.h4,{id:"1031-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"10.3.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-swift-proxy python-swiftclient \\\npython-keystoneclient python-keystonemiddleware memcached openstack-utils.noarch\n"})}),"\n",(0,c.jsx)(n.h4,{id:"1032-\u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u83b7\u53d6\u4ee3\u7406\u670d\u52a1\u914d\u7f6e\u6587\u4ef6",children:"10.3.2 \u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u83b7\u53d6\u4ee3\u7406\u670d\u52a1\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"curl -o /etc/swift/proxy-server.conf https://opendev.org/openstack/swift/raw/branch/stable/rocky/etc/proxy-server.conf-sample \n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1033-\u7f16\u8f91-etcswiftproxy-serverconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["10.3.3 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/swift/proxy-server.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u8fd9\u91cc\u5b98\u65b9\u6587\u6863\u6709\u5751\uff0cq\u7248\u4e4b\u540e\u5c31\u4e0d\u752835357\u7aef\u53e3\u4e86\uff0c\u4f46\u662f\u6587\u6863\u4e2d\u8fd8\u662f\u5199\u7740",(0,c.jsx)(n.code,{children:"auth_url = http://controller:35357"}),"\uff0c\u8fd9\u91cc\u5e94\u8be5\u6539\u62105000\u7aef\u53e3\uff0c\u5426\u5219\u540e\u7eed\u9a8c\u8bc1swift\u4f1a\u62a5\u9519500"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"1.\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u7ed1\u5b9a\u7aef\u53e3\uff0c\u7528\u6237\u548c\u914d\u7f6e\u76ee\u5f55\uff1a\n[DEFAULT]\n...\nbind_port = 8080\nuser = swift\nswift_dir = /etc/swift\n\n2.\u5728\u8be5[pipeline:main]\u90e8\u5206\u4e2d\uff0c\u5220\u9664tempurl\u548c tempauth\u6a21\u5757\uff0c\u7136\u540e\u6dfb\u52a0authtoken\u548ckeystoneauth \u6a21\u5757  \u8bf7\u52ff\u66f4\u6539\u6a21\u5757\u7684\u987a\u5e8f\uff01\uff01\uff01\n\u6709\u5173\u542f\u7528\u5176\u4ed6\u529f\u80fd\u7684\u5176\u4ed6\u6a21\u5757\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u8003\u5982\u4e0b\u5730\u5740\nhttps://docs.openstack.org/swift/latest/deployment_guide.html\n\n[pipeline:main]\npipeline = catch_errors gatekeeper healthcheck proxy-logging cache container_sync bulk ratelimit authtoken keystoneauth container-quotas account-quotas slo dlo versioned_writes proxy-logging proxy-server\n\n3.\u5728\u8be5[app:proxy-server]\u90e8\u5206\u4e2d\uff0c\u542f\u7528\u81ea\u52a8\u5e10\u6237\u521b\u5efa\uff1a\n[app:proxy-server]\nuse = egg:swift#proxy\n...\naccount_autocreate = True\n\n4.\u5728\u8be5[filter:keystoneauth]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u64cd\u4f5c\u5458\u89d2\u8272\uff1a\n[filter:keystoneauth]\nuse = egg:swift#keystoneauth\n...\noperator_roles = admin,user\n\n5.\u5728\u8be5[filter:authtoken]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u8eab\u4efd\u670d\u52a1\u8bbf\u95ee\uff1a\n[filter:authtoken]\npaste.filter_factory = keystonemiddleware.auth_token:filter_factory\n...\nwww_authenticate_uri = http://controller:5000\nauth_url = http://controller:5000\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_id = default\nuser_domain_id = default\nproject_name = service\nusername = swift\npassword = SWIFT_PASS\ndelay_auth_decision = True\n\n6.\u5728\u8be5[filter:cache]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6ememcached\u4f4d\u7f6e\uff1a\n[filter:cache]\nuse = egg:swift#memcache\n...\nmemcache_servers = controller:11211\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/swift/proxy-server.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/swift/proxy-server.conf.bak > /etc/swift/proxy-server.conf\nopenstack-config --set /etc/swift/proxy-server.conf DEFAULT bind_port 8080\nopenstack-config --set /etc/swift/proxy-server.conf DEFAULT user swift\nopenstack-config --set /etc/swift/proxy-server.conf DEFAULT swift_dir /etc/swift\nopenstack-config --set /etc/swift/proxy-server.conf app:proxy-server use egg:swift#proxy\nopenstack-config --set /etc/swift/proxy-server.conf app:proxy-server account_autocreate True\nopenstack-config --set /etc/swift/proxy-server.conf filter:keystoneauth use egg:swift#keystoneauth\nopenstack-config --set /etc/swift/proxy-server.conf filter:keystoneauth operator_roles admin,user\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken paste.filter_factory keystonemiddleware.auth_token:filter_factory\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken www_authenticate_uri http://controller:5000\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken auth_url http://controller:5000\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken memcached_servers controller:11211\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken auth_type password\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken project_domain_id default\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken user_domain_id default\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken project_name service\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken username swift\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken password SWIFT_PASS\nopenstack-config --set /etc/swift/proxy-server.conf filter:authtoken delay_auth_decision True \nopenstack-config --set /etc/swift/proxy-server.conf filter:cache use egg:swift#memcache \nopenstack-config --set /etc/swift/proxy-server.conf filter:cache memcache_servers controller:11211   \nsed -i '/^pipeline/c pipeline = catch_errors gatekeeper healthcheck proxy-logging cache container_sync bulk ratelimit authtoken keystoneauth container-quotas account-quotas slo dlo versioned_writes proxy-logging proxy-server' /etc/swift/proxy-server.conf\n"})}),"\n",(0,c.jsx)("h3",{style:{color:"red"},children:"\u5b89\u88c5\u548c\u914d\u7f6e\u5bf9\u8c61\u8282\u70b9"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install-rdo.html",children:"rocky\u7248\u5b58\u50a8\u8282\u70b9\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1swift\u5b89\u88c5\u914d\u7f6e\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u672c\u8282\u4ecb\u7ecd\u5982\u4f55\u5b89\u88c5\u548c\u914d\u7f6e\u7528\u4e8e\u64cd\u4f5c\u5e10\u6237\uff0c\u5bb9\u5668\u548c\u5bf9\u8c61\u670d\u52a1\u7684\u5b58\u50a8\u8282\u70b9\u3002\u4e3a\u7b80\u5355\u8d77\u89c1\uff0c\u6b64\u914d\u7f6e\u5f15\u7528\u4e24\u4e2a\u5b58\u50a8\u8282\u70b9\uff0c\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u5305\u542b\u4e24\u4e2a\u7a7a\u7684\u672c\u5730\u5757\u5b58\u50a8\u8bbe\u5907\u3002\u6307\u4ee4\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"/dev/sdb"})," \u548c ",(0,c.jsx)(n.code,{children:"/dev/sdc"}),"\uff0c\u4f46\u662f\u60a8\u53ef\u4ee5\u4e3a\u7279\u5b9a\u8282\u70b9\u66ff\u6362\u4e0d\u540c\u7684\u503c\u3002"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5c3d\u7ba1\u5bf9\u8c61\u5b58\u50a8\u652f\u6301\u5177\u6709\u6269\u5c55\u5c5e\u6027\uff08xattr\uff09\u7684\u4efb\u4f55\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f46\u662f\u6d4b\u8bd5\u548c\u57fa\u51c6\u6d4b\u8bd5\u8868\u660eXFS\u5177\u6709\u6700\u4f73\u6027\u80fd\u548c\u53ef\u9760\u6027\u3002\u6709\u5173\u6c34\u5e73\u6269\u5c55\u73af\u5883\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u300a ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/latest/deployment_guide.html",children:"\u90e8\u7f72\u6307\u5357\u300b"}),"\u3002"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u672c\u90e8\u5206\u9002\u7528\u4e8eRed Hat Enterprise Linux 7\u548cCentOS 7"})}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"104-\u524d\u63d0\u6761\u4ef6",children:"10.4 \u524d\u63d0\u6761\u4ef6"}),"\n",(0,c.jsx)(n.h4,{id:"1041-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"10.4.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"yum -y install xfsprogs rsync\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1042-\u5c06devsdb\u548cdevsdc\u8bbe\u5907\u683c\u5f0f\u5316\u4e3axfs",children:["10.4.2 \u5c06",(0,c.jsx)(n.code,{children:"/dev/sdb"}),"\u548c",(0,c.jsx)(n.code,{children:"/dev/sdc"}),"\u8bbe\u5907\u683c\u5f0f\u5316\u4e3aXFS"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"mkfs.xfs /dev/sdb\nmkfs.xfs /dev/sdc\n"})}),"\n",(0,c.jsx)(n.h4,{id:"1043-\u521b\u5efa\u5b89\u88c5\u70b9\u76ee\u5f55\u7ed3\u6784",children:"10.4.3 \u521b\u5efa\u5b89\u88c5\u70b9\u76ee\u5f55\u7ed3\u6784"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"mkdir -p /srv/node/sdb\nmkdir -p /srv/node/sdc\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1044-\u7f16\u8f91-etcfstab-\u6587\u4ef6\u5e76\u5411\u5176\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9",children:["10.4.4 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/fstab"})," \u6587\u4ef6\u5e76\u5411\u5176\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"cp /etc/fstab{,.bak}\ncat >> /etc/fstab <<EOF\n/dev/sdb /srv/node/sdb xfs noatime,nodiratime,nobarrier,logbufs=8 0 2\n/dev/sdc /srv/node/sdc xfs noatime,nodiratime,nobarrier,logbufs=8 0 2\nEOF\n"})}),"\n",(0,c.jsx)(n.h4,{id:"1045-\u6302\u8f7d\u76ee\u5f55",children:"10.4.5 \u6302\u8f7d\u76ee\u5f55"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"mount /srv/node/sdb\nmount /srv/node/sdc\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1046-\u521b\u5efa\u6216\u7f16\u8f91-etcrsyncdconf-\u6587\u4ef6\u4ee5\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9",children:["10.4.6 \u521b\u5efa\u6216\u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/rsyncd.conf"})," \u6587\u4ef6\u4ee5\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u8be5 ",(0,c.jsx)(n.code,{children:"rsync"})," \u670d\u52a1\u4e0d\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1\uff0c\u56e0\u6b64\u8bf7\u8003\u8651\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u4e13\u7528\u7f51\u7edc\u4e0a\u8fd0\u884c\u5b83\u3002"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u66ff\u6362 ",(0,c.jsx)(n.code,{children:"MANAGEMENT_INTERFACE_IP_ADDRESS"})," \u4e3a\u5b58\u50a8\u8282\u70b9\u4e0a\u7ba1\u7406\u7f51\u7edc\u7684IP\u5730\u5740"]})}),"\n",(0,c.jsx)(n.p,{children:"object01\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/rsyncd{,.bak}\ncat > /etc/rsyncd.conf <<EOF\nuid = swift\ngid = swift\nlog file = /var/log/rsyncd.log\npid file = /var/run/rsyncd.pid\naddress = 172.30.100.7\n\n[account]\nmax connections = 2\npath = /srv/node/\nread only = False\nlock file = /var/lock/account.lock\n\n[container]\nmax connections = 2\npath = /srv/node/\nread only = False\nlock file = /var/lock/container.lock\n\n[object]\nmax connections = 2\npath = /srv/node/\nread only = False\nlock file = /var/lock/object.lock\nEOF\n"})}),"\n",(0,c.jsx)(n.p,{children:"object02\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/rsyncd{,.bak}\ncat > /etc/rsyncd.conf <<EOF\nuid = swift\ngid = swift\nlog file = /var/log/rsyncd.log\npid file = /var/run/rsyncd.pid\naddress = 172.30.100.8\n\n[account]\nmax connections = 2\npath = /srv/node/\nread only = False\nlock file = /var/lock/account.lock\n\n[container]\nmax connections = 2\npath = /srv/node/\nread only = False\nlock file = /var/lock/container.lock\n\n[object]\nmax connections = 2\npath = /srv/node/\nread only = False\nlock file = /var/lock/object.lock\nEOF\n"})}),"\n",(0,c.jsx)(n.h3,{id:"105-\u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6",children:"10.5 \u5b89\u88c5\u548c\u914d\u7f6e\u7ec4\u4ef6"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5728\u6bcf\u4e2a\u5bf9\u8c61\u8282\u70b9\u4e0a\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4"})}),"\n",(0,c.jsx)(n.h4,{id:"1051-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"10.5.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"yum -y install openstack-swift-account openstack-swift-container \\\nopenstack-swift-object openstack-utils.noarch\n"})}),"\n",(0,c.jsx)(n.h4,{id:"1052-\u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u4e2d\u83b7\u53d6\u8ba1\u8d39\u5bb9\u5668\u548c\u5bf9\u8c61\u670d\u52a1\u914d\u7f6e\u6587\u4ef6",children:"10.5.2 \u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u4e2d\u83b7\u53d6\u8ba1\u8d39\uff0c\u5bb9\u5668\u548c\u5bf9\u8c61\u670d\u52a1\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"curl -o /etc/swift/account-server.conf https://opendev.org/openstack/swift/raw/branch/stable/rocky/etc/account-server.conf-sample\n  \ncurl -o /etc/swift/container-server.conf https://opendev.org/openstack/swift/raw/branch/stable/rocky/etc/container-server.conf-sample\n  \ncurl -o /etc/swift/object-server.conf https://opendev.org/openstack/swift/raw/branch/stable/rocky/etc/object-server.conf-sample\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1053-\u7f16\u8f91-etcswiftaccount-serverconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["10.5.3 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/swift/account-server.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u6b64[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u7ed1\u5b9aIP\u5730\u5740\uff0c\u7ed1\u5b9a\u7aef\u53e3\uff0c\u7528\u6237\uff0c\u914d\u7f6e\u76ee\u5f55\u548c\u5b89\u88c5\u70b9\u76ee\u5f55\uff1a\u66ff\u6362MANAGEMENT_INTERFACE_IP_ADDRESS\u4e3a\u5b58\u50a8\u8282\u70b9\u4e0a\u7ba1\u7406\u7f51\u7edc\u7684IP\u5730\u5740\u3002\n[DEFAULT]\n...\nbind_ip = MANAGEMENT_INTERFACE_IP_ADDRESS\nbind_port = 6202\nuser = swift\nswift_dir = /etc/swift\ndevices = /srv/node\nmount_check = True\n\n2.\u5728\u8be5[pipeline:main]\u90e8\u5206\u4e2d\uff0c\u542f\u7528\u9002\u5f53\u7684\u6a21\u5757\uff1a\n\u6709\u5173\u542f\u7528\u5176\u4ed6\u529f\u80fd\u7684\u5176\u4ed6\u6a21\u5757\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53c2\u8003\u5982\u4e0b\u5730\u5740\nhttps://docs.openstack.org/swift/latest/deployment_guide.html\n[pipeline:main]\npipeline = healthcheck recon account-server\n\n3.\u5728\u8be5[filter:recon]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u4fa6\u5bdf\uff08\u8ba1\u91cf\uff09\u7f13\u5b58\u76ee\u5f55\uff1a\n[filter:recon]\nuse = egg:swift#recon\n...\nrecon_cache_path = /var/cache/swift\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"export IP=`ip a s eth0| awk -F '[ /]+' 'NR==3{print $3}'`\n\\cp /etc/swift/account-server.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/swift/account-server.conf.bak > /etc/swift/account-server.conf\nopenstack-config --set /etc/swift/account-server.conf DEFAULT bind_ip ${IP}\nopenstack-config --set /etc/swift/account-server.conf DEFAULT bind_port 6202\nopenstack-config --set /etc/swift/account-server.conf DEFAULT user swift\nopenstack-config --set /etc/swift/account-server.conf DEFAULT swift_dir /etc/swift\nopenstack-config --set /etc/swift/account-server.conf DEFAULT devices /srv/node\nopenstack-config --set /etc/swift/account-server.conf DEFAULT mount_check True\nopenstack-config --set /etc/swift/account-server.conf filter:recon use egg:swift#recon\nopenstack-config --set /etc/swift/account-server.conf filter:recon recon_cache_path /var/cache/swift \n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1054-\u7f16\u8f91-etcswiftcontainer-serverconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["10.5.4 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/swift/container-server.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"1.\u5728\u6b64[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u7ed1\u5b9aIP\u5730\u5740\uff0c\u7ed1\u5b9a\u7aef\u53e3\uff0c\u7528\u6237\uff0c\u914d\u7f6e\u76ee\u5f55\u548c\u5b89\u88c5\u70b9\u76ee\u5f55\uff1a\n\u66ff\u6362MANAGEMENT_INTERFACE_IP_ADDRESS\u4e3a\u5b58\u50a8\u8282\u70b9\u4e0a\u7ba1\u7406\u7f51\u7edc\u7684IP\u5730\u5740\u3002\n[DEFAULT]\n...\nbind_ip = MANAGEMENT_INTERFACE_IP_ADDRESS\nbind_port = 6201\nuser = swift\nswift_dir = /etc/swift\ndevices = /srv/node\nmount_check = True\n\n2.\u5728\u8be5[pipeline:main]\u90e8\u5206\u4e2d\uff0c\u542f\u7528\u9002\u5f53\u7684\u6a21\u5757\uff1a\n\u6709\u5173\u542f\u7528\u5176\u4ed6\u529f\u80fd\u7684\u5176\u4ed6\u6a21\u5757\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u8003\u5982\u4e0b\u5730\u5740\nhttps://docs.openstack.org/swift/latest/deployment_guide.html\n[pipeline:main]\npipeline = healthcheck recon container-server\n\n3.\u5728\u8be5[filter:recon]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u4fa6\u5bdf\uff08\u8ba1\u91cf\uff09\u7f13\u5b58\u76ee\u5f55\uff1a\n[filter:recon]\nuse = egg:swift#recon\n...\nrecon_cache_path = /var/cache/swift\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"export IP=`ip a s eth0| awk -F '[ /]+' 'NR==3{print $3}'`\n\\cp /etc/swift/container-server.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/swift/container-server.conf.bak > /etc/swift/container-server.conf\nopenstack-config --set /etc/swift/container-server.conf DEFAULT bind_ip ${IP}\nopenstack-config --set /etc/swift/container-server.conf DEFAULT bind_port 6201\nopenstack-config --set /etc/swift/container-server.conf DEFAULT user swift\nopenstack-config --set /etc/swift/container-server.conf DEFAULT swift_dir /etc/swift\nopenstack-config --set /etc/swift/container-server.conf DEFAULT devices /srv/node\nopenstack-config --set /etc/swift/container-server.conf DEFAULT mount_check True\nopenstack-config --set /etc/swift/container-server.conf filter:recon use egg:swift#recon\nopenstack-config --set /etc/swift/container-server.conf filter:recon recon_cache_path /var/cache/swift \n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1055-\u7f16\u8f91etcswiftobject-serverconf\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["10.5.5 \u7f16\u8f91",(0,c.jsx)(n.code,{children:"/etc/swift/object-server.conf"}),"\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u6b64[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u7ed1\u5b9aIP\u5730\u5740\uff0c\u7ed1\u5b9a\u7aef\u53e3\uff0c\u7528\u6237\uff0c\u914d\u7f6e\u76ee\u5f55\u548c\u5b89\u88c5\u70b9\u76ee\u5f55\uff1a\n\u66ff\u6362MANAGEMENT_INTERFACE_IP_ADDRESS\u4e3a\u5b58\u50a8\u8282\u70b9\u4e0a\u7ba1\u7406\u7f51\u7edc\u7684IP\u5730\u5740\u3002\n[DEFAULT]\n...\nbind_ip = MANAGEMENT_INTERFACE_IP_ADDRESS\nbind_port = 6200\nuser = swift\nswift_dir = /etc/swift\ndevices = /srv/node\nmount_check = True\n\n2.\u5728\u8be5[pipeline:main]\u90e8\u5206\u4e2d\uff0c\u542f\u7528\u9002\u5f53\u7684\u6a21\u5757\uff1a\n\u6709\u5173\u542f\u7528\u5176\u4ed6\u529f\u80fd\u7684\u5176\u4ed6\u6a21\u5757\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u8003\u5982\u4e0b\u5730\u5740\nhttps://docs.openstack.org/swift/latest/deployment_guide.html\n[pipeline:main]\npipeline = healthcheck recon object-server\n\n3.\u5728\u6b64[filter:recon]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u4fa6\u5bdf\uff08\u4eea\u8868\uff09\u7f13\u5b58\u548c\u9501\u5b9a\u76ee\u5f55\uff1a\n[filter:recon]\nuse = egg:swift#recon\n...\nrecon_cache_path = /var/cache/swift\nrecon_lock_path = /var/lock\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"export IP=`ip a s eth0| awk -F '[ /]+' 'NR==3{print $3}'`\n\\cp /etc/swift/object-server.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/swift/object-server.conf.bak > /etc/swift/object-server.conf\nopenstack-config --set /etc/swift/object-server.conf DEFAULT bind_ip ${IP}\nopenstack-config --set /etc/swift/object-server.conf DEFAULT bind_port 6200\nopenstack-config --set /etc/swift/object-server.conf DEFAULT user swift\nopenstack-config --set /etc/swift/object-server.conf DEFAULT swift_dir /etc/swift\nopenstack-config --set /etc/swift/object-server.conf DEFAULT devices /srv/node\nopenstack-config --set /etc/swift/object-server.conf DEFAULT mount_check True\nopenstack-config --set /etc/swift/object-server.conf filter:recon use egg:swift#recon\nopenstack-config --set /etc/swift/object-server.conf filter:recon recon_cache_path /var/cache/swift\nopenstack-config --set /etc/swift/object-server.conf filter:recon recon_lock_path /var/lock   \n"})}),"\n",(0,c.jsx)(n.h4,{id:"1056-\u786e\u4fdd\u5bf9\u5b89\u88c5\u70b9\u76ee\u5f55\u7ed3\u6784\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743",children:"10.5.6 \u786e\u4fdd\u5bf9\u5b89\u88c5\u70b9\u76ee\u5f55\u7ed3\u6784\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"chown -R swift:swift /srv/node\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1057-\u521b\u5efa-recon-\u76ee\u5f55\u5e76\u786e\u4fdd\u5bf9\u5176\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743",children:["10.5.7 \u521b\u5efa ",(0,c.jsx)(n.code,{children:"recon"})," \u76ee\u5f55\u5e76\u786e\u4fdd\u5bf9\u5176\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"mkdir -p /var/cache/swift\nchown -R root:swift /var/cache/swift\nchmod -R 775 /var/cache/swift\n"})}),"\n",(0,c.jsx)(n.h3,{id:"106-\u521b\u5efa\u548c\u5206\u53d1\u521d\u59cb\u73af",children:"10.6 \u521b\u5efa\u548c\u5206\u53d1\u521d\u59cb\u73af"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5728\u63a7\u5236\u8282\u70b9\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5728\u542f\u52a8\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u4e4b\u524d\uff0c\u5fc5\u987b\u521b\u5efa\u521d\u59cb\u5e10\u6237\uff0c\u5bb9\u5668\u548c\u5bf9\u8c61\u73af\u3002\u73af\u5f62\u6784\u5efa\u5668\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u4f7f\u7528\u8be5\u914d\u7f6e\u6587\u4ef6\u6765\u786e\u5b9a\u548c\u90e8\u7f72\u5b58\u50a8\u4f53\u7cfb\u7ed3\u6784\u3002\u4e3a\u7b80\u5355\u8d77\u89c1\uff0c\u672c\u6307\u5357\u4f7f\u7528\u4e00\u4e2a\u533a\u57df\u548c\u4e24\u4e2a\u533a\u57df\uff0c\u6700\u5927\u5206\u533a\u4e3a2 ^ 10\uff081024\uff09\u4e2a\uff0c\u6bcf\u4e2a\u5bf9\u8c613\u4e2a\u526f\u672c\uff0c\u4e24\u6b21\u79fb\u52a8\u4e00\u4e2a\u5206\u533a\u4e4b\u95f4\u7684\u6700\u5c11\u95f4\u9694\u65f6\u95f4\u4e3a1\u5c0f\u65f6\u3002\u5bf9\u4e8e\u5bf9\u8c61\u5b58\u50a8\uff0c\u5206\u533a\u8868\u793a\u5b58\u50a8\u8bbe\u5907\u4e0a\u7684\u76ee\u5f55\uff0c\u800c\u4e0d\u662f\u5e38\u89c4\u5206\u533a\u8868\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u300a ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/latest/deployment_guide.html",children:"\u90e8\u7f72\u6307\u5357\u300b"}),"\u3002"]})}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"107-\u521b\u5efa\u5e10\u6237\u73af",children:"10.7 \u521b\u5efa\u5e10\u6237\u73af"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5e10\u6237\u670d\u52a1\u5668\u4f7f\u7528\u5e10\u6237\u73af\u7ef4\u62a4\u5bb9\u5668\u5217\u8868"})}),"\n",(0,c.jsxs)(n.h4,{id:"1071-\u8981\u5207\u6362\u5230etcswift\u76ee\u5f55",children:["10.7.1 \u8981\u5207\u6362\u5230",(0,c.jsx)(n.code,{children:"/etc/swift"}),"\u76ee\u5f55"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"cd /etc/swift\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1072-\u521b\u5efa\u57fa\u7840accountbuilder\u6587\u4ef6",children:["10.7.2 \u521b\u5efa\u57fa\u7840",(0,c.jsx)(n.code,{children:"account.builder"}),"\u6587\u4ef6"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"swift-ring-builder account.builder create 10 3 1\n"})}),"\n",(0,c.jsx)(n.h4,{id:"1073-\u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af",children:"10.7.3 \u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5b98\u7f51\u793a\u4f8b"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"swift-ring-builder account.builder \\\nadd --region 1 --zone 1 --ip STORAGE_NODE_MANAGEMENT_INTERFACE_IP_ADDRESS --port 6202 \\\n--device DEVICE_NAME --weight DEVICE_WEIGHT\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u66ff\u6362",(0,c.jsx)(n.code,{children:"STORAGE_NODE_MANAGEMENT_INTERFACE_IP_ADDRESS"}),"\u4e3a\u5b58\u50a8\u8282\u70b9\u4e0a\u7ba1\u7406\u7f51\u7edc\u7684IP\u5730\u5740\u3002\u7528",(0,c.jsx)(n.code,{children:"DEVICE_NAME"}),"\u540c\u4e00\u5b58\u50a8\u8282\u70b9\u4e0a\u7684\u5b58\u50a8\u8bbe\u5907\u540d\u79f0\u66ff\u6362\u3002\u4f8b\u5982\uff0c\u4f7f\u7528\u201c ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install.html#storage",children:"\u5b89\u88c5\u201d\u4e2d"}),"\u7684\u7b2c\u4e00\u4e2a\u5b58\u50a8\u8282\u70b9",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install.html#storage",children:"\u5e76"}),"\u4f7f\u7528",(0,c.jsx)(n.code,{children:"/dev/sdb"}),"\u5b58\u50a8\u8bbe\u5907\u548c\u6743\u91cd100 ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install.html#storage",children:"\u914d\u7f6e\u5b58\u50a8\u8282\u70b9"}),"\uff1a"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5bf9\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u4e0a\u7684\u6bcf\u4e2a\u5b58\u50a8\u8bbe\u5907\u91cd\u590d\u6b64\u547d\u4ee4\u3002\u5728\u793a\u4f8b\u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u4f7f\u7528\u4ee5\u4e0b\u56db\u4e2a\u53d8\u4f53\u4e2d\u7684\u547d\u4ee4"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ swift-ring-builder account.builder add \\\n  --region 1 --zone 1 --ip 172.30.100.7 --port 6202 --device vdb --weight 100\nDevice d0r1z1-172.30.100.7:6202R172.30.100.7:6202/vdb_"" with 100.0 weight got id 0\n\n$ swift-ring-builder account.builder add \\\n  --region 1 --zone 1 --ip 172.30.100.7 --port 6202 --device vdc --weight 100\nDevice d1r1z1-172.30.100.7:6202R172.30.100.7:6202/vdc_"" with 100.0 weight got id 1\n\n$ swift-ring-builder account.builder add \\\n  --region 1 --zone 2 --ip 172.30.100.8 --port 6202 --device vdb --weight 100\nDevice d2r1z2-172.30.100.8:6202R172.30.100.8:6202/vdb_"" with 100.0 weight got id 2\n\n$ swift-ring-builder account.builder add \\\n  --region 1 --zone 2 --ip 172.30.100.8 --port 6202 --device vdc --weight 100\nDevice d3r1z2-172.30.100.8:6202R172.30.100.8:6202/vdc_"" with 100.0 weight got id 3\n'})}),"\n",(0,c.jsx)(n.h4,{id:"1074-\u9a8c\u8bc1",children:"10.7.4 \u9a8c\u8bc1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ swift-ring-builder account.builder\naccount.builder, build version 4, id 2738119c3e3c47b199313d7ad28f17cd\n1024 partitions, 3.000000 replicas, 1 regions, 2 zones, 4 devices, 100.00 balance, 0.00 dispersion\nThe minimum number of hours before a partition can be reassigned is 1 (0:00:00 remaining)\nThe overload factor is 0.00% (0.000000)\nRing file account.ring.gz not found, probably it hasn't been written yet\nDevices:   id region zone   ip address:port replication ip:port  name weight partitions balance flags meta\n            0      1    1 172.30.100.7:6202   172.30.100.7:6202   vdb 100.00          0 -100.00       \n            1      1    1 172.30.100.7:6202   172.30.100.7:6202   vdc 100.00          0 -100.00       \n            2      1    2 172.30.100.8:6202   172.30.100.8:6202   vdb 100.00          0 -100.00       \n            3      1    2 172.30.100.8:6202   172.30.100.8:6202   vdc 100.00          0 -100.00       \n"})}),"\n",(0,c.jsx)(n.h4,{id:"1075-\u91cd\u65b0\u5e73\u8861\u6743\u91cd",children:"10.7.5 \u91cd\u65b0\u5e73\u8861\u6743\u91cd"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ swift-ring-builder account.builder rebalance\nReassigned 3072 (300.00%) partitions. Balance is now 0.00.  Dispersion is now 0.00\n"})}),"\n",(0,c.jsx)(n.h3,{id:"108-\u521b\u5efa\u5bb9\u5668\u73af",children:"10.8 \u521b\u5efa\u5bb9\u5668\u73af"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5bb9\u5668\u670d\u52a1\u5668\u4f7f\u7528\u5bb9\u5668\u73af\u7ef4\u62a4\u5bf9\u8c61\u5217\u8868\u3002\u4f46\u662f\uff0c\u5b83\u4e0d\u8ddf\u8e2a\u5bf9\u8c61\u4f4d\u7f6e"})}),"\n",(0,c.jsxs)(n.h4,{id:"1081-\u8f6c\u5230-etcswift-\u76ee\u5f55",children:["10.8.1 \u8f6c\u5230 ",(0,c.jsx)(n.code,{children:"/etc/swift"})," \u76ee\u5f55"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"cd /etc/swift\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1082-\u521b\u5efa\u57fa\u7840containerbuilder\u6587\u4ef6",children:["10.8.2 \u521b\u5efa\u57fa\u7840",(0,c.jsx)(n.code,{children:"container.builder"}),"\u6587\u4ef6"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"swift-ring-builder container.builder create 10 3 1\n"})}),"\n",(0,c.jsx)(n.h4,{id:"1083-\u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af",children:"10.8.3 \u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5b98\u7f51\u793a\u4f8b"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"swift-ring-builder container.builder \\\nadd --region 1 --zone 1 --ip STORAGE_NODE_MANAGEMENT_INTERFACE_IP_ADDRESS --port 6201 --device DEVICE_NAME --weight DEVICE_WEIGHT\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u66ff\u6362",(0,c.jsx)(n.code,{children:"STORAGE_NODE_MANAGEMENT_INTERFACE_IP_ADDRESS"}),"\u4e3a\u5b58\u50a8\u8282\u70b9\u4e0a\u7ba1\u7406\u7f51\u7edc\u7684IP\u5730\u5740\u3002\u7528",(0,c.jsx)(n.code,{children:"DEVICE_NAME"}),"\u540c\u4e00\u5b58\u50a8\u8282\u70b9\u4e0a\u7684\u5b58\u50a8\u8bbe\u5907\u540d\u79f0\u66ff\u6362\u3002\u4f8b\u5982\uff0c\u4f7f\u7528\u201c ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install.html#storage",children:"\u5b89\u88c5\u201d\u4e2d"}),"\u7684\u7b2c\u4e00\u4e2a\u5b58\u50a8\u8282\u70b9",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install.html#storage",children:"\u5e76"}),"\u4f7f\u7528",(0,c.jsx)(n.code,{children:"/dev/sdb"})," \u5b58\u50a8\u8bbe\u5907\u548c\u6743\u91cd100 ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install.html#storage",children:"\u914d\u7f6e\u5b58\u50a8\u8282\u70b9"})]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5bf9\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u4e0a\u7684\u6bcf\u4e2a\u5b58\u50a8\u8bbe\u5907\u91cd\u590d\u6b64\u547d\u4ee4\u3002\u5728\u793a\u4f8b\u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u4f7f\u7528\u4ee5\u4e0b\u56db\u4e2a\u53d8\u4f53\u4e2d\u7684\u547d\u4ee4"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ swift-ring-builder container.builder add \\\n  --region 1 --zone 1 --ip 172.30.100.7 --port 6201 --device vdb --weight 100\nDevice d0r1z1-172.30.100.7:6201R172.30.100.7:6201/vdb_"" with 100.0 weight got id 0\n\n$ swift-ring-builder container.builder add \\\n  --region 1 --zone 1 --ip 172.30.100.7 --port 6201 --device vdc --weight 100\nDevice d1r1z1-172.30.100.7:6201R172.30.100.7:6201/vdc_"" with 100.0 weight got id 1\n\n$ swift-ring-builder container.builder add \\\n  --region 1 --zone 2 --ip 172.30.100.8 --port 6201 --device vdb --weight 100\nDevice d2r1z2-172.30.100.8:6201R172.30.100.8:6201/vdb_"" with 100.0 weight got id 2\n\n$ swift-ring-builder container.builder add \\\n  --region 1 --zone 2 --ip 172.30.100.8 --port 6201 --device vdc --weight 100\nDevice d3r1z2-172.30.100.8:6201R172.30.100.8:6201/vdc_"" with 100.0 weight got id 3\n'})}),"\n",(0,c.jsx)(n.h4,{id:"1084-\u9a8c\u8bc1",children:"10.8.4 \u9a8c\u8bc1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ swift-ring-builder container.builder\ncontainer.builder, build version 4, id c50b252ff09548ba8e9f1639516cd6b1\n1024 partitions, 3.000000 replicas, 1 regions, 2 zones, 4 devices, 100.00 balance, 0.00 dispersion\nThe minimum number of hours before a partition can be reassigned is 1 (0:00:00 remaining)\nThe overload factor is 0.00% (0.000000)\nRing file container.ring.gz not found, probably it hasn't been written yet\nDevices:   id region zone   ip address:port replication ip:port  name weight partitions balance flags meta\n            0      1    1 172.30.100.7:6201   172.30.100.7:6201   vdb 100.00          0 -100.00       \n            1      1    1 172.30.100.7:6201   172.30.100.7:6201   vdc 100.00          0 -100.00       \n            2      1    2 172.30.100.8:6201   172.30.100.8:6201   vdb 100.00          0 -100.00       \n            3      1    2 172.30.100.8:6201   172.30.100.8:6201   vdc 100.00          0 -100.00       \n"})}),"\n",(0,c.jsx)(n.h4,{id:"1085-\u91cd\u65b0\u5e73\u8861\u6743\u91cd",children:"10.8.5 \u91cd\u65b0\u5e73\u8861\u6743\u91cd"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ swift-ring-builder container.builder rebalance\nReassigned 3072 (300.00%) partitions. Balance is now 0.00.  Dispersion is now 0.00\n"})}),"\n",(0,c.jsx)(n.h3,{id:"109-\u521b\u5efa\u5bf9\u8c61\u73af",children:"10.9 \u521b\u5efa\u5bf9\u8c61\u73af"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5bf9\u8c61\u670d\u52a1\u5668\u4f7f\u7528\u5bf9\u8c61\u73af\u7ef4\u62a4\u672c\u5730\u8bbe\u5907\u4e0a\u5bf9\u8c61\u4f4d\u7f6e\u7684\u5217\u8868"})}),"\n",(0,c.jsxs)(n.h4,{id:"1091-\u8f6c\u5230-etcswift-\u76ee\u5f55",children:["10.9.1 \u8f6c\u5230 ",(0,c.jsx)(n.code,{children:"/etc/swift"})," \u76ee\u5f55"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"cd /etc/dwift\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"1092-\u521b\u5efa\u57fa\u7840-objectbuilder-\u6587\u4ef6",children:["10.9.2 \u521b\u5efa\u57fa\u7840 ",(0,c.jsx)(n.code,{children:"object.builder"})," \u6587\u4ef6"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"swift-ring-builder object.builder create 10 3 1\n"})}),"\n",(0,c.jsx)(n.h4,{id:"1093-\u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af",children:"10.9.3 \u5c06\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u6dfb\u52a0\u5230\u73af"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5b98\u65b9\u793a\u4f8b"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"swift-ring-builder object.builder \\\nadd --region 1 --zone 1 --ip STORAGE_NODE_MANAGEMENT_INTERFACE_IP_ADDRESS --port 6200 --device DEVICE_NAME --weight DEVICE_WEIGHT\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u66ff\u6362",(0,c.jsx)(n.code,{children:"STORAGE_NODE_MANAGEMENT_INTERFACE_IP_ADDRESS"}),"\u4e3a\u5b58\u50a8\u8282\u70b9\u4e0a\u7ba1\u7406\u7f51\u7edc\u7684IP\u5730\u5740\u3002\u7528",(0,c.jsx)(n.code,{children:"DEVICE_NAME"}),"\u540c\u4e00\u5b58\u50a8\u8282\u70b9\u4e0a\u7684\u5b58\u50a8\u8bbe\u5907\u540d\u79f0\u66ff\u6362\u3002\u4f8b\u5982\uff0c\u4f7f\u7528\u201c ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install.html#storage",children:"\u5b89\u88c5\u201d\u4e2d"}),"\u7684\u7b2c\u4e00\u4e2a\u5b58\u50a8\u8282\u70b9",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install.html#storage",children:"\u5e76"}),"\u4f7f\u7528",(0,c.jsx)(n.code,{children:"/dev/sdb"}),"\u5b58\u50a8\u8bbe\u5907\u548c\u6743\u91cd100 ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/storage-install.html#storage",children:"\u914d\u7f6e\u5b58\u50a8\u8282\u70b9"})]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5bf9\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u4e0a\u7684\u6bcf\u4e2a\u5b58\u50a8\u8bbe\u5907\u91cd\u590d\u6b64\u547d\u4ee4\u3002\u5728\u793a\u4f8b\u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u4f7f\u7528\u4ee5\u4e0b\u56db\u4e2a\u53d8\u4f53\u4e2d\u7684\u547d\u4ee4"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'$ swift-ring-builder object.builder add \\\n  --region 1 --zone 1 --ip 172.30.100.7 --port 6200 --device vdb --weight 100\nDevice d0r1z1-172.30.100.7:6200R172.30.100.7:6200/vdb_"" with 100.0 weight got id 0\n\n$ swift-ring-builder object.builder add \\\n  --region 1 --zone 1 --ip 172.30.100.7 --port 6200 --device vdc --weight 100\nDevice d1r1z1-172.30.100.7:6200R172.30.100.7:6200/vdc_"" with 100.0 weight got id 1\n\n$ swift-ring-builder object.builder add \\\n  --region 1 --zone 2 --ip 172.30.100.8 --port 6200 --device vdb --weight 100\nDevice d2r1z2-172.30.100.8:6200R172.30.100.8:6200/vdb_"" with 100.0 weight got id 2\n\n$ swift-ring-builder object.builder add \\\n  --region 1 --zone 2 --ip 172.30.100.8 --port 6200 --device sdc --weight 100\nDevice d3r1z2-172.30.100.8:6200R172.30.100.8:6200/sdc_"" with 100.0 weight got id 3\n'})}),"\n",(0,c.jsx)(n.h4,{id:"1094-\u9a8c\u8bc1",children:"10.9.4 \u9a8c\u8bc1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ swift-ring-builder object.builder\nobject.builder, build version 4, id 0a4d3c0a65aa4d3d9a0d9407c99312c6\n1024 partitions, 3.000000 replicas, 1 regions, 2 zones, 4 devices, 100.00 balance, 0.00 dispersion\nThe minimum number of hours before a partition can be reassigned is 1 (0:00:00 remaining)\nThe overload factor is 0.00% (0.000000)\nRing file object.ring.gz not found, probably it hasn't been written yet\nDevices:   id region zone   ip address:port replication ip:port  name weight partitions balance flags meta\n            0      1    1 172.30.100.7:6200   172.30.100.7:6200   vdb 100.00          0 -100.00       \n            1      1    1 172.30.100.7:6200   172.30.100.7:6200   vdc 100.00          0 -100.00       \n            3      1    2 172.30.100.8:6200   172.30.100.8:6200   sdc 100.00          0 -100.00       \n            2      1    2 172.30.100.8:6200   172.30.100.8:6200   vdb 100.00          0 -100.00       \n"})}),"\n",(0,c.jsx)(n.h4,{id:"1095-\u91cd\u65b0\u5e73\u8861\u6743\u91cd",children:"10.9.5 \u91cd\u65b0\u5e73\u8861\u6743\u91cd"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ swift-ring-builder object.builder rebalance\nReassigned 3072 (300.00%) partitions. Balance is now 0.00.  Dispersion is now 0.00\n"})}),"\n",(0,c.jsx)(n.h3,{id:"1010-\u5206\u53d1\u73af\u7f51\u914d\u7f6e\u6587\u4ef6",children:"10.10 \u5206\u53d1\u73af\u7f51\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,c.jsxs)(n.p,{children:["\u62f7\u8d1d ",(0,c.jsx)(n.code,{children:"account.ring.gz"}),"\uff0c",(0,c.jsx)(n.code,{children:"container.ring.gz"})," \u4ee5\u53ca  ",(0,c.jsx)(n.code,{children:"object.ring.gz"})," \u6587\u4ef6\u590d\u5236\u5230 ",(0,c.jsx)(n.code,{children:"/etc/swift"})," \u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u548c\u8fd0\u884c\u4ee3\u7406\u670d\u52a1\u7684\u4efb\u4f55\u5176\u4ed6\u8282\u70b9\u4e0a\u76ee\u5f55"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"scp /etc/swift/{account.ring.gz,container.ring.gz,object.ring.gz} object01:/etc/swift\n  \nscp /etc/swift/{account.ring.gz,container.ring.gz,object.ring.gz} object02:/etc/swift\n"})}),"\n",(0,c.jsx)(n.h3,{id:"1011-\u5b8c\u6210\u5b89\u88c5",children:"10.11 \u5b8c\u6210\u5b89\u88c5"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/finalize-installation-rdo.html",children:"rocky\u7248\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1swift\u5b8c\u6210\u5b89\u88c5\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsxs)(n.h4,{id:"10111-etcswiftswiftconf\u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u4e2d\u83b7\u53d6\u6587\u4ef6",children:["10.11.1 ",(0,c.jsx)(n.code,{children:"/etc/swift/swift.conf"}),"\u4ece\u5bf9\u8c61\u5b58\u50a8\u6e90\u5b58\u50a8\u5e93\u4e2d\u83b7\u53d6\u6587\u4ef6"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u26a0\ufe0f\u8fd9\u4e00\u6b65\u5728\u63a7\u5236\u8282\u70b9\u6267\u884c"})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"/etc/swift/swift.conf "})," \u539f\u5148\u5185\u5bb9"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"[swift-hash]\nswift_hash_path_suffix = %SWIFT_HASH_PATH_SUFFIX%\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6267\u884c\u547d\u4ee4"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"curl -o /etc/swift/swift.conf \\\nhttps://opendev.org/openstack/swift/raw/branch/stable/rocky/etc/swift.conf-sample\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"10112-\u7f16\u8f91-etcswiftswiftconf-\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["10.11.2 \u7f16\u8f91 ",(0,c.jsx)(n.code,{children:"/etc/swift/swift.conf"})," \u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u26a0\ufe0f\u8fd9\u4e00\u6b65\u5728\u63a7\u5236\u8282\u70b9\u6267\u884c"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"1.\u5728\u8be5[swift-hash]\u90e8\u5206\u4e2d\uff0c\u4e3a\u60a8\u7684\u73af\u5883\u914d\u7f6e\u54c8\u5e0c\u8def\u5f84\u524d\u7f00\u548c\u540e\u7f00\u3002\u7528\u552f\u4e00\u503c\u66ff\u6362HASH_PATH_PREFIX\u548cHASH_PATH_SUFFIX\uff0c\u8bf7\u5c06\u8fd9\u4e9b\u503c\u4fdd\u5bc6\uff0c\u4e0d\u8981\u66f4\u6539\u6216\u4e22\u5931\u5b83\u4eec\n[swift-hash]\n...\nswift_hash_path_suffix = HASH_PATH_SUFFIX\nswift_hash_path_prefix = HASH_PATH_PREFIX\n\n2.\u5728\u8be5[storage-policy:0]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u9ed8\u8ba4\u5b58\u50a8\u7b56\u7565\uff1a\n[storage-policy:0]\n...\nname = Policy-0\ndefault = yes\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\\cp /etc/swift/swift.conf{,.bak}\ngrep '^[a-Z\\[]' /etc/swift/swift.conf.bak > /etc/swift/swift.conf\nopenstack-config --set /etc/swift/swift.conf swift-hash swift_hash_path_suffix HASH_PATH_SUFFIX\nopenstack-config --set /etc/swift/swift.conf swift-hash swift_hash_path_prefix HASH_PATH_PREFIX\nopenstack-config --set /etc/swift/swift.conf storage-policy:0 name Policy-0\nopenstack-config --set /etc/swift/swift.conf storage-policy:0 default yes\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"10113-\u5c06-swiftconf-\u6587\u4ef6\u590d\u5236\u5230-etcswift-\u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u4ee5\u53ca\u8fd0\u884c\u4ee3\u7406\u670d\u52a1\u7684\u6240\u6709\u5176\u4ed6\u8282\u70b9\u4e0a\u7684\u76ee\u5f55\u4e2d",children:["10.11.3 \u5c06 ",(0,c.jsx)(n.code,{children:"swift.conf"})," \u6587\u4ef6\u590d\u5236\u5230 ",(0,c.jsx)(n.code,{children:"/etc/swift"})," \u6bcf\u4e2a\u5b58\u50a8\u8282\u70b9\u4ee5\u53ca\u8fd0\u884c\u4ee3\u7406\u670d\u52a1\u7684\u6240\u6709\u5176\u4ed6\u8282\u70b9\u4e0a\u7684\u76ee\u5f55\u4e2d"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u26a0\ufe0f\u8fd9\u4e00\u6b65\u5728\u63a7\u5236\u8282\u70b9\u6267\u884c"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"scp /etc/swift/swift.conf object01:/etc/swift\nscp /etc/swift/swift.conf object02:/etc/swift  \n"})}),"\n",(0,c.jsx)(n.h4,{id:"10114-\u5728\u6240\u6709\u8282\u70b9\u4e0a\u786e\u4fdd\u5bf9\u914d\u7f6e\u76ee\u5f55\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743",children:"10.11.4 \u5728\u6240\u6709\u8282\u70b9\u4e0a\uff0c\u786e\u4fdd\u5bf9\u914d\u7f6e\u76ee\u5f55\u62e5\u6709\u9002\u5f53\u7684\u6240\u6709\u6743"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5728\u63a7\u5236\u8282\u70b9\u548c\u4e24\u4e2a\u5bf9\u8c61\u5b58\u50a8\u8282\u70b9\u6267\u884c"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"chown -R root:swift /etc/swift\n"})}),"\n",(0,c.jsx)(n.h4,{id:"10115-\u5728\u63a7\u5236\u5668\u8282\u70b9\u548c\u8fd0\u884c\u4ee3\u7406\u670d\u52a1\u7684\u4efb\u4f55\u5176\u4ed6\u8282\u70b9\u4e0a\u542f\u52a8\u5bf9\u8c61\u5b58\u50a8\u4ee3\u7406\u670d\u52a1\u53ca\u5176\u76f8\u5173\u6027\u5e76\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",children:"10.11.5 \u5728\u63a7\u5236\u5668\u8282\u70b9\u548c\u8fd0\u884c\u4ee3\u7406\u670d\u52a1\u7684\u4efb\u4f55\u5176\u4ed6\u8282\u70b9\u4e0a\uff0c\u542f\u52a8\u5bf9\u8c61\u5b58\u50a8\u4ee3\u7406\u670d\u52a1\u53ca\u5176\u76f8\u5173\u6027\uff0c\u5e76\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u26a0\ufe0f\u8fd9\u4e00\u6b65\u5728\u63a7\u5236\u8282\u70b9\u6267\u884c"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable openstack-swift-proxy.service memcached.service\nsystemctl start openstack-swift-proxy.service memcached.service\n"})}),"\n",(0,c.jsx)(n.h4,{id:"10116-\u5728\u5b58\u50a8\u8282\u70b9\u4e0a\u542f\u52a8\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8",children:"10.11.6 \u5728\u5b58\u50a8\u8282\u70b9\u4e0a\uff0c\u542f\u52a8\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u542f\u52a8"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u4e24\u4e2a\u5bf9\u8c61\u5b58\u50a8\u8282\u70b9\u6267\u884c"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable openstack-swift-account \\\nopenstack-swift-account-auditor \\\nopenstack-swift-account-reaper \\\nopenstack-swift-account-replicator \\\nopenstack-swift-container \\\nopenstack-swift-container-auditor \\\nopenstack-swift-container-replicator \\\nopenstack-swift-container-updater \\\nopenstack-swift-object \\\nopenstack-swift-object-auditor \\\nopenstack-swift-object-replicator \\\nopenstack-swift-object-updater \n  \nsystemctl start openstack-swift-account \\\nopenstack-swift-account-auditor \\\nopenstack-swift-account-reaper \\\nopenstack-swift-account-replicator \\\nopenstack-swift-container \\\nopenstack-swift-container-auditor \\\nopenstack-swift-container-replicator \\\nopenstack-swift-container-updater \\\nopenstack-swift-object \\\nopenstack-swift-object-auditor \\\nopenstack-swift-object-replicator \\\nopenstack-swift-object-updater \n"})}),"\n",(0,c.jsx)(n.h3,{id:"1012-\u9a8c\u8bc1\u64cd\u4f5c",children:"10.12 \u9a8c\u8bc1\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/rocky/install/verify.html",children:"rocky\u7248\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1swift\u9a8c\u8bc1\u64cd\u4f5c\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5728\u63a7\u5236\u5668\u4e0a\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4"})}),"\n",(0,c.jsx)(n.p,{children:"\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662fRed Hat Enterprise Linux 7\u6216CentOS 7\uff0c\u5e76\u4e14\u5176\u4e2d\u4e00\u4e2a\u6216\u591a\u4e2a\u6b65\u9aa4\u4e0d\u8d77\u4f5c\u7528\uff0c\u8bf7\u68c0\u67e5\u8be5",(0,c.jsx)(n.code,{children:"/var/log/audit/audit.log"}),"\u6587\u4ef6\u4e2d\u662f\u5426\u6709SELinux\u6d88\u606f\uff0c\u8868\u660e\u8be5",(0,c.jsx)(n.code,{children:"swift"}),"\u8fdb\u7a0b\u62d2\u7edd\u91c7\u53d6\u63aa\u65bd\u3002\u5982\u679c\u5b58\u5728\uff0c\u8bf7\u5c06",(0,c.jsx)(n.code,{children:"/srv/node"}),"\u76ee\u5f55\u7684\u5b89\u5168\u4e0a\u4e0b\u6587\u66f4\u6539\u4e3a",(0,c.jsx)(n.code,{children:"swift_data_t"}),"\u7c7b\u578b\uff0c",(0,c.jsx)(n.code,{children:"object_r"})," \u89d2\u8272\u548c",(0,c.jsx)(n.code,{children:"system_u"}),"\u7528\u6237\u7684\u6700\u4f4e\u5b89\u5168\u7ea7\u522b\uff08s0\uff09\uff1a"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"chcon -R system_u:object_r:swift_data_t:s0 /srv/node\n"})}),"\n",(0,c.jsx)(n.h3,{id:"10121-\u83b7\u53d6demo\u51ed\u8bc1",children:"10.12.1 \u83b7\u53d6demo\u51ed\u8bc1"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f\u8fd9\u91cc\u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\u539f\u56e0(\u4e5f\u80af\u80fd\u662f\u6211\u81ea\u5df1\u54ea\u91cc\u51fa\u9519\u4e86)\uff0c\u5982\u679c\u6309\u7167\u5b98\u65b9\u6587\u6863\u4e2d\u52a0\u8f7ddemo\u51ed\u8bc1\uff0c\u90a3\u4e48\u5728\u6267\u884c",(0,c.jsx)(n.code,{children:"swift stat"}),"\u547d\u4ee4\u65f6\u4f1a\u62a5\u9519403\u6743\u9650\u62d2\u7edd\uff0c\u6240\u4ee5\u8fd9\u91cc\u52a0\u8f7d\u4e86admin\u51ed\u8bc1"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"source /opt/admin-openrc\n"})}),"\n",(0,c.jsx)(n.h4,{id:"10122-\u663e\u793a\u670d\u52a1\u72b6\u6001",children:"10.12.2 \u663e\u793a\u670d\u52a1\u72b6\u6001"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"$ swift stat\n               Account: AUTH_a8cb8e52e5a44288b2ac1a216195ee10\n            Containers: 0\n               Objects: 0\n                 Bytes: 0\n       X-Put-Timestamp: 1590683616.82847\n           X-Timestamp: 1590683616.82847\n            X-Trans-Id: tx85844a798ed34d998b692-005ecfe7e0\n          Content-Type: text/plain; charset=utf-8\nX-Openstack-Request-Id: tx85844a798ed34d998b692-005ecfe7e0\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"10123-\u521b\u5efacontainer1\u5bb9\u5668",children:["10.12.3 \u521b\u5efa",(0,c.jsx)(n.code,{children:"container1"}),"\u5bb9\u5668"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"openstack container create container1\n+---------------------------------------+------------+------------------------------------+\n| account                               | container  | x-trans-id                         |\n+---------------------------------------+------------+------------------------------------+\n| AUTH_a8cb8e52e5a44288b2ac1a216195ee10 | container1 | tx3e166ae00ded4264a0dbe-005ecfea29 |\n+---------------------------------------+------------+------------------------------------+\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"10124-\u5c06\u6d4b\u8bd5\u6587\u4ef6\u4e0a\u4f20\u5230container1\u5bb9\u5668",children:["10.12.4 \u5c06\u6d4b\u8bd5\u6587\u4ef6\u4e0a\u4f20\u5230",(0,c.jsx)(n.code,{children:"container1"}),"\u5bb9\u5668"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"#\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6\necho test >/tmp/test.txt\n\n$ openstack object create container1 /tmp/test.txt\n+---------------+------------+----------------------------------+\n| object        | container  | etag                             |\n+---------------+------------+----------------------------------+\n| /tmp/test.txt | container1 | d8e8fca2dc0f896fd7cb4cb0031ba249 |\n+---------------+------------+----------------------------------+\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"10125-\u5217\u51facontainer1\u5bb9\u5668\u4e2d\u7684\u6587\u4ef6",children:["10.12.5 \u5217\u51fa",(0,c.jsx)(n.code,{children:"container1"}),"\u5bb9\u5668\u4e2d\u7684\u6587\u4ef6"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"openstack object list container1\n+---------------+\n| Name          |\n+---------------+\n| /tmp/test.txt |\n+---------------+\n"})}),"\n",(0,c.jsxs)(n.h4,{id:"10126-\u4ececontainer1\u5bb9\u5668\u4e0b\u8f7d\u6d4b\u8bd5\u6587\u4ef6",children:["10.12.6 \u4ece",(0,c.jsx)(n.code,{children:"container1"}),"\u5bb9\u5668\u4e0b\u8f7d\u6d4b\u8bd5\u6587\u4ef6"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"#\u5148\u628a\u672c\u5730\u7684\u6d4b\u8bd5\u6587\u4ef6/tmp/test.txt\u5220\u9664\nrm /tmp/test.txt\n\n#\u7136\u540e\u4e0b\u8f7d\u6d4b\u8bd5\u6587\u4ef6\uff0c\u80fd\u4e0b\u8f7d\u5e76\u4e14\u6587\u4ef6\u5185\u5bb9\u4e0d\u53d8\u5373\u4e3a\u6b63\u786e\nopenstack object save container1 /tmp/test.txt\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5230\u6b64\uff0c\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1swift\u5b89\u88c5\u5b8c\u6210"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://docs.openstack.org/rocky/install/index.html",children:"rocky\u7248\u66f4\u591a\u670d\u52a1\u53c2\u8003\u8fd9\u4e2a\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.h2,{id:"11\u5b89\u88c5\u548c\u914d\u7f6e\u5907\u4efd\u670d\u52a1\u53ef\u9009",children:"11.\u5b89\u88c5\u548c\u914d\u7f6e\u5907\u4efd\u670d\u52a1(\u53ef\u9009)"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5b89\u88c5\u548c\u914d\u7f6e\u5907\u4efd\u670d\u52a1\u3002\u4e3a\u7b80\u5355\u8d77\u89c1\uff0c\u6b64\u914d\u7f6e\u4f7f\u7528\u201c\u5757\u5b58\u50a8\u201d\u8282\u70b9\u548c\u201c\u5bf9\u8c61\u5b58\u50a8\u201d\uff08\u9a71\u52a8\u7a0b\u5e8f\uff09\u9a71\u52a8\u7a0b\u5e8f\uff0c\u56e0\u6b64\u53d6\u51b3\u4e8e\u201c ",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/swift/latest/install/",children:"\u5bf9\u8c61\u5b58\u50a8\u201d\u670d\u52a1"}),"\u3002"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u5728\u5b89\u88c5\u548c\u914d\u7f6e\u5907\u4efd\u670d\u52a1\u4e4b\u524d\uff0c\u5fc5\u987b\u5148",(0,c.jsx)(n.a,{href:"https://docs.openstack.org/cinder/rocky/configuration/block-storage/config-options.html#cinder-storage",children:"\u5b89\u88c5\u548c\u914d\u7f6e\u5b58\u50a8\u8282\u70b9"}),"\u3002"]})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5728\u5757\u5b58\u50a8\u8282\u70b9\u4e0a\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4"})}),"\n",(0,c.jsx)(n.h3,{id:"111-\u5b89\u88c5\u8f6f\u4ef6\u5305",children:"11.1 \u5b89\u88c5\u8f6f\u4ef6\u5305"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"yum -y install openstack-cinder\n"})}),"\n",(0,c.jsxs)(n.h3,{id:"112-\u7f16\u8f91etccindercinderconf\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c",children:["11.2 \u7f16\u8f91",(0,c.jsx)(n.code,{children:"/etc/cinder/cinder.conf"}),"\u6587\u4ef6\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"\u5728\u8be5[DEFAULT]\u90e8\u5206\u4e2d\uff0c\u914d\u7f6e\u5907\u4efd\u9009\u9879\uff1a\n\n[DEFAULT]\n# ...\nbackup_driver = cinder.backup.drivers.swift\nbackup_swift_url = SWIFT_URL\n\n#\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539\nopenstack-config --set /etc/cinder/cinder.conf DEFAULT backup_driver cinder.backup.drivers.swift\nopenstack-config --set /etc/cinder/cinder.conf DEFAULT backup_swift_url http://controller:8080/v1/AUTH_ee435c972a7a476cadbd2c9ad782c6f0\n    \npublic\u7684url\u6bcf\u6b21\u90fd\u662f\u4e0d\u4e00\u6837\u7684\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u66ff\u6362",(0,c.jsx)(n.code,{children:"SWIFT_URL"}),"\u4e3a\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u7684URL\u3002\u53ef\u4ee5\u901a\u8fc7\u663e\u793a\u5bf9\u8c61\u5e93API\u7aef\u70b9\u6765\u627e\u5230URL\uff0c\u5728\u63a7\u5236\u8282\u70b9\u4e0a\u6267\u884c\u547d\u4ee4",(0,c.jsx)(n.code,{children:"openstack catalog show object-store"})]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"openstack catalog show object-store\n+-----------+-----------------------------------------------------------------------------+\n| Field     | Value                                                                       |\n+-----------+-----------------------------------------------------------------------------+\n| endpoints | RegionOne                                                                   |\n|           |   admin: http://controller:8080/v1                                          |\n|           | RegionOne                                                                   |\n|           |   public: http://controller:8080/v1/AUTH_a8cb8e52e5a44288b2ac1a216195ee10   |\n|           | RegionOne                                                                   |\n|           |   internal: http://controller:8080/v1/AUTH_a8cb8e52e5a44288b2ac1a216195ee10 |\n|           |                                                                             |\n| id        | b5169189845a4fb1b80fe1ab06584ffc                                            |\n| name      | swift                                                                       |\n| type      | object-store                                                                |\n+-----------+-----------------------------------------------------------------------------+\n"})}),"\n",(0,c.jsx)(n.h3,{id:"113-\u542f\u52a8\u5757\u5b58\u50a8\u5907\u4efd\u670d\u52a1\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8",children:"11.3 \u542f\u52a8\u5757\u5b58\u50a8\u5907\u4efd\u670d\u52a1\uff0c\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"systemctl enable openstack-cinder-backup.service\nsystemctl start openstack-cinder-backup.service\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5230\u6b64\u5757\u5b58\u50a8\u8282\u70b9\u5757\u5b58\u50a8\u5907\u4efd\u670d\u52a1\u5b89\u88c5\u5b8c\u6210\uff01\uff01\uff01"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>i});var c=t(96540);const s={},o=c.createContext(s);function r(e){const n=c.useContext(o);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),c.createElement(o.Provider,{value:n},e.children)}}}]);