"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[9528],{48786:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>d,toc:()=>l});var r=s(74848),t=s(28453);const c={},o="spug\u5b89\u88c5",d={id:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/spug/spug\u5b89\u88c5",title:"spug\u5b89\u88c5",description:"[toc]",source:"@site/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/spug/spug\u5b89\u88c5.md",sourceDirName:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/spug",slug:"/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/spug/spug\u5b89\u88c5",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/spug/spug\u5b89\u88c5",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"spug\u4e0a\u7ebf\u793a\u4f8b",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/spug/spug\u4e0a\u7ebf\u793a\u4f8b"},next:{title:"CentOS7.5\u5b89\u88c5walle1.2",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/walle/CentOS7.5\u5b89\u88c5walle1.2"}},i={},l=[{value:"\u5173\u4e8eSpug",id:"\u5173\u4e8espug",level:2},{value:"\u7279\u6027",id:"\u7279\u6027",level:2},{value:"1.docker\u5b89\u88c5",id:"1docker\u5b89\u88c5",level:2},{value:"1.1 \u5b89\u88c5docker",id:"11-\u5b89\u88c5docker",level:3},{value:"1.1.1 \u4e0b\u8f7d\u4e8c\u8fdb\u5236\u5305",id:"111-\u4e0b\u8f7d\u4e8c\u8fdb\u5236\u5305",level:4},{value:"1.1.2 \u89e3\u538b\u7f29\u5e76\u62f7\u8d1d\u6587\u4ef6",id:"112-\u89e3\u538b\u7f29\u5e76\u62f7\u8d1d\u6587\u4ef6",level:4},{value:"1.1.3 \u4f7f\u7528systemd\u7ba1\u7406docker",id:"113-\u4f7f\u7528systemd\u7ba1\u7406docker",level:4},{value:"1.1.4 \u91cd\u65b0\u52a0\u8f7d\u670d\u52a1\u5e76\u542f\u52a8docker",id:"114-\u91cd\u65b0\u52a0\u8f7d\u670d\u52a1\u5e76\u542f\u52a8docker",level:4},{value:"1.1.5 \u914d\u7f6e\u963f\u91cc\u4e91\u52a0\u901f",id:"115-\u914d\u7f6e\u963f\u91cc\u4e91\u52a0\u901f",level:4},{value:"1.2 \u5b89\u88c5spug",id:"12-\u5b89\u88c5spug",level:3},{value:"1.2.1 \u542f\u52a8\u5bb9\u5668",id:"121-\u542f\u52a8\u5bb9\u5668",level:4},{value:"1.2.2 \u521d\u59cb\u5316",id:"122-\u521d\u59cb\u5316",level:4},{value:"1.3 \u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406spug",id:"13-\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406spug",level:3},{value:"1.4 \u5173\u4e8enginx\u914d\u7f6e\u9047\u5230\u7684\u95ee\u9898",id:"14-\u5173\u4e8enginx\u914d\u7f6e\u9047\u5230\u7684\u95ee\u9898",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"[toc]"}),"\n",(0,r.jsx)(n.h1,{id:"spug\u5b89\u88c5",children:"spug\u5b89\u88c5"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://spug.dev/",children:"spug\u5b98\u7f51"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/openspug/spug",children:"spug github\u5730\u5740"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5173\u4e8espug",children:"\u5173\u4e8eSpug"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Spug"})," \u9762\u5411\u4e2d\u5c0f\u578b\u4f01\u4e1a\u8bbe\u8ba1\u7684\u8f7b\u91cf\u7ea7\u65e0 Agent \u7684\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0\uff0c\u6574\u5408\u4e86\u4e3b\u673a\u7ba1\u7406\u3001\u4e3b\u673a\u6279\u91cf\u6267\u884c\u3001\u4e3b\u673a\u5728\u7ebf\u7ec8\u7aef\u3001\u6587\u4ef6\u5728\u7ebf\u4e0a\u4f20\u4e0b\u8f7d\u3001\u5e94\u7528\u53d1\u5e03\u90e8\u7f72\u3001\u5728\u7ebf\u4efb\u52a1\u8ba1\u5212\u3001\u914d\u7f6e\u4e2d\u5fc3\u3001\u76d1\u63a7\u3001\u62a5\u8b66\u7b49\u4e00\u7cfb\u5217\u529f\u80fd\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u7279\u6027",children:"\u7279\u6027"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u6279\u91cf\u6267\u884c: \u4e3b\u673a\u547d\u4ee4\u5728\u7ebf\u6279\u91cf\u6267\u884c"}),"\n",(0,r.jsx)(n.li,{children:"\u5728\u7ebf\u7ec8\u7aef: \u4e3b\u673a\u652f\u6301\u6d4f\u89c8\u5668\u5728\u7ebf\u7ec8\u7aef\u767b\u5f55"}),"\n",(0,r.jsx)(n.li,{children:"\u6587\u4ef6\u7ba1\u7406: \u4e3b\u673a\u6587\u4ef6\u5728\u7ebf\u4e0a\u4f20\u4e0b\u8f7d"}),"\n",(0,r.jsx)(n.li,{children:"\u4efb\u52a1\u8ba1\u5212: \u7075\u6d3b\u7684\u5728\u7ebf\u4efb\u52a1\u8ba1\u5212"}),"\n",(0,r.jsx)(n.li,{children:"\u53d1\u5e03\u90e8\u7f72: \u652f\u6301\u81ea\u5b9a\u4e49\u53d1\u5e03\u90e8\u7f72\u6d41\u7a0b"}),"\n",(0,r.jsx)(n.li,{children:"\u914d\u7f6e\u4e2d\u5fc3: \u652f\u6301 KV\u3001\u6587\u672c\u3001json \u7b49\u683c\u5f0f\u7684\u914d\u7f6e"}),"\n",(0,r.jsx)(n.li,{children:"\u76d1\u63a7\u4e2d\u5fc3: \u652f\u6301\u7ad9\u70b9\u3001\u7aef\u53e3\u3001\u8fdb\u7a0b\u3001\u81ea\u5b9a\u4e49\u7b49\u76d1\u63a7"}),"\n",(0,r.jsx)(n.li,{children:"\u62a5\u8b66\u4e2d\u5fc3: \u652f\u6301\u77ed\u4fe1\u3001\u90ae\u4ef6\u3001\u9489\u9489\u3001\u5fae\u4fe1\u7b49\u62a5\u8b66\u65b9\u5f0f"}),"\n",(0,r.jsx)(n.li,{children:"\u4f18\u96c5\u7f8e\u89c2: \u57fa\u4e8e Ant Design \u7684 UI \u754c\u9762"}),"\n",(0,r.jsx)(n.li,{children:"\u5f00\u6e90\u514d\u8d39: \u524d\u540e\u7aef\u4ee3\u7801\u5b8c\u5168\u5f00\u6e90"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"1docker\u5b89\u88c5",children:"1.docker\u5b89\u88c5"}),"\n",(0,r.jsx)(n.h3,{id:"11-\u5b89\u88c5docker",children:"1.1 \u5b89\u88c5docker"}),"\n",(0,r.jsx)(n.h4,{id:"111-\u4e0b\u8f7d\u4e8c\u8fdb\u5236\u5305",children:"1.1.1 \u4e0b\u8f7d\u4e8c\u8fdb\u5236\u5305"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"wget https://download.docker.com/linux/static/stable/x86_64/docker-20.10.2.tgz\n"})}),"\n",(0,r.jsx)(n.h4,{id:"112-\u89e3\u538b\u7f29\u5e76\u62f7\u8d1d\u6587\u4ef6",children:"1.1.2 \u89e3\u538b\u7f29\u5e76\u62f7\u8d1d\u6587\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"tar xf docker-20.10.2.tgz && cp docker/* /usr/bin\n"})}),"\n",(0,r.jsx)(n.h4,{id:"113-\u4f7f\u7528systemd\u7ba1\u7406docker",children:"1.1.3 \u4f7f\u7528systemd\u7ba1\u7406docker"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/config/daemon/systemd/",children:"Control Docker with systemd \u5b98\u65b9\u6587\u6863\u5173\u4e8e\u4f7f\u7528systemd\u7ba1\u7406docker\u7684\u8bf4\u660e"})}),"\n",(0,r.jsx)(n.p,{children:"\u5982\u679c\u4f60\u662f\u4f7f\u7528\u4e8c\u8fdb\u5236\u65b9\u5f0f\u5b89\u88c5\u7684 docker\uff0c\u90a3\u4e48\u4f60\u4e5f\u8bb8\u9700\u8981\u6574\u5408 docker \u5230 systemd \u4e2d\u53bb\u3002\u4e3a\u4e86\u5b8c\u6210\u8fd9\u4e2a\u4efb\u52a1\uff0c\u4f60\u9700\u8981\u5b89\u88c5\u4e24\u4e2a\u5355\u5143\u6587\u4ef6\uff08service \u548c socket\uff09\u5230 /etc/systemd/system \u4e2d\u53bb"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Manually create the systemd unit files"}),"\n",(0,r.jsxs)(n.p,{children:["When installing the binary without a package, you may want to integrate Docker with systemd. For this, install the two unit files (",(0,r.jsx)(n.code,{children:"service"})," and ",(0,r.jsx)(n.code,{children:"socket"}),") from ",(0,r.jsx)(n.a,{href:"https://github.com/moby/moby/tree/master/contrib/init/systemd",children:"the github repository"})," to ",(0,r.jsx)(n.code,{children:"/etc/systemd/system"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u26a0\ufe0f\u9700\u8981\u4e0b\u8f7d\u7684\u662f",(0,r.jsx)(n.code,{children:"docker.service.rpm"}),"\u548c",(0,r.jsx)(n.code,{children:"docker.socket"}),"\u8fd9\u4e24\u4e2a\u6587\u4ef6\uff0c\u9700\u8981\u628a",(0,r.jsx)(n.code,{children:"docker.service.rpm"}),"\u91cd\u547d\u540d\u4e3a",(0,r.jsx)(n.code,{children:"docker.service"}),"\uff0c\u7136\u540e\u518d\u79fb\u52a8\u5230",(0,r.jsx)(n.code,{children:"/etc/systemd/system"}),"\u4e0b"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"wget https://github.com/moby/moby/raw/branch/branch/master/contrib/init/systemd/docker.service.rpm\nwget https://github.com/moby/moby/raw/branch/branch/master/contrib/init/systemd/docker.socket  \n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u5411\u6587\u4ef6\u5199\u5165\u5185\u5bb9"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"docker.service"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"cat > /etc/systemd/system/docker.service <<'EOF'\n[Unit]\nDescription=Docker Application Container Engine\nDocumentation=https://docs.docker.com\nAfter=network-online.target firewalld.service\nWants=network-online.target\n\n[Service]\nType=notify\n# the default is not to use systemd for cgroups because the delegate issues still\n# exists and systemd currently does not support the cgroup feature set required\n# for containers run by docker\nExecStart=/usr/bin/dockerd\nExecReload=/bin/kill -s HUP $MAINPID\n# Having non-zero Limit*s causes performance problems due to accounting overhead\n# in the kernel. We recommend using cgroups to do container-local accounting.\nLimitNOFILE=infinity\nLimitNPROC=infinity\nLimitCORE=infinity\n# Uncomment TasksMax if your systemd version supports it.\n# Only systemd 226 and above support this version.\n#TasksMax=infinity\nTimeoutStartSec=0\n# set delegate yes so that systemd does not reset the cgroups of docker containers\nDelegate=yes\n# kill only the docker process, not all processes in the cgroup\nKillMode=process\n# restart the docker process if it exits prematurely\nRestart=on-failure\nStartLimitBurst=3\nStartLimitInterval=60s\n\n[Install]\nWantedBy=multi-user.target\nEOF\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"docker.socket"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"cat >/etc/systemd/system/docker.socket<<EOF\n[Unit]\nDescription=Docker Socket for the API\n\n[Socket]\n# If /var/run is not implemented as a symlink to /run, you may need to\n# specify ListenStream=/var/run/docker.sock instead.\nListenStream=/run/docker.sock\nSocketMode=0660\nSocketUser=root\nSocketGroup=docker\n\n[Install]\nWantedBy=sockets.target\nEOF\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.a,{href:"http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html",children:["linux\u4e2d ",(0,r.jsx)(n.code,{children:"/etc/systemd/system"})," \u548c ",(0,r.jsx)(n.code,{children:"/usr/lib/systemd/system"})," \u7684\u533a\u522b"]})}),"\n",(0,r.jsxs)(n.p,{children:["\u6bcf\u4e00\u4e2a Unit\uff08\u670d\u52a1\u7b49\uff09 \u90fd\u6709\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u544a\u8bc9 Systemd \u600e\u4e48\u542f\u52a8\u8fd9\u4e2a Unit \u3002\nSystemd \u9ed8\u8ba4\u4ece\u76ee\u5f55 ",(0,r.jsx)(n.code,{children:"/etc/systemd/system/"})," \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u3002\n\u4f46\u662f\uff0c\u91cc\u9762\u5b58\u653e\u7684\u5927\u90e8\u5206\u6587\u4ef6\u90fd\u662f\u7b26\u53f7\u94fe\u63a5\uff0c\u6307\u5411\u76ee\u5f55 ",(0,r.jsx)(n.code,{children:"/usr/lib/systemd/system/"}),"\uff0c\u771f\u6b63\u7684\u914d\u7f6e\u6587\u4ef6\u5b58\u653e\u5728\u90a3\u4e2a\u76ee\u5f55\u3002 ",(0,r.jsx)(n.code,{children:"systemctl enable "}),"\u547d\u4ee4\u7528\u4e8e\u5728\u4e0a\u9762\u4e24\u4e2a\u76ee\u5f55\u4e4b\u95f4\uff0c\u5efa\u7acb\u7b26\u53f7\u94fe\u63a5\u5173\u7cfb\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"sudo systemctl enable clamd@scan.service\n\n# \u7b49\u540c\u4e8e\n\nsudo ln -s '/usr/lib/systemd/system/clamd@scan.service' '/etc/systemd/system/multi-user.target.wants/clamd@scan.service'\n"})}),"\n",(0,r.jsx)(n.h4,{id:"114-\u91cd\u65b0\u52a0\u8f7d\u670d\u52a1\u5e76\u542f\u52a8docker",children:"1.1.4 \u91cd\u65b0\u52a0\u8f7d\u670d\u52a1\u5e76\u542f\u52a8docker"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"systemctl daemon-reload\nsystemctl start docker && systemctl enable docker\n"})}),"\n",(0,r.jsx)(n.h4,{id:"115-\u914d\u7f6e\u963f\u91cc\u4e91\u52a0\u901f",children:"1.1.5 \u914d\u7f6e\u963f\u91cc\u4e91\u52a0\u901f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:'cat > /etc/docker/daemon.json <<-\'EOF\'\n{\n  "registry-mirrors": ["https://gqk8w9va.mirror.aliyuncs.com"]\n}\nEOF\n\nsystemctl restart docker\n'})}),"\n",(0,r.jsx)(n.h3,{id:"12-\u5b89\u88c5spug",children:"1.2 \u5b89\u88c5spug"}),"\n",(0,r.jsx)(n.h4,{id:"121-\u542f\u52a8\u5bb9\u5668",children:"1.2.1 \u542f\u52a8\u5bb9\u5668"}),"\n",(0,r.jsxs)(n.p,{children:["Docker\u955c\u50cf\u5185\u90e8\u4f7f\u7528\u7684 ",(0,r.jsx)(n.code,{children:"Mysql"})," \u6570\u636e\u5e93\u3002"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u5982\u679c\u9700\u8981\u6301\u4e45\u5316\u5b58\u50a8\u4ee3\u7801\u548c\u6570\u636e\uff0c\u53ef\u4ee5\u6dfb\u52a0\uff1a-v \u6620\u5c04\u5bb9\u5668\u5185/data\u8def\u5f84"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"docker run \\\n\t-d \\\n\t--restart=always \\\n\t--name=spug \\\n\t-p 8000:80 \\\n\t-v /mydata/:/data \\\n\tregistry.aliyuncs.com/openspug/spug\n"})}),"\n",(0,r.jsx)(n.h4,{id:"122-\u521d\u59cb\u5316",children:"1.2.2 \u521d\u59cb\u5316"}),"\n",(0,r.jsxs)(n.p,{children:["\u4ee5\u4e0b\u64cd\u4f5c\u4f1a\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540d\u4e3a ",(0,r.jsx)(n.code,{children:"admin"})," \u5bc6\u7801\u4e3a ",(0,r.jsx)(n.code,{children:"spug.dev"})," \u7684\u7ba1\u7406\u5458\u8d26\u6237\uff0c\u53ef\u81ea\u884c\u66ff\u6362\u7ba1\u7406\u5458\u8d26\u6237\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# \u521d\u59cb\u5316\u7ba1\u7406\u5458\u8d26\u6237\ndocker exec spug init_spug admin spug.dev\n\n# \u6267\u884c\u5b8c\u6bd5\u540e\u9700\u8981\u91cd\u542f\u5bb9\u5668\ndocker restart spug\n"})}),"\n",(0,r.jsx)(n.h3,{id:"13-\u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406spug",children:"1.3 \u4f7f\u7528nginx\u53cd\u5411\u4ee3\u7406spug"}),"\n",(0,r.jsx)(n.p,{children:"http\u914d\u7f6e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:'server {\n  listen 80;\n  server_name spug.test.com;\n  \n  location / {\n    proxy_pass http://127.0.0.1:8000;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  }\n\n  location ^~ /api/ws/ {\n    proxy_pass http://127.0.0.1:8000;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection "Upgrade";\n    proxy_set_header X-Real-IP $remote_addr;\n  }\n\n  error_page 404 /index.html;\n  \n  access_log /var/log/spug/spug.test.com.access.log;\n  error_log /var/log/spug/spug.test.com.error.log;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"https\u914d\u7f6e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:'server {\n  listen 80;\n  server_name spug.test.com;\n  return 301 https://$server_name$request_uri;\n  client_max_body_size 1000m;\n}\n\nserver {\n  listen 443 ssl;\n  server_name spug.test.com;\n  \n  location / {\n    proxy_pass http://127.0.0.1:8000;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  }\n\n  location ^~ /api/ws/ {\n    proxy_pass http://127.0.0.1:8000;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection "Upgrade";\n    proxy_set_header X-Real-IP $remote_addr;\n  }\n\n  error_page 404 /index.html;\n  \n  access_log /var/log/spug/spug.test.com.access.log;\n  error_log /var/log/spug/spug.test.com.error.log;\n  ssl_certificate ssl_key/spug/1_spug.test.com_bundle.crt;\n  ssl_certificate_key ssl_key/spug/2_spug.test.com.key;\n  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u6d4f\u89c8\u5668\u8bbf\u95ee"}),"\n",(0,r.jsxs)(n.p,{children:["\u7528\u6237\u540d\uff1a",(0,r.jsx)(n.code,{children:"admin"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u5bc6\u7801\uff1a",(0,r.jsx)(n.code,{children:"spug.dev"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-02-03%2010.02.25.png",alt:"iShot2021-02-03 10.02.25"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-02-03%2010.03.25.png",alt:"iShot2021-02-03 10.03.25"})}),"\n",(0,r.jsx)(n.h3,{id:"14-\u5173\u4e8enginx\u914d\u7f6e\u9047\u5230\u7684\u95ee\u9898",children:"1.4 \u5173\u4e8enginx\u914d\u7f6e\u9047\u5230\u7684\u95ee\u9898"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://spug.dev/docs/install-error/",children:"\u5b98\u65b9\u6587\u6863\u5173\u4e8econsole\u8fde\u63a5\u95ee\u9898\u7684\u8bf4\u660e"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u95ee\u9898\u4e00\uff1a\u4e3b\u673aconsole\u8fde\u63a5\u7a7a\u767d"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-02-02%2015.45.57.png",alt:"iShot2021-02-02 15.45.57"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u539f\u56e0\uff1a"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u8fd9\u79cd\u60c5\u51b5\u5927\u90e8\u5206\u90fd\u662f ",(0,r.jsx)(n.code,{children:"Websocket"})," \u8fde\u63a5\u5efa\u7acb\u5931\u8d25\u4e86\uff0c\u4e00\u822c\u51fa\u73b0\u5728\u90e8\u7f72\u65f6\u81ea\u5df1\u52a0\u4e86\u4e00\u5c42 nginx \u4e4b\u7c7b\u7684\u4ee3\u7406\u5de5\u5177\uff0c\u8fd9\u4e9b\u4ee3\u7406\u5de5\u5177\u9ed8\u8ba4\u65e0\u6cd5\u5904\u7406 ",(0,r.jsx)(n.code,{children:"Weboscket"})," \u8bf7\u6c42\uff0c \u8fd9\u5c31\u9700\u8981\u4f60\u914d\u7f6e\u5176\u652f\u6301\u8f6c\u53d1 ",(0,r.jsx)(n.code,{children:"Websocket"})," \u8bf7\u6c42"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u89e3\u51b3\u65b9\u6cd5\uff1a"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u5728nginx\u4e2d\u914d\u7f6e\u5982\u4e0b\u5185\u5bb9"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:'location ^~ /api/ws/ {\n    proxy_pass http://127.0.0.1:8000;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection "Upgrade";\n    proxy_set_header X-Real-IP $remote_addr;\n  }\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u95ee\u9898\u4e8c\uff1a\u65e0\u6cd5\u83b7\u53d6\u5ba2\u6237\u7aef\u771f\u5b9eIP\u4ee5\u53caspug console\u65e0\u6cd5\u8fde\u63a5"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u5728\u5bbf\u4e3b\u673anginx\u4e2d\u5982\u679c\u4e0d\u914d\u7f6e ",(0,r.jsx)(n.code,{children:"proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"})," \u5728\u767b\u9646spug\u7684\u65f6\u5019\u5c31\u4f1a\u63d0\u793a\u65e0\u6cd5\u83b7\u53d6\u5ba2\u6237\u7aef\u771f\u5b9eIP\uff0c\u4f46\u662f\u914d\u7f6e\u4e86 ",(0,r.jsx)(n.code,{children:"proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"})," \u540e\u53ef\u4ee5\u83b7\u53d6\u5ba2\u6237\u7aef\u771f\u5b9eIP\uff0c\u7136\u800c\u786e\u65e0\u6cd5\u8fde\u63a5\u4e3b\u673aconsole"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u539f\u56e0\uff1a"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"spug\u5bb9\u5668\u4e2d\u5df2\u7ecf\u6709\u4e00\u5c42nginx\u505a\u4ee3\u7406\u4e86"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u89e3\u51b3\u65b9\u6cd5\uff1a"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u6ce8\u91caspug\u5bb9\u5668\u4e2dnginx\u914d\u7f6e\u6587\u4ef6 ",(0,r.jsx)(n.code,{children:"/etc/nginx/nginx.conf"})," \u4e2d ",(0,r.jsx)(n.code,{children:"location ^~ /api/ws/"})," \u4e0b\u7684   ",(0,r.jsx)(n.code,{children:"proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var r=s(96540);const t={},c=r.createContext(t);function o(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);