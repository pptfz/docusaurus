"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[4025],{90834:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>d,metadata:()=>c,toc:()=>t});var l=s(74848),a=s(28453);const d={},i="ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude",c={id:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude",title:"ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude",description:"include\u7684\u4f7f\u7528\u573a\u666f\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u591a\u4e2aplaybook\u9700\u8981\u6267\u884c\u76f8\u540c\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u67095\u4e2aplaybook\uff0c\u8fd95\u4e2aplaybook\u90fd\u662f\u5b89\u88c5\u4e0d\u540c\u7684\u670d\u52a1\uff0c\u4f46\u662f\u90fd\u4f1a\u5b89\u88c5nginx\uff0c\u540c\u65f6\u4e5f\u90fd\u4f1a\u91cd\u542fnginx\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528include",source:"@site/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude.md",sourceDirName:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236",slug:"/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ansible\u4efb\u52a1\u63a7\u5236-\u5224\u65ad\u8bed\u53e5when",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5224\u65ad\u8bed\u53e5when"},next:{title:"ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/ansible/ansible\u4efb\u52a1\u63a7\u5236/ansible\u4efb\u52a1\u63a7\u5236-\u5faa\u73af\u8bed\u53e5with_items"}},o={},t=[];function r(e){const n={blockquote:"blockquote",code:"code",h1:"h1",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude",children:"ansible\u4efb\u52a1\u63a7\u5236-\u5305\u542binclude"}),"\n",(0,l.jsx)(n.p,{children:"include\u7684\u4f7f\u7528\u573a\u666f\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u591a\u4e2aplaybook\u9700\u8981\u6267\u884c\u76f8\u540c\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u67095\u4e2aplaybook\uff0c\u8fd95\u4e2aplaybook\u90fd\u662f\u5b89\u88c5\u4e0d\u540c\u7684\u670d\u52a1\uff0c\u4f46\u662f\u90fd\u4f1a\u5b89\u88c5nginx\uff0c\u540c\u65f6\u4e5f\u90fd\u4f1a\u91cd\u542fnginx\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528include"}),"\n",(0,l.jsx)(n.p,{children:"\u9996\u5148\u7f16\u8f91\u4e00\u4e2a\u6ca1\u6709play\u7684yml\uff0c\u5176\u4ed6\u7684yml\u4e2d\u4f7f\u7528include\u6765\u5305\u542b\u8fd9\u4e2ayml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"cat > task_include_tem.yml <<EOF\n- name: restart nginx\n  service:\n    name: nginx\n    state: restarted\nEOF\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7f16\u8f91a.yml"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u6211\u4eec\u4ec5\u4ec5\u4f7f\u7528shell\u6a21\u5757echo\u4e00\u53e5\u8bdd\uff0c\u7136\u540e\u91cd\u542fnginx"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"cat > a.yml << EOF\n- hosts: all\n  tasks:\n    - name: print test a\n      shell: echo 'test a'\n    - name: restat nginx\n      include: ./task_include_tem.yml\nEOF\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6267\u884ca.yml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"$ ansible-playbook a.yml \n\nPLAY [all] *********************************************************************************************************************************************\n\nTASK [Gathering Facts] *********************************************************************************************************************************\nok: [devops03]\nok: [devops02]\nok: [devops01]\n\nTASK [print test a] ************************************************************************************************************************************\nchanged: [devops03]\nchanged: [devops02]\nchanged: [devops01]\n\nTASK [restart nginx] ***********************************************************************************************************************************\nchanged: [devops02]\nchanged: [devops03]\nchanged: [devops01]\n\nPLAY RECAP *********************************************************************************************************************************************\ndevops01                   : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \ndevops02                   : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \ndevops03                   : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7f16\u8f91b.yml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"cat > b.yml << EOF\n- hosts: all\n  tasks:\n    - name: print test b\n      shell: echo 'test b'\n    - name: restat nginx\n      include: ./task_include_tem.yml\nEOF\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6267\u884cb.yml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"$ ansible-playbook b.yml \n\nPLAY [all] *********************************************************************************************************************************************\n\nTASK [Gathering Facts] *********************************************************************************************************************************\nok: [devops02]\nok: [devops03]\nok: [devops01]\n\nTASK [print test b] ************************************************************************************************************************************\nchanged: [devops03]\nchanged: [devops02]\nchanged: [devops01]\n\nTASK [restart nginx] ***********************************************************************************************************************************\nchanged: [devops03]\nchanged: [devops02]\nchanged: [devops01]\n\nPLAY RECAP *********************************************************************************************************************************************\ndevops01                   : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \ndevops02                   : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \ndevops03                   : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n"})}),"\n",(0,l.jsxs)(n.p,{children:["yml\u6587\u4ef6\u4e2d\u7684 ",(0,l.jsx)(n.code,{children:"include"})," \u8fd8\u53ef\u4ee5\u5199\u6210 ",(0,l.jsx)(n.code,{children:"include_tasks"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"cat > b.yml << EOF\n- hosts: all\n  tasks:\n    - name: print test b\n      shell: echo 'test b'\n    - name: restat nginx\n      include_tasks: ./task_include_tem.yml\nEOF\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u6267\u884c\u7684\u65f6\u5019\u4f1a\u591a\u4e86\u4e00\u4e2a ",(0,l.jsx)(n.code,{children:"included: /root/yml/task_include_tem.yml for devops01, devops02, devops03"})," \u63d0\u793a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"$ ansible-playbook b.yml \n\nPLAY [all] *********************************************************************************************************************************************\n\nTASK [Gathering Facts] *********************************************************************************************************************************\nok: [devops03]\nok: [devops02]\nok: [devops01]\n\nTASK [print test b] ************************************************************************************************************************************\nchanged: [devops02]\nchanged: [devops03]\nchanged: [devops01]\n\nTASK [restat nginx] ************************************************************************************************************************************\nincluded: /root/yml/task_include_tem.yml for devops01, devops02, devops03\n\nTASK [restart nginx] ***********************************************************************************************************************************\nchanged: [devops03]\nchanged: [devops02]\nchanged: [devops01]\n\nPLAY RECAP *********************************************************************************************************************************************\ndevops01                   : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \ndevops02                   : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \ndevops03                   : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(r,{...e})}):r(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var l=s(96540);const a={},d=l.createContext(a);function i(e){const n=l.useContext(d);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),l.createElement(d.Provider,{value:n},e.children)}}}]);