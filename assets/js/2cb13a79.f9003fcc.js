"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7309],{3665:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>p,contentTitle:()=>t,default:()=>d,frontMatter:()=>c,metadata:()=>r,toc:()=>o});var s=i(74848),a=i(28453);const c={},t="nginx\u4e0ephp\u901a\u4fe1\u65b9\u5f0f",r={id:"linux/linux\u670d\u52a1/php/\u77e5\u8bc6\u70b9/nginx\u4e0ephp\u901a\u4fe1\u65b9\u5f0f",title:"nginx\u4e0ephp\u901a\u4fe1\u65b9\u5f0f",description:"[toc]",source:"@site/docs/linux/linux\u670d\u52a1/php/\u77e5\u8bc6\u70b9/nginx\u4e0ephp\u901a\u4fe1\u65b9\u5f0f.md",sourceDirName:"linux/linux\u670d\u52a1/php/\u77e5\u8bc6\u70b9",slug:"/linux/linux\u670d\u52a1/php/\u77e5\u8bc6\u70b9/nginx\u4e0ephp\u901a\u4fe1\u65b9\u5f0f",permalink:"/docs/linux/linux\u670d\u52a1/php/\u77e5\u8bc6\u70b9/nginx\u4e0ephp\u901a\u4fe1\u65b9\u5f0f",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u6e90\u7801\u5b89\u88c5",permalink:"/docs/linux/linux\u670d\u52a1/php/\u5b89\u88c5/\u6e90\u7801\u5b89\u88c5"},next:{title:"ssh config",permalink:"/docs/linux/linux\u670d\u52a1/ssh/ssh config"}},p={},o=[{value:"unix socket",id:"unix-socket",level:2},{value:"\u914d\u7f6e\u793a\u4f8b",id:"\u914d\u7f6e\u793a\u4f8b",level:3},{value:"\u751f\u4ea7\u914d\u7f6e\u793a\u4f8b",id:"\u751f\u4ea7\u914d\u7f6e\u793a\u4f8b",level:3},{value:"tcp socket",id:"tcp-socket",level:2},{value:"\u914d\u7f6e\u793a\u4f8b",id:"\u914d\u7f6e\u793a\u4f8b-1",level:3}];function l(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,a.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.p,{children:"[toc]"}),"\n",(0,s.jsx)(e.h1,{id:"nginx\u4e0ephp\u901a\u4fe1\u65b9\u5f0f",children:"nginx\u4e0ephp\u901a\u4fe1\u65b9\u5f0f"}),"\n",(0,s.jsx)(e.h2,{id:"unix-socket",children:"unix socket"}),"\n",(0,s.jsx)(e.h3,{id:"\u914d\u7f6e\u793a\u4f8b",children:"\u914d\u7f6e\u793a\u4f8b"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"location ~ \\.php$ {\n    include fastcgi_params;\n    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n    fastcgi_pass unix:/var/run/php7-fpm.sock;\n    fastcgi_index index.php;\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u751f\u4ea7\u914d\u7f6e\u793a\u4f8b",children:"\u751f\u4ea7\u914d\u7f6e\u793a\u4f8b"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"php-fpm.conf"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"[global]\npid = /usr/local/php/var/run/php-fpm.pid\nerror_log = /usr/local/php/var/log/php-fpm.log\nlog_level = notice\n\n[www]\nlisten = /tmp/php-cgi.sock\nlisten.backlog = -1\nlisten.allowed_clients = 127.0.0.1\nlisten.owner = www\nlisten.group = www\nlisten.mode = 0666\nuser = www\ngroup = www\npm = dynamic\npm.max_children = 100\npm.start_servers = 20\npm.min_spare_servers = 20\npm.max_spare_servers = 40\nrequest_terminate_timeout = 100\nrequest_slowlog_timeout = 0\nslowlog = var/log/slow.log\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u5728nginx\u540e\u7aefapi\u63a5\u53e3\u914d\u7f6e\u6587\u4ef6\u4e2d\u6709\u5982\u4e0b\u914d\u7f6e\uff0c\u628anginx\u4e0ephp\u901a\u4fe1\u7684\u914d\u7f6e\u5355\u72ec\u5199\u5230\u4e86\u4e00\u4e2a\u6587\u4ef6\u4e2d"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"include enable-php.conf;\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"enable-php.conf"})," \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"location ~ [^/]\\.php(/|$)\n    {\n        try_files $uri =404;\n        fastcgi_pass  unix:/tmp/php-cgi.sock;\n        fastcgi_index index.php;\n        include fastcgi.conf;\n    }\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u800c ",(0,s.jsx)(e.code,{children:"enable-php.conf"})," \u53c8\u6709 ",(0,s.jsx)(e.code,{children:"include fastcgi.conf"})," \u914d\u7f6e\uff0c",(0,s.jsx)(e.code,{children:"fastcgi.conf"}),"\u5185\u5bb9\u5982\u4e0b"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:'fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;\nfastcgi_param  QUERY_STRING       $query_string;\nfastcgi_param  REQUEST_METHOD     $request_method;\nfastcgi_param  CONTENT_TYPE       $content_type;\nfastcgi_param  CONTENT_LENGTH     $content_length;\n\nfastcgi_param  SCRIPT_NAME        $fastcgi_script_name;\nfastcgi_param  REQUEST_URI        $request_uri;\nfastcgi_param  DOCUMENT_URI       $document_uri;\nfastcgi_param  DOCUMENT_ROOT      $document_root;\nfastcgi_param  SERVER_PROTOCOL    $server_protocol;\nfastcgi_param  REQUEST_SCHEME     $scheme;\nfastcgi_param  HTTPS              $https if_not_empty;\n\nfastcgi_param  GATEWAY_INTERFACE  CGI/1.1;\nfastcgi_param  SERVER_SOFTWARE    nginx/$nginx_version;\n\nfastcgi_param  REMOTE_ADDR        $remote_addr;\nfastcgi_param  REMOTE_PORT        $remote_port;\nfastcgi_param  SERVER_ADDR        $server_addr;\nfastcgi_param  SERVER_PORT        $server_port;\nfastcgi_param  SERVER_NAME        $server_name;\n\n# PHP only, required if PHP was built with --enable-force-cgi-redirect\nfastcgi_param  REDIRECT_STATUS    200;\nfastcgi_param PHP_ADMIN_VALUE "open_basedir=$document_root/:/tmp/:/proc/:/data/ald_api";\n'})}),"\n",(0,s.jsx)(e.h2,{id:"tcp-socket",children:"tcp socket"}),"\n",(0,s.jsx)(e.h3,{id:"\u914d\u7f6e\u793a\u4f8b-1",children:"\u914d\u7f6e\u793a\u4f8b"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"location ~ \\.php$ {\n    include fastcgi_params;\n    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n    fastcgi_pass 127.0.0.1:9000;\n    fastcgi_index index.php;\n}\n"})})]})}function d(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}},28453:(n,e,i)=>{i.d(e,{R:()=>t,x:()=>r});var s=i(96540);const a={},c=s.createContext(a);function t(n){const e=s.useContext(c);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:t(n.components),s.createElement(c.Provider,{value:e},n.children)}}}]);