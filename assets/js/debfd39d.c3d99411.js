"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[6282],{9528:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>p,default:()=>d,frontMatter:()=>s,metadata:()=>a,toc:()=>i});var l=t(74848),r=t(28453);const s={},p="openvpn\u5bf9\u63a5ldap",a={id:"linux/linux\u670d\u52a1/VPN/openvpn\u5bf9\u63a5ldap",title:"openvpn\u5bf9\u63a5ldap",description:"1.\u5b89\u88c5 openvpn ldap\u8ba4\u8bc1\u63d2\u4ef6",source:"@site/docs/linux/linux\u670d\u52a1/VPN/openvpn\u5bf9\u63a5ldap.md",sourceDirName:"linux/linux\u670d\u52a1/VPN",slug:"/linux/linux\u670d\u52a1/VPN/openvpn\u5bf9\u63a5ldap",permalink:"/docs/linux/linux\u670d\u52a1/VPN/openvpn\u5bf9\u63a5ldap",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"CentOS7\u624b\u52a8\u5b89\u88c5OpenVPN",permalink:"/docs/linux/linux\u670d\u52a1/VPN/CentOS7\u624b\u52a8\u5b89\u88c5OpenVPN"},next:{title:"elasticsearch\u5b89\u88c5",permalink:"/docs/linux/linux\u670d\u52a1/elk/elasticsearch/elasticsearch\u5b89\u88c5"}},o={},i=[{value:"1.\u5b89\u88c5 openvpn ldap\u8ba4\u8bc1\u63d2\u4ef6",id:"1\u5b89\u88c5-openvpn-ldap\u8ba4\u8bc1\u63d2\u4ef6",level:2},{value:"2.\u4fee\u6539 openvpn ldap\u8ba4\u8bc1\u6587\u4ef6",id:"2\u4fee\u6539-openvpn-ldap\u8ba4\u8bc1\u6587\u4ef6",level:2},{value:"3.\u4fee\u6539 openvpn \u914d\u7f6e\u6587\u4ef6",id:"3\u4fee\u6539-openvpn-\u914d\u7f6e\u6587\u4ef6",level:2},{value:"4.\u4fee\u6539openvpn\u5ba2\u6237\u7aef\u6587\u4ef6",id:"4\u4fee\u6539openvpn\u5ba2\u6237\u7aef\u6587\u4ef6",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"openvpn\u5bf9\u63a5ldap",children:"openvpn\u5bf9\u63a5ldap"}),"\n",(0,l.jsx)(n.h2,{id:"1\u5b89\u88c5-openvpn-ldap\u8ba4\u8bc1\u63d2\u4ef6",children:"1.\u5b89\u88c5 openvpn ldap\u8ba4\u8bc1\u63d2\u4ef6"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"yum -y install openvpn-auth-ldap\n"})}),"\n",(0,l.jsx)(n.h2,{id:"2\u4fee\u6539-openvpn-ldap\u8ba4\u8bc1\u6587\u4ef6",children:"2.\u4fee\u6539 openvpn ldap\u8ba4\u8bc1\u6587\u4ef6"}),"\n",(0,l.jsxs)(n.p,{children:["\u4fee\u6539 ",(0,l.jsx)(n.code,{children:"/etc/openvpn/auth/ldap.conf"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:'<LDAP>\n    URL        ldap://xxx:389\u3000\u3000# \u6307\u5b9aldap server\u5730\u5740\u4ee5\u53ca\u7aef\u53e3\n    BindDN    "cn=xxx,dc=xxx,dc=com"\u3000\u3000     # \u6307\u5b9abinddn\u4fe1\u606f\u5373\u7ba1\u7406\u5458\u4fe1\u606f\n    Password    "xxx"\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000     # \u6307\u5b9a\u7ba1\u7406\u5458\u5bc6\u7801\n    Timeout        15\u3000\u3000\t\t\t\t\t\t\t\t\t\t# \u8bbe\u7f6e\u7f51\u7edc\u8d85\u65f6\u65f6\u95f4\n    TLSEnable    no\t\t\t\t\t\t\t\t\t\t\t\t# \u662f\u5426\u4f7f\u7528TLS\n    FollowReferrals yes\n</LDAP>\n<Authorization>\n    BaseDN        "dc=xxx,dc=com"\u3000\u3000        # \u6307\u5b9abase dn \u57df\n    SearchFilter    "uid=%u"\u3000\u3000\u3000       # \u6307\u5b9a\u641c\u7d22\u6761\u4ef6\uff0c\u6b64\u5904\u82e5\u4f7f\u7528cn\u4f5c\u4e3a\u7528\u6237\u540d\uff0c\u5219\u4e0d\u7528\u4fee\u6539\uff0c\u9ed8\u8ba4\u4e3a (&(uid=%u)(accountStatus=active)) \uff0c\u4f46\u662f\u4e0d\u597d\u4f7f\uff0c\u539f\u56e0\u672a\u77e5\n    RequireGroup    false\n</Authorization>\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"/etc/openvpn/auth/ldap.conf"})," \u9ed8\u8ba4\u5185\u5bb9\u5982\u4e0b"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:'<LDAP>\n\t# LDAP server URL\n\tURL\t\tldap://ldap1.example.org\n\n\t# Bind DN (If your LDAP server doesn\'t support anonymous binds)\n\t# BindDN\t\tuid=Manager,ou=People,dc=example,dc=com\n\n\t# Bind Password\n\t# Password\tSecretPassword\n\n\t# Network timeout (in seconds)\n\tTimeout\t\t15\n\n\t# Enable Start TLS\n\tTLSEnable\tyes\n\n\t# Follow LDAP Referrals (anonymously)\n\tFollowReferrals yes\n\n\t# TLS CA Certificate File\n\tTLSCACertFile\t/usr/local/etc/ssl/ca.pem\n\n\t# TLS CA Certificate Directory\n\tTLSCACertDir\t/etc/ssl/certs\n\n\t# Client Certificate and key\n\t# If TLS client authentication is required\n\tTLSCertFile\t/usr/local/etc/ssl/client-cert.pem\n\tTLSKeyFile\t/usr/local/etc/ssl/client-key.pem\n\n\t# Cipher Suite\n\t# The defaults are usually fine here\n\t# TLSCipherSuite\tALL:!ADH:@STRENGTH\n</LDAP>\n\n<Authorization>\n\t# Base DN\n\tBaseDN\t\t"ou=People,dc=example,dc=com"\n\n\t# User Search Filter\n\tSearchFilter\t"(&(uid=%u)(accountStatus=active))"\n\n\t# Require Group Membership\n\tRequireGroup\tfalse\n\n\t# Add non-group members to a PF table (disabled)\n\t#PFTable\tips_vpn_users\n\n\t<Group>\n\t\tBaseDN\t\t"ou=Groups,dc=example,dc=com"\n\t\tSearchFilter\t"(|(cn=developers)(cn=artists))"\n\t\tMemberAttribute\tuniqueMember\n\t\t# Add group members to a PF table (disabled)\n\t\t#PFTable\tips_vpn_eng\n\t</Group>\n</Authorization>\n'})}),"\n",(0,l.jsx)(n.h2,{id:"3\u4fee\u6539-openvpn-\u914d\u7f6e\u6587\u4ef6",children:"3.\u4fee\u6539 openvpn \u914d\u7f6e\u6587\u4ef6"}),"\n",(0,l.jsxs)(n.p,{children:["\u4fee\u6539 ",(0,l.jsx)(n.code,{children:"/etc/openvpn/server/server.conf "}),"\u65b0\u589e\u5982\u4e0b\u4e24\u884c"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:'# \u6307\u5b9aldap\u8ba4\u8bc1\u63d2\u4ef6\u5730\u5740\uff0c\u6b64\u5904\u64cd\u4f5c\u7cfb\u7edf\u4e3a64\u4f4d\u3002\u5e76\u6307\u5b9aauth ldap\u8ba4\u8bc1\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\u3002\nplugin /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so "/etc/openvpn/auth/ldap.conf %u" \n\n# \u8bbe\u7f6e\u5ba2\u6237\u7aef\u53ef\u4ee5\u4e0d\u7528\u901a\u8fc7\u8bc1\u4e66\u8ba4\u8bc1\uff0c\u8f93\u5165ldap\u4e2d\u7528\u6237\u540d\u548c\u5bc6\u7801\u5373\u53ef\u5b9e\u73b0\u8ba4\u8bc1\u3002\nclient-cert-not-required\n'})}),"\n",(0,l.jsx)(n.h2,{id:"4\u4fee\u6539openvpn\u5ba2\u6237\u7aef\u6587\u4ef6",children:"4.\u4fee\u6539openvpn\u5ba2\u6237\u7aef\u6587\u4ef6"}),"\n",(0,l.jsxs)(n.p,{children:["\u4fee\u6539 ",(0,l.jsx)(n.code,{children:"client.ovpn"})," \uff08\u6b64\u6587\u4ef6\u4e3a\u5b89\u88c5openvpn\u65f6\u6307\u5b9a\u7684\u4ee5 ",(0,l.jsx)(n.code,{children:"ovpn"})," \u7ed3\u5c3e\u7684\u6587\u4ef6\uff09"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:";cert xxx.crt                                  # \u5ba2\u6237\u7aef\u8bc1\u4e66\uff0c\u56e0\u4f7f\u7528ldap\u8ba4\u8bc1\uff0c\u6240\u4ee5\u6ce8\u91ca\n;key xxx.key                                   # \u5ba2\u6237\u7aef\u5bc6\u94a5\uff0c\u56e0\u4f7f\u7528ldap\u8ba4\u8bc1\uff0c\u6240\u4ee5\u6ce8\u91ca\nauth-user-pass\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t# \u5f00\u542f\u7528\u6237\u540d\u5bc6\u7801\u8ba4\u8bc1\n"})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>p,x:()=>a});var l=t(96540);const r={},s=l.createContext(r);function p(e){const n=l.useContext(s);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:p(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);