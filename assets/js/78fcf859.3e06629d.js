"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[307],{80086:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>a,frontMatter:()=>c,metadata:()=>o,toc:()=>x});var s=i(74848),t=i(28453);const c={},r="nginx\u57fa\u7840\u5e94\u7528",o={id:"linux/linux\u670d\u52a1/nginx/nginx\u57fa\u7840\u5e94\u7528",title:"nginx\u57fa\u7840\u5e94\u7528",description:"[toc]",source:"@site/docs/linux/linux\u670d\u52a1/nginx/3.nginx\u57fa\u7840\u5e94\u7528.md",sourceDirName:"linux/linux\u670d\u52a1/nginx",slug:"/linux/linux\u670d\u52a1/nginx/nginx\u57fa\u7840\u5e94\u7528",permalink:"/docs/linux/linux\u670d\u52a1/nginx/nginx\u57fa\u7840\u5e94\u7528",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"http\u7b80\u8981\u8bb0\u5f55",permalink:"/docs/linux/linux\u670d\u52a1/nginx/http\u7b80\u8981\u8bb0\u5f55"},next:{title:"nginx\u8bbf\u95ee\u63a7\u5236",permalink:"/docs/linux/linux\u670d\u52a1/nginx/nginx\u8bbf\u95ee\u63a7\u5236"}},l={},x=[{value:"1.nginx\u76ee\u5f55\u7d22\u5f15",id:"1nginx\u76ee\u5f55\u7d22\u5f15",level:2},{value:"autoindex",id:"autoindex",level:3},{value:"autoindex_exact_size",id:"autoindex_exact_size",level:3},{value:"autoindex_localtime",id:"autoindex_localtime",level:3},{value:"\u914d\u7f6e\u7ad9\u70b9\u76ee\u5f55\u6d4f\u89c8\u529f\u80fd",id:"\u914d\u7f6e\u7ad9\u70b9\u76ee\u5f55\u6d4f\u89c8\u529f\u80fd",level:3},{value:"2.nginx\u72b6\u6001\u76d1\u63a7",id:"2nginx\u72b6\u6001\u76d1\u63a7",level:2},{value:"2.1 \u68c0\u6d4bnginx\u662f\u5426\u652f\u6301<code>stub_status</code>\u6a21\u5757",id:"21-\u68c0\u6d4bnginx\u662f\u5426\u652f\u6301stub_status\u6a21\u5757",level:3},{value:"2.2 \u914d\u7f6enginx status",id:"22-\u914d\u7f6enginx-status",level:3},{value:"2.3 \u6d4f\u89c8\u5668\u8bbf\u95ee<code>\u57df\u540d/nginx_status</code>",id:"23-\u6d4f\u89c8\u5668\u8bbf\u95ee\u57df\u540dnginx_status",level:3}];function d(n){const e={admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.p,{children:"[toc]"}),"\n",(0,s.jsx)(e.h1,{id:"nginx\u57fa\u7840\u5e94\u7528",children:"nginx\u57fa\u7840\u5e94\u7528"}),"\n",(0,s.jsx)(e.h2,{id:"1nginx\u76ee\u5f55\u7d22\u5f15",children:"1.nginx\u76ee\u5f55\u7d22\u5f15"}),"\n",(0,s.jsx)(e.admonition,{type:"info",children:(0,s.jsx)(e.p,{children:(0,s.jsxs)(e.strong,{children:["\u52a0\u53c2\u6570 ",(0,s.jsx)(e.code,{children:"charset utf-8,gbk;"})," \u89e3\u51b3\u4e2d\u6587\u4e71\u7801\u95ee\u9898"]})})}),"\n",(0,s.jsx)(e.h3,{id:"autoindex",children:"autoindex"}),"\n",(0,s.jsxs)(e.admonition,{type:"info",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:(0,s.jsxs)("span",{style:{color:"red"},children:["\u662f\u5426\u5217\u51fa\u7f51\u7ad9\u6839\u76ee\u5f55(nginx\u9ed8\u8ba4\u662f\u4e0d\u5141\u8bb8\u5217\u51fa\u6574\u4e2a\u76ee\u5f55\u6d4f\u89c8\u4e0b\u8f7d\u7684\uff0c\u5373 ",(0,s.jsx)(e.code,{children:"autoindex off"}),")"]})})}),(0,s.jsxs)(e.p,{children:["\u9ed8\u8ba4\u4e3a",(0,s.jsx)(e.strong,{children:"off"}),"\uff0c\u7981\u6b62\u5217\u51fa\u7f51\u7ad9\u6839\u76ee\u5f55\u5185\u5bb9"]}),(0,s.jsxs)(e.p,{children:["\u4fee\u6539\u4e3a",(0,s.jsx)(e.strong,{children:"on"}),"\uff0c\u5217\u51fa\u7f51\u7ad9\u6839\u76ee\u5f55\u5185\u5bb9"]})]}),"\n",(0,s.jsx)(e.p,{children:"\u7f16\u8f91nginx\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"cat > /etc/nginx/conf.d/www.abc.com <<'EOF'\nserver {\n    listen 80;\n    server_name www.abc.com;\n\n    location / {\n        root /website;\n        autoindex off;\n        charset utf-8,gbk;\n    }\n}\nEOF\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u68c0\u6d4bnginx\u8bed\u6cd5\u5e76\u91cd\u8f7dnginx"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"nginx -t\nnginx -s reload\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u521b\u5efa\u7f51\u7ad9\u6839\u76ee\u5f55\u5e76\u521b\u5efa\u6587\u4ef6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"mkdir /website && cd /website\ntouch {1..3}.txt\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u672c\u673ahosts\u89e3\u6790\uff0c\u7136\u540e\u6d4f\u89c8\u5668\u8bbf\u95ee\u57df\u540d",(0,s.jsx)(e.code,{children:"www.abc.com"})]}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["windows","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"c:\\windows\\system32\\drivers\\etc"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["mac","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"/etc/hosts"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["\u5f53",(0,s.jsx)(e.code,{children:"autoindex"}),"\u4e3a",(0,s.jsx)(e.strong,{children:"off"}),"\u7684\u65f6\u5019\u662f\u62d2\u7edd\u8bbf\u95ee\u7f51\u7ad9\u6839\u76ee\u5f55\u7684"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-06-1521.51.20.png",alt:"iShot2020-06-1521.52.53"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5f53",(0,s.jsx)(e.code,{children:"autoindex"}),"\u4e3a",(0,s.jsx)(e.strong,{children:"on"}),"\u7684\u65f6\u5019\u662f\u53ef\u4ee5\u8bbf\u95ee\u7f51\u7ad9\u6839\u76ee\u5f55\u7684"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-06-1522.24.06.png",alt:"iShot2020-06-1521.51.20"})}),"\n",(0,s.jsx)(e.h3,{id:"autoindex_exact_size",children:"autoindex_exact_size"}),"\n",(0,s.jsxs)(e.admonition,{type:"info",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:(0,s.jsx)("span",{style:{color:"red"},children:"\u662f\u5426\u663e\u793a\u6587\u4ef6\u7684\u786e\u5207\u5927\u5c0f"})})}),(0,s.jsxs)(e.p,{children:["\u9ed8\u8ba4\u4e3a",(0,s.jsx)(e.strong,{children:"on"}),"\uff0c \u663e\u793a\u51fa\u6587\u4ef6\u7684\u786e\u5207\u5927\u5c0f\uff0c\u5355\u4f4d\u662fbytes\u3002"]}),(0,s.jsxs)(e.p,{children:["\u4fee\u6539\u4e3a",(0,s.jsx)(e.strong,{children:"off"}),"\uff0c\u663e\u793a\u51fa\u6587\u4ef6\u7684\u5927\u6982\u5927\u5c0f\uff0c\u5355\u4f4d\u662fkB\u6216\u8005MB\u6216\u8005GB"]})]}),"\n",(0,s.jsxs)(e.p,{children:["\u5f53",(0,s.jsx)(e.code,{children:"autoindex_exact_size"}),"\u4e3a",(0,s.jsx)(e.strong,{children:"on"}),"\u7684\u65f6\u5019\uff0c\u663e\u793a\u6587\u4ef6\u786e\u5207\u5927\u5c0f\uff0c\u5355\u4f4d\u662f\u5b57\u8282\uff0c\u663e\u793a\u5982\u4e0b"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-06-1521.52.53.png",alt:"iShot2020-06-1522.24.06"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5f53",(0,s.jsx)(e.code,{children:"autoindex_exact_size"}),"\u4e3a",(0,s.jsx)(e.strong,{children:"off"}),"\u7684\u65f6\u5019\uff0c\u663e\u793a\u662f\u6587\u4ef6\u7684\u5927\u6982\u5927\u5c0f\uff0c\u5355\u4f4d\u662fKB/MB/GB\uff0c\u663e\u793a\u5982\u4e0b"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-06-1522.25.44.png",alt:"iShot2020-06-1522.25.44"})}),"\n",(0,s.jsx)(e.h3,{id:"autoindex_localtime",children:"autoindex_localtime"}),"\n",(0,s.jsxs)(e.admonition,{type:"info",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:(0,s.jsx)("span",{style:{color:"red"},children:"\u663e\u793a\u6587\u4ef6\u4fee\u6539\u65f6\u95f4\u6216\u6587\u4ef6\u670d\u52a1\u5668\u65f6\u95f4"})})}),(0,s.jsxs)(e.p,{children:["\u9ed8\u8ba4\u4e3a",(0,s.jsx)(e.strong,{children:"off"}),"\uff0c\u663e\u793a\u7684\u6587\u4ef6\u65f6\u95f4\u4e3aGMT\u65f6\u95f4\u3002"]}),(0,s.jsxs)(e.p,{children:["\u4fee\u6539\u4e3a",(0,s.jsx)(e.strong,{children:"on"}),"\uff0c \u663e\u793a\u7684\u6587\u4ef6\u65f6\u95f4\u4e3a\u6587\u4ef6\u7684\u670d\u52a1\u5668\u65f6\u95f4\u3002"]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u5317\u4eac\u65f6\u95f4=GMT\u65f6\u95f4+8\u5c0f\u65f6"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5f53",(0,s.jsx)(e.code,{children:"autoindex_localtime"}),"\u4e3a",(0,s.jsx)(e.strong,{children:"off"}),"\u7684\u65f6\u5019\uff0c\u663e\u793a\u5982\u4e0b"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-06-1522.31.35.png",alt:"iShot2020-06-1522.31.35"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5f53",(0,s.jsx)(e.code,{children:"autoindex_localtime"}),"\u4e3a",(0,s.jsx)(e.strong,{children:"on"}),"\u7684\u65f6\u5019\uff0c\u663e\u793a\u5982\u4e0b"]}),"\n",(0,s.jsx)(e.admonition,{type:"tip",children:(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u4e0a\u4f20\u7684\u6587\u4ef6\u663e\u793a\u7684\u65f6\u95f4\u662f\u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\uff0c\u4e0e\u670d\u52a1\u5668\u65f6\u95f4\u6ca1\u6709\u5173\u7cfb\uff0c\u5728\u670d\u52a1\u5668\u4e2d\u521b\u5efa\u7684\u6587\u4ef6\u624d\u662f\u670d\u52a1\u5668\u7684\u65f6\u95f4"})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-06-1522.32.56.png",alt:"iShot2020-06-1522.32.56"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"\u914d\u7f6e\u7ad9\u70b9\u76ee\u5f55\u6d4f\u89c8\u529f\u80fd",children:"\u914d\u7f6e\u7ad9\u70b9\u76ee\u5f55\u6d4f\u89c8\u529f\u80fd"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u5728nginx\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f00\u542f\u4ee5\u4e0b\u53c2\u6570\u5373\u53ef"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"location / {\n    root /xxx;\n    autoindex on;\t\t\t\t#\u5217\u51fa\u6839\u76ee\u5f55\uff0c\u9ed8\u8ba4off\n    autoindex_localtime on;\t\t#\u663e\u793a\u6587\u4ef6\u65f6\u95f4\u4e3a\u5f53\u524d\u670d\u52a1\u5668\u65f6\u95f4\uff0c\u9ed8\u8ba4off\n    autoindex_exact_size off;\t\t#\u663e\u793a\u6587\u4ef6\u786e\u5207\u5927\u5c0f\uff0c\u4ee5\u4eba\u7c7b\u6613\u8bfb\u7684\u65b9\u5f0f\u663e\u793a\uff0c\u9ed8\u8ba4on\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"2nginx\u72b6\u6001\u76d1\u63a7",children:"2.nginx\u72b6\u6001\u76d1\u63a7"}),"\n",(0,s.jsxs)(e.p,{children:["nginx\u4e2d",(0,s.jsx)(e.code,{children:"ngx_http_stub_status_module"}),"\u7528\u4e8e\u5c55\u793anginx\u8fde\u63a5\u72b6\u6001\u4fe1\u606f, \u9700\u8981",(0,s.jsx)(e.code,{children:"--with-http_stub_status_module"}),"\u6a21\u5757\u652f\u6301"]}),"\n",(0,s.jsxs)(e.h3,{id:"21-\u68c0\u6d4bnginx\u662f\u5426\u652f\u6301stub_status\u6a21\u5757",children:["2.1 \u68c0\u6d4bnginx\u662f\u5426\u652f\u6301",(0,s.jsx)(e.code,{children:"stub_status"}),"\u6a21\u5757"]}),"\n",(0,s.jsx)(e.admonition,{type:"tip",children:(0,s.jsx)(e.p,{children:(0,s.jsxs)(e.strong,{children:["\u4f7f\u7528\u547d\u4ee4 ",(0,s.jsx)(e.code,{children:"nginx -V\xa0&>nginx.txt"})," \u628anginx\u652f\u6301\u7684\u6a21\u5757\u4fe1\u606f\u653e\u5165\u5230\u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u5728\u6587\u4ef6\u4e2d\u8fc7\u6ee4 ",(0,s.jsx)(e.code,{children:"--with-http_stub_status"})," \u6a21\u5757(rpm\u5305\u6216\u8005yum\u5b89\u88c5\u7684nginx\u90fd\u652f\u6301)\uff0c\u6ce8\u610f\u4e00\u5b9a\u8981\u5199\u6210 ",(0,s.jsx)(e.code,{children:"&>"})," \uff0c\u53ea\u5199 ",(0,s.jsx)(e.code,{children:">"})," \u4e0d\u4f1a\u6709\u5185\u5bb9"]})})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"nginx -V &> nginx.txt\n"})}),"\n",(0,s.jsx)(e.h3,{id:"22-\u914d\u7f6enginx-status",children:"2.2 \u914d\u7f6enginx status"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"location /nginx_status {\n    stub_status;\n    access_log off;\n}\n"})}),"\n",(0,s.jsxs)(e.h3,{id:"23-\u6d4f\u89c8\u5668\u8bbf\u95ee\u57df\u540dnginx_status",children:["2.3 \u6d4f\u89c8\u5668\u8bbf\u95ee",(0,s.jsx)(e.code,{children:"\u57df\u540d/nginx_status"})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u7ed3\u679c\u5982\u4e0b"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-06-1522.50.18.png",alt:"iShot2020-06-1522.50.18"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u5404\u53c2\u6570\u542b\u4e49"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"Active connections:1    #\u5f53\u524d\u6d3b\u52a8\u7684\u8fde\u63a5\u6570\nserver accepts handled requests\n21     21     27\n\n21\t\t#\u603b\u7684tcp\u8fde\u63a5\u6570connection\n21\t\t#\u6210\u529ftcp\u8fde\u63a5\u6570connection(\u5931\u8d25\u8fde\u63a5=(\u603b\u8fde\u63a5\u6570-\u6210\u529f\u8fde\u63a5\u6570))\n27   \t#\u603b\u5171\u5904\u7406\u7684http\u8bf7\u6c42\u6570requests\n\n#keepalive_timeout 0;  \u6bcf\u6b21\u8fde\u63a5\u90fd\u4f1a\u4ea7\u751f\u4e00\u6b21\u8bf7\u6c42(\u77ed\u8fde\u63a5)\n#keepalive_timeout 60; \u572860s\u4ee5\u5185\u7684\u8bf7\u6c42\u5efa\u7acb\u5728\u4e00\u4e2a\u8fde\u63a5\u57fa\u7840\u4e4b\u4e0a(\u957f\u8fde\u63a5)\n\nReading:0 Writing:1 Waiting: 0\nReading\t\t\t#\u8bf7\u6c42\nWriting\t\t\t#\u54cd\u5e94\nWaiting\t\t\t#\u7b49\u5f85\u7684\u8bf7\u6c42\u6570\uff0c\u5f00\u542f\u4e86keepalive\n"})})]})}function a(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},28453:(n,e,i)=>{i.d(e,{R:()=>r,x:()=>o});var s=i(96540);const t={},c=s.createContext(t);function r(n){const e=s.useContext(c);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:r(n.components),s.createElement(c.Provider,{value:e},n.children)}}}]);