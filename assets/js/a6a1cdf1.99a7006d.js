"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7742],{2835:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var n=r(74848),i=r(28453);const o={},t="supervisor\u5b89\u88c5",l={id:"linux/linux\u670d\u52a1/supervisor/supervisor\u5b89\u88c5",title:"supervisor\u5b89\u88c5",description:"[toc]",source:"@site/docs/linux/linux\u670d\u52a1/supervisor/supervisor\u5b89\u88c5.md",sourceDirName:"linux/linux\u670d\u52a1/supervisor",slug:"/linux/linux\u670d\u52a1/supervisor/supervisor\u5b89\u88c5",permalink:"/docs/linux/linux\u670d\u52a1/supervisor/supervisor\u5b89\u88c5",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ssh\u8fde\u63a5\u62a5\u9519",permalink:"/docs/linux/linux\u670d\u52a1/ssh/ssh\u8fde\u63a5\u62a5\u9519"},next:{title:"supervisor\u7ba1\u7406docusaurus",permalink:"/docs/linux/linux\u670d\u52a1/supervisor/supervisor\u7ba1\u7406docusaurus"}},d={},c=[{value:"1.Supervisor\u7b80\u4ecb",id:"1supervisor\u7b80\u4ecb",level:2},{value:"1.1 \u5b98\u7f51\u5bf9\u4e8eSupervisor\u7684\u4ecb\u7ecd",id:"11-\u5b98\u7f51\u5bf9\u4e8esupervisor\u7684\u4ecb\u7ecd",level:3},{value:"1.1.1 \u603b\u89c8",id:"111-\u603b\u89c8",level:4},{value:"1.1.2 \u7279\u5f81",id:"112-\u7279\u5f81",level:4},{value:"1.1.3 Supervisor\u7ec4\u4ef6",id:"113-supervisor\u7ec4\u4ef6",level:4},{value:"2.\u5b89\u88c5supervisor",id:"2\u5b89\u88c5supervisor",level:2},{value:"2.1 \u7cfb\u7edfpython\u73af\u5883",id:"21-\u7cfb\u7edfpython\u73af\u5883",level:3},{value:"2.2 \u5b89\u88c5suprvisor",id:"22-\u5b89\u88c5suprvisor",level:3},{value:"3.\u914d\u7f6esupervisor",id:"3\u914d\u7f6esupervisor",level:2},{value:"3.1 \u8fd0\u884c <code>echo_supervisord_conf</code> \u547d\u4ee4\u751f\u6210\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6",id:"31-\u8fd0\u884c-echo_supervisord_conf-\u547d\u4ee4\u751f\u6210\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6",level:3},{value:"3.2 supervisor\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\u7684\u987a\u5e8f",id:"32-supervisor\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\u7684\u987a\u5e8f",level:3},{value:"3.3 \u624b\u52a8\u7f16\u8f91supervisor\u914d\u7f6e\u6587\u4ef6",id:"33-\u624b\u52a8\u7f16\u8f91supervisor\u914d\u7f6e\u6587\u4ef6",level:3},{value:"3.4 \u8bbe\u7f6esupervisor\u65e5\u5fd7\u6eda\u52a8",id:"34-\u8bbe\u7f6esupervisor\u65e5\u5fd7\u6eda\u52a8",level:3},{value:"3.5 \u8bbe\u7f6eTmpfiles\u9632\u6b62sock\u6587\u4ef6\u88ab\u6e05\u7406",id:"35-\u8bbe\u7f6etmpfiles\u9632\u6b62sock\u6587\u4ef6\u88ab\u6e05\u7406",level:3},{value:"3.6 \u4f7f\u7528systemd\u7ba1\u7406supervisor",id:"36-\u4f7f\u7528systemd\u7ba1\u7406supervisor",level:3},{value:"4.supervisor\u76f8\u5173\u547d\u4ee4",id:"4supervisor\u76f8\u5173\u547d\u4ee4",level:2},{value:"4.1 supervisord\u547d\u4ee4\u9009\u9879",id:"41-supervisord\u547d\u4ee4\u9009\u9879",level:3},{value:"4.2 supervisorctl\u547d\u4ee4\u9009\u9879\u53ca\u52a8\u4f5c",id:"42-supervisorctl\u547d\u4ee4\u9009\u9879\u53ca\u52a8\u4f5c",level:3},{value:"5.supervisor\u4fe1\u53f7",id:"5supervisor\u4fe1\u53f7",level:2},{value:"6.supervisor\u4e00\u952e\u5b89\u88c5\u811a\u672c",id:"6supervisor\u4e00\u952e\u5b89\u88c5\u811a\u672c",level:2}];function p(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.p,{children:"[toc]"}),"\n",(0,n.jsx)(s.h1,{id:"supervisor\u5b89\u88c5",children:"supervisor\u5b89\u88c5"}),"\n",(0,n.jsx)(s.h2,{id:"1supervisor\u7b80\u4ecb",children:"1.Supervisor\u7b80\u4ecb"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://github.com/Supervisor/Supervisor",children:"Supervisor github\u5730\u5740"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://Supervisord.org/",children:"Supervisor\u5b98\u7f51"})}),"\n",(0,n.jsx)(s.h3,{id:"11-\u5b98\u7f51\u5bf9\u4e8esupervisor\u7684\u4ecb\u7ecd",children:"1.1 \u5b98\u7f51\u5bf9\u4e8eSupervisor\u7684\u4ecb\u7ecd"}),"\n",(0,n.jsx)(s.h4,{id:"111-\u603b\u89c8",children:"1.1.1 \u603b\u89c8"}),"\n",(0,n.jsx)(s.p,{children:"Supervisor\u662f\u4e00\u4e2a\u5ba2\u6237\u7aef/\u670d\u52a1\u5668\u7cfb\u7edf\uff0c\u5141\u8bb8\u5176\u7528\u6237\u63a7\u5236\u7c7b\u4f3cUNIX\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u8bb8\u591a\u8fdb\u7a0b\u3002\u5b83\u53d7\u5230\u4ee5\u4e0b\u65b9\u9762\u7684\u542f\u53d1"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u65b9\u4fbf"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u65b9\u4fbf"}),"\n",(0,n.jsxs)(s.p,{children:["\u9700\u8981\u4e3a\u6bcf\u4e2a\u5355\u4e2a\u6d41\u7a0b\u5b9e\u4f8b\u7f16\u5199",(0,n.jsx)(s.code,{children:"rc.d"}),"\u811a\u672c\u901a\u5e38\u5f88\u4e0d\u65b9\u4fbf\u3002 ",(0,n.jsx)(s.code,{children:"rc.d"}),"\u811a\u672c\u662f\u8fdb\u7a0b\u521d\u59cb\u5316/\u81ea\u52a8\u542f\u52a8/\u7ba1\u7406\u7684\u4e00\u4e2a\u5f88\u597d\u7684\u6700\u4f4e\u516c\u5206\u6bcd\u5f62\u5f0f\uff0c\u4f46\u662f\u7f16\u5199\u548c\u7ef4\u62a4\u5b83\u4eec\u53ef\u80fd\u5f88\u9ebb\u70e6\u3002\u6b64\u5916\uff0c",(0,n.jsx)(s.code,{children:"rc.d"}),"\u811a\u672c\u65e0\u6cd5\u81ea\u52a8\u91cd\u65b0\u542f\u52a8\u5d29\u6e83\u7684\u8fdb\u7a0b\uff0c\u5e76\u4e14\u8bb8\u591a\u7a0b\u5e8f\u5728\u5d29\u6e83\u65f6\u65e0\u6cd5\u6b63\u786e\u5730\u81ea\u884c\u91cd\u542f\u3002Supervisord\u5c06\u8fdb\u7a0b\u4f5c\u4e3a\u5176\u5b50\u8fdb\u7a0b\u542f\u52a8\uff0c\u5e76\u4e14\u53ef\u4ee5\u914d\u7f6e\u4e3a\u5728\u5d29\u6e83\u65f6\u81ea\u52a8\u91cd\u65b0\u542f\u52a8\u5b83\u4eec\u3002\u4e5f\u53ef\u4ee5\u5c06\u5176\u81ea\u52a8\u914d\u7f6e\u4e3a\u81ea\u884c\u8c03\u7528\u542f\u52a8\u8fdb\u7a0b\u3002"]}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u51c6\u786e\u6027"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u51c6\u786e\u6027"}),"\n",(0,n.jsx)(s.p,{children:"\u5728UNIX\u4e0a\uff0c\u901a\u5e38\u5f88\u96be\u83b7\u5f97\u51c6\u786e\u7684\u542f\u52a8/\u5173\u95ed\u72b6\u6001\u4fe1\u606f\u3002Pidfile\u7ecf\u5e38\u8bf4\u8c0e\u3002Supervisord\u5c06\u6d41\u7a0b\u4f5c\u4e3a\u5b50\u6d41\u7a0b\u542f\u52a8\uff0c\u56e0\u6b64\u5b83\u59cb\u7ec8\u77e5\u9053\u5176\u5b50\u7ea7\u7684\u771f\u5b9e\u4e0a/\u4e0b\u72b6\u6001\uff0c\u5e76\u4e14\u53ef\u4ee5\u65b9\u4fbf\u5730\u67e5\u8be2\u8be5\u6570\u636e\u3002"}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u6388\u6743"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u6388\u6743"}),"\n",(0,n.jsx)(s.p,{children:'\u9700\u8981\u63a7\u5236\u6d41\u7a0b\u72b6\u6001\u7684\u7528\u6237\u901a\u5e38\u53ea\u9700\u8981\u8fd9\u6837\u505a\u3002\u4ed6\u4eec\u4e0d\u5e0c\u671b\u6216\u4e0d\u9700\u8981\u5b8c\u5168\u7684Shell\u8bbf\u95ee\u8fd0\u884c\u8fd9\u4e9b\u8fdb\u7a0b\u7684\u8ba1\u7b97\u673a\u3002\u4fa6\u542c"\u4f4e" TCP\u7aef\u53e3\u7684\u8fdb\u7a0b\u901a\u5e38\u9700\u8981\u4ee5root\u7528\u6237\u8eab\u4efd\u542f\u52a8\u548c\u91cd\u65b0\u542f\u52a8\uff08UNIX\u529f\u80fd\u4e0d\u5168\uff09\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5141\u8bb8"\u6b63\u5e38"\u4eba\u5458\u505c\u6b62\u6216\u91cd\u65b0\u542f\u52a8\u8fd9\u6837\u7684\u8fc7\u7a0b\u662f\u5b8c\u5168\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u4e3a\u4ed6\u4eec\u63d0\u4f9bshell\u8bbf\u95ee\u901a\u5e38\u662f\u4e0d\u5207\u5b9e\u9645\u7684\uff0c\u5e76\u4e14\u4e3a\u4ed6\u4eec\u63d0\u4f9broot\u8bbf\u95ee\u6216sudo\u8bbf\u95ee\u901a\u5e38\u662f\u4e0d\u53ef\u80fd\u7684\u3002\uff08\u6b63\u786e\uff09\u4e5f\u5f88\u96be\u5411\u4ed6\u4eec\u89e3\u91ca\u4e3a\u4ec0\u4e48\u5b58\u5728\u6b64\u95ee\u9898\u3002\u5982\u679c\u8d85\u7ea7\u7528\u6237\u4ee5root\u7528\u6237\u8eab\u4efd\u542f\u52a8\uff0c\u5219\u53ef\u4ee5\u5141\u8bb8"\u666e\u901a"\u7528\u6237\u63a7\u5236\u6b64\u7c7b\u8fc7\u7a0b\uff0c\u800c\u65e0\u9700\u5411\u4ed6\u4eec\u89e3\u91ca\u95ee\u9898\u7684\u590d\u6742\u6027\u3002Supervisorctl\u5141\u8bb8\u4ee5\u975e\u5e38\u6709\u9650\u7684\u5f62\u5f0f\u8bbf\u95ee\u8ba1\u7b97\u673a'}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u8fdb\u7a0b\u7ec4"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u8fdb\u7a0b\u7ec4"}),"\n",(0,n.jsx)(s.p,{children:'\u6d41\u7a0b\u901a\u5e38\u9700\u8981\u6210\u7ec4\u5730\u542f\u52a8\u548c\u505c\u6b62\uff0c\u6709\u65f6\u751a\u81f3\u9700\u8981\u6309\u7167"\u4f18\u5148\u7ea7\u987a\u5e8f"\u8fdb\u884c\u3002\u901a\u5e38\u5f88\u96be\u5411\u4eba\u4eec\u89e3\u91ca\u5982\u4f55\u6267\u884c\u6b64\u64cd\u4f5c\u3002Supervisor\u5141\u8bb8\u60a8\u4e3a\u8fdb\u7a0b\u5206\u914d\u4f18\u5148\u7ea7\uff0c\u5e76\u5141\u8bb8\u7528\u6237\u901a\u8fc7Supervisorctl\u5ba2\u6237\u7aef\u53d1\u51fa\u547d\u4ee4\uff0c\u5982"\u5168\u90e8\u542f\u52a8"\u548c"\u5168\u90e8\u91cd\u65b0\u542f\u52a8"\uff0c\u8fd9\u5c06\u6309\u9884\u5148\u5206\u914d\u7684\u4f18\u5148\u7ea7\u987a\u5e8f\u542f\u52a8\u5b83\u4eec\u3002\u6b64\u5916\uff0c\u53ef\u4ee5\u5c06\u8fdb\u7a0b\u5206\u4e3a"\u8fdb\u7a0b\u7ec4"\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u4e00\u7ec4\u903b\u8f91\u76f8\u5173\u7684\u8fdb\u7a0b\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u505c\u6b62\u548c\u542f\u52a8\u3002'}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.h4,{id:"112-\u7279\u5f81",children:"1.1.2 \u7279\u5f81"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u7b80\u5355"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u7b80\u5355"}),"\n",(0,n.jsx)(s.p,{children:"\u901a\u8fc7\u7b80\u5355\u6613\u61c2\u7684INI\u6837\u5f0f\u914d\u7f6e\u6587\u4ef6\u914d\u7f6eSupervisor\u3002\u5b83\u63d0\u4f9b\u4e86\u8bb8\u591a\u6309\u8fdb\u7a0b\u9009\u62e9\u7684\u9009\u9879\uff0c\u4f7f\u60a8\u7684\u751f\u6d3b\u66f4\u52a0\u8f7b\u677e\uff0c\u4f8b\u5982\u91cd\u65b0\u542f\u52a8\u5931\u8d25\u7684\u8fdb\u7a0b\u548c\u81ea\u52a8\u65e5\u5fd7\u8f6e\u6362\u3002"}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u96c6\u4e2d"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u96c6\u4e2d"}),"\n",(0,n.jsx)(s.p,{children:"Supervisor\u4e3a\u60a8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f00\u59cb\uff0c\u505c\u6b62\u548c\u76d1\u89c6\u8fc7\u7a0b\u7684\u5730\u65b9\u3002\u53ef\u4ee5\u5355\u72ec\u6216\u6210\u7ec4\u63a7\u5236\u8fc7\u7a0b\u3002\u60a8\u53ef\u4ee5\u914d\u7f6eSupervisor\u4ee5\u63d0\u4f9b\u672c\u5730\u6216\u8fdc\u7a0b\u547d\u4ee4\u884c\u548cWeb\u754c\u9762\u3002"}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u9ad8\u6548\u7684"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u9ad8\u6548"}),"\n",(0,n.jsx)(s.p,{children:"Supervisor\u901a\u8fc7fork / exec\u542f\u52a8\u5176\u5b50\u8fdb\u7a0b\uff0c\u5e76\u4e14\u5b50\u8fdb\u7a0b\u4e0d\u5b88\u62a4\u3002\u8fdb\u7a0b\u7ec8\u6b62\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u7acb\u5373\u5411Supervisor\u53d1\u9001\u4fe1\u53f7\uff0c\u8fd9\u4e0e\u67d0\u4e9b\u4f9d\u8d56\u9ebb\u70e6\u7684PID\u6587\u4ef6\u548c\u5b9a\u671f\u8f6e\u8be2\u4ee5\u91cd\u65b0\u542f\u52a8\u5931\u8d25\u7684\u8fdb\u7a0b\u7684\u89e3\u51b3\u65b9\u6848\u4e0d\u540c\u3002"}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u53ef\u6269\u5c55\u7684"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u53ef\u6269\u5c55"}),"\n",(0,n.jsx)(s.p,{children:"Supervisor\u5177\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u4e8b\u4ef6\u901a\u77e5\u534f\u8bae\uff0c\u8be5\u534f\u8bae\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u8bed\u8a00\u7f16\u5199\u7684\u7a0b\u5e8f\u5bf9\u5176\u8fdb\u884c\u76d1\u89c6\uff0c\u5e76\u4e14\u5177\u6709\u7528\u4e8e\u63a7\u5236\u7684XML-RPC\u63a5\u53e3\u3002\u5b83\u8fd8\u4f7f\u7528\u6269\u5c55\u70b9\u6784\u5efa\uff0cPython\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u6269\u5c55\u70b9\u3002"}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u517c\u5bb9"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u517c\u5bb9"}),"\n",(0,n.jsx)(s.p,{children:"\u9664Windows\u5916\uff0cSupervisor\u51e0\u4e4e\u9002\u7528\u4e8e\u6240\u6709\u5176\u4ed6\u65b9\u9762\u3002\u5b83\u5df2\u5728Linux\uff0cMac OS X\uff0cSolaris\u548cFreeBSD\u4e0a\u7ecf\u8fc7\u6d4b\u8bd5\u548c\u652f\u6301\u3002\u5b83\u5b8c\u5168\u7528Python\u7f16\u5199\uff0c\u56e0\u6b64\u5b89\u88c5\u4e0d\u9700\u8981C\u7f16\u8bd1\u5668\u3002"}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u4e45\u7ecf\u8003\u9a8c"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u4e45\u7ecf\u8003\u9a8c"}),"\n",(0,n.jsx)(s.p,{children:"\u5c3d\u7ba1Supervisor\u5982\u4eca\u975e\u5e38\u6d3b\u8dc3\uff0c\u4f46\u5b83\u4e0d\u662f\u65b0\u8f6f\u4ef6\u3002Supervisor\u5df2\u7ecf\u5b58\u5728\u4e86\u5f88\u591a\u5e74\uff0c\u5e76\u4e14\u5df2\u7ecf\u5728\u8bb8\u591a\u670d\u52a1\u5668\u4e0a\u4f7f\u7528\u3002"}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.h4,{id:"113-supervisor\u7ec4\u4ef6",children:"1.1.3 Supervisor\u7ec4\u4ef6"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"supervisord"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u8bf4\u660e"}),"\n",(0,n.jsxs)(s.p,{children:["\u670d\u52a1\u5668Supervisor\u7684\u540d\u79f0\u4e3a",(0,n.jsx)(s.strong,{children:"supervisor"}),"\u3002\u5b83\u8d1f\u8d23\u81ea\u884c\u8c03\u7528\u542f\u52a8\u5b50\u7a0b\u5e8f\uff0c\u54cd\u5e94\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u547d\u4ee4\uff0c\u91cd\u65b0\u542f\u52a8\u5d29\u6e83\u6216\u9000\u51fa\u7684\u5b50\u8fdb\u7a0b\uff0c\u8bb0\u5f55\u5176\u5b50\u8fdb\u7a0b",(0,n.jsx)(s.code,{children:"stdout"}),"\u548c",(0,n.jsx)(s.code,{children:"stderr"}),' \u8f93\u51fa\u4ee5\u53ca\u751f\u6210\u548c\u5904\u7406\u4e0e\u5b50\u8fdb\u7a0b\u751f\u5b58\u671f\u4e2d\u7684\u70b9\u76f8\u5bf9\u5e94\u7684"\u4e8b\u4ef6"\u3002']}),"\n",(0,n.jsxs)(s.p,{children:["\u670d\u52a1\u5668\u8fdb\u7a0b\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u3002\u5b83\u901a\u5e38\u4f4d\u4e8e",(0,n.jsx)(s.code,{children:"/etc/supervisord.conf\u4e2d"}),'\u3002\u6b64\u914d\u7f6e\u6587\u4ef6\u662f" Windows-INI"\u6837\u5f0f\u7684\u914d\u7f6e\u6587\u4ef6\u3002\u901a\u8fc7\u9002\u5f53\u7684\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u6765\u786e\u4fdd\u6b64\u6587\u4ef6\u7684\u5b89\u5168\u5f88\u91cd\u8981\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u5305\u542b\u672a\u52a0\u5bc6\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002']}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"supervisorctl"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u8bf4\u660e"}),"\n",(0,n.jsxs)(s.p,{children:["Supervisor\u7684\u547d\u4ee4\u884c\u5ba2\u6237\u7aef\u540d\u4e3a ",(0,n.jsx)(s.strong,{children:"supervisorctl"}),"\u3002\u5b83\u63d0\u4f9b\u4e86\u7c7b\u4f3c\u4e8eshell\u7684\u754c\u9762\uff0c\u53ef\u4e0e",(0,n.jsx)(s.strong,{children:"supervisor"}),"\u63d0\u4f9b\u7684\u529f\u80fd\u7ed3\u5408\u4f7f\u7528\u3002\u4ece ",(0,n.jsx)(s.strong,{children:"supervisorctl"}),"\uff0c\u7528\u6237\u53ef\u4ee5\u8fde\u63a5\u5230\u4e0d\u540c\u7684 ",(0,n.jsx)(s.strong,{children:"supervisord"}),"\u8fdb\u7a0b\uff08\u4e00\u6b21\u4e00\u4e2a\uff09\uff0c\u5bf9\uff0c\u505c\u6b62\u63a7\u5236\u7684\u5b50\u6d41\u7a0b\u83b7\u5f97\u5730\u4f4d\u548c\u542f\u52a8\u7684\u5b50\u8fdb\u7a0b\uff0c\u5e76\u83b7\u5f97\u8fd0\u884c\u7684\u8fdb\u7a0b\u7684\u5217\u8868",(0,n.jsx)(s.strong,{children:"supervisord"}),"\u3002"]}),"\n",(0,n.jsxs)(s.p,{children:["\u547d\u4ee4\u884c\u5ba2\u6237\u7aef\u901a\u8fc7UNIX\u57df\u5957\u63a5\u5b57\u6216Internet\uff08TCP\uff09\u5957\u63a5\u5b57\u4e0e\u670d\u52a1\u5668\u5bf9\u8bdd\u3002\u670d\u52a1\u5668\u53ef\u4ee5\u65ad\u8a00\u5ba2\u6237\u7aef\u7684\u7528\u6237\u5e94\u8be5\u5728\u5141\u8bb8\u5ba2\u6237\u7aef\u6267\u884c\u547d\u4ee4\u4e4b\u524d\u51fa\u793a\u8eab\u4efd\u9a8c\u8bc1\u51ed\u636e\u3002\u5ba2\u6237\u7aef\u8fdb\u7a0b\u901a\u5e38\u4f7f\u7528\u4e0e\u670d\u52a1\u5668\u76f8\u540c\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u662f\u4efb\u4f55\u5e26\u6709",(0,n.jsx)(s.code,{children:"[supervisorctl]"}),"\u8282\u7684\u914d\u7f6e\u6587\u4ef6\u90fd\u53ef\u4ee5\u4f7f\u7528\u3002"]}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Web Server"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u8bf4\u660e"}),"\n",(0,n.jsxs)(s.p,{children:["\u4e0e\u529f\u80fd\u5ab2\u7f8eA\uff08\u7a00\u758f\uff09\u7684Web\u7528\u6237\u754c\u9762 ",(0,n.jsx)(s.strong,{children:"supervisorctl"}),"\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\uff0c\u5982\u679c\u4f60\u5f00\u59cb\u8bbf\u95ee ",(0,n.jsx)(s.strong,{children:"supervisord"}),"\u5bf9\u4e92\u8054\u7f51\u63d2\u5ea7\u3002\u6fc0\u6d3b\u914d\u7f6e\u6587\u4ef6\u7684",(0,n.jsx)(s.code,{children:"[inet_http_server]"}),"\u90e8\u5206\u540e\uff0c\u8bf7\u8bbf\u95ee\u670d\u52a1\u5668URL\uff08\u4f8b\u5982",(0,n.jsx)(s.code,{children:"http://localhost:9001/"}),"\uff09\u4ee5\u901a\u8fc7Web\u754c\u9762\u67e5\u770b\u548c\u63a7\u5236\u8fdb\u7a0b\u72b6\u6001\u3002"]}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"XML-RPC Interface"})}),"\n",(0,n.jsx)(s.p,{children:":::info\u8bf4\u660e"}),"\n",(0,n.jsxs)(s.p,{children:["\u670d\u52a1\u4e8eWeb UI\u7684\u540c\u4e00HTTP\u670d\u52a1\u5668\u63d0\u4f9bXML-RPC\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u7528\u4e8e\u8be2\u95ee\u548c\u63a7\u5236\u7ba1\u7406\u7a0b\u5e8f\u53ca\u5176\u8fd0\u884c\u7684\u7a0b\u5e8f\u3002\u8bf7\u53c2\u9605",(0,n.jsx)(s.a,{href:"http://supervisord.org/api.html#xml-rpc",children:(0,n.jsx)(s.em,{children:"XML-RPC API\u6587\u6863"})}),"\u3002"]}),"\n",(0,n.jsx)(s.p,{children:":::"}),"\n",(0,n.jsx)(s.h2,{id:"2\u5b89\u88c5supervisor",children:"2.\u5b89\u88c5supervisor"}),"\n",(0,n.jsx)(s.h3,{id:"21-\u7cfb\u7edfpython\u73af\u5883",children:"2.1 \u7cfb\u7edfpython\u73af\u5883"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ python -V\nPython 2.7.5\n"})}),"\n",(0,n.jsx)(s.h3,{id:"22-\u5b89\u88c5suprvisor",children:"2.2 \u5b89\u88c5suprvisor"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u914d\u7f6e\u56fd\u5185pip\u6e90"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"mkdir ~/.pip\ncat > .pip/pip.conf <<'EOF'\n[global]\nindex-url = https://pypi.tuna.tsinghua.edu.cn/simple/\nEOF\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u5b89\u88c5\u6700\u65b0\u7248"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"# \u65b9\u6cd5\u4e00\npip install supervisor\n\n# \u65b9\u6cd5\u4e8c\nyum -y install python-setuptools\neasy_install supervisor\n\n# \u67e5\u770b\u7248\u672c\n$ supervisord -v\n4.2.0\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u5b89\u88c5\u6307\u5b9a\u7248\u672c"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"pip install supervisor==3.3.5\n"})}),"\n",(0,n.jsx)(s.h2,{id:"3\u914d\u7f6esupervisor",children:"3.\u914d\u7f6esupervisor"}),"\n",(0,n.jsxs)(s.h3,{id:"31-\u8fd0\u884c-echo_supervisord_conf-\u547d\u4ee4\u751f\u6210\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6",children:["3.1 \u8fd0\u884c ",(0,n.jsx)(s.code,{children:"echo_supervisord_conf"})," \u547d\u4ee4\u751f\u6210\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsxs)(s.strong,{children:["\u8fd0\u884c",(0,n.jsx)(s.code,{children:"echo_supervisord_conf"}),"\u547d\u4ee4\uff0c\u4f1a\u5728\u5f53\u524d\u7ec8\u7aef\u7684\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370\u4e00\u4e2a\u6837\u672cSupervisor\u914d\u7f6e\u6587\u4ef6"]})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:'$ echo_supervisord_conf\n; Sample supervisor config file.\n;\n; For more information on the config file, please see:\n; http://supervisord.org/configuration.html\n;\n; Notes:\n;  - Shell expansion ("~" or "$HOME") is not supported.  Environment\n;    variables can be expanded using this syntax: "%(ENV_HOME)s".\n;  - Quotes around values are not supported, except in the case of\n;    the environment= options as shown below.\n;  - Comments must have a leading space: "a=b ;comment" not "a=b;comment".\n;  - Command will be truncated if it looks like a config file comment, e.g.\n;    "command=bash -c \'foo ; bar\'" will truncate to "command=bash -c \'foo ".\n;\n; Warning:\n;  Paths throughout this example file use /tmp because it is available on most\n;  systems.  You will likely need to change these to locations more appropriate\n;  for your system.  Some systems periodically delete older files in /tmp.\n;  Notably, if the socket file defined in the [unix_http_server] section below\n;  is deleted, supervisorctl will be unable to connect to supervisord.\n\n[unix_http_server]\nfile=/tmp/supervisor.sock   ; the path to the socket file\n;chmod=0700                 ; socket file mode (default 0700)\n;chown=nobody:nogroup       ; socket file uid:gid owner\n;username=user              ; default is no username (open server)\n;password=123               ; default is no password (open server)\n\n; Security Warning:\n;  The inet HTTP server is not enabled by default.  The inet HTTP server is\n;  enabled by uncommenting the [inet_http_server] section below.  The inet\n;  HTTP server is intended for use within a trusted environment only.  It\n;  should only be bound to localhost or only accessible from within an\n;  isolated, trusted network.  The inet HTTP server does not support any\n;  form of encryption.  The inet HTTP server does not use authentication\n;  by default (see the username= and password= options to add authentication).\n;  Never expose the inet HTTP server to the public internet.\n\n;[inet_http_server]         ; inet (TCP) server disabled by default\n;port=127.0.0.1:9001        ; ip_address:port specifier, *:port for all iface\n;username=user              ; default is no username (open server)\n;password=123               ; default is no password (open server)\n\n[supervisord]\nlogfile=/tmp/supervisord.log ; main log file; default $CWD/supervisord.log\nlogfile_maxbytes=50MB        ; max main logfile bytes b4 rotation; default 50MB\nlogfile_backups=10           ; # of main logfile backups; 0 means none, default 10\nloglevel=info                ; log level; default info; others: debug,warn,trace\npidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid\nnodaemon=false               ; start in foreground if true; default false\nsilent=false                 ; no logs to stdout if true; default false\nminfds=1024                  ; min. avail startup file descriptors; default 1024\nminprocs=200                 ; min. avail process descriptors;default 200\n;umask=022                   ; process file creation umask; default 022\n;user=supervisord            ; setuid to this UNIX account at startup; recommended if root\n;identifier=supervisor       ; supervisord identifier, default is \'supervisor\'\n;directory=/tmp              ; default is not to cd during start\n;nocleanup=true              ; don\'t clean up tempfiles at start; default false\n;childlogdir=/tmp            ; \'AUTO\' child log dir, default $TEMP\n;environment=KEY="value"     ; key value pairs to add to environment\n;strip_ansi=false            ; strip ansi escape codes in logs; def. false\n\n; The rpcinterface:supervisor section must remain in the config file for\n; RPC (supervisorctl/web interface) to work.  Additional interfaces may be\n; added by defining them in separate [rpcinterface:x] sections.\n\n[rpcinterface:supervisor]\nsupervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface\n\n; The supervisorctl section configures how supervisorctl will connect to\n; supervisord.  configure it match the settings in either the unix_http_server\n; or inet_http_server section.\n\n[supervisorctl]\nserverurl=unix:///tmp/supervisor.sock ; use a unix:// URL  for a unix socket\n;serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket\n;username=chris              ; should be same as in [*_http_server] if set\n;password=123                ; should be same as in [*_http_server] if set\n;prompt=mysupervisor         ; cmd line prompt (default "supervisor")\n;history_file=~/.sc_history  ; use readline history if available\n\n; The sample program section below shows all possible program subsection values.\n; Create one or more \'real\' program: sections to be able to control them under\n; supervisor.\n\n;[program:theprogramname]\n;command=/bin/cat              ; the program (relative uses PATH, can take args)\n;process_name=%(program_name)s ; process_name expr (default %(program_name)s)\n;numprocs=1                    ; number of processes copies to start (def 1)\n;directory=/tmp                ; directory to cwd to before exec (def no cwd)\n;umask=022                     ; umask for process (default None)\n;priority=999                  ; the relative start priority (default 999)\n;autostart=true                ; start at supervisord start (default: true)\n;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)\n;startretries=3                ; max # of serial start failures when starting (default 3)\n;autorestart=unexpected        ; when to restart if exited after running (def: unexpected)\n;exitcodes=0                   ; \'expected\' exit codes used with autorestart (default 0)\n;stopsignal=QUIT               ; signal used to kill process (default TERM)\n;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)\n;stopasgroup=false             ; send stop signal to the UNIX process group (default false)\n;killasgroup=false             ; SIGKILL the UNIX process group (def false)\n;user=chrism                   ; setuid to this UNIX account to run the program\n;redirect_stderr=true          ; redirect proc stderr to stdout (default false)\n;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO\n;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)\n;stdout_logfile_backups=10     ; # of stdout logfile backups (0 means none, default 10)\n;stdout_capture_maxbytes=1MB   ; number of bytes in \'capturemode\' (default 0)\n;stdout_events_enabled=false   ; emit events on stdout writes (default false)\n;stdout_syslog=false           ; send stdout to syslog with process name (default false)\n;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO\n;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)\n;stderr_logfile_backups=10     ; # of stderr logfile backups (0 means none, default 10)\n;stderr_capture_maxbytes=1MB   ; number of bytes in \'capturemode\' (default 0)\n;stderr_events_enabled=false   ; emit events on stderr writes (default false)\n;stderr_syslog=false           ; send stderr to syslog with process name (default false)\n;environment=A="1",B="2"       ; process environment additions (def no adds)\n;serverurl=AUTO                ; override serverurl computation (childutils)\n\n; The sample eventlistener section below shows all possible eventlistener\n; subsection values.  Create one or more \'real\' eventlistener: sections to be\n; able to handle event notifications sent by supervisord.\n\n;[eventlistener:theeventlistenername]\n;command=/bin/eventlistener    ; the program (relative uses PATH, can take args)\n;process_name=%(program_name)s ; process_name expr (default %(program_name)s)\n;numprocs=1                    ; number of processes copies to start (def 1)\n;events=EVENT                  ; event notif. types to subscribe to (req\'d)\n;buffer_size=10                ; event buffer queue size (default 10)\n;directory=/tmp                ; directory to cwd to before exec (def no cwd)\n;umask=022                     ; umask for process (default None)\n;priority=-1                   ; the relative start priority (default -1)\n;autostart=true                ; start at supervisord start (default: true)\n;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)\n;startretries=3                ; max # of serial start failures when starting (default 3)\n;autorestart=unexpected        ; autorestart if exited after running (def: unexpected)\n;exitcodes=0                   ; \'expected\' exit codes used with autorestart (default 0)\n;stopsignal=QUIT               ; signal used to kill process (default TERM)\n;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)\n;stopasgroup=false             ; send stop signal to the UNIX process group (default false)\n;killasgroup=false             ; SIGKILL the UNIX process group (def false)\n;user=chrism                   ; setuid to this UNIX account to run the program\n;redirect_stderr=false         ; redirect_stderr=true is not allowed for eventlisteners\n;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO\n;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)\n;stdout_logfile_backups=10     ; # of stdout logfile backups (0 means none, default 10)\n;stdout_events_enabled=false   ; emit events on stdout writes (default false)\n;stdout_syslog=false           ; send stdout to syslog with process name (default false)\n;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO\n;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)\n;stderr_logfile_backups=10     ; # of stderr logfile backups (0 means none, default 10)\n;stderr_events_enabled=false   ; emit events on stderr writes (default false)\n;stderr_syslog=false           ; send stderr to syslog with process name (default false)\n;environment=A="1",B="2"       ; process environment additions\n;serverurl=AUTO                ; override serverurl computation (childutils)\n\n; The sample group section below shows all possible group values.  Create one\n; or more \'real\' group: sections to create "heterogeneous" process groups.\n\n;[group:thegroupname]\n;programs=progname1,progname2  ; each refers to \'x\' in [program:x] definitions\n;priority=999                  ; the relative start priority (default 999)\n\n; The [include] section can just contain the "files" setting.  This\n; setting can list multiple files (separated by whitespace or\n; newlines).  It can also contain wildcards.  The filenames are\n; interpreted as relative to this file.  Included files *cannot*\n; include files themselves.\n\n;[include]\n;files = relative/directory/*.ini\n'})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u53bb\u6389\u6ce8\u91ca\u540e\u7684\u5185\u5bb9\u5982\u4e0b"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ echo_supervisord_conf  > hehe\n$ egrep -v '^$|^;' hehe\n[unix_http_server]\nfile=/tmp/supervisor.sock   ; the path to the socket file\n[supervisord]\nlogfile=/tmp/supervisord.log ; main log file; default $CWD/supervisord.log\nlogfile_maxbytes=50MB        ; max main logfile bytes b4 rotation; default 50MB\nlogfile_backups=10           ; # of main logfile backups; 0 means none, default 10\nloglevel=info                ; log level; default info; others: debug,warn,trace\npidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid\nnodaemon=false               ; start in foreground if true; default false\nsilent=false                 ; no logs to stdout if true; default false\nminfds=1024                  ; min. avail startup file descriptors; default 1024\nminprocs=200                 ; min. avail process descriptors;default 200\n[rpcinterface:supervisor]\nsupervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface\n[supervisorctl]\nserverurl=unix:///tmp/supervisor.sock ; use a unix:// URL  for a unix socket\n"})}),"\n",(0,n.jsx)(s.h3,{id:"32-supervisor\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\u7684\u987a\u5e8f",children:"3.2 supervisor\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\u7684\u987a\u5e8f"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsxs)(s.strong,{children:["supervisor\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u88ab\u547d\u540d\u4e3a",(0,n.jsx)(s.code,{children:"supervisor.conf"}),"\uff0csupervisor\u548csupervisorctl\u90fd\u4f7f\u7528\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u679c\u5728\u6ca1\u6709",(0,n.jsx)(s.code,{children:"-c"}),"\u9009\u9879\u7684\u60c5\u51b5\u4e0b\u542f\u52a8\u4e86\u4efb\u4e00\u5e94\u7528\u7a0b\u5e8f\uff08\u8be5\u9009\u9879\u7528\u4e8e\u663e\u5f0f\u544a\u77e5\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u540d\uff09\uff0c\u5219\u8be5\u5e94\u7528\u7a0b\u5e8f\u5c06\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u6309\u6307\u5b9a\u987a\u5e8f\u67e5\u627e\u540d\u4e3a",(0,n.jsx)(s.code,{children:"supervisord.conf"}),"\u7684\u6587\u4ef6\u3002\u5b83\u5c06\u4f7f\u7528\u627e\u5230\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\u3002"]})}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"../etc/supervisord.conf"})," (\u76f8\u5bf9\u4e8e\u53ef\u6267\u884c\u6587\u4ef6)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"../supervisord.conf"})," (\u76f8\u5bf9\u4e8e\u53ef\u6267\u884c\u6587\u4ef6)"]}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"$CWD/supervisord.conf"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"$CWD/etc/supervisord.conf"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"/etc/supervisord.conf"})}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"/etc/supervisor/supervisord.conf"})," (\u81eaSupervisor 3.3.0\u7248\u672c\u5f00\u59cb)"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"33-\u624b\u52a8\u7f16\u8f91supervisor\u914d\u7f6e\u6587\u4ef6",children:"3.3 \u624b\u52a8\u7f16\u8f91supervisor\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\u548c\u65e5\u5fd7\u6587\u4ef6\u76ee\u5f55"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"mkdir -p /etc/supervisor/config.d\nmkdir /var/log/supervisor\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u521b\u5efasupervisor\u8fd0\u884c\u7528\u6237supervisor"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"useradd supervisor -s /sbin/nologin -M\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u624b\u52a8\u7f16\u8f91supervisor\u914d\u7f6e\u6587\u4ef6"})}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u9700\u8981\u6ce8\u610f\u7684\u70b9"})})}),"\n",(0,n.jsxs)(s.p,{children:["supervisor\u9ed8\u8ba4\u4ee5root\u8eab\u4efd\u8fd0\u884c\uff0c\u5982\u679c\u60f3\u8981\u6307\u5b9a\u7528\u6237\uff0c\u9700\u8981\u5728\u6807\u7b7e ",(0,n.jsx)(s.code,{children:"[supervisord]"}),"\u4e0b\u6dfb\u52a0 ",(0,n.jsx)(s.code,{children:"user=xxx"})]}),"\n",(0,n.jsxs)(s.p,{children:["\u5982\u679c\u6ca1\u6709\u4ee5-c\u9009\u9879\u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\uff0c\u5219supervisor\u4f1a\u6309\u7167\u4ee5\u4e0b\u987a\u5e8f\u67e5\u627e\u914d\u7f6e\u6587\u4ef6 \uff0c\u5426\u5219\u4f1a\u62a5\u9519 ",(0,n.jsx)(s.code,{children:"Error: No config file found at default paths (/usr/etc/supervisord.conf, /usr/supervisord.conf, supervisord.conf, etc/supervisord.conf, /etc/supervisord.conf, /etc/supervisor/supervisord.conf); use the -c option to specify a config file at a different path"})]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["1 ",(0,n.jsx)(s.code,{children:"../etc/supervisord.conf\uff08\u76f8\u5bf9\u4e8e\u53ef\u6267\u884c\u6587\u4ef6\uff09"})]}),"\n",(0,n.jsxs)(s.li,{children:["2 ",(0,n.jsx)(s.code,{children:"../supervisord.conf\uff08\u76f8\u5bf9\u4e8e\u53ef\u6267\u884c\u6587\u4ef6\uff09"})]}),"\n",(0,n.jsxs)(s.li,{children:["3 ",(0,n.jsx)(s.code,{children:"$CWD/supervisord.conf"})]}),"\n",(0,n.jsxs)(s.li,{children:["4 ",(0,n.jsx)(s.code,{children:"$CWD/etc/supervisord.conf"})]}),"\n",(0,n.jsxs)(s.li,{children:["5 ",(0,n.jsx)(s.code,{children:"/etc/supervisord.conf"})]}),"\n",(0,n.jsxs)(s.li,{children:["6 ",(0,n.jsx)(s.code,{children:"/etc/supervisor/supervisord.conf"})," (since Supervisor 3.3.0)"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"http://supervisord.org/configuration.html",children:"\u5b98\u65b9\u5bf9\u4e8e\u914d\u7f6e\u6587\u4ef6\u67e5\u627e\u987a\u5e8f\u7684\u8bf4\u660e"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"cat > /etc/supervisor/supervisord.conf <<'EOF'\n[unix_http_server]\nfile=/tmp/supervisor.sock   ; \nchmod = 0770\nchown = supervisor:supervisor   ; /tmp/supervisor.sock\u6240\u6709\u8005\u4e3asupervisor\n \n[supervisord]\nlogfile=/var/log/supervisor/supervisord.log ; main log file;\nlogfile_maxbytes=50MB        ; max main logfile bytes b4 rotation; default 50MB\nlogfile_backups=10           ; # of main logfile backups; 0 means none, default 10\nloglevel=info                ; log level; default info; others: debug,warn,trace\npidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid\n \n;[inet_http_server]\n;port=10.0.0.10:9001\n;username=test\n;password=test\n \n[rpcinterface:supervisor]\nsupervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface\n \n[supervisorctl]\nserverurl=unix:///tmp/supervisor.sock ; use a unix:// URL  for a unix socket\n \n[include]\nfiles = /etc/supervisor/config.d/*.ini\nEOF\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u5f53\u6709\u5982\u4e0b\u914d\u7f6e\u65f6\uff0csupervisor\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2aweb\u754c\u9762"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"[inet_http_server]\nport=10.0.0.10:9001\nusername=test\npassword=test\n"})}),"\n",(0,n.jsxs)(s.p,{children:["\u6d4f\u89c8\u5668\u8bbf\u95ee ",(0,n.jsx)(s.code,{children:"IP:9001"})," \uff0c\u7528\u6237\u540d\u548c\u5bc6\u7801\u90fd\u662ftest"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-06-3011.46.06.png",alt:"iShot2020-06-3011.46.06"})}),"\n",(0,n.jsx)(s.h3,{id:"34-\u8bbe\u7f6esupervisor\u65e5\u5fd7\u6eda\u52a8",children:"3.4 \u8bbe\u7f6esupervisor\u65e5\u5fd7\u6eda\u52a8"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"cat >/etc/logrotate.d/supervisor <<EOF\n/var/log/supervisor/*.log {\n       missingok\n       weekly\n       notifempty\n       nocompress\n}\nEOF\n"})}),"\n",(0,n.jsx)(s.h3,{id:"35-\u8bbe\u7f6etmpfiles\u9632\u6b62sock\u6587\u4ef6\u88ab\u6e05\u7406",children:"3.5 \u8bbe\u7f6eTmpfiles\u9632\u6b62sock\u6587\u4ef6\u88ab\u6e05\u7406"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"cat >> /usr/lib/tmpfiles.d/tmp.conf<<EOF\nx /tmp/supervisor.sock\nx /tmp/supervisord.pid\nEOF\n"})}),"\n",(0,n.jsx)(s.h3,{id:"36-\u4f7f\u7528systemd\u7ba1\u7406supervisor",children:"3.6 \u4f7f\u7528systemd\u7ba1\u7406supervisor"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://github.com/Supervisor/initscripts",children:"\u5bf9\u5404\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9bsupervisor\u811a\u672c\u7684github\u5730\u5740"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u514b\u9686\u9879\u76ee"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ git clone https://github.com/Supervisor/initscripts.git\n$ cd initscripts\n$ ls\ncentos-systemd-etcs  gentoo-matagus       redhat-init-equeffelec  redhat-sysconfig-equeffelec  ubuntu\ndebian-norrgard      opensuse-garymonson  redhat-init-jkoppe      redhat-sysconfig-jkoppe\nfedora-bmbouter      README.md            redhat-init-mingalevme  slackware\n\n# \u5c06centos-systemd-etcs\u4e2d\u7684\u5185\u5bb9\u62f7\u8d1d\u5230/usr/lib/systemd/system/supervisord.service\ncat centos-systemd-etcs >/usr/lib/systemd/system/supervisord.service\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsxs)(s.strong,{children:[(0,n.jsx)(s.code,{children:"centos-systemd-etcs"}),"\u6587\u4ef6\u5185\u5bb9"]})}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsx)(s.p,{children:(0,n.jsxs)(s.strong,{children:["\u8981\u6ce8\u610f ",(0,n.jsx)(s.code,{children:"supervisord"}),"\xa0\u548c ",(0,n.jsx)(s.code,{children:"supervisorctl"}),"\xa0\u8fd9\u4e24\u4e2a\u547d\u4ee4\u7684\u7edd\u5bf9\u8def\u5f84"]})})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"# centos-systemd-etcs\u6587\u4ef6\u5185\u5bb9\ncat > /usr/lib/systemd/system/supervisord.service <<'EOF'\n# supervisord service for systemd (CentOS 7.0+)\n# by ET-CS (https://github.com/ET-CS)\n[Unit]\nDescription=Supervisor daemon\n\n[Service]\nType=forking\nExecStart=`which supervisord`\nExecStop=`which supervisorctl` $OPTIONS shutdown\nExecReload=`which /usr/bin/supervisorctl` $OPTIONS reload\nKillMode=process\nRestart=on-failure\nRestartSec=42s\n\n[Install]\nWantedBy=multi-user.target\nEOF\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u542f\u52a8supervisord\u5e76\u52a0\u5165\u5f00\u673a\u81ea\u542f"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"systemctl daemon-reload\nsystemctl start supervisord && systemctl enable supervisord\n"})}),"\n",(0,n.jsx)(s.h2,{id:"4supervisor\u76f8\u5173\u547d\u4ee4",children:"4.supervisor\u76f8\u5173\u547d\u4ee4"}),"\n",(0,n.jsx)(s.h3,{id:"41-supervisord\u547d\u4ee4\u9009\u9879",children:"4.1 supervisord\u547d\u4ee4\u9009\u9879"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsxs)(s.strong,{children:[(0,n.jsx)(s.code,{children:"supervisord"}),"\u547d\u4ee4"]})}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u9009\u9879"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8bf4\u660e"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-c FILE, --configuration=FILE"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u6307\u5b9asupervisor\u914d\u7f6e\u6587\u4ef6"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-n, --nodaemon"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u5728\u524d\u53f0\u8fd0\u884csupervisord"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-h, --help"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u67e5\u770b\u5e2e\u52a9"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-u USER, --user=USER"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"UNIX\u7528\u6237\u540d\u6216\u6570\u5b57\u7528\u6237\u6807\u8bc6\u3002\u5982\u679c\u4ee5root\u7528\u6237\u8eab\u4efd\u542f\u52a8supervisord\uff0c\u8bf7\u5728\u542f\u52a8\u671f\u95f4\u5c3d\u5febsetuid\u7ed9\u8be5\u7528\u6237"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-m OCTAL, --umask=OCTAL"})}),(0,n.jsx)(s.td,{children:(0,n.jsxs)(s.strong,{children:["\u8868\u793asupervisord\u542f\u52a8\u540e\u5e94\u8be5\u4f7f\u7528\u7684  ",(0,n.jsx)(s.a,{href:"http://supervisord.org/glossary.html#term-umask",children:"umask"})," \u516b\u8fdb\u5236\u6570\uff08\u4f8b\u5982022\uff09"]})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-d PATH, --directory=PATH"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u5f53supervisord\u4f5c\u4e3a\u5b88\u62a4\u8fdb\u7a0b\u8fd0\u884c\u65f6\uff0c\u5728\u5b88\u62a4\u8fdb\u7a0b\u4e4b\u524dcd\u5230\u6b64\u76ee\u5f55"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-l FILE, --logfile=FILE"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u7528\u4f5csupervisord\u6d3b\u52a8\u65e5\u5fd7\u7684\u6587\u4ef6\u540d\u8def\u5f84"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-y BYTES, --logfile_maxbytes=BYTES"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u65cb\u8f6c\u53d1\u751f\u524d\uff0csupervisord\u6d3b\u52a8\u65e5\u5fd7\u6587\u4ef6\u7684\u6700\u5927\u5927\u5c0f\u3002\u8be5\u503c\u662f\u540e\u7f00\u500d\u589e\u7684\uff0c\u4f8b\u5982\u201c1\u201d\u662f\u4e00\u4e2a\u5b57\u8282\uff0c\u201c1MB\u201d\u662f1\u5146\u5b57\u8282\uff0c\u201c1GB\u201d\u662f1\u5343\u5146\u5b57\u8282"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-z NUM, --logfile_backups=NUM"})}),(0,n.jsx)(s.td,{children:(0,n.jsxs)(s.strong,{children:["\u8981\u4fdd\u6301\u7684supervisord\u6d3b\u52a8\u65e5\u5fd7\u7684\u5907\u4efd\u526f\u672c\u6570\u3002\u6bcf\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4e3a",(0,n.jsx)(s.code,{children:"logfile_maxbytes"})]})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-e LEVEL, --loglevel=LEVEL"})}),(0,n.jsx)(s.td,{children:(0,n.jsxs)(s.strong,{children:["supervisor\u5e94\u8be5\u5199\u5165\u6d3b\u52a8\u65e5\u5fd7\u7684\u65e5\u5fd7\u8bb0\u5f55\u7ea7\u522b\u3002\u6709\u6548\u7ea7\u522b\u5305\u62ec",(0,n.jsx)(s.code,{children:"trace"}),"(\u8ffd\u8e2a), ",(0,n.jsx)(s.code,{children:"debug"}),"(\u8c03\u8bd5), ",(0,n.jsx)(s.code,{children:"info"}),"(\u4fe1\u606f), ",(0,n.jsx)(s.code,{children:"warn"}),"(\u8b66\u544a), ",(0,n.jsx)(s.code,{children:"error"}),"(\u9519\u8bef),",(0,n.jsx)(s.code,{children:"critical(\u4e25\u91cd)"})]})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-j FILE, --pidfile=FILE"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"supervisord\u5e94\u8be5\u5c06\u5176pid\u6587\u4ef6\u5199\u5165\u7684\u6587\u4ef6\u540d"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-i STRING, --identifier=STRING"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u7531supervisor\u5b9e\u4f8b\u7684\u5404\u79cd\u5ba2\u6237\u7aefUI\u516c\u5f00\u7684\u4efb\u610f\u5b57\u7b26\u4e32\u6807\u8bc6\u7b26"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-q PATH, --childlogdir=PATH"})}),(0,n.jsx)(s.td,{children:(0,n.jsxs)(s.strong,{children:["\u76ee\u5f55\u7684\u8def\u5f84\uff08\u5b83\u5fc5\u987b\u5df2\u7ecf\u5b58\u5728\uff09\uff0c\u5176\u4e2dsupervisor\u5c06\u5199\u5165\u5176",(0,n.jsx)(s.code,{children:"AUTO"})," -mode\u5b50\u8fdb\u7a0b\u65e5\u5fd7"]})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-k, --nocleanup"})}),(0,n.jsx)(s.td,{children:(0,n.jsxs)(s.strong,{children:["\u9632\u6b62supervisord\u5728\u542f\u52a8\u65f6\u6267\u884c\u6e05\u7406\uff08\u5220\u9664\u65e7\u7684",(0,n.jsx)(s.code,{children:"AUTO"}),"\u8fdb\u7a0b\u65e5\u5fd7\u6587\u4ef6\uff09"]})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-a NUM, --minfds=NUM"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u5728\u6210\u529f\u542f\u52a8\u4e4b\u524d\uff0csupervisord\u8fdb\u7a0b\u5fc5\u987b\u53ef\u7528\u7684\u6700\u5c0f\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-t, --strip_ansi"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u4ece\u6240\u6709\u5b50\u65e5\u5fd7\u8fdb\u7a0b\u4e2d\u5265\u79bbANSI\u8f6c\u4e49\u5e8f\u5217"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-v, --version"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u67e5\u770b\u7248\u672c"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"--profile_options=LIST"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u7528\u4e8e\u5206\u6790\u7684\u9017\u53f7\u5206\u9694\u9009\u9879\u5217\u8868\u3002\u5bfc\u81f4 supervisord\u5728\u63a2\u67e5\u5668\u4e0b\u8fd0\u884c\uff0c\u5e76\u6839\u636e\u9009\u9879\u8f93\u51fa\u7ed3\u679c\uff0c\u8fd9\u4e9b\u9009\u9879\u662f\u4ee5\u9017\u53f7\u5206\u9694\u7684\u4ee5\u4e0b\u5217\u8868\uff1a\u7d2f\u79ef\uff0c\u547c\u53eb\uff0c\u547c\u53eb\u8005\u3002\u4f8b\u5982\u7d2f\u8ba1\uff0c\u6765\u7535\u8005"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"--minprocs=NUM"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u5728\u6210\u529f\u542f\u52a8\u4e4b\u524d\uff0csupervisord\u8fdb\u7a0b\u5fc5\u987b\u53ef\u7528\u7684\u6700\u5c0fOS\u8fdb\u7a0b\u69fd\u6570"})})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"42-supervisorctl\u547d\u4ee4\u9009\u9879\u53ca\u52a8\u4f5c",children:"4.2 supervisorctl\u547d\u4ee4\u9009\u9879\u53ca\u52a8\u4f5c"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"supervisorctl\u547d\u4ee4\u9009\u9879"})}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u9009\u9879"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.strong,{children:"\u8bf4\u660e"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-c, --configuration"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff08\u9ed8\u8ba4\u4e3a/etc/supervisord.conf\uff09"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-h, --help"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u67e5\u770b\u5e2e\u52a9"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-i, --interactive"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u6267\u884c\u547d\u4ee4\u540e\u542f\u52a8\u4ea4\u4e92\u5f0fshell"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-s, --serverurl URL"})}),(0,n.jsx)(s.td,{children:(0,n.jsxs)(s.strong,{children:["supervisord\u670d\u52a1\u5668\u6b63\u5728\u4fa6\u542c\u7684URL(default \u201c",(0,n.jsx)(s.a,{href:"http://localhost:9001%E2%80%9D",children:"http://localhost:9001\u201d"}),")"]})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-u, --username"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u7528\u4e8e\u4e0e\u670d\u52a1\u5668\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u540d"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-p, --password"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u7528\u4e8e\u4e0e\u670d\u52a1\u5668\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u5bc6\u7801"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"-r, --history-file"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"\u4fdd\u7559readline\u5386\u53f2\u8bb0\u5f55\uff08\u5982\u679creadline\u53ef\u7528\uff09"})})]})]})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"supervisorctl\u547d\u4ee4\u52a8\u4f5c"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-02-01%2015.21.54.png",alt:"iShot2021-02-01 15.21.54"})}),"\n",(0,n.jsx)(s.h2,{id:"5supervisor\u4fe1\u53f7",children:"5.supervisor\u4fe1\u53f7"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"supervisor\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u88ab\u53d1\u9001\u4fe1\u53f7\uff0c\u4f7f\u5176\u5728\u8fd0\u884c\u65f6\u6267\u884c\u67d0\u4e9b\u64cd\u4f5c\u3002"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsxs)(s.strong,{children:["\u4f60\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u4fe1\u53f7\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u53d1\u9001\u5230\u5355\u4e2asupervisord\u8fdb\u7a0bid\uff0c\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u7684",(0,n.jsx)(s.code,{children:"[supervisord]"}),"\u90e8\u5206\u7684",(0,n.jsx)(s.code,{children:"pidfile"}),"\u53c2\u6570\u8868\u793a\u7684\u6587\u4ef6\u4e2d\u627e\u5230\u6b64\u8fdb\u7a0bID \uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3a",(0,n.jsx)(s.code,{children:"$CWD/supervisord.pid"}),"\uff09"]})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"SIGTERM"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"supervisord"}),"\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\u90fd\u5c06\u5173\u95ed\u3002\u8fd9\u53ef\u80fd\u9700\u8981\u51e0\u79d2\u949f\u3002"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"SIGINT"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"supervisord"}),"\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\u90fd\u5c06\u5173\u95ed\u3002\u8fd9\u53ef\u80fd\u9700\u8981\u51e0\u79d2\u949f\u3002"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"SIGQUIT"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"supervisord"}),"\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\u90fd\u5c06\u5173\u95ed\u3002\u8fd9\u53ef\u80fd\u9700\u8981\u51e0\u79d2\u949f\u3002"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"SIGHUP"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"supervisord"}),"\u5c06\u505c\u6b62\u6240\u6709\u8fdb\u7a0b\uff0c\u4ece\u5b83\u627e\u5230\u7684\u7b2c\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\uff0c\u7136\u540e\u542f\u52a8\u6240\u6709\u8fdb\u7a0b\u3002"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"SIGUSR2"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"supervisord"}),"\u5c06\u5173\u95ed\u5e76\u91cd\u65b0\u6253\u5f00\u4e3b\u6d3b\u52a8\u65e5\u5fd7\u548c\u6240\u6709\u5b50\u65e5\u5fd7\u6587\u4ef6\u3002"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"6supervisor\u4e00\u952e\u5b89\u88c5\u811a\u672c",children:"6.supervisor\u4e00\u952e\u5b89\u88c5\u811a\u672c"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"#!/usr/bin/env bash\nset -e\n\nTMP_FILE=/usr/lib/tmpfiles.d/tmp.conf\n\n# \u5b89\u88c5supervisor\u6700\u65b0\u7248\nyum -y install python3-pip && pip3 install supervisor\n\n# \u521b\u5efa\u76ee\u5f55\n[ -d /etc/supervisor ] || mkdir /etc/supervisor\n\n# \u521b\u5efasupervisor\u914d\u7f6e\u6587\u4ef6\ncat > /etc/supervisor/supervisord.conf <<EOF\n[unix_http_server]\nfile=/tmp/supervisor.sock   ; /tmp/supervisor.sock\u6240\u6709\u8005\u4e3asupervisor\nchmod = 0770\nchown = root:root\n\n\n[supervisord]\nlogfile=/var/log/supervisor/supervisord.log ; main log file;\nlogfile_maxbytes=50MB        ; max main logfile bytes b4 rotation; default 50MB\nlogfile_backups=10           ; # of main logfile backups; 0 means none, default 10\nloglevel=info                ; log level; default info; others: debug,warn,trace\npidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid\n\n;[inet_http_server]\n;port=10.0.0.10:9001\n;username=test\n;password=test\n\n[rpcinterface:supervisor]\nsupervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface\n\n[supervisorctl]\nserverurl=unix:///tmp/supervisor.sock ; use a unix:// URL  for a unix socket\n\n[include]\nfiles = /etc/supervisor/config.d/*.ini\nEOF\n\n\n# \u8bbe\u7f6esupervisor\u65e5\u5fd7\u6eda\u52a8\ncat > /etc/logrotate.d/supervisor <<EOF\n/var/log/supervisor/*.log {\n       missingok\n       weekly\n       notifempty\n       nocompress\n}\nEOF\n\n\n# \u8bbe\u7f6eTmpfiles\u9632\u6b62sock\u6587\u4ef6\u88ab\u6e05\u7406\ngrep -w 'x /tmp/supervisor.sock' $TMP_FILE && grep -w 'x /tmp/supervisord.pid' $TMP_FILE\nif [ $? -ne 0 ];then\n   sed -i.bak '/x \\/tmp\\/supervisord.pid/d' $TMP_FILE && sed -i '/x \\/tmp\\/supervisor.sock/d' $TMP_FILE\n   echo -e \"x /tmp/supervisor.sock\\nx /tmp/supervisord.pid\" >> $TMP_FILE\nfi\n\n\n# \u5c06supervisor\u52a0\u5165systemd\ncat >/usr/lib/systemd/system/supervisord.service <<EOF\n# supervisord service for systemd (CentOS 7.0+)\n# by ET-CS (https://github.com/ET-CS)\n[Unit]\nDescription=Supervisor daemon\n\n[Service]\nType=forking\nExecStart=`which supervisord`\nExecStop=`which supervisorctl` $OPTIONS shutdown\nExecReload=`which supervisorctl` $OPTIONS reload\nKillMode=process\nRestart=on-failure\nRestartSec=42s\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\n\n# \u521b\u5efasupervisor\u76f8\u5173\u76ee\u5f55\n[ -d /var/log/supervisor ] || mkdir /var/log/supervisor\n[ -d /etc/supervisor/config.d ] || mkdir -p /etc/supervisor/config.d\n\n# \u542f\u52a8supervisor\nsystemctl daemon-reload\nsystemctl start supervisord && systemctl enable supervisord\n"})})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},28453:(e,s,r)=>{r.d(s,{R:()=>t,x:()=>l});var n=r(96540);const i={},o=n.createContext(i);function t(e){const s=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),n.createElement(o.Provider,{value:s},e.children)}}}]);