"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[8868],{31246:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>o,frontMatter:()=>i,metadata:()=>c,toc:()=>a});var s=t(74848),r=t(28453);const i={},l="CentOS7\u5b89\u88c5gitlab-ce",c={id:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/gitlab/gitlab\u5b89\u88c5/CentOS7\u5b89\u88c5gitlab-ce",title:"CentOS7\u5b89\u88c5gitlab-ce",description:"[toc]",source:"@site/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/gitlab/gitlab\u5b89\u88c5/CentOS7\u5b89\u88c5gitlab-ce.md",sourceDirName:"linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/gitlab/gitlab\u5b89\u88c5",slug:"/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/gitlab/gitlab\u5b89\u88c5/CentOS7\u5b89\u88c5gitlab-ce",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/gitlab/gitlab\u5b89\u88c5/CentOS7\u5b89\u88c5gitlab-ce",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"gitlab runner\u5b89\u88c5\u914d\u7f6e",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/gitlab/gitlab runner/gitlab runner\u5b89\u88c5\u914d\u7f6e"},next:{title:"\u5173\u95edgitlab\u81ea\u52a8\u6ce8\u518c\u529f\u80fd",permalink:"/docs/linux/\u81ea\u52a8\u5316\u8fd0\u7ef4\u5e73\u53f0/gitlab/gitlab\u77e5\u8bc6\u70b9/\u5173\u95edgitlab\u81ea\u52a8\u6ce8\u518c\u529f\u80fd"}},d={},a=[{value:"1.rpm\u5305\u5b89\u88c5",id:"1rpm\u5305\u5b89\u88c5",level:2},{value:"1.1 \u5b89\u88c5\u4f9d\u8d56\u5305",id:"11-\u5b89\u88c5\u4f9d\u8d56\u5305",level:3},{value:"1.2 \u4e0b\u8f7d\u5b89\u88c5\u5305",id:"12-\u4e0b\u8f7d\u5b89\u88c5\u5305",level:3},{value:"1.3 \u5b89\u88c5",id:"13-\u5b89\u88c5",level:3},{value:"1.4 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6",id:"14-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6",level:3},{value:"1.5 \u542f\u52a8gitlab",id:"15-\u542f\u52a8gitlab",level:3},{value:"2.yum\u5b89\u88c5",id:"2yum\u5b89\u88c5",level:2},{value:"2.1 \u6dfb\u52a0\u5b98\u65b9yum\u6e90",id:"21-\u6dfb\u52a0\u5b98\u65b9yum\u6e90",level:3},{value:"2.2 \u5b89\u88c5",id:"22-\u5b89\u88c5",level:3},{value:"2.3 \u5173\u95edhttps\u81ea\u52a8\u91cd\u5b9a\u5411",id:"23-\u5173\u95edhttps\u81ea\u52a8\u91cd\u5b9a\u5411",level:3},{value:"3.docker\u5b89\u88c5",id:"3docker\u5b89\u88c5",level:2},{value:"3.1 \u7f16\u8f91docker-compose.yml\u6587\u4ef6",id:"31-\u7f16\u8f91docker-composeyml\u6587\u4ef6",level:3},{value:"3.2 \u542f\u52a8",id:"32-\u542f\u52a8",level:3},{value:"4.\u8bbf\u95eegitlab",id:"4\u8bbf\u95eegitlab",level:2},{value:"5.gitlab\u76f8\u5173\u6587\u4ef6\u3001\u547d\u4ee4\u3001\u670d\u52a1",id:"5gitlab\u76f8\u5173\u6587\u4ef6\u547d\u4ee4\u670d\u52a1",level:2},{value:"5.1 gitlab\u76f8\u5173\u6587\u4ef6",id:"51-gitlab\u76f8\u5173\u6587\u4ef6",level:3},{value:"5.2 gitlab\u76f8\u5173\u547d\u4ee4",id:"52-gitlab\u76f8\u5173\u547d\u4ee4",level:3},{value:"5.3 gitlab\u76f8\u5173\u670d\u52a1",id:"53-gitlab\u76f8\u5173\u670d\u52a1",level:3}];function h(n){const e={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.p,{children:"[toc]"}),"\n",(0,s.jsx)(e.h1,{id:"centos7\u5b89\u88c5gitlab-ce",children:"CentOS7\u5b89\u88c5gitlab-ce"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://about.gitlab.com/",children:"gitlab\u5b98\u7f51"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://github.com/gitlabhq/gitlabhq",children:"gitlab github\u5730\u5740"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://about.gitlab.com/install/",children:"gitlab\u5b98\u65b9\u5b89\u88c5\u6587\u6863"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://packages.gitlab.com/gitlab/gitlab-ce",children:"gitlab\u5b98\u65b9\u4e0b\u8f7d\u5730\u5740"})}),"\n",(0,s.jsx)(e.h2,{id:"1rpm\u5305\u5b89\u88c5",children:"1.rpm\u5305\u5b89\u88c5"}),"\n",(0,s.jsx)(e.h3,{id:"11-\u5b89\u88c5\u4f9d\u8d56\u5305",children:"1.1 \u5b89\u88c5\u4f9d\u8d56\u5305"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://docs.gitlab.com/omnibus/settings/smtp.html",children:"\u4e0d\u4f7f\u7528postfix\u4f7f\u7528\u5176\u4ed6\u65b9\u5f0f\u53d1\u9001\u90ae\u4ef6\u53c2\u8003\u5b98\u65b9\u6587\u6863"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# \u5b89\u88c5\u4f9d\u8d56\u5305\nyum -y install curl openssh-server openssh-clients postfix cronie policycoreutils-python\n\n# \u542f\u52a8postfix\nsystemctl start postfix && systemctl enable postfix\n"})}),"\n",(0,s.jsx)(e.h3,{id:"12-\u4e0b\u8f7d\u5b89\u88c5\u5305",children:"1.2 \u4e0b\u8f7d\u5b89\u88c5\u5305"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://packages.gitlab.com/gitlab/gitlab-ce",children:"gitlab\u5b98\u65b9rpm\u5305\u4e0b\u8f7d\u5730\u5740"})}),"\n",(0,s.jsxs)(e.p,{children:["\u4e5f\u53ef\u4ee5\u4ece ",(0,s.jsx)(e.a,{href:"https://mirrors4.tuna.tsinghua.edu.cn/gitlab-ce/",children:"\u6e05\u534e\u6e90"})," \u4e0b\u8f7d"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"wget --content-disposition https://packages.gitlab.com/gitlab/gitlab-ce/packages/el/7/gitlab-ce-13.12.3-ce.0.el7.x86_64.rpm/download.rpm\n"})}),"\n",(0,s.jsx)(e.h3,{id:"13-\u5b89\u88c5",children:"1.3 \u5b89\u88c5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"yum -y localinstall gitlab-ce-13.12.3-ce.0.el7.x86_64.rpm \n"})}),"\n",(0,s.jsx)(e.h3,{id:"14-\u4fee\u6539\u914d\u7f6e\u6587\u4ef6",children:"1.4 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsxs)(e.strong,{children:["\u4fee\u6539 ",(0,s.jsx)(e.code,{children:"/etc/gitlab/gitlab.rb"})," \u4e2d ",(0,s.jsx)(e.code,{children:"xternal_url"})," \u4e00\u884c\uff0c\u4fee\u6539\u4e3a\u81ea\u5df1\u7684\u57df\u540d\u6216IP"]})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"export IP=10.0.0.100\nsed -i.bak \"/^external_url/c external_url 'http://$IP'\" /etc/gitlab/gitlab.rb\n"})}),"\n",(0,s.jsx)(e.h3,{id:"15-\u542f\u52a8gitlab",children:"1.5 \u542f\u52a8gitlab"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# \u542f\u52a8gitlab\ngitlab-ctl start\n\n# \u91cd\u8f7dgitlab\u914d\u7f6e\u6587\u4ef6\ngitlab-ctl reconfigure\n\n# \u8bbe\u7f6egitlab\u5f00\u673a\u81ea\u542f\nsystemctl enable gitlab-runsvdir.service\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6\u6210\u529f\u63d0\u793a\u5982\u4e0b"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-06-20%2001.20.14.png",alt:"iShot2021-06-20 01.20.14"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"gitlab\u542f\u52a8\u7684\u7aef\u53e3"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"$ netstat -ntpl\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 127.0.0.1:8082          0.0.0.0:*               LISTEN      3276/sidekiq 5.2.9  \ntcp        0      0 127.0.0.1:9236          0.0.0.0:*               LISTEN      3770/gitaly         \ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      969/sshd            \ntcp        0      0 127.0.0.1:3000          0.0.0.0:*               LISTEN      3926/grafana-server \ntcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1194/master         \ntcp        0      0 0.0.0.0:8060            0.0.0.0:*               LISTEN      3330/nginx: master  \ntcp        0      0 127.0.0.1:9121          0.0.0.0:*               LISTEN      3815/redis_exporter \ntcp        0      0 127.0.0.1:9090          0.0.0.0:*               LISTEN      3897/prometheus     \ntcp        0      0 127.0.0.1:9187          0.0.0.0:*               LISTEN      3919/postgres_expor \ntcp        0      0 127.0.0.1:9093          0.0.0.0:*               LISTEN      3911/alertmanager   \ntcp        0      0 127.0.0.1:9100          0.0.0.0:*               LISTEN      3791/node_exporter  \ntcp        0      0 127.0.0.1:9229          0.0.0.0:*               LISTEN      3778/gitlab-workhor \ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      701/rpcbind         \ntcp        0      0 127.0.0.1:9168          0.0.0.0:*               LISTEN      3802/ruby           \ntcp        0      0 127.0.0.1:8080          0.0.0.0:*               LISTEN      3253/puma 5.1.1 (un \ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      3330/nginx: master  \ntcp6       0      0 :::22                   :::*                    LISTEN      969/sshd            \ntcp6       0      0 ::1:25                  :::*                    LISTEN      1194/master         \ntcp6       0      0 :::9094                 :::*                    LISTEN      3911/alertmanager   \ntcp6       0      0 :::111                  :::*                    LISTEN      701/rpcbind         \ntcp6       0      0 ::1:9168                :::*                    LISTEN      3802/ruby    \n"})}),"\n",(0,s.jsx)(e.h2,{id:"2yum\u5b89\u88c5",children:"2.yum\u5b89\u88c5"}),"\n",(0,s.jsx)(e.h3,{id:"21-\u6dfb\u52a0\u5b98\u65b9yum\u6e90",children:"2.1 \u6dfb\u52a0\u5b98\u65b9yum\u6e90"}),"\n",(0,s.jsx)(e.admonition,{type:"tip",children:(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u8fd9\u4e2a\u6e90\u9700\u8981\u79d1\u5b66\u4e0a\u7f51"})})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash\n"})}),"\n",(0,s.jsx)(e.h3,{id:"22-\u5b89\u88c5",children:"2.2 \u5b89\u88c5"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u9700\u8981\u4fee\u6539\u4e3a\u81ea\u5df1\u7684url\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u4f1a\u81ea\u52a8\u542f\u52a8gitlab-ce"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:'# \u9ed8\u8ba4\u5b89\u88c5\u6700\u65b0\u7248\nsudo EXTERNAL_URL="https://gitlab.example.com" yum -y install gitlab-ce\n\n# \u5b89\u88c5\u6307\u5b9a\u7248\u672c\nsudo EXTERNAL_URL="https://gitlab.example.com" yum -y install -y gitlab-ce-13.12.3\n'})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"gitlab\u542f\u52a8\u7684\u7aef\u53e3"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"$ netstat -ntpl\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 127.0.0.1:9236          0.0.0.0:*               LISTEN      3581/gitaly         \ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1254/sshd           \ntcp        0      0 127.0.0.1:3000          0.0.0.0:*               LISTEN      3671/grafana-server \ntcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1181/master         \ntcp        0      0 0.0.0.0:5050            0.0.0.0:*               LISTEN      3098/nginx: master  \ntcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      3098/nginx: master  \ntcp        0      0 0.0.0.0:8060            0.0.0.0:*               LISTEN      3098/nginx: master  \ntcp        0      0 127.0.0.1:9121          0.0.0.0:*               LISTEN      3636/redis_exporter \ntcp        0      0 127.0.0.1:9090          0.0.0.0:*               LISTEN      3641/prometheus     \ntcp        0      0 127.0.0.1:9187          0.0.0.0:*               LISTEN      3665/postgres_expor \ntcp        0      0 127.0.0.1:9093          0.0.0.0:*               LISTEN      3658/alertmanager   \ntcp        0      0 127.0.0.1:5000          0.0.0.0:*               LISTEN      3599/registry       \ntcp        0      0 127.0.0.1:9100          0.0.0.0:*               LISTEN      3629/node_exporter  \ntcp        0      0 127.0.0.1:9229          0.0.0.0:*               LISTEN      3587/gitlab-workhor \ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      588/rpcbind         \ntcp        0      0 127.0.0.1:9168          0.0.0.0:*               LISTEN      3634/ruby           \ntcp        0      0 127.0.0.1:8080          0.0.0.0:*               LISTEN      2922/puma 5.1.1 (un \ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      3098/nginx: master  \ntcp        0      0 127.0.0.1:8082          0.0.0.0:*               LISTEN      2943/sidekiq 5.2.9  \ntcp6       0      0 :::22                   :::*                    LISTEN      1254/sshd           \ntcp6       0      0 ::1:25                  :::*                    LISTEN      1181/master         \ntcp6       0      0 :::9094                 :::*                    LISTEN      3658/alertmanager   \ntcp6       0      0 :::111                  :::*                    LISTEN      588/rpcbind         \ntcp6       0      0 ::1:9168                :::*                    LISTEN      3634/ruby   \n"})}),"\n",(0,s.jsx)(e.h3,{id:"23-\u5173\u95edhttps\u81ea\u52a8\u91cd\u5b9a\u5411",children:"2.3 \u5173\u95edhttps\u81ea\u52a8\u91cd\u5b9a\u5411"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["\u4f7f\u7528gitlab-ce\u5b98\u65b9\u63d0\u4f9b\u7684\u811a\u672c\u5b89\u88c5\u540e\uff0cgitlab-ce\u4f1a\u9ed8\u8ba4\u5f00\u542f ",(0,s.jsx)(e.code,{children:"http->https"})," \u91cd\u5b9a\u5411\uff0c\u5982\u679c\u4f7f\u7528nginx\u505a\u4ee3\u7406\u5219\u5173\u95edhttps\u81ea\u52a8\u91cd\u5b9a\u5411"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["\u7f16\u8f91 ",(0,s.jsx)(e.code,{children:"/etc/gitlab/gitlab.rb"})," \u6587\u4ef6\uff0c\u53d6\u6d88\u4ee5\u4e0b\u884c\u7684\u6ce8\u91ca"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"nginx['redirect_http_to_https'] = false\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"gitlab-ctl reconfigure\n"})}),"\n",(0,s.jsx)(e.h2,{id:"3docker\u5b89\u88c5",children:"3.docker\u5b89\u88c5"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://docs.gitlab.com/omnibus/docker/",children:"gitlab docker\u5b89\u88c5\u5b98\u65b9\u6587\u6863"})}),"\n",(0,s.jsx)(e.h3,{id:"31-\u7f16\u8f91docker-composeyml\u6587\u4ef6",children:"3.1 \u7f16\u8f91docker-compose.yml\u6587\u4ef6"}),"\n",(0,s.jsxs)(e.p,{children:["\u9ed8\u8ba4 ",(0,s.jsx)(e.code,{children:"https"})," \u548c ",(0,s.jsx)(e.code,{children:"ssh"})," \u7aef\u53e3"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"# \u81ea\u884c\u4fee\u6539\u76f8\u5bf9\u5e94\u7684\u57df\u540d\u3001\u6620\u5c04\u7684\u7aef\u53e3\u3001\u6302\u8f7d\u7684\u5377\ncat > docker-compose.yml <<EOF\nversion: '3.6'\nservices:\n  web:\n    image: 'gitlab/gitlab-ee:latest'\n    restart: always\n    hostname: 'gitlab.example.com'\n    environment:\n      GITLAB_OMNIBUS_CONFIG: |\n        external_url 'https://gitlab.example.com'\n        # Add any other gitlab.rb configuration here, each on its own line\n    ports:\n      - '80:80'\n      - '443:443'\n      - '22:22'\n    volumes:\n      - '$GITLAB_HOME/config:/etc/gitlab'\n      - '$GITLAB_HOME/logs:/var/log/gitlab'\n      - '$GITLAB_HOME/data:/var/opt/gitlab'\n    shm_size: '256m'\nEOF\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u81ea\u5b9a\u4e49 ",(0,s.jsx)(e.code,{children:"http"})," \u548c ",(0,s.jsx)(e.code,{children:"ssh"})," \u7aef\u53e3"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"# \u81ea\u884c\u4fee\u6539\u76f8\u5bf9\u5e94\u7684\u57df\u540d\u3001\u6620\u5c04\u7684\u7aef\u53e3\u3001\u6302\u8f7d\u7684\u5377\ncat > docker-compose.yml <<EOF\nversion: '3.6'\nservices:\n  web:\n    image: 'gitlab/gitlab-ee:latest'\n    restart: always\n    hostname: 'gitlab.example.com'\n    environment:\n      GITLAB_OMNIBUS_CONFIG: |\n        external_url 'http://gitlab.example.com:8929'\n        gitlab_rails['gitlab_shell_ssh_port'] = 2224\n    ports:\n      - '8929:8929'\n      - '2224:22'\n    volumes:\n      - '$GITLAB_HOME/config:/etc/gitlab'\n      - '$GITLAB_HOME/logs:/var/log/gitlab'\n      - '$GITLAB_HOME/data:/var/opt/gitlab'\n    shm_size: '256m'\nEOF\n"})}),"\n",(0,s.jsx)(e.h3,{id:"32-\u542f\u52a8",children:"3.2 \u542f\u52a8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"docker-compose up -d\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u67e5\u770b\u542f\u52a8\u7684\u5bb9\u5668"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:'$ docker ps -a\nCONTAINER ID   IMAGE                     COMMAND             CREATED         STATUS                   PORTS                                                                                                           NAMES\na9ed8420da5d   gitlab/gitlab-ce:latest   "/assets/wrapper"   3 minutes ago   Up 3 minutes (healthy)   0.0.0.0:80->80/tcp, :::80->80/tcp, 0.0.0.0:443->443/tcp, :::443->443/tcp, 0.0.0.0:222->22/tcp, :::222->22/tcp   gitlab\n'})}),"\n",(0,s.jsx)(e.h2,{id:"4\u8bbf\u95eegitlab",children:"4.\u8bbf\u95eegitlab"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"gitlab\u9ed8\u8ba4\u7aef\u53e3\u4e3a80\uff0c\u7b2c\u4e00\u6b21\u8bbf\u95ee\u9700\u8981\u8bbe\u7f6eroot\u5bc6\u7801\uff0c\u6700\u5c118\u4f4d"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-06-20%2001.22.44.png",alt:"iShot2021-06-20 01.22.44"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u521d\u59cb\u9875\u9762"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-06-20%2001.24.18.png",alt:"iShot2021-06-20 01.24.18"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsxs)(e.strong,{children:["\u8fd9\u91cc\u7684\u8b66\u544a\u4e3agitlab\u9ed8\u8ba4\u5f00\u542f\u4e86\u5f00\u653e\u6ce8\u518c\uff0c\u70b9\u51fb ",(0,s.jsx)(e.code,{children:"learn more"})," \u67e5\u770b\u5173\u95ed\u65b9\u6cd5"]})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-06-20%2001.26.03.png",alt:"iShot2021-06-20 01.26.03"})}),"\n",(0,s.jsxs)(e.p,{children:["\u70b9\u51fb ",(0,s.jsx)(e.code,{children:"Admin Area"}),"  -> ",(0,s.jsx)(e.code,{children:"Settings"})," -> ",(0,s.jsx)(e.code,{children:"General"})," -> ",(0,s.jsx)(e.code,{children:"Sign-up restrictions"})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-06-20%2001.32.23.png",alt:"iShot2021-06-20 01.32.23"})}),"\n",(0,s.jsxs)(e.p,{children:["\u53d6\u6d88\u52fe\u9009 ",(0,s.jsx)(e.code,{children:"Sign-up enabled"})," \uff0c\u4fdd\u5b58\u5373\u53ef"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-06-20%2001.35.58.png",alt:"iShot2021-06-20 01.35.58"})}),"\n",(0,s.jsx)(e.p,{children:"gitlab\u9ed8\u8ba4\u5f00\u542f\u6ce8\u518c"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-06-20%2014.54.27.png",alt:"iShot2021-06-20 14.54.27"})}),"\n",(0,s.jsx)(e.p,{children:"\u5173\u95ed\u540e"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2021-06-20%2014.57.52fa.png",alt:"iShot2021-06-20 14.57.52fa"})}),"\n",(0,s.jsx)(e.h2,{id:"5gitlab\u76f8\u5173\u6587\u4ef6\u547d\u4ee4\u670d\u52a1",children:"5.gitlab\u76f8\u5173\u6587\u4ef6\u3001\u547d\u4ee4\u3001\u670d\u52a1"}),"\n",(0,s.jsx)(e.h3,{id:"51-gitlab\u76f8\u5173\u6587\u4ef6",children:"5.1 gitlab\u76f8\u5173\u6587\u4ef6"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"gitlab\u76f8\u5173\u6587\u4ef6\u8def\u5f84\u8bf4\u660e"})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u8def\u5f84"}),(0,s.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"/opt/gitlab"}),(0,s.jsx)(e.td,{children:"gitlab\u7684\u7a0b\u5e8f\u5b89\u88c5\u76ee\u5f55"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"/var/opt/gitlab"}),(0,s.jsx)(e.td,{children:"gitlab\u76ee\u5f55\u6570\u636e\u76ee\u5f55"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"/var/opt/gitlab/git-data/repositories"}),(0,s.jsx)(e.td,{children:"\u5b58\u653e\u4ed3\u5e93\u6570\u636e"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"/etc/gitlab/gitlab.rb"}),(0,s.jsx)(e.td,{children:"\u4e3b\u914d\u7f6e\u6587\u4ef6"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"/var/opt/gitlab/nginx/conf/gitlab-http.conf"}),(0,s.jsx)(e.td,{children:"nginx\u914d\u7f6e\u6587\u4ef6"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"/var/opt/gitlab/postgresql/data"}),(0,s.jsx)(e.td,{children:"Postgresql\u6570\u636e\u76ee\u5f55"})]})]})]}),"\n",(0,s.jsx)(e.h3,{id:"52-gitlab\u76f8\u5173\u547d\u4ee4",children:"5.2 gitlab\u76f8\u5173\u547d\u4ee4"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u8fd0\u7ef4\u7ba1\u7406\u547d\u4ee4"})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u547d\u4ee4"}),(0,s.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"cat /opt/gitlab/embedded/service/gitlab-rails/VERSION"}),(0,s.jsx)(e.td,{children:"\u67e5\u770b\u7248\u672c"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u670d\u52a1\u63a7\u5236\u547d\u4ee4"})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"\u547d\u4ee4"})}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"\u8bf4\u660e"})})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitlab-ctl status"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u67e5\u770b\u76ee\u524dgitlab\u6240\u6709\u670d\u52a1\u8fd0\u7ef4\u72b6\u6001"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitlab-ctl start/stop/restart"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u542f\u52a8/\u505c\u6b62/\u91cd\u542f\u6240\u6709 gitlab \u7ec4\u4ef6"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitlab-ctl start/stop nginx"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u5355\u72ec\u542f\u52a8/\u505c\u6b62\u67d0\u4e2a\u670d\u52a1"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitlab-ctl reconfigure"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6"})})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u65e5\u5fd7\u76f8\u5173\u547d\u4ee4"})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"\u547d\u4ee4"})}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"\u8bf4\u660e"})})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitlab-ctl tail"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u5b9e\u65f6\u67e5\u770b\u6240\u6709\u65e5\u5fd7"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitlab-ctl tail redis/postgresql/gitlab-workhorse/logrotate/nginx/sidekiq/unicorn"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u5b9e\u65f6\u67e5\u770b\u5404\u670d\u52a1\u65e5\u5fd7"})})]})]})]}),"\n",(0,s.jsx)(e.h3,{id:"53-gitlab\u76f8\u5173\u670d\u52a1",children:"5.3 gitlab\u76f8\u5173\u670d\u52a1"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsxs)(e.strong,{children:["\u8fd0\u884c\u547d\u4ee4 ",(0,s.jsx)(e.code,{children:"gitlab-ctl status"})," \u67e5\u770bgitlab\u6240\u6709\u670d\u52a1"]})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"$ gitlab-ctl status\nrun: alertmanager: (pid 3911) 54193s; run: log: (pid 3614) 54248s\nrun: gitaly: (pid 3804) 54195s; run: log: (pid 3031) 54349s\nrun: gitlab-exporter: (pid 3802) 54195s; run: log: (pid 3393) 54268s\nrun: gitlab-workhorse: (pid 3778) 54196s; run: log: (pid 3307) 54286s\nrun: grafana: (pid 3926) 54192s; run: log: (pid 3735) 54210s\nrun: logrotate: (pid 16507) 1784s; run: log: (pid 2874) 54363s\nrun: nginx: (pid 3330) 54281s; run: log: (pid 3348) 54279s\nrun: node-exporter: (pid 3791) 54196s; run: log: (pid 3377) 54274s\nrun: postgres-exporter: (pid 3919) 54192s; run: log: (pid 3644) 54243s\nrun: postgresql: (pid 3067) 54346s; run: log: (pid 3099) 54343s\nrun: prometheus: (pid 3897) 54194s; run: log: (pid 3446) 54256s\nrun: puma: (pid 3253) 54300s; run: log: (pid 3266) 54297s\nrun: redis: (pid 2896) 54358s; run: log: (pid 2913) 54355s\nrun: redis-exporter: (pid 3815) 54194s; run: log: (pid 3412) 54262s\nrun: sidekiq: (pid 3271) 54294s; run: log: (pid 3286) 54291s\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://docs.gitlab.com/ce/administration/monitoring/",children:"\u5b98\u65b9\u6587\u6863\u5bf9\u4e8e\u5404\u670d\u52a1\u6307\u6807\u7684\u8bf4\u660e"})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"\u670d\u52a1\u540d"})}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"\u9ed8\u8ba4\u76d1\u542c\u7aef\u53e3"})}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"\u8bf4\u660e"})})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"alertmanager"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:9093"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u544a\u8b66\u5de5\u5177"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitaly"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:9236"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u63d0\u4f9b\u96c6\u7fa4\u529f\u80fd"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitlab-exporter"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"---"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u76d1\u63a7gitlab\u6307\u6807"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitlab-workhorse"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:9229"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"gitlab\u53cd\u5411\u4ee3\u7406\uff0c\u5904\u7406\u6587\u4ef6\u4e0a\u4f20\u3001\u4e0b\u8f7d\uff0cgit\u63a8\u62c9\u7b49\u64cd\u4f5c"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"grafana"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:3000"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u51fa\u56fe\u5de5\u5177"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"logrotate"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"---"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u65e5\u5fd7\u5207\u5272"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"nginx"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:80"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u9759\u6001web\u670d\u52a1\u5668"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"node-exporter"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:9100"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"Prometheus\u7528\u6765\u76d1\u63a7\u670d\u52a1\u5668\u6307\u6807"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"postgres-exporter"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:9187"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u5bfc\u51faPostgreSQL\u6307\u6807"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"postgresql"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"UDP:60387"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u9ed8\u8ba4\u6570\u636e\u5e93"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"prometheus"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:9090"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u76d1\u63a7"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"puma"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:8080"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u9ed8\u8ba4\u7684web\u670d\u52a1\u5668"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"redis"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"---"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u7f13\u5b58\u670d\u52a1"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"redis-exporter"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:9121"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u76d1\u63a7redis"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"sidekiq"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"TCP:8082"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"\u4f9d\u8d56redis\u7684\u6d88\u606f\u961f\u5217"})})]})]})]})]})}function o(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>l,x:()=>c});var s=t(96540);const r={},i=s.createContext(r);function l(n){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);