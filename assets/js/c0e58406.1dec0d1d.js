"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7046],{64641:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>d,toc:()=>a});var c=s(74848),t=s(28453);const r={},o="k8s\u8bbe\u7f6e\u901a\u8fc7kubeconfig\u767b\u9646dashboard",d={id:"\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u6587\u7ae0/k8s\u8bbe\u7f6e\u901a\u8fc7kubeconfig\u767b\u9646dashboard",title:"k8s\u8bbe\u7f6e\u901a\u8fc7kubeconfig\u767b\u9646dashboard",description:"[toc]",source:"@site/docs/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u6587\u7ae0/k8s\u8bbe\u7f6e\u901a\u8fc7kubeconfig\u767b\u9646dashboard.md",sourceDirName:"\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u6587\u7ae0",slug:"/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u6587\u7ae0/k8s\u8bbe\u7f6e\u901a\u8fc7kubeconfig\u767b\u9646dashboard",permalink:"/docs/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u6587\u7ae0/k8s\u8bbe\u7f6e\u901a\u8fc7kubeconfig\u767b\u9646dashboard",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"k8s\u7ed9node\u8282\u70b9\u6dfb\u52a0\u89d2\u8272\u6807\u7b7e",permalink:"/docs/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u6587\u7ae0/k8s\u7ed9node\u8282\u70b9\u6dfb\u52a0\u89d2\u8272\u6807\u7b7e"},next:{title:"kubeadm \u4e13\u9898 \u4e00 init \u7a76\u7adf\u5e72\u4e86\u4e9b\u4ec0\u4e48",permalink:"/docs/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u6587\u7ae0/kubeadm \u4e13\u9898 \u4e00 init \u7a76\u7adf\u5e72\u4e86\u4e9b\u4ec0\u4e48"}},i={},a=[{value:"1.\u521b\u5efacluster",id:"1\u521b\u5efacluster",level:2},{value:"2.\u83b7\u53d6token",id:"2\u83b7\u53d6token",level:2},{value:"3.\u521b\u5efacredentials",id:"3\u521b\u5efacredentials",level:2},{value:"4.\u521b\u5efacontext",id:"4\u521b\u5efacontext",level:2},{value:"5.\u5207\u6362context\u7684current-context\u662fdashboard-admin@kubernetes",id:"5\u5207\u6362context\u7684current-context\u662fdashboard-adminkubernetes",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.p,{children:"[toc]"}),"\n",(0,c.jsx)(n.h1,{id:"k8s\u8bbe\u7f6e\u901a\u8fc7kubeconfig\u767b\u9646dashboard",children:"k8s\u8bbe\u7f6e\u901a\u8fc7kubeconfig\u767b\u9646dashboard"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/configure-access-multiple-clusters/",children:"k8s\u8bbe\u7f6e\u901a\u8fc7kubeconfig\u767b\u9646dashboard\u5b98\u65b9\u6587\u6863"})}),"\n",(0,c.jsx)(n.p,{children:"k8s \u5b98\u65b9\u7684dashboard\u6bcf\u6b21\u767b\u9646\u90fd\u9700\u8981\u8f93\u5165token\uff0c\u800c\u8fd9\u4e2atoken\u4e00\u4f1a\u7279\u4e48\u5c31\u8fc7\u671f\u4e86\uff0c\u6211\u5c31\u662f\u672c\u673a\u5b9e\u9a8c\uff0c\u6bcf\u6b21\u90fd\u5f97\u624b\u52a8\u7c98\u8d34\u4e00\u5927\u4e32\u547d\u4ee4\u83b7\u53d6token\u7136\u540e\u518d\u767b\u9646\uff0c\u975e\u5e38\u9ebb\u70e6"}),"\n",(0,c.jsx)(n.p,{children:"\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u83b7\u53d6\u767b\u9646dashboard\u7684token"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"kubectl get secret `kubectl get secret -n kube-system|grep admin-token|awk '{print $1}'` -o jsonpath={.data.token} -n kube-system |base64 -d && echo\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u67e5\u770bsecrets"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"$ kubectl get secrets \nNAME                  TYPE                                  DATA   AGE\ndefault-token-jlz9f   kubernetes.io/service-account-token   3      45h\n"})}),"\n",(0,c.jsx)(n.p,{children:"1.\u5b9a\u4e49\u96c6\u7fa4\u3001\u7528\u6237\u548c\u4e0a\u4e0b\u95ee"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:"cat > dashboard-config.yaml << EOF\napiVersion: v1\nkind: Config\npreferences: {}\n\nclusters:\n- cluster:\n  name: ctyun\n\nusers:\n- name: ctyun\n\ncontexts:\n- context:\n  name: ctyun\nEOF\n"})}),"\n",(0,c.jsx)(n.p,{children:"2.\u5c06\u96c6\u7fa4\u8be6\u7ec6\u4fe1\u606f\u6dfb\u52a0\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"kubectl config --kubeconfig=dashboard-config.yaml set-cluster ctyun --server=https://192.168.1.96 --insecure-skip-tls-verify\n"})}),"\n",(0,c.jsx)(n.p,{children:"3.\u5c06\u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u6dfb\u52a0\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d"}),"\n",(0,c.jsx)(n.p,{children:":::caution\u6ce8\u610f"}),"\n",(0,c.jsxs)(n.p,{children:["\u5c06\u5bc6\u7801\u4fdd\u5b58\u5230 Kubernetes \u5ba2\u6237\u7aef\u914d\u7f6e\u4e2d\u6709\u98ce\u9669\u3002 \u4e00\u4e2a\u8f83\u597d\u7684\u66ff\u4ee3\u65b9\u5f0f\u662f\u4f7f\u7528\u51ed\u636e\u63d2\u4ef6\u5e76\u5355\u72ec\u4fdd\u5b58\u8fd9\u4e9b\u51ed\u636e\u3002 \u53c2\u9605 ",(0,c.jsx)(n.a,{href:"https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/authentication/#client-go-credential-plugins",children:"client-go \u51ed\u636e\u63d2\u4ef6"})]}),"\n",(0,c.jsx)(n.p,{children:":::"}),"\n",(0,c.jsx)(n.p,{children:":::tip\u8bf4\u660e"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u8981\u5220\u9664\u7528\u6237\uff0c\u53ef\u4ee5\u8fd0\u884c ",(0,c.jsx)(n.code,{children:"kubectl --kubeconfig=config-demo config unset users.<name>"})]}),"\n",(0,c.jsxs)(n.li,{children:["\u8981\u5220\u9664\u96c6\u7fa4\uff0c\u53ef\u4ee5\u8fd0\u884c ",(0,c.jsx)(n.code,{children:"kubectl --kubeconfig=config-demo config unset clusters.<name>"})]}),"\n",(0,c.jsxs)(n.li,{children:["\u8981\u5220\u9664\u4e0a\u4e0b\u6587\uff0c\u53ef\u4ee5\u8fd0\u884c ",(0,c.jsx)(n.code,{children:"kubectl --kubeconfig=config-demo config unset contexts.<name>"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:":::"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"kubectl config --kubeconfig=dashboard-config.yaml set-credentials experimenter --username=admin --password=admin\n"})}),"\n",(0,c.jsx)(n.p,{children:"4.\u5c06\u4e0a\u4e0b\u6587\u8be6\u7ec6\u4fe1\u606f\u6dfb\u52a0\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"kubectl config --kubeconfig=dashboard-config.yaml set-context ctyun --cluster=ctyun --namespace=kubernetes-dashboard --user=admin\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"kubectl config --kubeconfig=dashboard-config.yaml view\n"})}),"\n",(0,c.jsx)(n.h2,{id:"1\u521b\u5efacluster",children:"1.\u521b\u5efacluster"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"kubectl config set-cluster kubernetes --certificate-authority=/etc/kubernetes/pki/ca.crt --server=10.0.0.130:6443 --kubeconfig=/root/dashbord-admin.conf\n"})}),"\n",(0,c.jsx)(n.h2,{id:"2\u83b7\u53d6token",children:"2.\u83b7\u53d6token"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"DASH_TOCKEN=$(kubectl get secret -n kube-system `kubectl get secret -n kube-system |grep dashboard |awk '{print $1}'` -o jsonpath={.data.token}|base64 -d)\n"})}),"\n",(0,c.jsx)(n.h2,{id:"3\u521b\u5efacredentials",children:"3.\u521b\u5efacredentials"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"kubectl config set-credentials dashboard-admin --token=$DASH_TOCKEN --kubeconfig=/root/dashbord-admin.conf\n"})}),"\n",(0,c.jsx)(n.h2,{id:"4\u521b\u5efacontext",children:"4.\u521b\u5efacontext"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"kubectl config set-context dashboard-admin@kubernetes --cluster=kubernetes --user=dashboard-admin --kubeconfig=/root/dashbord-admin.conf\n"})}),"\n",(0,c.jsx)(n.h2,{id:"5\u5207\u6362context\u7684current-context\u662fdashboard-adminkubernetes",children:"5.\u5207\u6362context\u7684current-context\u662fdashboard-admin@kubernetes"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"kubectl config use-context dashboard-admin@kubernetes --kubeconfig=/root/dashbord-admin.conf\n"})}),"\n",(0,c.jsx)(n.admonition,{type:"tip",children:(0,c.jsx)(n.p,{children:(0,c.jsxs)(n.strong,{children:["\u4e0b\u8f7d ",(0,c.jsx)(n.code,{children:"dashboard-admin.conf"})," \u7136\u540e\u767b\u9646\u7684\u65f6\u5019\u9009\u62e9\u8fd9\u4e2a\u6587\u4ef6\u5373\u53ef"]})})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var c=s(96540);const t={},r=c.createContext(t);function o(e){const n=c.useContext(r);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),c.createElement(r.Provider,{value:n},e.children)}}}]);