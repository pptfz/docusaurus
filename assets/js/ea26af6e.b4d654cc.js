"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[9307],{9677:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var i=s(74848),r=s(28453);const t={},a="ingress-nginx\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1",o={id:"\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u670d\u52a1\u3001\u8d1f\u8f7d\u5747\u8861\u548c\u8054\u7f51/ingress/ingress-nginx/ingress-nginx\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1",title:"ingress-nginx\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1",description:"\u6709\u4e00\u4e9b\u5e73\u53f0\u662f\u4e0d\u9700\u8981\u767b\u9646\u5c31\u53ef\u4ee5\u8bbf\u95ee\u7684\uff0c\u4f8b\u5982prometheus\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u76f4\u63a5\u8bbf\u95ee\u5c31\u53ef\u4ee5\u4e86",source:"@site/docs/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u670d\u52a1\u3001\u8d1f\u8f7d\u5747\u8861\u548c\u8054\u7f51/ingress/ingress-nginx/ingress-nginx\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1.md",sourceDirName:"\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u670d\u52a1\u3001\u8d1f\u8f7d\u5747\u8861\u548c\u8054\u7f51/ingress/ingress-nginx",slug:"/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u670d\u52a1\u3001\u8d1f\u8f7d\u5747\u8861\u548c\u8054\u7f51/ingress/ingress-nginx/ingress-nginx\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1",permalink:"/docs/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u670d\u52a1\u3001\u8d1f\u8f7d\u5747\u8861\u548c\u8054\u7f51/ingress/ingress-nginx/ingress-nginx\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ingress-nginx\u5b89\u88c5",permalink:"/docs/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u670d\u52a1\u3001\u8d1f\u8f7d\u5747\u8861\u548c\u8054\u7f51/ingress/ingress-nginx/ingress-nginx\u5b89\u88c5"},next:{title:"headless service",permalink:"/docs/\u4e91\u539f\u751f/k8s/k8s\u77e5\u8bc6\u70b9/\u670d\u52a1\u3001\u8d1f\u8f7d\u5747\u8861\u548c\u8054\u7f51/service/headless service"}},c={},l=[{value:"ingress\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1",id:"ingress\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1",level:3},{value:"\u521b\u5efa\u57fa\u672c\u8ba4\u8bc1\u5bc6\u7801\u6587\u4ef6",id:"\u521b\u5efa\u57fa\u672c\u8ba4\u8bc1\u5bc6\u7801\u6587\u4ef6",level:3},{value:"\u521b\u5efasecret",id:"\u521b\u5efasecret",level:3},{value:"\u914d\u7f6eingress-nginx",id:"\u914d\u7f6eingress-nginx",level:3},{value:"\u8bbf\u95ee",id:"\u8bbf\u95ee",level:3}];function p(e){const n={admonition:"admonition",code:"code",h1:"h1",h3:"h3",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"ingress-nginx\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1",children:"ingress-nginx\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1"}),"\n",(0,i.jsx)(n.p,{children:"\u6709\u4e00\u4e9b\u5e73\u53f0\u662f\u4e0d\u9700\u8981\u767b\u9646\u5c31\u53ef\u4ee5\u8bbf\u95ee\u7684\uff0c\u4f8b\u5982prometheus\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u76f4\u63a5\u8bbf\u95ee\u5c31\u53ef\u4ee5\u4e86"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot_2024-05-30_17.23.40.png",alt:"iShot_2024-05-30_17.23.40"})}),"\n",(0,i.jsx)(n.h3,{id:"ingress\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1",children:"ingress\u914d\u7f6e\u8bbf\u95ee\u8ba4\u8bc1"}),"\n",(0,i.jsx)(n.h3,{id:"\u521b\u5efa\u57fa\u672c\u8ba4\u8bc1\u5bc6\u7801\u6587\u4ef6",children:"\u521b\u5efa\u57fa\u672c\u8ba4\u8bc1\u5bc6\u7801\u6587\u4ef6"}),"\n",(0,i.jsxs)(n.admonition,{title:"\u8bf4\u660e",type:"tip",children:[(0,i.jsxs)(n.p,{children:["\u5176\u4e2d ",(0,i.jsx)(n.code,{children:"p8s"})," \u662f\u7528\u6237\u540d\uff0c\u56de\u8f66\u540e\u4f1a\u63d0\u793a\u8f93\u5165\u5bc6\u7801\uff0c\u6267\u884c\u5b8c\u6210\u540e\u751f\u6210\u7684 ",(0,i.jsx)(n.code,{children:"auth"})," \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ cat auth\np8s:$apr1$VKAtzj6S$Pl/NTZiMLXUSCI1oOSykv.\n"})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ htpasswd -c auth p8s \nNew password: \nRe-type new password: \nAdding password for user p8s\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u521b\u5efasecret",children:"\u521b\u5efasecret"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl create secret generic basic-auth --from-file=auth\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u914d\u7f6eingress-nginx",children:"\u914d\u7f6eingress-nginx"}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u4e0b\u662f\u539f\u5148\u7684\u9ed8\u8ba4ingress\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsxs)(n.admonition,{title:"\u8bf4\u660e",type:"tip",children:[(0,i.jsxs)(n.p,{children:["\u4e4b\u9700\u8981\u5728ingress\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 ",(0,i.jsx)(n.code,{children:"annotations"})," \u4e0b\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\u5373\u53ef\uff0c\u5176\u4e2d ",(0,i.jsx)(n.code,{children:"basic-auth"})," \u662f\u4e0a\u4e00\u6b65\u521b\u5efa\u7684 ",(0,i.jsx)(n.code,{children:"secret"})," \u7684\u540d\u79f0"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'annotations:\n    nginx.ingress.kubernetes.io/auth-type: "basic"\n    nginx.ingress.kubernetes.io/auth-secret: "basic-auth"\n    nginx.ingress.kubernetes.io/auth-realm: "Authentication Required"\n'})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'$ kubectl get ingress prometheus-server -o yaml\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  annotations:\n    meta.helm.sh/release-name: prometheus\n    meta.helm.sh/release-namespace: monitor\n  creationTimestamp: "2024-05-30T06:19:35Z"\n  generation: 1\n  labels:\n    app.kubernetes.io/component: server\n    app.kubernetes.io/instance: prometheus\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: prometheus\n    app.kubernetes.io/part-of: prometheus\n    app.kubernetes.io/version: v2.52.0\n    helm.sh/chart: prometheus-25.21.0\n  name: prometheus-server\n  namespace: monitor\n  resourceVersion: "293693"\n  uid: 4da70182-6882-4f02-bb29-627aba3e1a2e\nspec:\n  rules:\n  - host: p8s.ops.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: prometheus-server\n            port:\n              number: 80\n        path: /\n        pathType: Prefix\nstatus:\n  loadBalancer:\n    ingress:\n    - hostname: localhost\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u8bbf\u95ee",children:"\u8bbf\u95ee"}),"\n",(0,i.jsx)(n.p,{children:"\u914d\u7f6e\u5b8c\u6210\u540e\u8bbf\u95ee\u6d4f\u89c8\u5668\u5c31\u63d0\u793a\u9700\u8981\u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\u4e86"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot_2024-05-30_17.43.09.png",alt:"iShot_2024-05-30_17.43.09"})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var i=s(96540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);