<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">CentOS7中用Ambari快速搭建大数据平台 | 我的站点</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://pptfz.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://pptfz.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://pptfz.github.io/docs/linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="CentOS7中用Ambari快速搭建大数据平台 | 我的站点"><meta data-rh="true" name="description" content="[toc]"><meta data-rh="true" property="og:description" content="[toc]"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pptfz.github.io/docs/linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台"><link data-rh="true" rel="alternate" href="https://pptfz.github.io/docs/linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://pptfz.github.io/docs/linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://SICNXLSDBZ-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="我的站点" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.061a1b25.css">
<script src="/assets/js/runtime~main.19595b7b.js" defer="defer"></script>
<script src="/assets/js/main.1b24f5df.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="announcementBar_mb4j" style="background-color:pink;color:@091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">一名运维，两台电脑，三餐不定，只为设备工作四平八稳，拼得五脏俱损，六神无主，仍然七点起床，八点出发，晚上九点不返，十分辛苦！<br> 十年运维，九转功成，八面张罗，忙得七窍流血，换得六神不宁，五体欠安，仍然四处奔波，三更不眠，只为两个铜板，一生拼搏！</div></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">我的站点</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">笔记</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">😂 😂  😂</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/github/github下载加速">github</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/go/go功能脚本/k8s/获取k8s集群资源配置">go</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/idea/vscode/vscode好用的插件">idea</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台">linux</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台">big-data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台">Ambari</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台">CentOS7中用Ambari快速搭建大数据平台</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/big-data/Ambari/ambari下载">ambari下载</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/big-data/CDH/CentOS7.9安装CDH6.2.1">CDH</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/big-data/MapReduce/腾讯云 MapReduce 集群 core 节点下线过程">MapReduce</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/git/CentOS7编译安装git">git</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/kvm/安装/kvm安装">kvm</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/linux其他/CentOS7安装字体">linux其他</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/linux内核/Linux升级内核">linux内核</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/linux命令/Linux权限总结">linux命令</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/linux实用开源小工具/bat">linux实用开源小工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/linux服务/VPN/CentOS7一键安装OpenVPN">linux服务</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/linux系统/deepin/deepin15.11使用记录">linux系统</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/monitor/grafana/安装/grafana安装">monitor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/openstack/mitaka/centos7.8搭建openstack Mitaka版">openstack</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/shell/expect自动化交互式程序">shell</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/包管理工具/gvm/gvm安装">包管理工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/性能测试/文件删除效率测试/测试Linux下删除大量文件的效率">性能测试</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/日志/Linux 日志切割神器 Logrotate 原理和配置详解">日志</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/生产环境开源项目/bi工具/superset/superset安装">生产环境开源项目</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/生产问题总结/ssh/记录一次诡异的ssh连接问题">生产问题总结</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/linux/科学上网">科学上网</a><button aria-label="展开侧边栏分类 &#x27;科学上网&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/网 络协议/http/HTTP 协议">网络协议</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/自动化运维平台/ansible/ansible playbook">自动化运维平台</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/linux/阿里云开发者社区优秀文章/shell脚本/shell脚本速查手册">阿里云开发者社区优秀文章</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/mac专区/brew安装">mac专区</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/python/python-other/nginx+django+uwsgi部署项目">python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/web/css/css基础知识">web</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/云原生/k8s/helm/helm3安装">云原生</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/其他/wps/wps冻结窗口">其他</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/博客工具/Docusaurus/Docusaurus 安装">博客工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/操作小技巧/linux/linux一些骚操作">操作小技巧</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/数据库/mongodb/centos7安装mongodb">数据库</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/翻车问题合集/翻车问题-ssh密钥问题">翻车问题合集</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">linux</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">big-data</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Ambari</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">CentOS7中用Ambari快速搭建大数据平台</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><p>[toc]</p>
<h1>CentOS7中用Ambari快速搭建大数据平台</h1>
<p>公司的产品是基于大数据平台的，近期要做公司产品私有化部署，因此学习一下 <a href="http://ambari.apache.org/" target="_blank" rel="noopener noreferrer">Ambari</a></p>
<p>本文参考地址 <a href="https://blog.csdn.net/jiaowoshouzi/article/details/80675007?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.edu_weight&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.edu_weight" target="_blank" rel="noopener noreferrer">原文链接</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1ambari简介">1.Ambari简介<a href="#1ambari简介" class="hash-link" aria-label="1.Ambari简介的直接链接" title="1.Ambari简介的直接链接">​</a></h2>
<p><a href="http://ambari.apache.org/" target="_blank" rel="noopener noreferrer">Ambari官网</a></p>
<p><a href="https://github.com/apache/ambari" target="_blank" rel="noopener noreferrer">Ambari github地址</a></p>
<p><strong>Ambari是什么</strong></p>
<p><a href="http://ambari.apache.org/" target="_blank" rel="noopener noreferrer">Ambari</a> 是创建、管理、监视 <a href="http://hadoop.apache.org/" target="_blank" rel="noopener noreferrer">Hadoop</a> 的集群的软件。这里的 Hadoop 是广义，指的是 Hadoop 整个生态圈（例如 <a href="https://hive.apache.org/" target="_blank" rel="noopener noreferrer">Hive</a>，<a href="https://hbase.apache.org/" target="_blank" rel="noopener noreferrer">Hbase</a>，<a href="https://sqoop.apache.org/" target="_blank" rel="noopener noreferrer">Sqoop</a>，<a href="https://zookeeper.apache.org/" target="_blank" rel="noopener noreferrer">Zookeeper</a> ，<a href="https://spark.apache.org/" target="_blank" rel="noopener noreferrer">Spark</a> ，<a href="https://flink.apache.org/" target="_blank" rel="noopener noreferrer">Flink</a> ，<a href="https://flume.apache.org/" target="_blank" rel="noopener noreferrer">Flume</a> ，<a href="https://oozie.apache.org/" target="_blank" rel="noopener noreferrer">Oozie</a> 等），而并不仅是特指 Hadoop。用一句话来说，Ambari 就是为了让 Hadoop 以及相关的大数据软件更容易使用的一个工具。 Ambari 现在所支持的平台组件也越来越多，例如流行的 Spark，Storm 等计算框架，以及资源调度平台 YARN 等，我们都能轻松地通过 Ambari 来进行部署，为想构建大数据平台的初学者提供了很大的便捷。</p>
<p>Ambari 自身也是一个分  布式架构的软件，主要由两部分组成：<code>Ambari Server</code> 和 <code>Ambari Agent</code>。简单来说，用户通过 <code>Ambari Server</code> 通知 <code>Ambari Agent</code> 安装对应的软件；Agent 会定时地发送各个机器每个软件模块的状态给 <code>Ambari Server</code>，最终这些状态信息会呈现在 Ambari 的 GUI，方便用户了解到集群的各种状态，并进行相应的维护。</p>
<p><strong>Ambari</strong></p>
<blockquote>
<p>基于Web的工具，支持Apache Hadoop集群的创建、管理和监控。</p>
</blockquote>
<p><strong>HDP</strong></p>
<blockquote>
<p>包含了hadoop生态系统的所有软件项目，比如HBase、Zookeeper、Hive</p>
<p>、Pig等等。</p>
</blockquote>
<p><strong>HDP-UTILS</strong></p>
<blockquote>
<p>工具类库。</p>
</blockquote>
<p><strong>HDP-GPL</strong></p>
<blockquote>
<p>LZO压缩库软件包存储在单独的HDP-GPL存储库中。</p>
</blockquote>
<p><strong>Ambari安装说明</strong></p>
<blockquote>
<p><strong>Ambari类似于Ansible，并没有明确的 master/slave 之分</strong></p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2环境准备">2.环境准备<a href="#2环境准备" class="hash-link" aria-label="2.环境准备的直接链接" title="2.环境准备的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="20-安装纯净系统后执行的脚本">2.0 安装纯净系统后执行的脚本<a href="#20-安装纯净系统后执行的脚本" class="hash-link" aria-label="2.0 安装纯净系统后执行的脚本的直接链接" title="2.0 安装纯净系统后执行的脚本的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#!/usr/bin/env bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 修改系统yum源为aliyun并添加epel源</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ ! -e /etc/yum.repos.d/CentOS-Base.repo ] &amp;&amp; curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo &amp;&amp; sed -i -e &#x27;/mirrors.cloud.aliyuncs.com/d&#x27; -e &#x27;/mirrors.aliyuncs.com/d&#x27; /etc/yum.repos.d/CentOS-Base.repo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ ! -e /etc/yum.repos.d/epel.repo ] &amp;&amp; curl -o /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum makecache</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum -y install tar wget net-tools git vim tree lrzsz htop iftop iotop psmisc python36 python3-devel zlib zlib-devel gcc gcc-c++ conntrack-tools jq socat bash-completion telnet nload strace tcpdump lsof sysstat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 关闭防火墙、selinux、NetworkManager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl disable firewalld NetworkManager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;7s/enforcing/disabled/&#x27; /etc/selinux/config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 同步时间计划任务 由于后续要用到ntpserver，因此ntpdate选择不执行</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#sed -i &#x27;/*\/10 \* \* \* \* \/usr\/sbin\/ntpdate ntp2\.aliyun\.com &amp;&gt;\/dev\/null/d&#x27; /var/spool/cron/root</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#echo &quot;*/10 * * * * /usr/sbin/ntpdate ntp2.aliyun.com &amp;&gt;/dev/null&quot; &gt;&gt;/var/spool/cron/root</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 历史命令显示时间</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;/HISTFILESIZE=2000/d&#x27; /etc/bashrc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;/HISTSIZE=2000/d&#x27; /etc/bashrc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;/HISTTIMEFORMAT=&quot;%Y-%m-%d %H:%M:%S &quot;/d&#x27; /etc/bashrc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;/export HISTTIMEFORMAT/d&#x27; /etc/bashrc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt;&gt;/etc/bashrc&lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">HISTFILESIZE=2000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">HISTSIZE=2000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">HISTTIMEFORMAT=&quot;%Y-%m-%d %H:%M:%S &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export HISTTIMEFORMAT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source /etc/bashrc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 修改系统最大文件描述符</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;/root soft nofile 65535/d&#x27; /etc/security/limits.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;/root hard nofile 65535/d&#x27; /etc/security/limits.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;/* soft nofile 65535/d&#x27; /etc/security/limits.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;/* hard nofile 65535/d&#x27; /etc/security/limits.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt;&gt;/etc/security/limits.conf&lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root soft nofile 65535</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root hard nofile 65535</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* soft nofile 65535</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* hard nofile 65535</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 设置pip国内源</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir ~/.pip</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt;~/.pip/pip.conf&lt;&lt;EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[global]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">index-url = https://pypi.tuna.tsinghua.edu.cn/simple/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 个人习惯执行命令 netstat -ntpl，所以做一个别名</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i.bak &quot;8c alias n=&#x27;netstat -ntpl&#x27;&quot; ~/.bashrc &amp;&amp; source ~/.bashrc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">reboot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-实验环境">2.1 实验环境<a href="#21-实验环境" class="hash-link" aria-label="2.1 实验环境的直接链接" title="2.1 实验环境的直接链接">​</a></h3>
<table><thead><tr><th><strong>角色</strong></th><th><strong>IP地址</strong></th><th><strong>主机名</strong></th><th><strong>ambari版本</strong></th><th><strong>硬件配置</strong></th><th><strong>系统</strong></th><th><strong>内核</strong></th></tr></thead><tbody><tr><td><strong>master</strong></td><td><strong>10.0.0.136</strong></td><td><strong>ambari-server01.test.com</strong></td><td><strong>2.6.2.2</strong></td><td><strong>2c8g</strong></td><td><strong>CentOS7.8</strong></td><td><strong>3.10.0-1127.el7.x86_64</strong></td></tr><tr><td><strong>slave</strong></td><td><strong>10.0.0.137</strong></td><td><strong>ambari-agent01.test.com</strong></td><td><strong>2.6.2.2</strong></td><td><strong>2c8g</strong></td><td><strong>CentOS7.8</strong></td><td><strong>3.10.0-1127.el7.x86_64</strong></td></tr><tr><td><strong>slave</strong></td><td><strong>10.0.0.138</strong></td><td><strong>ambari-agent02.test.com</strong></td><td><strong>2.6.2.2</strong></td><td><strong>2c8g</strong></td><td><strong>CentOS7.8</strong></td><td><strong>3.10.0-1127.el7.x86_64</strong></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-配置ssh免密">2.2 配置ssh免密<a href="#22-配置ssh免密" class="hash-link" aria-label="2.2 配置ssh免密的直接链接" title="2.2 配置ssh免密的直接链接">​</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>如无特殊说明，以下操作均在 <code>ambari-server01</code> 节点</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="221-编辑环境变量文件">2.2.1 编辑环境变量文件<a href="#221-编辑环境变量文件" class="hash-link" aria-label="2.2.1 编辑环境变量文件的直接链接" title="2.2.1 编辑环境变量文件的直接链接">​</a></h4>
<p><strong>环境变量文件中IP、主机名、子网网段可自行修改</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ -d /opt/ambari/script ] || mkdir -p /opt/ambari/script &amp;&amp; cd /opt/ambari/script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt; env.sh &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export NODE_IPS=(10.0.0.136 10.0.0.137 10.0.0.138)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export NODE_NAMES=(ambari-server01.test.com ambari-agent01.test.com ambari-agent02.test.com)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export NODE_SUBNET=&#x27;10.0.0.0/24&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="222-生成密钥对">2.2.2 生成密钥对<a href="#222-生成密钥对" class="hash-link" aria-label="2.2.2 生成密钥对的直接链接" title="2.2.2 生成密钥对的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ssh-keygen -t rsa -P &#x27;&#x27; -f ~/.ssh/id_rsa &amp;&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="223-编辑expect自动化交互脚本">2.2.3 编辑expect自  动化交互脚本<a href="#223-编辑expect自动化交互脚本" class="hash-link" aria-label="2.2.3 编辑expect自动化交互脚本的直接链接" title="2.2.3 编辑expect自动化交互脚本的直接链接">​</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p><strong>这里机器用户名是 <code>root</code>，密码是国际标准通用密码 <code>1</code>，ssh端口 <code>22</code></strong></p><p><strong>⚠️执行路径在 <code>/opt/ambari/script</code></strong></p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt; ssh.exp &lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#!/usr/bin/expect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if { $argc !=2 } {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  send_user &quot;usage: expect ssh.exp file ip\n&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set file [lindex $argv 0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set ip [lindex $argv 1]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set password &quot;1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">spawn ssh-copy-id -i $file -p 22 root@$ip</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">expect {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;yes/no&quot; {send &quot;yes\r&quot;;exp_continue}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;*password&quot; {send &quot;$password\r&quot;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">expect eof</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="224-编辑shell脚本循环执行expect脚本">2.2.4 编辑shell脚本循环执行expect脚本<a href="#224-编辑shell脚本循环执行expect脚本" class="hash-link" aria-label="2.2.4 编辑shell脚本循环执行expect脚本的直接链接" title="2.2.4 编辑shell脚本循环执行expect脚本的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 编辑脚本</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source env.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt; ssh.sh &lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for i in ${NODE_IPS[@]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">do</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  expect ./ssh.exp ~/.ssh/id_rsa.pub $i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">done</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 安装expect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum -y install expect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 执行脚本</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source ssh.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-每个节点配置hosts信息">2.3 每个节点配置hosts信息<a href="#23-每个节点配置hosts信息" class="hash-link" aria-label="2.3 每个节点配置hosts信息的直接链接" title="2.3 每个节点配置hosts信息的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">source /opt/ambari/script/env.sh </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for node_ip in ${NODE_IPS[@]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  do</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;&gt;&gt;&gt; ${node_ip}&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssh root@${node_ip} &quot;cat &gt;&gt; /etc/hosts &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">${NODE_IPS[0]} ${NODE_NAMES[0]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">${NODE_IPS[1]} ${NODE_NAMES[1]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">${NODE_IPS[2]} ${NODE_NAMES[2]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24-禁用防火墙和selinux">2.4 禁用防火墙和selinux<a href="#24-禁用防火墙和selinux" class="hash-link" aria-label="2.4 禁用防火墙和selinux的直接链接" title="2.4 禁用防火墙和selinux的直接链接">​</a></h3>
<p><strong>这一步已在2.0安装纯净系统后执行的脚本中执行过了</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 禁用防火墙</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 禁用selinux	临时修改</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">setenforce 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 禁用selinux	永久修改，重启服务器后生效</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;7s/enforcing/disabled/&#x27; /etc/selinux/config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="25-安装jdk8">2.5 安装JDK8<a href="#25-安装jdk8" class="hash-link" aria-label="2.5 安装JDK8的直接链接" title="2.5 安装JDK8的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="251-安装说明">2.5.1 安装说  明<a href="#251-安装说明" class="hash-link" aria-label="2.5.1 安装说明的直接链接" title="2.5.1 安装说明的直接链接">​</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p><strong><span style="color:red">⚠️⚠️⚠️集群中每一个节点都需要安装jdk</span></strong></p><p><strong>⚠️jdk需要登陆到 <a href="https://www.oracle.com/" target="_blank" rel="noopener noreferrer">oracle</a> 官网才可以下载，这里下载的是版本是 <code>jdk-8u251</code></strong></p><p><strong>jdk安装包下载至 <code>/opt/ambari/pkg</code></strong></p><p><a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="noopener noreferrer">jdk官方下载地址</a></p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p /opt/ambari/pkg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="252-编写jdk安装脚本">2.5.2 编写jdk安装脚本<a href="#252-编写jdk安装脚本" class="hash-link" aria-label="2.5.2 编写jdk安装脚本的直接链接" title="2.5.2 编写jdk安装脚本的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt;/opt/ambari/script/jdk8_install.sh &lt;&lt;&#x27;ABC&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#!/usr/bin/env bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PWD=`pwd`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">JDK_PKG=jdk-8u251-linux-x64.tar.gz</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 安装jdk1.8.0_251</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar xf $PWD/$JDK_PKG -C /usr/local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt;/etc/profile.d/jdk8.sh&lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export JAVA_HOME=/usr/local/jdk1.8.0_251</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export PATH=$JAVA_HOME/bin:$JAVA_HOME/jre:$JAVA_HOME/lib:$PATH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export JAVA_HOME PATH CLASSPATH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 使jdk命令环境变量生效</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source /etc/profile.d/jdk8.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 做一个软连接</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ln -sf $JAVA_HOME/bin/java /usr/bin/java</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ABC</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="253-拷贝jdk安装包和jdk安装脚本到其余节点">2.5.3 拷贝jdk安装包和jdk安装脚本到其余节点<a href="#253-拷贝jdk安装包和jdk安装脚本到其余节点" class="hash-link" aria-label="2.5.3 拷贝jdk安装包和jdk安装脚本到其余节点的直接链接" title="2.5.3 拷贝jdk安装包和jdk安装脚本到其余节点的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">source /opt/ambari/script/env.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export NODE_IPS=(${NODE_IPS[1]} ${NODE_IPS[2]})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for node_ip in ${NODE_IPS[@]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  do</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;&gt;&gt;&gt; ${node_ip}&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    scp ${NODE_NAMES}:/opt/ambari/script/jdk8_install.sh ${node_ip}:/opt/ambari/script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    scp ${NODE_NAMES}:/opt/ambari/pkg/jdk-8u251-linux-x64.tar.gz ${node_ip}:/opt/ambari/pkg </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  done  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="254-所有节点执行jdk安装脚本">2.5.4 所有节点执行jdk安装脚本<a href="#254-所有节点执行jdk安装脚本" class="hash-link" aria-label="2.5.4 所有节点执行jdk安装脚本的直接链接" title="2.5.4 所有节点执行jdk安装脚本的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">source /opt/ambari/script/env.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export NODE_IPS=(${NODE_IPS[1]} ${NODE_IPS[2]})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for node_ip in ${NODE_IPS[@]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  do</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;&gt;&gt;&gt; ${node_ip}&quot;  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssh root@${node_ip} &#x27;source /opt/ambari/script/jdk8_install.sh&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="26-配置时间同步">2.6 配置时间同步<a href="#26-配置时间同步" class="hash-link" aria-label="2.6 配置时间同步的直接链接" title="2.6 配置时间同步的直接链接">​</a></h3>
<p><strong>时间同步可选 ntp 和 chrony，这里选择 chrony</strong></p>
<p><a href="http://www.ntp.org" target="_blank" rel="noopener noreferrer">ntp官网</a></p>
<p><a href="https://chrony.tuxfamily.org/" target="_blank" rel="noopener noreferrer">chrony官网</a></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p><strong>⚠️sed中有变量替换，需要使用双引号</strong></p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="261-各节点安装chrony">2.6.1 各节点安装chrony<a href="#261-各节点安装chrony" class="hash-link" aria-label="2.6.1 各节点安装chrony的直接链接" title="2.6.1 各节点安装chrony的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">source /opt/ambari/script/env.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for node_ip in ${NODE_IPS[@]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  do</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;&gt;&gt;&gt; ${node_ip}&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssh root@${node_ip} yum -y install chrony</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="262-cdh-master节点修改服务器地址为阿里云">2.6.2 cdh master节点修改服务器地址为阿里云<a href="#262-cdh-master节点修改服务器地址为阿里云" class="hash-link" aria-label="2.6.2 cdh master节点修改服务器地址为阿里云的直接链接" title="2.6.2 cdh master节点修改服务器地址为阿里云的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i.bak &#x27;3,6d&#x27; /etc/chrony.conf &amp;&amp; sed -i -e &#x27;3cserver ntp1.aliyun.com iburst&#x27; -e &quot;/^#allow/callow ${NODE_SUBNET}&quot; /etc/chrony.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="263-alave节点修改同步服务器为master节点">2.6.3 alave节点修改同步服务器为master节点<a href="#263-alave节点修改同步服务器为master节点" class="hash-link" aria-label="2.6.3 alave节点修改同步服务器为master节点的直接链接" title="2.6.3 alave节点修改同步服务器为master节点的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 这里选择另外两个节点执行</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export NODE_IPS=(${NODE_IPS[1]} ${NODE_IPS[2]})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for node_ip in ${NODE_IPS[@]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  do</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;&gt;&gt;&gt; ${node_ip}&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssh root@${node_ip} sed -i.bak &#x27;3,6d&#x27; /etc/chrony.conf &amp;&amp; sed -i &quot;3cserver ${NODE_NAMES[0]} iburst&quot; /etc/chrony.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="264-启动chronyd服务并设置开机自启">2.6.4 启动chronyd服务并设置开机自启<a href="#264-启动chronyd服务并设置开机自启" class="hash-link" aria-label="2.6.4 启动chronyd服务并设置开机自启的直接链接" title="2.6.4 启动chronyd服务并设置开机自启的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">for node_ip in ${NODE_IPS[@]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  do</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;&gt;&gt;&gt; ${node_ip}&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssh root@${node_ip} &#x27;systemctl enable chronyd &amp;&amp; systemctl start chronyd&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="265-检查端口chronyd监听udp323端口">2.6.5 检查端口，chronyd监听udp323端口<a href="#265-检查端口chronyd监听udp323端口" class="hash-link" aria-label="2.6.5 检查端口，chronyd监听udp323端口的直接链接" title="2.6.5 检查端口，chronyd监听udp323端口的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">for node_ip in ${NODE_IPS[@]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  do</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;&gt;&gt;&gt; ${node_ip}&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssh root@${node_ip} netstat -nupl|grep chronyd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="266-检查同步">2.6.6 检查同步<a href="#266-检查同步" class="hash-link" aria-label="2.6.6 检查同步的直接链接" title="2.6.6 检查同步的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">for node_ip in ${NODE_IPS[@]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  do</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;&gt;&gt;&gt; ${node_ip}&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ssh root@${node_ip} chronyc sources</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="27-安装apache">2.7 安装apache<a href="#27-安装apache" class="hash-link" aria-label="2.7 安装apache的直接链接" title="2.7 安装apache的直接链接">​</a></h3>
<p><a href="http://httpd.apache.org/" target="_blank" rel="noopener noreferrer">httpd官网</a></p>
<p><strong>说明</strong></p>
<blockquote>
<p><strong>这里安装 HTTP 主要作用在为后期安装 ambari 制作本地源时候用的</strong></p>
<p><strong>CentOS7.8默认的httpd版本是2.4.6</strong></p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum -y install httpd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl enable httpd &amp;&amp; systemctl start httpd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="28-安装mysql">2.8 安装mysql<a href="#28-安装mysql" class="hash-link" aria-label="2.8 安装mysql的直接链接" title="2.8 安装mysql的直接链接">​</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p><strong>二进制安装的mysql启动脚本 <code>/etc/init.d/mysql</code> 和  <code>安装目录/mysql/bin/mysqld_safe</code>  这两个文件中都是默认在 <code>/usr/local/mysql</code>，如果安装目录不在 <code>/usr/local/</code> 下，需要修改这两个文件中的路径，即把 <code>/usr/local</code> 替换为mysql安装目录，使用如下命令</strong></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i &#x27;s#/usr/local#你的mysql安装目录#g&#x27; /etc/init.d/mysql /你的mysql安装目录/mysql/bin/mysqld_safe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="281-下载二进制包">2.8.1 下载二进制包<a href="#281-下载二进制包" class="hash-link" aria-label="2.8.1 下载二进制包的直接链接" title="2.8.1 下载二进制包的直接链接">​</a></h4>
<p><a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noopener noreferrer">mysql官方下载地址</a></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p><strong>mysql5.7.30 md5值  <code>611be3b18a30498b705db773293ad341</code></strong></p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget https://downloads.mysql.com/archives/get/p/23/file/mysql-5.7.30-linux-glibc2.12-x86_64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="282-解压缩mysql二进制包到usrlocal">2.8.2 解压缩mysql二进制包到/usr/local<a href="#282-解压缩mysql二进制包到usrlocal" class="hash-link" aria-label="2.8.2 解压缩mysql二进制包到/usr/local的直接链接" title="2.8.2 解压缩mysql二进制包到/usr/local的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar xf mysql-5.7.30-linux-glibc2.12-x86_64.tar.gz -C /usr/local</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="283-修改名称做软连接">2.8.3 修改名称、做软连接<a href="#283-修改名称做软连接" class="hash-link" aria-label="2.8.3 修改名称、做软连接的直接链接" title="2.8.3 修改名称、做软连接的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mv /usr/local/mysql-5.7.30-linux-glibc2.12-x86_64 /usr/local/mysql-5.7.30 &amp;&amp; </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ln -s /usr/local/mysql-5.7.30 /usr/local/mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="284-创建mysql用户">2.8.4 创建mysql用户<a href="#284-创建mysql用户" class="hash-link" aria-label="2.8.4 创建mysql用户的直接链接" title="2.8.4 创建mysql用户的直接链接">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">useradd </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">M </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">s </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token builtin" style="color:rgb(130, 170, 255)">bin</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">nologin mysql </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="285-编辑主配置文件myql-5730二进制包默认没有mysql配置文件">2.8.5 编辑主配置文件，myql-5.7.30二进制包默认没有mysql配置文件<a href="#285-编辑主配置文件myql-5730二进制包默认没有mysql配置文件" class="hash-link" aria-label="2.8.5 编辑主配置文件，myql-5.7.30二进制包默认没有mysql配置文件的直接链接" title="2.8.5 编辑主配置文件，myql-5.7.30二进制包默认没有mysql配置文件的直接链接">​</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p><strong>⚠️如果指定了mysql的socket文件位置，则必须添加 <code>[client]</code> 标签并同时指定socket文件位置，否则客户端会默认从 <code>/tmp</code> 下找socket文件</strong></p></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 备份/etc/my.cnf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mv </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cnf </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cnf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">old</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 以下配置为最精简版，可根据实际情况进行相应设置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cnf </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;EOF&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mysqld</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">basedir</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">local</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datadir</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">local</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">socket</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">var</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">lib</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mysql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">log</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">error</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">local</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">data</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">log</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">socket</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">var</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">lib</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sock</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="286-创建socker文件目录目录文件授权">2.8.6 创建socker文件目录、目录文件授权<a href="#286-创建socker文件目录目录文件授权" class="hash-link" aria-label="2.8.6 创建socker文件目录、目录文件授权的直接链接" title="2.8.6 创建socker文件目录、目录文件授权的直接链接">​</a></h4>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p><strong>⚠️⚠️⚠️如果mysql配置文件中指定了socket文件目录，则这个目录的权限必须是mysql，否则mysql会启动失败</strong></p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p /var/lib/mysql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">chown -R mysql.mysql /usr/local/mysql* /var/lib/mysql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">chown mysql.mysql /etc/my.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="287-拷贝启动脚本">2.8.7 拷贝启动脚本<a href="#287-拷贝启动脚本" class="hash-link" aria-label="2.8.7 拷贝启动脚本的直接链接" title="2.8.7 拷贝启动脚本的直接链接">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cp </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">local</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">support</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">files</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">server </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">d</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysqld</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="288-初始化mysql">2.8.8 初始化mysql<a href="#288-初始化mysql" class="hash-link" aria-label="2.8.8 初始化mysql的直接链接" title="2.8.8 初始化mysql的直 接链接">​</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p><strong>⚠️⚠️⚠️mysql-5.7.22初始化没有提示！！！</strong></p></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">local</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token builtin" style="color:rgb(130, 170, 255)">bin</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysqld </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">initialize</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">insecure </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mysql </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">basedir</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">local</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">datadir</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">local</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>参数说明</strong></p>
<table><thead><tr><th><strong>参数</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td><strong>--user</strong></td><td><strong>指定mysql用户</strong></td></tr><tr><td><strong>--basedir</strong></td><td><strong>指定mysql安装目录</strong></td></tr><tr><td><strong>--datadir</strong></td><td><strong>指定mysql数据目录</strong></td></tr><tr><td><strong>--initialize-insecure</strong></td><td><strong>不生成随机密码</strong></td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="289-添加mysql命令环境变量">2.8.9 添加mysql命令环境变量<a href="#289-添加mysql命令环境变量" class="hash-link" aria-label="2.8.9 添加mysql命令环境变量的直接链接" title="2.8.9 添加mysql命令环境变量的直接链接">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 导出mysql命令环境变量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;export PATH=/usr/local/mysql/bin:$PATH&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">profile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">d</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 使配置生效</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">profile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2810-配置systemd管理mysql">2.8.10 配置systemd管理mysql<a href="#2810-配置systemd管理mysql" class="hash-link" aria-label="2.8.10 配置systemd管理mysql的直接链接" title="2.8.10 配置systemd管理mysql的直接链接">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">systemd</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">system</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysqld</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">service </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;EOF&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Unit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Description</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">MySQL Server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Documentation</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">man</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">mysqld</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Documentation</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">//</span><span class="token plain">dev</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mysql</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">com</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">doc</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">refman</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">en</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">using</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">systemd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">html</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">After</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">network</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">target</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">After</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">syslog</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">target</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Install</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">WantedBy</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">multi</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">target</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Service</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mysql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Group</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mysql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecStart</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">usr</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">local</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysql</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token builtin" style="color:rgb(130, 170, 255)">bin</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysqld </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">defaults</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token builtin" style="color:rgb(130, 170, 255)">file</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cnf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LimitNOFILE </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2811-启动mysql检查启动">2.8.11 启动mysql、检查启动<a href="#2811-启动mysql检查启动" class="hash-link" aria-label="2.8.11 启动mysql、检查启动的直接链接" title="2.8.11 启动mysql、检查启动的直接链接">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 重新加载systemd系统服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl daemon</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token builtin" style="color:rgb(130, 170, 255)">reload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 启动mysql并加入开机自启</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl start mysqld </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> systemctl enable mysqld</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看mysql端口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ netstat </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">ntpl  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> grep </span><span class="token number" style="color:rgb(247, 140, 108)">3306</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tcp6       </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token number" style="color:rgb(247, 140, 108)">3306</span><span class="token plain">                 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">                    LISTEN      </span><span class="token number" style="color:rgb(247, 140, 108)">31349</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">mysqld  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2812-创建ambari数据库及授权">2.8.12 创建ambari数据库及授权<a href="#2812-创建ambari数据库及授权" class="hash-link" aria-label="2.8.12 创建ambari数据库及授权的直接链接" title="2.8.12 创建ambari数据库及授权的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mysql -uroot -e &quot;create database ambari character set utf8mb4&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mysql -uroot -e &quot;grant all on ambari.* to ambari@&#x27;localhost&#x27; identified by &#x27;ambari&#x27;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mysql -uroot -e &quot;grant all on ambari.* to ambari@&#x27;%&#x27; identified by &#x27;ambari&#x27;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mysql -uroot -e &quot;flush privileges&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3安装ambari">3.安装ambari<a href="#3安装ambari" class="hash-link" aria-label="3.安装ambari的直接链接" title="3.安装ambari的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-制作ambari本地源">3.1 制作ambari本地源<a href="#31-制作ambari本地源" class="hash-link" aria-label="3.1 制作ambari本地源的直接链接" title="3.1 制作ambari本地源的直接链接">​</a></h3>
<p><strong>各包大小</strong></p>
<blockquote>
<p><code>HDP-2.6.5.0-centos7-rpm.tar.gz</code> 6.8G</p>
<p><code>ambari-2.6.2.2-centos7.tar.gz</code> 1.7G</p>
<p><code>HDP-UTILS-1.1.0.22-centos7.tar.gz</code> 87M</p>
</blockquote>
<p><strong>下载 ambari 、HDP-UTILS、 HDP 包</strong></p>
<blockquote>
<p><a href="https://supportmatrix.hortonworks.com/" target="_blank" rel="noopener noreferrer">官方下载地址</a>，可以从这里下载不同版本的包</p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir /opt/ambari/yum &amp;&amp; cd /opt/ambari/yum</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.2.2/ambari-2.6.2.2-centos7.tar.gz</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0/HDP-2.6.5.0-centos7-rpm.tar.gz</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.22/repos/centos7/HDP-UTILS-1.1.0.22-centos7.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>将3个压缩包解压至 <code>/var/www/html/ambari</code></strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir /var/www/html/ambari</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar xf ambari-2.6.2.2-centos7.tar.gz -C /var/www/html/ambari</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar xf HDP-UTILS-1.1.0.22-centos7.tar.gz -C /var/www/html/ambari</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar xf HDP-2.6.5.0-centos7-rpm.tar.gz -C /var/www/html/ambari</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-安装制作本地yum源工具">3.2 安装制作本地yum源工具<a href="#32-安装制作本地yum源工具" class="hash-link" aria-label="3.2 安装制作本地yum源工具的直接链接" title="3.2 安装制作本地yum源工具的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum -y install yum-utils createrepo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-创建ambarihdphdp-utils的repo仓库">3.3 创建ambari、HDP、HDP-UTILS的repo仓库<a href="#33-创建ambarihdphdp-utils的repo仓库" class="hash-link" aria-label="3.3 创建ambari、HDP、HDP-UTILS的repo仓库的直接链接" title="3.3 创建ambari、HDP、HDP-UTILS的repo仓库的直接链接">​</a></h3>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p><strong>⚠️如果下载的版本不同，则需要修改  <code>baseurl</code> 和 <code>gpgcheck</code> 中的url路径</strong></p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="331-创建ambari的repo仓库">3.3.1 创建ambari的repo仓库<a href="#331-创建ambari的repo仓库" class="hash-link" aria-label="3.3.1 创建ambari的repo仓库的直接链接" title="3.3.1 创建ambari的repo仓库的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">source /opt/ambari/script/env.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt; /etc/yum.repos.d/ambari.repo &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ambari-2.6.2.2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">name=ambari-2.6.2.2-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">baseurl=http://${NODE_IPS}/ambari/ambari/centos7/2.6.2.2-1/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgcheck=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgkey=http://${NODE_IPS}/ambari/ambari/centos7/2.6.2.2-1/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">enabled=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">priority=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="332-创建hdphdp-utils的repo仓库">3.3.2 创建HDP、HDP-UTILS的repo仓库<a href="#332-创建hdphdp-utils的repo仓库" class="hash-link" aria-label="3.3.2 创建HDP、HDP-UTILS的repo仓库的直接链接" title="3.3.2 创建HDP、HDP-UTILS的repo仓库的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt; /etc/yum.repos.d/hdp.repo &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[HDP-2.6.5.0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">name=HDP-2.6.5.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">baseurl=http://${NODE_IPS}/ambari/HDP/centos7/2.6.5.0-292/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgcheck=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgkey=http://${NODE_IPS}/ambari/HDP/centos7/2.6.5.0-292/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">enabled=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">priority=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[HDP-UTILS-1.1.0.22]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">name=HDP-UTILS-1.1.0.22</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">baseurl=http://${NODE_IPS}/ambari/HDP-UTILS/centos7/1.1.0.22/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgcheck=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpgkey=http://${NODE_IPS}/ambari/HDP-UTILS/centos7/1.1.0.22/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">enabled=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">priority=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="333-生成本地缓存">3.3.3 生成本地缓存<a href="#333-生成本地缓存" class="hash-link" aria-label="3.3.3 生成本地缓存的直接链接" title="3.3.3 生成本地缓存的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum clean all &amp;&amp; yum makecache</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="334-通过本地源安装ambari">3.3.4 通过本地源安装ambari<a href="#334-通过本地源安装ambari" class="hash-link" aria-label="3.3.4 通过本地源安装ambari的直接链接" title="3.3.4 通过本地源安装ambari的直接链接">​</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p><strong>⚠️执行此命令会安装 ambari2.6.2.2 和 pg9.2.24</strong></p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum -y install ambari-server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4配置ambari">4.配置ambari<a href="#4配置ambari" class="hash-link" aria-label="4.配置ambari的直接链接" title="4.配置ambari的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-下载mysql驱动">4.1 下载mysql驱动<a href="#41-下载mysql驱动" class="hash-link" aria-label="4.1 下载mysql驱动的直接链接" title="4.1 下载mysql驱动的直接链接">​</a></h3>
<p><a href="https://downloads.mysql.com/archives/c-j/" target="_blank" rel="noopener noreferrer">mysql驱动官方下载地址</a></p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p><strong>由于使用的是mysql5.7，因此必须下载mysql5.7驱动，<span style="color:red">且必须放于 <code>/usr/share/java</code> 下</span></strong></p><p>否则后续会有如下报错，原因是 ambari 默认的 mysql jdbc 驱动不支持 5.6 以上版本</p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Configuring ambari database...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">WARNING: Before starting Ambari Server, you must copy the MySQL JDBC driver JAR file to /usr/share/java and set property &quot;server.jdbc.driver.path=[path/to/custom_jdbc_driver]&quot; in ambari.properties.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Press &lt;enter&gt; to continue.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR: Before starting Ambari Server, you must copy the MySQL JDBC driver JAR file to /usr/share/java and set property &quot;server.jdbc.driver.path=[path/to/custom_jdbc_driver]&quot; in ambari.properties.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR: Exiting with exit code -1. </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">REASON: Before starting Ambari Server, you must copy the MySQL JDBC driver JAR file to /usr/share/java and set property &quot;server.jdbc.driver.path=[path/to/custom_jdbc_driver]&quot; in ambari.properties.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 创建/usr/share/java目录</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ -d /usr/share/java ] || mkdir /usr/share/java &amp;&amp; cd /usr/share/java</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 下载mysql驱动</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget https://downloads.mysql.com/archives/get/p/3/file/mysql-connector-java-5.1.46.tar.gz</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 解压缩包</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tar xf mysql-connector-java-5.1.46.tar.gz </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 移动mysql驱动到/usr/share/java，且名称必须为 mysql-connector-java.jar</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mv mysql-connector-java-5.1.46/mysql-connector-java-5.1.46.jar /usr/share/java/mysql-connector-java.jar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-启动配置程序">4.2 启动配置程序<a href="#42-启动配置程序" class="hash-link" aria-label="4.2 启动配置程序的直接链接" title="4.2 启动配置程序的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-server setup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="421-提示是否自定义设置输入y">4.2.1 提示是否自定义设置	输入：y<a href="#421-提示是否自定义设置输入y" class="hash-link" aria-label="4.2.1 提示是否自定义设置	输入：y的直接链接" title="4.2.1 提示是否自定义设置	输入：y的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Customize user account for ambari-server daemon [y/n] (n)?</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="422-设置ambari-server-账号输入ambari">4.2.2 设置ambari-server 账号	输入：ambari<a href="#422-设置ambari-server-账号输入ambari" class="hash-link" aria-label="4.2.2 设置ambari-server 账号	输入：ambari的直接链接" title="4.2.2 设置ambari-server 账号	输入：ambari的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Enter user account for ambari-server daemon (root):</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="423-设置jdk输入3">4.2.3 设置JDK	输入：3<a href="#423-设置jdk输入3" class="hash-link" aria-label="4.2.3 设置JDK	输入：3的直接链接" title="4.2.3 设置JDK	输入：3的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Checking JDK...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[1] Oracle JDK 1.8 + Java Cryptography Extension (JCE) Policy Files 8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[2] Oracle JDK 1.7 + Java Cryptography Extension (JCE) Policy Files 7</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[3] Custom JDK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==============================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Enter choice (1): </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="424-设置jdk家目录输入usrlocaljdk180_251">4.2.4 设置JDK家目录	输入：/usr/local/jdk1.8.0_251<a href="#424-设置jdk家目录输入usrlocaljdk180_251" class="hash-link" aria-label="4.2.4 设置JDK家目录	输入：/usr/local/jdk1.8.0_251的直接链接" title="4.2.4 设置JDK家目录	输入：/usr/local/jdk1.8.0_251的直接链接">​</a></h4>
<p><strong>jdk的家目录路径是 /usr/local/jdk1.8.0_251</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">WARNING: JDK must be installed on all hosts and JAVA_HOME must be valid on all hosts.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">WARNING: JCE Policy files are required for configuring Kerberos security. If you plan to use Kerberos,please make sure JCE Unlimited Strength Jurisdiction Policy Files are valid on all hosts.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Path to JAVA_HOME:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="425-是否允许ambari服务器下载和安装gpl许可的lzo包输入y">4.2.5 是否允许Ambari服务器下载和安装GPL许可的LZO包	输入：y<a href="#425-是否允许ambari服务器下载和安装gpl许可的lzo包输入y" class="hash-link" aria-label="4.2.5 是否允许Ambari服务器下载和安装GPL许可的LZO包	输入：y的直接链接" title="4.2.5 是否允许Ambari服务器下载和安装GPL许可的LZO包	输入：y的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Enable Ambari Server to download and install GPL Licensed LZO packages [y/n] (n)?</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="426-数据库配置输入y">4.2.6 数据库配置	输入：y<a href="#426-数据库配置输入y" class="hash-link" aria-label="4.2.6 数据库配置	输入：y的直接链接" title="4.2.6 数据库配置	输入：y的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Enter advanced database configuration [y/n] (n)? </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="427-选择数据库类型输入3">4.2.7 选择数据库类型	输入：3<a href="#427-选择数据库类型输入3" class="hash-link" aria-label="4.2.7 选择数据库类型	输入：3的直接链接" title="4.2.7 选择数据库类型	输入：3的直接链接">​</a></h4>
<p><strong>输入3选择mysql</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Configuring database...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==============================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Choose one of the following options:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[1] - PostgreSQL (Embedded)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[2] - Oracle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[3] - MySQL / MariaDB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[4] - PostgreSQL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[5] - Microsoft SQL Server (Tech Preview)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[6] - SQL Anywhere</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[7] - BDB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==============================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Enter choice (1): </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="428-数据库信息填写">4.2.8 数 据库信息填写<a href="#428-数据库信息填写" class="hash-link" aria-label="4.2.8 数据库信息填写的直接链接" title="4.2.8 数据库信息填写的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Enter choice (1): 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Hostname (localhost): 		#默认即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Port (3306): 		#默认3306</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Database name (ambari): 	#这里数据库名称为ambari</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Username (ambari): 		#数据库用户名是ambari</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Enter Database Password (bigdata): 		#用户ambari的密码是ambari</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Re-enter password: 		#确认密码</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Configuring ambari database...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="429-继续配置远程数据库连接属性输入y">4.2.9 继续配置远程数据库连接属性	输入：y<a href="#429-继续配置远程数据库连接属性输入y" class="hash-link" aria-label="4.2.9 继续配置远程数据库连接属性	输入：y的直接链接" title="4.2.9 继续配置远程数据库连接属性	输入：y的直接链接">​</a></h4>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p><strong>⚠️需要导入 <code>/var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql</code>到ambari数据库中</strong></p></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">WARNING: Before starting Ambari Server, you must run the following DDL against the database to create the schema: /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Proceed with configuring remote database connection properties [y/n] (y)?</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>提示如下即为成功</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Extracting system views...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-admin-2.6.2.2.1.jar</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...........</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adjusting ambari-server permissions and ownership...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Ambari Server &#x27;setup&#x27; completed successfully.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4210-导入数据库">4.2.10 导入数据库<a href="#4210-导入数据库" class="hash-link" aria-label="4.2.10 导入数据库的直接链接" title="4.2.10 导入数据库的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mysql -uroot -D ambari -e &quot;source /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-启动ambari">4.3 启动ambari<a href="#43-启动ambari" class="hash-link" aria-label="4.3 启动ambari的直接链接" title="4.3 启动ambari的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-server start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>提示如下即为成功</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Using python  /usr/bin/python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Starting ambari-server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Ambari Server running with administrator privileges.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Organizing resource files at /var/lib/ambari-server/resources...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Ambari database consistency check started...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Server PID at: /var/run/ambari-server/ambari-server.pid</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Server out at: /var/log/ambari-server/ambari-server.out</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Server log at: /var/log/ambari-server/ambari-server.log</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Waiting for server start........................</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Server started listening on 8080</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DB configs consistency check: no errors and warnings were found.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Ambari Server &#x27;start&#x27; completed successfully.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-登陆ambari">4.4 登陆ambari<a href="#44-登陆ambari" class="hash-link" aria-label="4.4 登陆ambari的直接链接" title="4.4 登陆ambari的直接链接">​</a></h3>
<p><strong>浏览器访问 <code>http://IP:8080</code></strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2010.12.43.png" alt="iShot2020-09-15 10.12.43" class="img_ev3q"></p>
<p><strong>登陆后首界面</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2010.13.09.png" alt="iShot2020-09-15 10.13.09" class="img_ev3q"></p>
<p><strong><span style="color:red">到此，ambari安装成功！！！</span></strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5使用ambari界面安装大数据组件">5.使用Ambari界面安装大数据组件<a href="#5使用ambari界面安装大数据组件" class="hash-link" aria-label="5.使用Ambari界面安装大数据组件的直接链接" title="5.使用Ambari界面安装大数据组件的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-启动安装向导">5.1 启动安装向导<a href="#51-启动安装向导" class="hash-link" aria-label="5.1 启动安装向导的直接链接" title="5.1 启动安装向导的直接链接">​</a></h3>
<p><strong>选择 <code>Launch Install Wizard</code></strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2010.17.22.png" alt="iShot2020-09-15 10.17.22" class="img_ev3q"></p>
<p><strong>输入集群名称</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2010.20.01.png" alt="iShot2020-09-15 10.20.01" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-选择集群版本配置集群本地源">5.2 选择集群版本、配置集群本地源<a href="#52-选择集群版本配置集群本地源" class="hash-link" aria-label="5.2 选择集群版本、配置集群本地源的直接链接" title="5.2 选择集群版本、配置集群本地源的直接链接">​</a></h3>
<p>这里选择 HDP-2.6.5.0 版本</p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2010.22.13.png" alt="iShot2020-09-15 10.22.13" class="img_ev3q"></p>
<p><strong>保留 redhat7 一处，删除其他</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2010.24.07.png" alt="iShot2020-09-15 10.24.07" class="img_ev3q"></p>
<p><strong>设置HDP安装源，修改为本地源</strong></p>
<p><strong>原先默认源</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">HDP-2.6	http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">HDP-2.6-GPL	http://public-repo-1.hortonworks.com/HDP-GPL/centos7/2.x/updates/2.6.5.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">HDP-UTILS-1.1.0.22	http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.22/repos/centos7</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>HDP-2.6、HDP-2.6-GPL、HDP-UTILS-1.1.0.22 依次修改为如下</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">http://10.0.0.136/ambari/ambari/centos7/2.6.2.2-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">http://10.0.0.136/ambari/HDP/centos7/2.6.5.0-292</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">http://10.0.0.136/ambari/HDP-UTILS/centos7/1.1.0.22</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>修改完成后点击下一步</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2010.28.55.png" alt="iShot2020-09-15 10.28.55" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-配置安装选项">5.3 配置安装选项<a href="#53-配置安装选项" class="hash-link" aria-label="5.3 配置安装选项的直接链接" title="5.3 配置安装选项的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="531-修改配置文件">5.3.1 修改配置文件<a href="#531-修改配置文件" class="hash-link" aria-label="5.3.1 修改配置文件的直 接链接" title="5.3.1 修改配置文件的直接链接">​</a></h4>
<p>需要修改配置文件中https为http，否则后续会有类似如下报错</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR 2020-09-15 01:34:45,716 NetUtil.py:96-EOF occurred in vic lation of protocol (_ssl.c:618)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR 2020-09-15 01:34:45,716 NetUtil.py:97-SSLError:Failed to connect. Please check openssl Library versions.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Refer to:https://bugzilla.redhat.com/show_bug.cgi?id=1022468 for more details.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>1.修改 <code>/etc/python/cert-verification.cfg</code> 中 <code>verify=platform_default</code>  为 <code>verify=disable</code></strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i.bak &#x27;/^verify/cverify=disable&#x27; /etc/python/cert-verification.cfg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>2.修改 <code>/etc/ambari-agent/conf/ambari-agent.ini</code> 中 <code>[security]</code> 标签后加入以下两行内容</strong></p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p><strong>⚠️这一步必须在 <code>Confirm Hosts</code> 进行安装后才会有相应的文件，也就是说进入到 <code>Confirm Hosts</code> 这一步中注册主机稍等一会才可以进行修改文件操作(目前了解是这样，不知道有没有更好的方法)</strong></p></div></div>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-17%2018.38.49.png" alt="iShot2020-09-17 18.38.49" class="img_ev3q"></p>
<p><strong>上图界面稍等几十秒然后再进行以下操作</strong></p>
<p><strong><code>ssl_verify_cert=0</code></strong>
<strong><code>force_https_protocol=PROTOCOL_TLSv1_2</code></strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i.bak -e &#x27;/^credential_shell_cmd/assl_verify_cert=0\nforce_https_protocol=PROTOCOL_TLSv1_2&#x27; /etc/ambari-agent/conf/ambari-agent.ini</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>以上两步修改完成后需要重启 ambari-agent</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-agent restart</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="532-配置集群节点信息">5.3.2 配置集群节点信息<a href="#532-配置集群节点信息" class="hash-link" aria-label="5.3.2 配置集群节点信息的直接链接" title="5.3.2 配置集群节点信息的直接链接">​</a></h4>
<p><strong>输入集群节点FQDN式主机名、ambari-server的私钥、ambari-server的用户名和ssh端口</strong></p>
<p><strong>各节点 hosts 信息</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">10.0.0.136 ambari-server01.test.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">10.0.0.137 ambari-agent01.test.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">10.0.0.138 ambari-agent02.test.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p><strong>⚠️⚠️⚠️<span style="color:red"><code>Target Hosts</code> 处一定不要写IP地址，一定要写成FQDN式的主机名</span></strong></p></div></div>
<p><strong>集群节点 <code>Target Hosts</code> 处要写成如下</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-server01.test.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-agent01.test.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-agent02.test.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2010.45.51.png" alt="iShot2020-09-15 10.45.51" class="img_ev3q"></p>
<p><strong>否则就会报错如下，非常坑</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR 2020-09-14 17:07:52,075 main.py:246 - Ambari agent machine hostname (ambari01.hadoop) does not match expected ambari server hostname (10.0.0.136). Aborting registration. Please check hostname, hostname -f and /etc/hosts file to confirm your hostname is setup correctly</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>注册成功后显示如下</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2014.07.53.png" alt="iShot2020-09-15 14.07.53" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p><strong>⚠️5.3.3为遇到的问及记录</strong></p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="533-ambari安装到-confirm-hosts遇到的报错">5.3.3 ambari安装到 <code>Confirm Hosts</code>遇到的报错<a href="#533-ambari安装到-confirm-hosts遇到的报错" class="hash-link" aria-label="533-ambari安装到-confirm-hosts遇到的报错的直接链接" title="533-ambari安装到-confirm-hosts遇到的报错的直接链接">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5331-报错1找不到-ambari-server">5.3.3.1 报错1	找不到 ambari server<a href="#5331-报错1找不到-ambari-server" class="hash-link" aria-label="5.3.3.1 报错1	找不到 ambari server的直接链接" title="5.3.3.1 报错1	找不到 ambari server的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-14%2017.00.15.png" alt="iShot2020-09-14 17.00.15" class="img_ev3q"></p>
<p><strong>重要日志</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-14%2017.01.54.png" alt="iShot2020-09-14 17.01.54" class="img_ev3q"></p>
<p><strong>解决方法</strong></p>
<p><strong>集群节点 <code>Target Hosts</code> 处主机信息要写成如下FQDN式</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-server01.test.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-agent01.test.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-agent02.test.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5332-报错2-sslerror">5.3.3.2 报错2 SSLError<a href="#5332-报错2-sslerror" class="hash-link" aria-label="5.3.3.2 报错2 SSLError的直接链接" title="5.3.3.2 报错2 SSLError的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2011.08.04.png" alt="iShot2020-09-15 11.08.04" class="img_ev3q"></p>
<p><strong>5.2步骤中修改了HDP源为本地</strong></p>
<p><strong>HDP-2.6、HDP-2.6-GPL、HDP-UTILS-1.1.0.22 依次修改为如下</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">http://10.0.0.136/ambari/ambari/centos7/2.6.2.2-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">http://10.0.0.136/ambari/HDP/centos7/2.6.5.0-292</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">http://10.0.0.136/ambari/HDP-UTILS/centos7/1.1.0.22</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>解决方法</strong></p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p><strong>⚠️<span style="color:red">以下操作需要在所有节点修改</span></strong></p></div></div>
<p>1.修改 <code>/etc/python/cert-verification.cfg</code> 中 <code>verify=platform_default</code>  为 <code>verify=disable</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i.bak &#x27;/^verify/cverify=disable&#x27; /etc/python/cert-verification.cfg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2.修改 <code>/etc/ambari-agent/conf/ambari-agent.ini</code> 中 <code>[security]</code> 标签后加入以下两行内容</p>
<p><code>ssl_verify_cert=0</code>
<code>force_https_protocol=PROTOCOL_TLSv1_2</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sed -i.bak -e &#x27;/^credential_shell_cmd/assl_verify_cert=0\nforce_https_protocol=PROTOCOL_TLSv1_2&#x27; /etc/ambari-agent/conf/ambari-agent.ini</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>重启 ambari-agent</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-agent restart</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-选择需要安装的组件">5.4 选择需要安装的组件<a href="#54-选择需要安装的组件" class="hash-link" aria-label="5.4 选择需要安装的组件的直接链接" title="5.4 选择需要安装的组件的直接链接">​</a></h3>
<p><strong>根据实际情况选择要安装的组件</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2014.18.23.png" alt="iShot2020-09-15 14.18.23" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="55-分配管理  端服务">5.5 分配管理端服务<a href="#55-分配管理端服务" class="hash-link" aria-label="5.5 分配管理端服务的直接链接" title="5.5 分配管理端服务的直接链接">​</a></h3>
<p><strong>根据实际情况选择各组件安装的节点</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2014.35.15.png" alt="iShot2020-09-15 14.35.15" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="56-定制服务">5.6 定制服务<a href="#56-定制服务" class="hash-link" aria-label="5.6 定制服务的直接链接" title="5.6 定制服务的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="561-hdfs">5.6.1 HDFS<a href="#561-hdfs" class="hash-link" aria-label="5.6.1 HDFS的直接链接" title="5.6.1 HDFS的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2016.00.36.png" alt="iShot2020-09-15 16.00.36" class="img_ev3q"></p>
<p>只保留一个路径</p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2016.01.23.png" alt="iShot2020-09-15 16.01.23" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="562-yarn">5.6.2 YARN<a href="#562-yarn" class="hash-link" aria-label="5.6.2 YARN的直接链接" title="5.6.2 YARN的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2016.05.09.png" alt="iShot2020-09-15 16.05.09" class="img_ev3q"></p>
<p>只保留一个路径</p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2016.14.29.png" alt="iShot2020-09-15 16.14.29" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="563-hive">5.6.3 HIVE<a href="#563-hive" class="hash-link" aria-label="5.6.3 HIVE的直接链接" title="5.6.3 HIVE的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2016.27.42.png" alt="iShot2020-09-15 16.27.42" class="img_ev3q"></p>
<p><strong>指定mysql驱动位置，否则hive连接数据库会失败</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ambari-server setup --jdbc-db=mysql --jdbc-driver=/usr/share/java/mysql-connector-java.jar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>输出如下即为成功</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Using python  /usr/bin/python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Setup ambari-server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Copying /usr/share/java/mysql-connector-java.jar to /var/lib/ambari-server/resources</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you are updating existing jdbc driver jar for mysql with mysql-connector-java.jar. Please remove the old driver jar, from all hosts. Restarting services that need the driver, will automatically copy the new jar to the hosts.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">JDBC driver was successfully initialized.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Ambari Server &#x27;setup&#x27; completed successfully.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>创建hive数据库及授权</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mysql -uroot -e &quot;create database hive character set utf8mb4&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mysql -uroot -e &quot;grant all on hive.* to hivei@&#x27;localhost&#x27; identified by &#x27;hive&#x27;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mysql -uroot -e &quot;grant all on hive.* to hive@&#x27;%&#x27; identified by &#x27;hive&#x27;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mysql -uroot -e &quot;flush privileges&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>选择 <code>Existing MySQL / MariaDB Database</code> ，输入hive数据库密码，修改 <code>Database URL</code> 连接地址，测试连接成功即可</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2016.37.23.png" alt="iShot2020-09-15 16.37.23" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="564-ambari-metrics">5.6.4 Ambari Metrics<a href="#564-ambari-metrics" class="hash-link" aria-label="5.6.4 Ambari Metrics的直接链接" title="5.6.4 Ambari Metrics的直接链接">​</a></h4>
<p><strong>需要设置grafana管理员用户的密码</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2016.41.09.png" alt="iShot2020-09-15 16.41.09" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2016.43.35.png" alt="iShot2020-09-15 16.43.35" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="565-atlas">5.6.5 Atlas<a href="#565-atlas" class="hash-link" aria-label="5.6.5 Atlas的直接链接" title="5.6.5 Atlas的直接链接">​</a></h4>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p><strong>⚠️⚠️⚠️最好不要选择这个Atlas，网上查了半天也不知道标红的这两处该怎么写以及怎么查找</strong></p></div></div>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2017.08.42.png" alt="iShot2020-09-15 17.08.42" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="566-smartsense">5.6.6 SmartSense<a href="#566-smartsense" class="hash-link" aria-label="5.6.6 SmartSense的直接链接" title="5.6.6 SmartSense的直接链接">​</a></h4>
<p><strong>需要输入密码，默认admin即可</strong></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2016.48.25.png" alt="iShot2020-09-15 16.48.25" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2017.12.39.png" alt="iShot2020-09-15 17.12.39" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="57-确认集群信息并部署">5.7 确认集群信息并部署<a href="#57-确认集群信息并部署" class="hash-link" aria-label="5.7 确认集群信 息并部署的直接链接" title="5.7 确认集群信息并部署的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2017.14.28.png" alt="iShot2020-09-15 17.14.28" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2017.15.07.png" alt="iShot2020-09-15 17.15.07" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2017.16.19.png" alt="iShot2020-09-15 17.16.19" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2018.45.14.png" alt="iShot2020-09-15 18.45.14" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="58-完成安装">5.8 完成安装<a href="#58-完成安装" class="hash-link" aria-label="5.8 完成安装的直接链接" title="5.8 完成安装的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2018.45.58.png" alt="iShot2020-09-15 18.45.58" class="img_ev3q"></p>
<p>完成安装</p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-09-15%2018.46.54.png" alt="iShot2020-09-15 18.46.54" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/idea/vscode/vscode配置记录"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">vscode配置记录</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/linux/big-data/Ambari/ambari下载"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">ambari下载</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1ambari简介" class="table-of-contents__link toc-highlight">1.Ambari简介</a></li><li><a href="#2环境准备" class="table-of-contents__link toc-highlight">2.环境准备</a><ul><li><a href="#20-安装纯净系统后执行的脚本" class="table-of-contents__link toc-highlight">2.0 安装纯净系统后执行的脚本</a></li><li><a href="#21-实验环境" class="table-of-contents__link toc-highlight">2.1 实验环境</a></li><li><a href="#22-配置ssh免密" class="table-of-contents__link toc-highlight">2.2 配置ssh免密</a><ul><li><a href="#221-编辑环境变量文件" class="table-of-contents__link toc-highlight">2.2.1 编辑环境变量文件</a></li><li><a href="#222-生成密钥对" class="table-of-contents__link toc-highlight">2.2.2 生成密钥对</a></li><li><a href="#223-编辑expect自动化交互脚本" class="table-of-contents__link toc-highlight">2.2.3 编辑expect自动化交互脚本</a></li><li><a href="#224-编辑shell脚本循环执行expect脚本" class="table-of-contents__link toc-highlight">2.2.4 编辑shell脚本循环执行expect脚本</a></li></ul></li><li><a href="#23-每个节点配置hosts信息" class="table-of-contents__link toc-highlight">2.3 每个节点配置hosts信息</a></li><li><a href="#24-禁用防火墙和selinux" class="table-of-contents__link toc-highlight">2.4 禁用防火墙和selinux</a></li><li><a href="#25-安装jdk8" class="table-of-contents__link toc-highlight">2.5 安装JDK8</a><ul><li><a href="#251-安装说明" class="table-of-contents__link toc-highlight">2.5.1 安装说明</a></li><li><a href="#252-编写jdk安装脚本" class="table-of-contents__link toc-highlight">2.5.2 编写jdk安装脚本</a></li><li><a href="#253-拷贝jdk安装包和jdk安装脚本到其余节点" class="table-of-contents__link toc-highlight">2.5.3 拷贝jdk安装包和jdk安装脚本到其余节点</a></li><li><a href="#254-所有节点执行jdk安装脚本" class="table-of-contents__link toc-highlight">2.5.4 所有节点执行jdk安装脚本</a></li></ul></li><li><a href="#26-配置时间同步" class="table-of-contents__link toc-highlight">2.6 配置时间同步</a><ul><li><a href="#261-各节点安装chrony" class="table-of-contents__link toc-highlight">2.6.1 各节点安装chrony</a></li><li><a href="#262-cdh-master节点修改服务器地址为阿里云" class="table-of-contents__link toc-highlight">2.6.2 cdh master节点修改服务器地址为阿里云</a></li><li><a href="#263-alave节点修改同步服务器为master节点" class="table-of-contents__link toc-highlight">2.6.3 alave节点修改同步服务器为master节点</a></li><li><a href="#264-启动chronyd服务并设置开机自启" class="table-of-contents__link toc-highlight">2.6.4 启动chronyd服务并设置开机自启</a></li><li><a href="#265-检查端口chronyd监听udp323端口" class="table-of-contents__link toc-highlight">2.6.5 检查端口，chronyd监听udp323端口</a></li><li><a href="#266-检查同步" class="table-of-contents__link toc-highlight">2.6.6 检查同步</a></li></ul></li><li><a href="#27-安装apache" class="table-of-contents__link toc-highlight">2.7 安装apache</a></li><li><a href="#28-安装mysql" class="table-of-contents__link toc-highlight">2.8 安装mysql</a><ul><li><a href="#281-下载二进制包" class="table-of-contents__link toc-highlight">2.8.1 下载二进制包</a></li><li><a href="#282-解压缩mysql二进制包到usrlocal" class="table-of-contents__link toc-highlight">2.8.2 解压缩mysql二进制包到/usr/local</a></li><li><a href="#283-修改名称做软连接" class="table-of-contents__link toc-highlight">2.8.3 修改名称、做软连接</a></li><li><a href="#284-创建mysql用户" class="table-of-contents__link toc-highlight">2.8.4 创建mysql用户</a></li><li><a href="#285-编辑主配置文件myql-5730二进制包默认没有mysql配置文件" class="table-of-contents__link toc-highlight">2.8.5 编辑主配置文件，myql-5.7.30二进制包默认没有mysql配置文件</a></li><li><a href="#286-创建socker文件目录目录文件授权" class="table-of-contents__link toc-highlight">2.8.6 创建socker文件目录、目录文件授权</a></li><li><a href="#287-拷贝启动脚本" class="table-of-contents__link toc-highlight">2.8.7 拷贝启动脚本</a></li><li><a href="#288-初始化mysql" class="table-of-contents__link toc-highlight">2.8.8 初始化mysql</a></li><li><a href="#289-添加mysql命令环境变量" class="table-of-contents__link toc-highlight">2.8.9 添加mysql命令环境变量</a></li><li><a href="#2810-配置systemd管理mysql" class="table-of-contents__link toc-highlight">2.8.10 配置systemd管理mysql</a></li><li><a href="#2811-启动mysql检查启动" class="table-of-contents__link toc-highlight">2.8.11 启动mysql、检查启动</a></li><li><a href="#2812-创建ambari数据库及授权" class="table-of-contents__link toc-highlight">2.8.12 创建ambari数据库及授权</a></li></ul></li></ul></li><li><a href="#3安装ambari" class="table-of-contents__link toc-highlight">3.安装ambari</a><ul><li><a href="#31-制作ambari本地源" class="table-of-contents__link toc-highlight">3.1 制作ambari本地源</a></li><li><a href="#32-安装制作本地yum源工具" class="table-of-contents__link toc-highlight">3.2 安装制作本地yum源工具</a></li><li><a href="#33-创建ambarihdphdp-utils的repo仓库" class="table-of-contents__link toc-highlight">3.3 创建ambari、HDP、HDP-UTILS的repo仓库</a><ul><li><a href="#331-创建ambari的repo仓库" class="table-of-contents__link toc-highlight">3.3.1 创建ambari的repo仓库</a></li><li><a href="#332-创建hdphdp-utils的repo仓库" class="table-of-contents__link toc-highlight">3.3.2 创建HDP、HDP-UTILS的repo仓库</a></li><li><a href="#333-生成本地缓存" class="table-of-contents__link toc-highlight">3.3.3 生成本地缓存</a></li><li><a href="#334-通过本地源安装ambari" class="table-of-contents__link toc-highlight">3.3.4 通过本地源安装ambari</a></li></ul></li></ul></li><li><a href="#4配置ambari" class="table-of-contents__link toc-highlight">4.配置ambari</a><ul><li><a href="#41-下载mysql驱动" class="table-of-contents__link toc-highlight">4.1 下载mysql驱动</a></li><li><a href="#42-启动配置程序" class="table-of-contents__link toc-highlight">4.2 启动配置程序</a><ul><li><a href="#421-提示是否自定义设置输入y" class="table-of-contents__link toc-highlight">4.2.1 提示是否自定义设置	输入：y</a></li><li><a href="#422-设置ambari-server-账号输入ambari" class="table-of-contents__link toc-highlight">4.2.2 设置ambari-server 账号	输入：ambari</a></li><li><a href="#423-设置jdk输入3" class="table-of-contents__link toc-highlight">4.2.3 设置JDK	输入：3</a></li><li><a href="#424-设置jdk家目录输入usrlocaljdk180_251" class="table-of-contents__link toc-highlight">4.2.4 设置JDK家目录	输入：/usr/local/jdk1.8.0_251</a></li><li><a href="#425-是否允许ambari服务器下载和安装gpl许可的lzo包输入y" class="table-of-contents__link toc-highlight">4.2.5 是否允许Ambari服务器下载和安装GPL许可的LZO包	输入：y</a></li><li><a href="#426-数据库配置输入y" class="table-of-contents__link toc-highlight">4.2.6 数据库配置	输入：y</a></li><li><a href="#427-选择数据库类型输入3" class="table-of-contents__link toc-highlight">4.2.7 选择数据库类型	输入：3</a></li><li><a href="#428-数据库信息填写" class="table-of-contents__link toc-highlight">4.2.8 数据库信息填写</a></li><li><a href="#429-继续配置远程数据库连接属性输入y" class="table-of-contents__link toc-highlight">4.2.9 继续配置远程数据库连接属性	输入：y</a></li><li><a href="#4210-导入数据库" class="table-of-contents__link toc-highlight">4.2.10 导入数据库</a></li></ul></li><li><a href="#43-启动ambari" class="table-of-contents__link toc-highlight">4.3 启动ambari</a></li><li><a href="#44-登陆ambari" class="table-of-contents__link toc-highlight">4.4 登陆ambari</a></li></ul></li><li><a href="#5使用ambari界面安装大数据组件" class="table-of-contents__link toc-highlight">5.使用Ambari界面安装大数据组件</a><ul><li><a href="#51-启动安装向导" class="table-of-contents__link toc-highlight">5.1 启动安装向导</a></li><li><a href="#52-选择集群版本配置集群本地源" class="table-of-contents__link toc-highlight">5.2 选择集群版本、配置集群本地源</a></li><li><a href="#53-配置安装选项" class="table-of-contents__link toc-highlight">5.3 配置安装选项</a><ul><li><a href="#531-修改配置文件" class="table-of-contents__link toc-highlight">5.3.1 修改配置文件</a></li><li><a href="#532-配置集群节点信息" class="table-of-contents__link toc-highlight">5.3.2 配置集群节点信息</a></li><li><a href="#533-ambari安装到-confirm-hosts遇到的报错" class="table-of-contents__link toc-highlight">5.3.3 ambari安装到 <code>Confirm Hosts</code>遇到的报错</a></li><li><a href="#5331-报错1找不到-ambari-server" class="table-of-contents__link toc-highlight">5.3.3.1 报错1	找不到 ambari server</a></li><li><a href="#5332-报错2-sslerror" class="table-of-contents__link toc-highlight">5.3.3.2 报错2 SSLError</a></li></ul></li><li><a href="#54-选择需要安装的组件" class="table-of-contents__link toc-highlight">5.4 选择需要安装的组件</a></li><li><a href="#55-分配管理端服务" class="table-of-contents__link toc-highlight">5.5 分配管理端服务</a></li><li><a href="#56-定制服务" class="table-of-contents__link toc-highlight">5.6 定制服务</a><ul><li><a href="#561-hdfs" class="table-of-contents__link toc-highlight">5.6.1 HDFS</a></li><li><a href="#562-yarn" class="table-of-contents__link toc-highlight">5.6.2 YARN</a></li><li><a href="#563-hive" class="table-of-contents__link toc-highlight">5.6.3 HIVE</a></li><li><a href="#564-ambari-metrics" class="table-of-contents__link toc-highlight">5.6.4 Ambari Metrics</a></li><li><a href="#565-atlas" class="table-of-contents__link toc-highlight">5.6.5 Atlas</a></li><li><a href="#566-smartsense" class="table-of-contents__link toc-highlight">5.6.6 SmartSense</a></li></ul></li><li><a href="#57-确认集群信息并部署" class="table-of-contents__link toc-highlight">5.7 确认集群信息并部署</a></li><li><a href="#58-完成安装" class="table-of-contents__link toc-highlight">5.8 完成安装</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">笔记</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 泡泡吐肥皂o</div></div></div></footer></div>
</body>
</html>