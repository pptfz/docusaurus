<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-云原生/k8s/k8s知识点/pod/图解kubernetes pod创建流程大揭秘" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">图解kubernetes pod创建流程大揭秘 | 我的站点</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://pptfz.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://pptfz.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://pptfz.github.io/docs/云原生/k8s/k8s知识点/pod/图解kubernetes pod创建流程大揭秘"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="图解kubernetes pod创建流程大揭秘 | 我的站点"><meta data-rh="true" name="description" content="[toc]"><meta data-rh="true" property="og:description" content="[toc]"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pptfz.github.io/docs/云原生/k8s/k8s知识点/pod/图解kubernetes pod创建流程大揭秘"><link data-rh="true" rel="alternate" href="https://pptfz.github.io/docs/云原生/k8s/k8s知识点/pod/图解kubernetes pod创建流程大揭秘" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://pptfz.github.io/docs/云原生/k8s/k8s知识点/pod/图解kubernetes pod创建流程大揭秘" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://SICNXLSDBZ-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="我的站点" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.061a1b25.css">
<script src="/assets/js/runtime~main.11d7a557.js" defer="defer"></script>
<script src="/assets/js/main.21de94ca.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="announcementBar_mb4j" style="background-color:pink;color:@091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">一名运维，两台电脑，三餐不定，只为设备工作四平八稳，拼得五脏俱损，六神无主，仍然七点起床，八点出发，晚上九点不返，十分辛苦！<br> 十年运维，九转功成，八面张罗，忙得七窍流血，换得六神不宁，五体欠安，仍然四处奔波，三更不眠，只为两个铜板，一生拼搏！</div></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">我的站点</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">笔记</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">😂 😂  😂</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/github/github下载加速">github</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/go/go功能脚本/k8s/获取k8s集群资源配置">go</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/idea/vscode/vscode好用的插件">idea</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/linux/big-data/Ambari/CentOS7中用Ambari快速搭建大数据平台">linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/mac专区/brew安装">mac专区</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/python/python-other/nginx+django+uwsgi部署项目">python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/web/css/css基础知识">web</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/云原生/k8s/helm/helm3安装">云原生</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/云原生/k8s/helm/helm3安装">k8s</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/helm/helm3安装">helm</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s下载/下载k8s二进制包">k8s下载</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s命令/kubectl top命令解析">k8s命令</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s安装/CentOS7.9二进制安装k8s-v1.20.15">k8s安装</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s常用命令速查">k8s常用命令速查</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s故障/使用config文件连接k8s集群遇到的问题">k8s故障</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/云原生/k8s/k8s知识点/k8s基础操作">k8s知识点</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s知识点/k8s基础操作">k8s基础操作</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s知识点/kubeconfig/使用kubecm管理多集群kubeconfig">kubeconfig</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/Downward API">pod</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/Downward API">Downward API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/init容器">init容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/pod hook">pod hook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/pod健康检查">pod健康检查</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/pod创建流程代码版本kubelet篇">pod创建流程代码版本kubelet篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/pod生命周期">pod生命周期</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/pod简介">pod简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/yaml文件">yaml文件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/云原生/k8s/k8s知识点/pod/图解kubernetes pod创建流程大揭秘">图解kubernetes pod创建流程大揭秘</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s知识点/存储/OpenEBS">存储</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s知识点/工作负载/CronJob/CronJob简介">工作负载</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s知识点/文章/k8s强制删除namespace">文章</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s知识点/服务、负载均衡和联网/ingress/ingress-nginx/ingress-nginx安装">服务、负载均衡和联网</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s知识点/调度、抢占和驱逐/将Pod调度到指定节点">调度、抢占和驱逐</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s知识点/配置/ConfigMap/ConfigMap简介">配置</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/k8s证书/kubeam安装k8s生成的证书">k8s证书</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/学习工具/kind/kind问题">学习工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/k8s/监控/metrics-server/metrics server">监控</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/云原生工具/harbor/harbor安装">云原生工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/容器/containerd/containerd 高级命令行工具 nerdctl">容器</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/云原生/监控/prometheus/prometheus安装">监控</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/其他/wps/wps冻结窗口">其他</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/博客工具/Docusaurus/Docusaurus 安装">博客工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/操作小技巧/linux/linux一些骚操作">操作小技巧</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/数据库/mongodb/centos7安装mongodb">数据库</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/翻车问题合集/翻车问题-ssh密钥问题">翻车问题合集</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">云原生</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">k8s</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">k8s知识点</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">pod</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">图解kubernetes pod创建流程大揭秘</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><p>[toc]</p>
<h1>图解kubernetes Pod创建流程大揭秘</h1>
<p><a href="https://www.kubernetes.org.cn/6766.html" target="_blank" rel="noopener noreferrer">本文严重抄袭至互联网</a></p>
<p>kubernetes中的容器创建无疑是个复杂的过程，涉及内部各种组件的统一协作，还有对接外部的CRI运行时，本文尝试初探一下容器创建流程中的各种细节，了解其各种组件协作流程，从而在后续出现问题的时候，也好能大概有点排查方向</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-基础筑基">1. 基础筑基<a href="#1-基础筑基" class="hash-link" aria-label="1. 基础筑基的直接链接" title="1. 基础筑基的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-容器管理线程模型">1.1 容器管理线程模型<a href="#11-容器管理线程模型" class="hash-link" aria-label="1.1 容器管理线程模型的直接链接" title="1.1 容器管理线程模型的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-15%2016.26.35.png" alt="iShot2020-10-15 16.26.35" class="img_ev3q"></p>
<p>kubelet中的线程模型属于master/wroker模型，通过单master来监听各种事件源，并为每个Pod创建一个goroutine来进行Pod业务逻辑的处理，master和wroker之间通过一个状态管道来进行通信</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-基于事件驱动的状态最终一致性">1.2 基于事件驱动的状态最终一致性<a href="#12-基于事件驱动的状态最终一致性" class="hash-link" aria-label="1.2 基于事件驱动的状态最终一致性的直接链接" title="1.2 基于事件驱动的状态最终一致性的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-15%2016.26.59.png" alt="iShot2020-10-15 16.26.59" class="img_ev3q"></p>
<p>在通过yaml创建Pod之后，kubernetes会根据当前的事件和当前的Pod状态，来不断进行调整，从而达到最终目标状态的一致性</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-组件协作流程">1.3 组件协作流程<a href="#13-组件协作流程" class="hash-link" aria-label="1.3 组件协作流程的直接链接" title="1.3 组件协作流程的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-15%2016.27.31.png" alt="iShot2020-10-15 16.27.31" class="img_ev3q"></p>
<p>kubelet的结构体声明就高达300多行代码，可见其复杂程度，但是我们按照容器创建这个流程，我们去观察其核心流程，其实主要可以概括为三部分：kubelet、containerRuntime、CRI容器运行时</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2kubelet创建容器流程">2.Kubelet创建容器流程<a href="#2kubelet创建容器流程" class="hash-link" aria-label="2.Kubelet创建容器流程的直接链接" title="2.Kubelet创建容器流程的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-15%2016.27.50.png" alt="iShot2020-10-15 16.27.50" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-获取pod进行准入检查">2.1 获取Pod进行准入检查<a href="#21-获取pod进行准入检查" class="hash-link" aria-label="2.1 获取Pod进行准入检查的直接链接" title="2.1 获取Pod进行准入检查的直接链接">​</a></h3>
<p>kubelet的事件源主要包含  两个部分：静态Pod和Apiserver，我们这里只考虑普通的Pod，则会直接将Pod加入到PodManager来进行管理，并且进行准入检查</p>
<p>准入检查主要包含两个关键的控制器：驱逐管理与预选检查驱逐管理主要是根据当前的资源压力，检测对应的Pod是否容忍当前的资源压力；预选检查则是根据当前活跃的容器和当前节点的信息来检查是否满足当前Pod的基础运行环境，例如亲和性检查，同时如果当前的Pod的优先级特别高或者是静态Pod，则会尝试为其进行资源抢占，会按照QOS等级逐级来进行抢占从而满足其运行环境</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-创建事件管道与容器管理主线程">2.2 创建事件管道与容器管理主线程<a href="#22-创建事件管道与容器管理主线程" class="hash-link" aria-label="2.2 创建事件管道与容器管理主线程的直接链接" title="2.2 创建事件管道与容器管理主线程的直接链接">​</a></h3>
<p>kubelet接收到一个新创建的Pod首先会为其创建一个事件管道，并且启动一个容器管理的主线程消费管道里面的事件，并且会基于最后同步时间来等待当前kubelet中最新发生的事件(从本地的podCache中获取)，如果是一个新建的Pod，则主要是通过PLEG中更新时间操作，广播的默认空状态来作为最新的状态</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-同步最新状态">2.3 同步最新状态<a href="#23-同步最新状态" class="hash-link" aria-label="2.3 同步最新状态的直接链接" title="2.3 同步最新状态的直接链接">​</a></h3>
<p>当从本地的podCache中获取到最新的状态信息和从事件源获取的Pod信息后，会结合当前当前statusManager和probeManager里面的Pod里面的容器状态来更新，从而获取当前感知到的最新的Pod状态</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24-准入控制检查">2.4 准入控制检查<a href="#24-准入控制检查" class="hash-link" aria-label="2.4 准入控制检查的直接链接" title="2.4 准入控制检查的直接链接">​</a></h3>
<p>之前的准入检查是Pod运行的资源硬性限制的检查，而这里的准入检查则是软状态即容器运行时和版本的一些软件运行环境检查，如果这里检查失败，则会讲对应的容器状态设置为Blocked</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="25-更新容器状态">2.5 更新容器状态<a href="#25-更新容器状态" class="hash-link" aria-label="2.5 更新容器状态的直接链接" title="2.5 更新容器状态的直接链接">​</a></h3>
<p>在通过准入检查之后，会调用statusManager来进行POd最新状态的同步，此处可能会同步给apiserver</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="26-cgroup配置">2.6 Cgroup配置<a href="#26-cgroup配置" class="hash-link" aria-label="2.6 Cgroup配置的直接链接" title="2.6 Cgroup配置的直接链接">​</a></h3>
<p>在更新完成状态之后会启动一个PodCOntainerManager主要作用则是为对应的Pod根据其QOS等级来进行Cgroup配置的更新</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="27-pod基础运行环境准备">2.7 Pod基础运行环境准备<a href="#27-pod基础运行环境准备" class="hash-link" aria-label="2.7 Pod基础运行环境准备的直接链接" title="2.7 Pod基础运行环境准备的直接链接">​</a></h3>
<p>接下来kubelet会为Pod的创建准备基础的环境，包括Pod数据目录的创建、镜像秘钥的获取、等待volume挂载完成等操作创建Pod的数据目录主要是创建 Pod运行所需要的Pod、插件、Volume目录，并且会通过Pod配置的镜像拉取秘钥生成秘钥信息，到此kubelet创建容器的工作就已经基本完成</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3containerruntime">3.ContainerRuntime<a href="#3containerruntime" class="hash-link" aria-label="3.ContainerRuntime的直接链接" title="3.ContainerRuntime的直 接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-15%2016.28.11.png" alt="iShot2020-10-15 16.28.11" class="img_ev3q"></p>
<p>前面我们提到过针对Pod的操作，最终都是基于事件和状态的同步而完成，在containerRUntime并不会区分对应的事件是创建还是更新操作，只是根据当前的Pod的信息与目标状态来进行对比，从而构建出对应的操作，达到目标状态</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-计算pod容器变更">3.1 计算Pod容器变更<a href="#31-计算pod容器变更" class="hash-link" aria-label="3.1 计算Pod容器变更的直接链接" title="3.1 计算Pod容器变更的直接链接">​</a></h3>
<p>计算容器变更主要包括：Pod的sandbox是否变更、短声明周期容器、初始化容器是否完成、业务容器是否已经完成，相应的我们会得到一个几个对应的容器列表：需要被kill掉的容器列表、需要启动的容器列表，注意如果我们的初始化容器未完成，则不会进行将要运行的业务容器加入到需要启动的容器列表，可以看到这个地方是两个阶段</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-初始化失败尝试终止">3.2 初始化失败尝试终止<a href="#32-初始化失败尝试终止" class="hash-link" aria-label="3.2 初始化失败尝试终止的直接链接" title="3.2 初始化失败尝试终止的直接链接">​</a></h3>
<p>如果之前检测到之前的初始化容器失败，则会检查当前Pod的所有容器和sandbox关联的容器如果有在运行的容器，会全部进行Kill操作，并且等待操作完成</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-未知状态容器补偿">3.3 未知状态容器补偿<a href="#33-未知状态容器补偿" class="hash-link" aria-label="3.3 未知状态容器补偿的直接链接" title="3.3 未知状态容器补偿的直接链接">​</a></h3>
<p>当一些Pod的容器已经运行，但是其状态仍然是Unknow的时候，在这个地方会进行统一的处理，全部kill掉，从而为接下来的重新启动做清理操作，此处和3.2只会进行一个分支，但核心的目标都是清理那些运行失败或者无法获取状态的容器</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-创建容器沙箱">3.4 创建容器沙箱<a href="#34-创建容器沙箱" class="hash-link" aria-label="3.4 创建容器沙箱的直接链接" title="3.4 创建容器沙箱的直接链接">​</a></h3>
<p>在启动Pod的容器之前，首先会为其创建一个sandbox容器，当前Pod的所有容器都和Pod对应的sandbox共享同一个namespace从而共享一个namespace里面的资源，创建Sandbox比较复杂，后续会继续介绍</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-启动pod相关容器">3.5 启动Pod相关容器<a href="#35-启动pod相关容器" class="hash-link" aria-label="3.5 启动Pod相关容器的直接链接" title="3.5 启动Pod相关容器的直接链接">​</a></h3>
<p>Pod的容器目前分为三大类：短生命周期容器、初始化容器、业务容器，启动顺序也是从左到右依次进行,如果对于的容器创建失败，则会通过backoff机制来延缓容器的创建，这里我们顺便介绍下containerRuntime启动容器的流程</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="351-检查容器镜像是否拉取">3.5.1 检查容器镜像是否拉取<a href="#351-检查容器镜像是否拉取" class="hash-link" aria-label="3.5.1 检查容器镜像是否拉取的直接链接" title="3.5.1 检查容器镜像是否拉取的直接链接">​</a></h4>
<p>镜像的拉取首先会进行对应容器镜像的拼接，然后将之前获取的拉取的秘钥信息和镜像信息，一起交给CRI运行时来进行底层容器镜像的拉取，当然这里也会各种backoff机制，从而避免频繁拉取失败影响kubelet的性能</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="352-创建容器配置">3.5.2 创建容器配置<a href="#352-创建容器配置" class="hash-link" aria-label="3.5.2 创建容器配置的直接链接" title="3.5.2 创建容器配置的直接链接">​</a></h4>
<p>创建容器配置主要是为了容器的运行创建对应的配置数据，主要包括：Pod的主机名、域名、挂载的volume、configMap、secret、环境变量、挂载的设备信息、要挂载的目录信息、端口映射信息、根据环境生成执行的命令、日志目录等信息</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="353-调用runtimeservice完成容器的创建">3.5.3 调用runtimeService完成容器的创建<a href="#353-调用runtimeservice完成容器的创建" class="hash-link" aria-label="3.5.3 调用runtimeService完成容器的创建的直接链接" title="3.5.3 调用runtimeService完成容器的创建的直接链接">​</a></h4>
<p>调用runtimeService传递容器的配置信息，调用CRI，并且最终调用容器的创建接口完成容器的状态</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="354-调用runtimeservice启动容器">3.5.4 调用runtimeService启动容器<a href="#354-调用runtimeservice启动容器" class="hash-link" aria-label="3.5.4 调用runtimeService启动容器的直接链接" title="3.5.4 调用runtimeService启动容器的直接链接">​</a></h4>
<p>通过之前创建容器返回的容器ID，来进行对应的容器的启动，并且会为容器创建对应的日志目录</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="355-执行容器的回调钩子">3.5.5 执行容器的回调钩子<a href="#355-执行容器的回调钩子" class="hash-link" aria-label="3.5.5 执行容器的回调钩子的直接链接" title="3.5.5 执行容器的回调钩子的直接链接">​</a></h4>
<p>如果容器配置了PostStart钩子，则会在此处进行对应钩子的执行，如果钩子的类型是Exec类则会调用CNI的EXec接口完成在容器内的执行</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-运行沙箱容  器">4. 运行沙箱容器<a href="#4-运行沙箱容器" class="hash-link" aria-label="4. 运行沙箱容器的直接链接" title="4. 运行沙箱容器的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-15%2016.28.56.png" alt="iShot2020-10-15 16.28.56" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-拉取sandbox镜像">4.1 拉取sandbox镜像<a href="#41-拉取sandbox镜像" class="hash-link" aria-label="4.1 拉取sandbox镜像的直接链接" title="4.1 拉取sandbox镜像的直接链接">​</a></h3>
<p>首先会拉取sandbox镜像</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-创建沙箱容器">4.2 创建沙箱容器<a href="#42-创建沙箱容器" class="hash-link" aria-label="4.2 创建沙箱容器的直接链接" title="4.2 创建沙箱容器的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="421-应用securitycontext">4.2.1 应用SecurityContext<a href="#421-应用securitycontext" class="hash-link" aria-label="4.2.1 应用SecurityContext的直接链接" title="4.2.1 应用SecurityContext的直接链接">​</a></h4>
<p>在创建容器之前会先根据SecurityContext里面的配资信息，来进行容器SecurityContext的配置，主要包括特权等级、只读目录、运行账户组等信息</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-其余基础信息">4.3 其余基础信息<a href="#43-其余基础信息" class="hash-link" aria-label="4.3 其余基础信息的直接链接" title="4.3 其余基础信息的直接链接">​</a></h3>
<p>除了应用SecurityContext还会进行断开、OOMScoreAdj、Cgroup驱动等信息的映射</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-创建容器">4.4 创建容器<a href="#44-创建容器" class="hash-link" aria-label="4.4 创建容器的直接链接" title="4.4 创建容器的直接链接">​</a></h3>
<p>根据上面的各种配置信息来进行容器的创建</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="45-创建checkpoint">4.5 创建checkpoint<a href="#45-创建checkpoint" class="hash-link" aria-label="4.5 创建checkpoint的直接链接" title="4.5 创建checkpoint的直接链接">​</a></h3>
<p>checkpoint主要是将当前sandbox的配置信息进行序列化，并且存储其当前的快照信息</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="46-启动sandbox容器">4.6 启动sandbox容器<a href="#46-启动sandbox容器" class="hash-link" aria-label="4.6 启动sandbox容器的直接链接" title="4.6 启动sandbox容器的直接链接">​</a></h3>
<p>启动sandbox容器则会直接调用StartContainer同时传入之前创建容器返回的ID完成容器的启动，并且此时会重写覆盖容器的dns配置文件</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="47-容器网络设置">4.7 容器网络设置<a href="#47-容器网络设置" class="hash-link" aria-label="4.7 容器网络设置的直接链接" title="4.7 容器网络设置的直接链接">​</a></h3>
<p>容器的网络配置主要是调用CNI插件来完成容器网络的配置，这里就先不展开了</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-pod容器启动总结">5. Pod容器启动总结<a href="#5-pod容器启动总结" class="hash-link" aria-label="5. Pod容器启动总结的直接链接" title="5. Pod容器启动总结的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-15%2016.29.20.png" alt="iShot2020-10-15 16.29.20" class="img_ev3q"></p>
<p>kubelet是容器管理的核心大管家，其负责各种准入控制、状态管理、探测管理、volume管理、QOS管理、CSI对接的统一调度，并且为Runtime运行时准备基础的数据和并反馈Pod当前的最新状态</p>
<p><img decoding="async" loading="lazy" src="https://gitea.pptfz.cn/pptfz/picgo-images/raw/branch/master/img/iShot2020-10-15%2016.29.38.png" alt="iShot2020-10-15 16.29.38" class="img_ev3q"></p>
<p>Runtime层则将kubelet组装的数据，按照CRI运行时的目标配置和kubelet管理的资源配置信息来进行资源的重组，并且根据Pod的容器的状态来决策容器的启停、创建等操作，并完成容器的基础配置环境的构建，并最终调用CRI完成容器的创建，而CRI运行时，则会讲传递过来的各种数据进行进一步的组合，并应用到主机和对应的namespace资源限制，并根据自己的容器服务组织数据，调用容器服务完成容器的最终创建</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/云原生/k8s/k8s知识点/pod/yaml文件"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">yaml文件</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/云原生/k8s/k8s知识点/存储/OpenEBS"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">OpenEBS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-基础筑基" class="table-of-contents__link toc-highlight">1. 基础筑基</a><ul><li><a href="#11-容器管理线程模型" class="table-of-contents__link toc-highlight">1.1 容器管理线程模型</a></li><li><a href="#12-基于事件驱动的状态最终一致性" class="table-of-contents__link toc-highlight">1.2 基于事件驱动的状态最终一致性</a></li><li><a href="#13-组件协作流程" class="table-of-contents__link toc-highlight">1.3 组件协作流程</a></li></ul></li><li><a href="#2kubelet创建容器流程" class="table-of-contents__link toc-highlight">2.Kubelet创建容器流程</a><ul><li><a href="#21-获取pod进行准入检查" class="table-of-contents__link toc-highlight">2.1 获取Pod进行准入检查</a></li><li><a href="#22-创建事件管道与容器管理主线程" class="table-of-contents__link toc-highlight">2.2 创建事件管道与容器管理主线程</a></li><li><a href="#23-同步最新状态" class="table-of-contents__link toc-highlight">2.3 同步最新状态</a></li><li><a href="#24-准入控制检查" class="table-of-contents__link toc-highlight">2.4 准入控制检查</a></li><li><a href="#25-更新容器状态" class="table-of-contents__link toc-highlight">2.5 更新容器状态</a></li><li><a href="#26-cgroup配置" class="table-of-contents__link toc-highlight">2.6 Cgroup配置</a></li><li><a href="#27-pod基础运行环境准备" class="table-of-contents__link toc-highlight">2.7 Pod基础运行环境准备</a></li></ul></li><li><a href="#3containerruntime" class="table-of-contents__link toc-highlight">3.ContainerRuntime</a><ul><li><a href="#31-计算pod容器变更" class="table-of-contents__link toc-highlight">3.1 计算Pod容器变更</a></li><li><a href="#32-初始化失败尝试终止" class="table-of-contents__link toc-highlight">3.2 初始化失败尝试终止</a></li><li><a href="#33-未知状态容器补偿" class="table-of-contents__link toc-highlight">3.3 未知状态容器补偿</a></li><li><a href="#34-创建容器沙箱" class="table-of-contents__link toc-highlight">3.4 创建容器沙箱</a></li><li><a href="#35-启动pod相关容器" class="table-of-contents__link toc-highlight">3.5 启动Pod相关容器</a><ul><li><a href="#351-检查容器镜像是否拉取" class="table-of-contents__link toc-highlight">3.5.1 检查容器镜像是否拉取</a></li><li><a href="#352-创建容器配置" class="table-of-contents__link toc-highlight">3.5.2 创建容器配置</a></li><li><a href="#353-调用runtimeservice完成容器的创建" class="table-of-contents__link toc-highlight">3.5.3 调用runtimeService完成容器的创建</a></li><li><a href="#354-调用runtimeservice启动容器" class="table-of-contents__link toc-highlight">3.5.4 调用runtimeService启动容器</a></li><li><a href="#355-执行容器的  回调钩子" class="table-of-contents__link toc-highlight">3.5.5 执行容器的回调钩子</a></li></ul></li></ul></li><li><a href="#4-运行沙箱容器" class="table-of-contents__link toc-highlight">4. 运行沙箱容器</a><ul><li><a href="#41-拉取sandbox镜像" class="table-of-contents__link toc-highlight">4.1 拉取sandbox镜像</a></li><li><a href="#42-创建沙箱容器" class="table-of-contents__link toc-highlight">4.2 创建沙箱容器</a><ul><li><a href="#421-应用securitycontext" class="table-of-contents__link toc-highlight">4.2.1 应用SecurityContext</a></li></ul></li><li><a href="#43-其余基础信息" class="table-of-contents__link toc-highlight">4.3 其余基础信息</a></li><li><a href="#44-创建容器" class="table-of-contents__link toc-highlight">4.4 创建容器</a></li><li><a href="#45-创建checkpoint" class="table-of-contents__link toc-highlight">4.5 创建checkpoint</a></li><li><a href="#46-启动sandbox容器" class="table-of-contents__link toc-highlight">4.6 启动sandbox容器</a></li><li><a href="#47-容器网络设置" class="table-of-contents__link toc-highlight">4.7 容器网络设置</a></li></ul></li><li><a href="#5-pod容器启动总结" class="table-of-contents__link toc-highlight">5. Pod容器启动总结</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">笔记</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 泡泡吐肥皂o</div></div></div></footer></div>
</body>
</html>